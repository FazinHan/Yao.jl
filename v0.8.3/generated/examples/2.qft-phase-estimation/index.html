<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.3/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.3/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.166107+0.0321206im     0.102035-0.104196im     -0.00735135+0.195075im      -0.0333981-0.00855957im  -0.000206212-0.144279im    -0.0264683-0.0621625im    -0.0536019-0.0279225im      0.119877-0.130338im      -0.136833-0.0465954im    -0.0187542-0.10619im          0.155641+0.0562241im   -0.0453376-0.0485903im    -0.276782+0.130148im      -0.102099-0.111643im   -0.0911191-0.0329198im      0.013058+0.0681058im      0.162567+0.0677885im       0.13284-0.0656398im     0.162181-0.186224im      -0.233535-0.249209im    -0.217705+0.0535524im     0.0111883+0.028078im     0.00204035-0.125715im       0.124139-0.0990117im    -0.0119844-0.230581im     -0.141216-0.0144474im    -0.0456307-0.0886799im       0.159539+0.194854im      -0.345926-0.00328541im   -0.0189905-0.0640338im     0.211328+0.0499727im   -0.0197421-0.118949im
  -0.0597386-0.0946299im     -0.18349-0.112468im        0.128725-0.0284572im       0.104548-0.142261im        0.034233-0.294413im    -0.0324306+0.00562782im   -0.0185787+0.0150469im     -0.257991+0.118407im     -0.0702913+0.232582im     0.00910327-0.0907651im       -0.129835-0.158346im     0.0169105-0.045572im     -0.125575+0.164968im      0.0647685+0.265472im   -0.0924233-0.00127847im     0.212397+0.0287704im     0.0453777+0.121362im     -0.0495749+0.173744im      0.216015+0.0184572im     -0.101358-0.136893im   0.00087762-0.127026im    -0.00673314+0.136361im        0.13394-0.188276im      0.0895046+0.124139im     -0.0603815+0.2302im        -0.11789+0.10964im      -0.0217386+0.103892im        0.114823-0.0712826im     0.0556735-0.207541im     -0.0260606+0.0620093im    -0.180388-0.0186253im    0.0646753+0.0429863im
    0.153138+0.0614097im    -0.156602-0.222052im       -0.272518-0.171213im        0.060251+0.0701131im     -0.0507368-0.00584263im   0.0953301-0.0547369im      0.140239+0.0798906im     -0.124108-0.159931im      -0.115808-0.10259im      -0.0440821-0.0459222im       0.0555861+0.119273im     0.0236641-0.0687744im    0.0611329-0.104774im       0.112485+0.188807im    0.0472177+0.0531846im   -0.00723795+0.0513511im     0.0127243-0.182905im       0.145834+0.121622im        0.2022+0.126964im      -0.163814+0.0844155im   -0.213263+0.0342647im      0.394475-0.0250465im     -0.065303+0.0474164im     0.0485941+0.0932023im    -0.0896247-0.127867im      0.199496+0.00841656im    -0.244796-0.0842448im     -0.0232023+0.0400226im       0.12898-0.124879im     -0.0713131+0.110932im      0.138595-0.00573424im   0.0188558-0.00327801im
    0.214186-0.0198278im    0.0709734+0.0532631im      0.0532009-0.0241003im      -0.190635+0.139342im      -0.0295574-0.100703im    -0.0205682+0.0179487im     0.0083646-0.0945684im     -0.104486-0.090408im       0.211546+0.142825im       0.225267+0.196844im       -0.0128967+0.359538im    -0.0222959-0.0745055im   0.00393029+0.015489im      0.0728097+0.187072im   -0.0498432-0.118899im      0.0115116+0.23897im      0.00136743+0.295281im      -0.102996-0.259149im      0.087509+0.0532843im    -0.0744144-0.0151409im   0.0967492+0.0249612im   -0.00418001-0.0432435im      -0.14341-0.0365527im      0.236468-0.127011im       0.129032-0.13897im       0.012284+0.00046128im    -0.192388+0.084504im       0.0669687+0.00413792im    0.0595231+0.058712im     -0.0192131+0.00266232im   -0.130997+0.0528379im    -0.170719+0.118354im
   0.0510369+0.0734516im   -0.0900119+0.208968im      -0.0354038+0.00741531im      -0.18978+0.194536im      -0.0318984-0.101469im     0.0212061-0.196404im     -0.0804492-0.00397802im    -0.252993-0.0748136im    -0.0322196+0.0462427im     0.0722502-0.095088im         0.126536-0.134765im    -0.0193495-0.037998im     0.0455871+0.035835im      -0.123136+0.0653643im    0.191237-0.173967im      -0.120921+0.00133547im       0.1456+0.00925424im   -0.0222112+0.051644im     0.0888238+0.0905701im     -0.172229+0.0522063im  -0.0013378-0.302386im      -0.157563-0.261514im     -0.0123885+0.115699im     -0.0223384+0.297075im       0.108247+0.015626im      0.114995-0.0415329im      0.123536-0.163915im       0.0241482-0.222222im      -0.201107+0.1043im         0.126992-0.111589im     0.0902553+0.0555986im     0.101279+0.0258993im
    0.059427-0.0385495im   -0.0385019+0.0746316im     -0.0384366+0.16905im        -0.169356+0.196611im       0.0456041-0.0781626im    -0.223654-0.0397799im     0.0992743+0.0987686im    -0.0370877-0.0387171im     -0.222221+0.0778789im    -0.0129082+0.0909328im       0.0893678+0.0761533im   -0.0926378-0.106259im      0.155291+0.109818im    0.000693243-0.200504im    0.0263958+0.181174im      0.0579565+0.108862im     -0.0062591-0.176203im      -0.303092+0.150503im      0.104523-0.206098im     -0.0532214+0.0157035im   0.0598727+0.0228225im      0.118773+0.102333im      0.0859843-0.0656606im     -0.156211+0.0105021im      0.231848+0.102865im     -0.156398-0.0803843im    -0.0935396-0.217068im       -0.229945+0.183573im      0.0381154+0.0408115im     0.0722605+0.144166im      -0.20329+0.0916857im   -0.0326273+0.031708im
   0.0175878+0.0987415im   -0.0738878-0.232708im         0.04512-0.0942194im      0.0187876+0.0490059im       0.131252+0.108468im        0.1026-0.0932143im      -0.44711-0.0415092im     0.0710108+0.0918396im     -0.123504+0.115561im       0.230868+0.0802316im    -0.000316745+0.0822303im    -0.196727+0.0687206im     0.028109-0.0557556im      0.171036+0.0797123im   -0.194151+0.208657im     -0.0375425+0.137633im    -0.00337802-0.164815im       0.019726-0.0762272im     -0.22843-0.12939im       0.0651466-0.111929im   -0.0292133-0.0828208im     0.0154287-0.0895917im    -0.0607694-0.092386im       0.133908+0.260058im      -0.156733+0.0277623im   -0.0265275-0.0991912im    -0.0383202-0.00258907im     -0.101972-0.0122592im     -0.069905+0.067228im       0.238911+0.0188234im   -0.0415725+0.11402im      0.0537956-0.0923219im
   0.0736389+0.149911im     0.0118333+0.126799im        0.353011+0.0993416im        0.10893+0.0406749im       -0.12851+0.145053im    -0.0412012-0.144954im       0.160508-0.0257245im      -0.25185+0.0307995im   -0.00294114-0.208038im       -0.15875+0.000912761im     0.0987188+0.134129im     0.0866982+0.166725im       0.06428-0.0162078im      0.107588+0.0546322im  -0.0309678-0.0930128im     -0.136333-0.0329912im      0.007866-0.164293im     -0.0344513+0.0573227im    -0.084143+0.0622546im    -0.0153149-0.414703im   -0.0115669+0.102093im       0.223789-0.0232157im    -0.0301492-0.0714545im     0.0815027+0.0154272im    -0.0267861+0.131258im     -0.138784-0.248009im      0.0586481+0.0946168im      0.0638753-0.0579212im    0.00545339-0.0037123im    -0.0456428-0.17968im     -0.0479405+0.159626im    -0.0237057+0.0834839im
  -0.0787263-0.0375267im     -0.11696-0.198094im      0.00498011+0.0239857im      0.0360141+0.0372651im      -0.109115+0.0824121im    -0.178481-0.176605im      0.0735537+0.00481217im   -0.0830533-0.107664im      -0.129325+0.118669im       0.185909+0.32295im         -0.144172+0.0516003im    0.0503814+0.182576im       0.27976-0.159341im      0.0660586-0.103181im   -0.0761921-0.11367im        0.211388-0.12491im        0.121734+0.0669259im     0.0734747+0.0557229im     0.181619+0.170256im       0.055049-0.0720708im   0.0234192+0.0930853im     -0.254638+0.0310624im     0.0577009-0.111284im      -0.149674-0.0751012im    -0.0415967+0.0700901im     0.106161+0.0111909im     0.0540678+0.0087528im       0.029924+0.0184282im    -0.0693383+0.0968797im    -0.0140577+0.0490031im         0.27+0.198333im     -0.101252-0.159775im
     0.11809-0.0417622im    -0.111459+0.11349im       -0.0874778+0.0200525im       0.117391+0.143016im       0.0315348-0.0382085im    0.0860289-0.237305im     -0.0949482-0.0985043im     0.0637002-0.152739im      0.0340649-0.196174im     -0.0752504+0.06018im          0.135764-0.280979im      0.180417-0.146223im     0.0214724-0.155705im       0.109718+0.127971im   -0.0650395+0.232287im      0.0807362-0.0919184im      0.111558+0.158449im       0.211238+0.0290884im    -0.065051-0.0728506im     0.0751025-0.0668269im    0.153372+0.0498299im    -0.0182189-0.0286361im     0.0648625-0.416895im     -0.0034522-0.128487im       0.196772-0.0438781im   0.00555719+0.0883669im     -0.116226-0.0953269im     -0.0464738-0.0520885im     0.0700497+0.150705im      0.0392453-0.161865im    -0.0848298-0.105213im    0.00770907+0.0627701im
 -0.00742309+0.0175446im   -0.0271442-0.0962882im   -0.000712589+0.0607103im       0.125963+0.0364638im      0.0156101-0.011583im      0.125816-0.027773im       0.160798-0.194184im     -0.0957883-0.0739997im    -0.0102026+0.0883805im    -0.0618602-0.122891im       -0.0159802+0.0920726im     0.051876-0.121898im      0.142141+0.0110856im      0.148465-0.101597im    0.0323638+0.338717im      -0.114378+0.0280832im    -0.0495251-0.0351021im    -0.0549904-0.209696im     0.0279199-0.0673702im      -0.03516+0.0726232im    0.220518+0.0866475im     -0.175266+0.23274im        0.195876+0.172897im        0.16269+0.227258im       0.104221-0.0633142im     0.101561+0.0665901im     0.0477597+0.0493365im        0.18857+0.0505941im    -0.0542898+0.0368994im     -0.247255-0.166762im     0.0294787+0.205904im      0.271493-0.0741576im
    0.184982+0.100413im    -0.0425851-0.124623im         0.10785+0.217488im       0.0187775+0.10928im        -0.138129-0.00349823im    0.101304-0.0534518im     -0.216387-0.174826im        0.02357-0.0493625im     -0.048331-0.169124im     -0.0879137-0.208688im         -0.23162+0.134073im     0.0246218+0.133347im     -0.114663-0.0843014im     0.0864432-0.152152im   -0.0122549-0.144235im       0.150167-0.0709565im     -0.125286-0.0599225im     0.0541699+0.125933im     0.0632051-0.115902im      -0.197616+0.0582956im    0.238497-0.0415782im     -0.142585-0.0554554im    -0.0679775+0.141682im      0.0434345-0.0435689im    -0.0253077+0.00190099im   0.0109867+0.186235im      0.0227197-0.273958im       0.0271502-0.0136332im      0.187986-0.186686im      0.0451373-0.0350447im      -0.1489+0.0108212im     -0.22901-0.119608im
  0.00518926+0.0786521im     0.134391+0.0591342im     -0.0345009+0.0341982im       0.226077+0.0235618im     0.00142721+0.257029im      0.269522-0.0122462im   -0.00842494-0.0223185im    -0.0873438+0.099335im     -0.0827601-0.0918831im      0.275027+0.0825357im      0.00552534+0.115876im      0.145299-0.132868im     -0.224137+0.420279im      -0.062959-0.15449im      0.181779-0.0742067im      0.162681+0.116044im     0.00456299-0.0234509im        0.0366+0.0987446im      0.12157+0.048649im       0.115759+0.152698im   -0.0149452+0.0443298im     0.0834609+0.0518371im    -0.0988874-0.154502im      0.0360912+0.0542433im     0.0685216+0.265739im     0.0999072+0.0778836im    -0.0238297+0.0175587im      0.0212857+0.0491101im     0.0547987+0.195109im      0.0560411-0.110575im     0.0431967+0.0430597im    0.0167901-0.0856051im
    0.283436+0.0204128im    -0.161067-0.054996im      -0.0500385+0.0668692im       0.253974-0.15955im        -0.114907+0.0551597im   -0.0494948-0.0378565im      0.110577+0.00278007im    0.0921423+0.0674866im       0.10262+0.17814im      -0.0988996+0.130262im       -0.0356982+0.0832922im    -0.086008-0.0502183im   -0.0325164-0.0605353im     -0.252379-0.209878im    -0.101751-0.0837866im      0.148836+0.0312427im       0.26356+0.0867001im     0.0112289-0.0461873im   -0.0135711+0.0270336im     -0.104625-0.194231im    0.0444828-0.0491616im      0.164325-0.0692782im     0.0860823+0.141741im      0.0717691+0.0615804im     -0.112468-0.0918258im     0.105978+0.143761im       0.151184-0.0491987im      -0.204309+0.0974121im    0.00591339+0.187341im       0.109805-0.0970657im    -0.175972-0.115764im      0.252341+0.110513im
  -0.0927456+0.0062252im    0.0413375-0.104142im        0.205081+0.233049im       -0.270004-0.127571im       -0.112818+0.0786181im     0.268055-0.0443004im      0.134589+0.171006im      -0.107565+0.0134143im     0.0592277+0.0254221im     0.0051954+0.0136148im        0.108365-0.203781im    -0.0753175-0.182801im     0.0212262-0.197244im      0.0583162-0.339459im    -0.327264+0.0359951im    -0.0880667+0.040287im     -0.0586708+0.241034im     -0.0562569+0.0637928im   -0.0335348+0.0592024im    -0.0650919+0.0963146im   -0.160249-0.0670169im    0.00795183-0.044235im      -0.156514-0.0891857im       0.09214+0.103478im     -0.0409835+0.109974im     0.0731859+0.000839083im   -0.095698-0.061362im       0.0375733+0.00241138im     0.236217+0.0210804im    -0.0358612+0.0307696im    0.0589212+0.00199597im   0.0507886+0.0133516im
     0.19977+0.052148im     0.0292359-0.0586753im      -0.164562+0.0545477im       0.219761+0.0161304im     -0.0556341+0.0588962im   -0.0864878-0.0656614im     -0.234603+0.198064im    -0.00228164+0.0333893im      0.145128-0.050713im      0.0385338+0.0611205im       -0.053649-0.0898695im   -0.0601752-0.135698im     0.0337904-0.0556021im     -0.145661+0.0632318im   0.0209313+0.0520195im     -0.437346+0.0696366im    -0.0381683+0.10838im      -0.0242078+0.23039im       0.107987-0.173994im      -0.113825-0.049785im    -0.115202+0.182882im      -0.116004-0.00389294im    0.0313067+0.0236359im    -0.0276951-0.0674777im     0.0467663+0.122963im       0.11979+0.0129095im       0.21264+0.121083im        0.283716+0.109401im      0.0420671+0.0264385im    0.00133651+0.190553im     -0.103983+0.171382im     -0.107997+0.0639103im
   -0.232881-0.101389im      0.129945-0.112886im       0.0730583-0.00107934im      0.189845-0.123958im       -0.233258+0.122205im     0.0713138-0.0936543im   -0.00924832-0.032928im      0.0862544-0.169633im       0.072056+0.170341im      0.0863929+0.0682382im        0.083297-0.295368im        0.2311+0.049955im    -0.0269287-0.0784386im    -0.0366089+0.0461471im   0.0491669+0.0561418im     0.0699809+0.145363im     -0.0990976-0.0946531im     -0.143713-0.155882im      0.108159-0.0493308im      -0.15634-0.0595172im  -0.0861887+0.00511626im     0.134628+0.0427427im     0.0480731+0.209036im    -0.00570763+0.00100353im     0.255369-0.0658548im     0.142993-0.0957im       -0.0203375+0.0364867im      -0.130777-0.19355im       -0.045023-0.0989422im      0.197609-0.0545329im     -0.18271+0.0448755im    -0.242114-0.0869162im
  -0.0363412-0.0207701im    -0.143059+0.084922im       -0.031963-0.171332im       0.0215542-0.144453im       -0.207017+0.139511im    -0.0617944-0.248816im     -0.0476858+0.0973438im      0.126533+0.00665654im   -0.0822821-0.203715im      0.0671261-0.00353442im       0.072053+0.0666983im    -0.108971+0.153775im    -0.0592313-0.174267im     -0.0419508+0.0569475im   0.0153329-0.184228im       0.111853-0.0408484im     -0.123688+0.0858942im     -0.307829-0.105189im     0.0701449-0.0897513im     0.0995873+0.104326im   -0.0881716+0.185342im    -0.00992668+0.0701783im     -0.123793-0.0773066im    -0.0440578+0.310832im       0.128656-0.0690822im    -0.192625+0.189787im     -0.0922626-0.0757226im       0.227706-0.00516483im   -0.0900815+0.00068496im    -0.115118+0.0156695im     -0.14534-0.0869334im     0.193917+0.00845157im
    0.178659+0.262811im      0.191136-0.0550111im      -0.185611+0.182518im       0.0619134-0.0413826im      0.0373079+0.0254745im    -0.175518-0.169569im      0.0745974-0.162916im     -0.0286671+0.0352808im      0.160439+0.165474im      0.0873928-0.264514im        0.0453616-0.0995316im    0.0770034+0.208696im    -0.0499409-0.0737019im    -0.0493642+0.0422572im   -0.119306-0.0456391im    9.68876e-5+0.128152im      0.0407253+0.0520852im     0.0182439-0.164232im     -0.198872+0.0784066im   -0.00278565+0.18662im    -0.0203207-0.0801817im      0.131134+0.0374445im    -0.0549118-0.16666im       -0.227991-0.0615604im   -0.00296407+0.242526im     0.0235481+0.0521039im    -0.0967045-0.0659682im     -0.0751666+0.0449316im     -0.191635-0.161512im      -0.174737+0.0913967im   -0.0341314+0.192177im     0.0739895-0.0189032im
   -0.018413-0.00984003im  -0.0594775-0.181993im      -0.0150278+0.0466275im      -0.183563+0.287503im        0.151838+0.183896im     0.0454032-0.0128546im    -0.0142485+0.21433im     -0.00838406+0.104815im       0.202774+0.00160943im   -0.0865782+0.0807613im        0.113076-0.0305194im    0.0256624-0.187856im     -0.152258-0.0600626im    0.00600991+0.0578406im    0.165976-0.296032im        0.18889-0.13486im      -0.0394837-0.0735225im      0.150672-0.158229im     -0.177913-0.102396im       -0.23644-0.193512im    0.0471833+0.0916045im    -0.0728192+0.149667im      0.0883929+0.0423172im    -0.0994551+0.0672147im      0.106194+0.0861746im    0.0159412+0.015223im     -0.0914644+0.176742im      -0.0612482-0.035678im      0.0578967-0.0232196im     -0.061649+0.173498im    -0.0534098+0.0629173im     0.178372-0.17626im
   0.0619813-0.167758im      0.099471-0.0282937im       0.112162+0.0723779im   -0.000543715+0.0562129im     -0.0347767+0.270712im     -0.121978-0.137647im     -0.0133968-0.0453698im    -0.0574918-0.0359734im     0.0466991+0.217123im      0.0742273-0.104528im        0.0114526+0.118151im      0.048587+0.0125478im  -0.00199852+0.213302im       0.264814+0.0134466im     0.16715+0.101465im      -0.177073-0.167343im       0.123159+0.206913im      0.0218326-0.0533001im    -0.126323+0.118372im     -0.0131531+0.0120638im   -0.258236+0.0765967im     0.0732599-0.0766735im      0.250531-0.0191307im    -0.0993324+0.059198im     0.00981868-0.149234im     -0.181845+0.158703im       0.123713-0.181422im       0.0562116+0.00725817im     0.205443-0.123476im       0.149017+0.0946985im    0.0368128-0.199041im     0.0173207-0.107581im
    0.227064-0.232562im    0.00375047+0.0633894im      0.0906167-0.0599873im     -0.0122747-0.0592641im    -0.00937949+0.0139107im     0.220499-0.195329im       0.173619+0.0191104im     0.0343597-0.101533im      0.0752545+0.0257523im     0.0336514-0.112829im        -0.150912-0.0274452im     0.165802-0.126169im      0.122837-0.00232369im    -0.102406+0.105901im    0.0500878-0.0761962im     -0.208112+0.0170389im    -0.0609814-0.0321852im     -0.163996+0.00626882im   0.0754108-0.230293im      0.0171897-0.0686102im    0.098069-0.00935967im   -0.0744383+0.117454im      -0.174497-0.0419661im    -0.0324745-0.0893447im     -0.291167+0.0256142im    -0.193981+0.155754im      -0.115595+0.0704245im      -0.243321+0.0273801im     -0.118035-0.0715839im       0.24916+0.0292947im     0.231943+0.0689044im     0.105617-0.164207im
   -0.188203+0.160487im    -0.0462253-0.00446082im      0.205066-0.0418349im       0.101717-0.152748im        0.100998-0.213804im     -0.191739-0.121882im      0.0430547-0.0118113im     0.0186454-0.182744im       0.146686-0.229628im      0.0544547-0.0115429im        0.125032+0.115128im      0.118198+0.0493558im    0.0366655+0.0031308im     0.0364985-0.0841382im   0.0772787+0.00534572im   -0.0658945+0.0802942im     0.0332104+0.106297im        0.32391-0.0299326im     0.131873-0.139197im      0.0495716+0.1583im     -0.0677077-0.131895im     -0.0121633-0.0723755im     0.0499274+0.182201im      -0.014653+0.0959307im    -0.0793857+0.0535736im    -0.200158+0.0768606im    -0.0792235+0.12819im        -0.145905-0.0255668im      0.178718+0.245363im      0.0457953+0.236662im     -0.166892+0.141577im     0.0514568-0.105659im
  -0.0612367-0.0650984im     0.223574-0.156589im       -0.231711-0.0752888im      -0.108326-0.0376709im      0.0133995-0.220106im    -0.0168077-0.290669im      0.0268308+0.147758im      -0.222942+0.274552im       0.219685-0.0382809im     -0.114656+0.263584im      -0.00496274-0.0155471im     0.259388+0.258318im    -0.0964496+0.14109im      -0.0616285-0.0822816im  -0.0668273+0.0815024im   -0.00912554-0.0631296im     0.0021551-0.0765652im   -0.00898312-0.0568135im   -0.0216871-0.155854im      0.0473627+0.0255979im    0.221403-0.0312648im     0.0717723-0.0276655im    -0.0437514+0.00706236im    0.0201032+0.14624im       -0.049282-0.156103im    -0.0176615-0.0503692im     0.0383649-0.111099im        0.144881+0.11368im        0.144599-0.0404181im      0.115036-0.0347059im     0.091494-0.0299999im    -0.028802+0.0377451im
  0.00120378-0.223018im      0.104683+0.110517im       -0.136857+0.016309im       -0.098338+0.211765im    -0.000911087+0.214168im     -0.128214+0.00650147im   -0.0576038-0.0817837im      0.142702-0.110423im      0.0292403-0.0301797im      -0.15721-0.0770937im      -0.0374516-0.0886079im    -0.029843+0.0015512im     0.165794+0.0536196im     -0.153684-0.0475833im   0.0187525+0.0950927im      0.217892+0.0128223im     -0.110995+0.130826im       0.164819-0.179546im      0.181207+0.00701183im   -0.0887919+0.0270741im  -0.0329721-0.0467294im      0.149878+0.142471im      -0.108666-0.124048im       0.130833+0.291405im      -0.317501+0.0875854im    -0.111666-0.068296im        0.24538+0.0548753im      0.0262407-0.066211im      0.0819494+0.000323054im  -0.0201863+0.0103317im   -0.0176006+0.169247im     -0.161326+0.176333im
   -0.203598-0.139504im     -0.204907-0.0550198im     -0.0653615+0.0661355im     -0.0374405+0.0732524im     -0.0705387+0.0872609im    0.0593751+0.00819408im   -0.0850537+0.0782046im     -0.338125+0.121435im     -0.0857219+0.0424479im   -0.00412533-0.151839im        0.0142103+0.0694992im     0.145982-0.140372im     0.0451251-0.104264im      -0.232182+0.0887504im   -0.144788+0.00173842im   -0.0466774+0.0659782im    -0.0730571-0.0911515im      0.159835-0.085212im    -0.0346172+0.236292im       0.162091+0.109865im    0.0360166+0.0364222im     0.0933203+0.0281154im     -0.141945+0.0214749im     0.0513306-0.250211im      0.0493813-0.177684im     -0.219547+0.0921352im      0.241299-0.10624im        0.0108829+0.077372im     -0.0989811+0.0987164im     0.0492214+0.0591758im    -0.254976+0.121288im     0.0370866-0.164029im
   -0.125404-0.241349im     -0.265368-0.123048im      -0.0452178-0.120783im       -0.045826+0.0884873im      -0.108072-0.046541im      0.088188+0.0753108im    -0.0223061-0.157304im       0.109559+0.208705im      -0.170009+0.00999141im    0.0218427-0.201644im        -0.112722-0.155187im     0.0912883+0.22898im     -0.0261628+0.0852656im     0.0174058-0.0373462im    0.120223-0.183039im      -0.252967+0.019868im       0.139759+0.273073im     -0.0348472-0.0959863im   -0.0719724-0.0797157im    -0.0554851-0.070012im    0.0638526+0.097128im       0.137714-0.039913im      0.0181027+0.0389176im    -0.0393538-0.0102094im      0.014084+0.0918463im    0.0732827-0.173609im      -0.181234-0.0979248im     -0.0735424+0.1554im         0.149571+0.255882im      -0.108221-0.00126641im  -0.0039745+0.181982im    -0.0340423+0.0671809im
   -0.168059+0.0594883im   -0.0794891-0.141495im      -0.0297879+0.134416im       0.0502315-0.0537259im      -0.237038-0.0101907im   -0.0726307-0.0112206im    -0.0513065-0.0692699im     0.0130416+0.00750802im    0.0236388+0.0469295im     -0.158057+0.0218404im        0.309729+0.173891im     -0.110264+0.0467009im    -0.112186+0.139518im      -0.137005+0.22413im     0.0636796+0.0920972im      -0.11986+0.00900981im   -0.0926535+0.115476im     -0.0264847+0.108749im    0.00652205+0.095277im     -0.0433992+0.0399038im    0.144442+0.170367im      -0.239487-0.0096814im     -0.189063-0.160462im      0.0134035+0.133762im      0.0398599-0.0350736im    0.0558301-0.00110982im     0.117425+0.0678664im      -0.471179+0.014865im       0.153978-0.127409im     -0.0705053-0.0271107im     0.156514-0.00735318im   0.0125587+0.0230558im
   0.0410543-0.0462072im     0.199663+0.152624im         0.11694+0.0889932im     0.00488878-0.0718329im     -0.0552098-0.212405im      0.180457-0.0990211im    -0.0318295+0.11993im        0.086449+0.196861im      -0.131309+0.00491441im     0.145857-0.00841121im      0.0552465+0.0596508im     0.129939-0.17189im      0.0453833-0.215897im     -0.0261492+0.109498im     0.116489+0.0556811im      0.118018-0.110916im       0.315935+0.0127873im       0.02891+0.0689672im    -0.166991+0.104082im     -0.0685575+0.127168im    0.0829453+0.286353im      0.0405061-0.0131356im     0.0955648+0.116219im      0.0927986+0.23865im        -0.13979+0.0296456im   -0.0511973-0.0201596im     0.0276701-0.000931858im    -0.109643+0.0960662im      -0.15856-0.0225595im     -0.174373+0.131382im    -0.0471049+0.0206794im    -0.304426-0.0050353im
   0.0898663-0.136126im     -0.164492-0.0708677im      -0.118277-0.0683298im      0.0681583+0.0382269im     -0.0928382+0.0561425im    0.0893184+0.113857im       0.103268+0.0610027im    -0.0504504-0.171285im       0.211503+0.0664735im     0.0526971+0.127413im        0.0380656-0.0995233im    -0.156013-0.0442844im    -0.132532+0.111951im      0.0313921-0.069697im   -0.0943231-0.0263449im    -0.0771178+0.0561551im      0.138912-0.125094im      0.0674666+0.0106886im   -0.0547439-0.155932im       0.270682-0.107316im    0.0311263-0.104934im      0.0181892-0.17409im     -0.00313149+0.0850629im    -0.0180993+0.142502im      0.0727555+0.0670691im    -0.291461+0.138868im      0.0381131-0.104322im      -0.0639083-0.114432im     -0.0415287-0.0742191im     -0.423003-0.0554065im    0.0644875+0.071886im      -0.32131-0.0978239im
 -0.00268579+0.0291046im   -0.0489706-0.079863im      -0.0245114-0.215884im        0.176215+0.00327039im     0.0943927+0.025683im     0.0577118-0.00872815im     0.345651-0.112777im      0.0238504-0.0435937im    -0.0316786+0.109992im      -0.174841-0.0415319im       0.0864177+0.103301im      0.156256-0.119156im    -0.0732151-0.0340813im     0.0720829+0.0274321im   0.0840489-0.00809083im     0.147002-0.00168711im    0.0383787+0.0332311im     -0.115392+0.0347364im    -0.216412-0.137537im     0.00559383-0.0167759im   -0.202043-0.118855im      -0.338338-0.0719665im     -0.273312-0.120882im      0.0298704+0.0231177im    -0.0738369-0.0236704im    0.0825262-0.247235im       0.166713-0.214545im        0.131183+0.0791595im   -0.00106906+0.0533054im     0.0402059+0.212578im     -0.185176+0.0337001im     -0.12734-0.00794065im
   0.0764832-0.0131549im    -0.128361-0.132699im     -0.00513206+0.253651im       -0.171716-0.057838im        0.269643+0.0505446im     0.139487-0.0821447im     0.0854181-0.115186im       0.118927+0.13519im       -0.149238+0.0706952im    -0.0855669+0.145954im         0.068724+0.00712709im   0.0760654+0.196364im    -0.0571791-0.134452im      0.0523524+0.0745784im    0.153727-0.0728138im     -0.123091+0.0278381im      0.163903-0.188146im     -0.0575795+0.0275676im    0.0732904-0.058062im    0.000842072+0.177307im    -0.247541-0.148522im     -0.0280464+0.130871im     -0.0337902-0.0700389im     0.0164384-0.0333337im     0.0717048-0.111216im    -0.0678127+0.269122im       0.148925+0.275469im     -0.00106799-0.0315353im     0.0824917+0.0735455im    -0.0225032-0.181977im    -0.0626625+0.0782429im    -0.158038+0.197665im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.03125596234581798 + 0.004772828550472859im
   -0.06279137486297925 + 0.19653450036080874im
    0.33093021935207245 + 0.0im
    0.06679054128989001 - 0.05899047930084024im
   0.007263545537369466 + 0.20045141362860694im
   -0.08945806421446229 - 0.18944083296266045im
    0.07634713319407725 - 0.054439583872961564im
  -0.013086866451566795 + 0.01586005988524141im
 -0.0010488939607317994 + 0.13735134494533313im
   -0.05647399748653744 + 0.019123739187443898im
   -0.04816561794879983 - 0.10428369872410996im
  -0.022817702754717974 + 0.0376246982271875im
    0.11026821482833193 - 0.038923690507975686im
    0.17788328612228171 - 0.03013379552603133im
    0.15774568078014797 + 0.15293492585846272im
   -0.19229162339808972 - 0.005851858758615097im
    0.15755482639035354 - 0.290442930474842im
    0.17358893450226426 - 0.138382574479644im
   -0.11499443589792807 - 0.10553686203458833im
   -0.12362598736762974 + 0.028106836503196075im
    -0.1534325640091561 + 0.27464519412598426im
   -0.13958737037718857 - 0.0075136278543781986im
  -0.015549003036566682 + 0.2398278705368089im
   -0.14761627891817594 - 0.1744941754216579im
   -0.04172271493337141 - 0.08669870088773846im
    0.06088631081763683 - 0.1902130296152439im
    0.11258515889915904 + 0.07902828139491636im
   0.014798049930336874 + 0.1202399752812078im
    0.07938161396770355 - 0.0635416702939339im
   0.048462596124257185 - 0.028493278660527626im
    0.17350359168197613 + 0.13784627545379793im
   0.028455686874092313 + 0.05485846251840856im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 21:23">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.5/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.5/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.211493-0.082228im     -0.0751609-0.0422532im   0.00805546+0.111134im       0.109336+0.283528im     0.0756865+0.175356im      -0.10906+0.0270517im    0.0384002-0.0223157im     -0.02306-0.0444446im   -0.00131816+0.0573814im      0.186512+0.0948926im    0.0206505-0.225867im       0.0611037-0.17411im       0.114249-0.103844im       0.228197+0.0675623im   -0.0609857+0.237333im      -0.0557162-0.129848im      0.176869+0.0651913im    -0.290289-0.0601549im       0.044907+0.0622429im     0.161607-0.151687im      0.135945+0.0991085im    0.0408185+0.163812im      0.0992158+0.0517142im       0.206197+0.15757im       -0.123133-0.204368im      -0.0478814+0.011979im       -0.206195+0.107027im      0.0448875-0.113186im      -0.0602167+0.0538102im      0.155732-0.0225131im   -0.0446497-0.0356942im     0.0511525-0.0961329im
   0.0206921+0.128728im      -0.080794-0.11375im      0.0220753+0.171072im      -0.142186-0.060105im     -0.162019+0.0990571im   -0.0197714+0.0918361im    -0.202926+0.00789731im  -0.0870468+0.32394im       -0.211035-0.00831264im     0.149445-0.0706826im    0.0995368-0.155626im       0.0642549+0.135231im     -0.295119+0.211342im      0.0528806+0.140902im      0.022716+0.0486111im      -0.161218+0.12778im      0.0340368-0.107001im     0.0735643-0.0455194im       0.115853+0.0667275im   -0.0712792-0.0478791im    -0.123984-0.123413im      0.248791-0.00136485im   -0.0767842-0.024357im       0.0223446-0.0717275im      0.163627-0.145595im        0.108669+0.0102369im      -0.150718+0.00319921im    -0.159967-0.247171im      -0.0610143+0.0332045im     0.0176912-0.13103im      -0.136782+0.123131im     -0.0767392+0.0434426im
    0.198955-0.219961im      0.0580746-0.330971im     0.0363884-0.257889im     0.00677186-0.0976807im    0.0720616+0.051823im     0.0211238-0.14824im       0.119683-0.0369765im   -0.0826444-0.192573im      0.0178427+0.0366907im   -0.00567001+0.129835im     -0.203001+0.0536176im      -0.145318+0.10851im      0.0461376+0.128942im       0.124443+0.134017im     0.0424246+0.192462im        -0.14597+0.0661332im   -0.0626907+0.00799307im   0.0632998-0.156382im         0.16494-0.260309im     0.0241629+0.00122482im  -0.0207031-0.0523201im    0.0317466-0.212898im        0.10718-0.124241im        0.111373-0.0401447im      0.327527-0.0237746im      0.0437795+0.149927im    -0.000631571-0.0462401im     0.0665861-0.015321im        0.103437-0.0739193im      0.138648-0.0696088im    0.0415584+0.0491567im     0.0638246+0.116646im
    0.175032-0.0625423im     -0.180525-0.0752821im    -0.176022+0.145274im      -0.160735-0.0718133im   -0.0416737-0.0519266im    0.0432586+0.00914214im   0.0695424-0.0486129im     0.127642-0.106775im     -0.0667289+0.0553073im     -0.132477-0.0591001im   -0.0832675-0.0116795im       0.301929+0.0254333im   -0.0761919-0.0248022im      0.059566+0.0669651im     0.120608-0.0710974im     -0.0236667-0.0443101im      0.12364-0.0304359im    0.0223778+0.190037im    -0.000807614+0.0292654im    -0.287242-0.0276356im     0.176815+0.00169549im  -0.0378852+0.054333im       0.152624-0.0277417im       -0.10985+0.241008im       0.182865+0.144775im        0.116355-0.10177im       -0.0174928+0.0525984im      0.180773+0.0434836im        0.16163+0.350612im     -0.0665809-0.255081im     0.0569577-0.0500729im      0.171714-0.0476535im
    0.116642-0.116378im       0.065618-0.159172im      0.222648+0.186237im      -0.172367-0.0291095im    -0.325979-0.0904266im   0.00212273+0.0668052im   -0.0395074+0.0939419im    0.0281878-0.0448523im      0.137419-0.0134945im   -0.00617864-0.0262608im    0.0132101+0.147504im      0.00114559-0.0318799im     -0.11692-0.0231316im     0.0289197-0.0958967im    0.0223506-0.103201im       0.0890253+0.125883im    -0.0915351+0.0218117im    -0.087107+0.323463im        0.149035+0.113913im      0.232111-0.171419im      -0.24904+0.0386872im   -0.0593532+0.133709im       0.138277-0.0496078im      0.0865239-0.103387im     0.00221827-0.197035im       -0.183214+0.0751986im      0.0495563-0.00972548im    0.0778284+0.113333im      -0.0576351-0.0569207im      0.051834-0.123598im        0.1843-0.145139im       0.154387+0.165246im
   -0.240062-0.149065im      0.0601675+0.0963177im   -0.0263983-0.00869201im   -0.0919714-0.0996311im     0.112958+0.0642849im    0.0255238+0.0476812im   -0.0704472-0.0108177im     0.203859+0.190554im      0.0438304+0.0400722im     0.0899161-0.00531135im  -0.0683057+0.0325178im      -0.107072-0.0165284im   -0.0535887-0.239813im       0.141677+0.27724im      0.0569564-0.0439405im     -0.0505599+0.0627857im     0.176312-0.175796im     0.0551895-0.0707174im       0.154407-0.190457im    -0.0514861-0.0543465im    0.0502826+0.0742192im     0.159481-0.0456573im    -0.0908462+0.16345im       -0.0371707+0.14918im       0.0214269-0.116724im        -0.35499-0.101459im       0.0160343-0.350613im       0.110807+0.142382im       -0.106055-0.0264437im    -0.0178092-0.0721036im       0.1198-0.11757im        0.026768-0.069528im
  -0.0805988-0.0485418im      0.022187-0.0675497im    -0.176547-0.249787im     -0.0571845+0.194659im     0.0755697+0.0484754im   -0.0835499+0.0712792im   -0.0410606+0.0316917im    -0.237441-0.0968715im     0.0182624+0.032472im      -0.217387-0.268193im      0.159571-0.147571im        0.069648+0.218376im    4.24011e-5-0.125627im      -0.131235-0.081715im     -0.217671-0.000786633im   -0.0515428+0.0354193im   -0.0127907-0.238359im      -0.11198+0.0259276im        0.22921+0.081978im    -0.0797987-0.00781277im   -0.151692+0.0353266im   -0.0614738-0.0990982im     -0.126224+0.0154022im        0.24151-0.0670286im     -0.022552-0.0430598im      -0.155216-0.209133im      -0.0160207+0.00689914im     0.121259-0.0754666im       0.123677+0.218158im      0.0212705+0.0962327im      0.14102+0.061357im      0.0319302+0.102839im
    0.089627-0.10681im       -0.070366-0.0528938im    -0.104324+0.0209035im   -0.00975771+0.139478im      0.210139-0.25056im       0.283903+0.144355im      -0.08031-0.0730922im   -0.0217195-0.188236im      -0.198624+0.240203im      -0.122727-0.0162713im     0.134372+0.0636148im     -0.0694008-0.0724346im   -0.0553845-0.0440231im    -0.0395474+0.0978906im    0.0527669-0.0609952im       0.149798+0.0250878im   -0.0281749-0.137677im    -0.0488539-0.0587156im      0.0757087+0.0741758im    -0.120544-0.156025im     -0.193521+0.149171im     0.0816624+0.0708581im     -0.134939-0.0460748im      0.0155626+0.0649566im      0.160824+0.0309371im      0.0653269+0.056858im      -0.0957872+0.136465im      -0.148599+0.218793im       -0.110113-0.241947im      0.0917574+0.0268945im    -0.222084-0.223002im     -0.0837519-0.0753543im
   0.0883456+0.135911im       0.113451+0.0686315im     0.141271+0.0463731im    -0.0202962+0.122249im     0.0631246-0.119858im    -0.0377655+0.190117im    -0.0414058+0.378721im     -0.142396+0.0146122im     -0.165669-0.18823im       0.0387889+0.0587373im   -0.0699037+0.153092im        0.161815-0.066069im     0.0865719-0.164474im       0.128267-0.058379im     0.0312928+0.160383im      -0.0398415-0.0775314im   -0.0950489-0.059445im      0.208928-0.104376im       -0.017125+0.0442374im    -0.119657-0.0486188im     0.197649-0.0510661im   -0.0726914-0.0460582im    -0.0992549-0.0158033im       0.207126-0.205346im      0.0619407-0.130614im        0.203748-0.12663im        0.0514915-0.230567im    -0.00679716+0.25288im       -0.0222534+0.0973907im     0.0614242-0.0586115im   -0.0876968-0.118843im      0.0833128+0.0849783im
    0.049229-0.0819108im      0.244048+0.157724im     -0.135464-0.0229597im     -0.272941-0.031812im      0.157497-0.0603122im   -0.0962415-0.0127256im    -0.287656-0.1098im      -0.0954447+0.103519im      0.0723628+0.105949im     -0.0129556-0.0989879im    0.0748619+0.0978771im      -0.128978-0.185587im    -0.0263626+0.00446456im     0.136537+0.138692im     0.0452813+0.144921im        0.064564-0.174708im    -0.0644374+0.270251im      0.101467-0.167834im        0.188255+0.0538554im   -0.0106058+0.0534581im    -0.213541-0.00713869im   -0.166949-0.0175319im      0.168608-0.0194863im     0.00311921-0.154151im      -0.126041+0.0752341im    -0.00425425+0.121787im       0.0660685+0.104248im     -0.0151264-0.0253689im   -0.000115224+0.264251im      -0.104375-0.159018im    -0.0584276+0.00949908im    0.0616625-0.146057im
   -0.108403-0.140102im      -0.120459+0.0691135im     0.172604-0.172696im      -0.131244-0.169275im     -0.021603-0.00338292im   -0.120239+0.0385341im   -0.0451785+0.127739im      0.119042-0.120164im      0.0516105-0.140545im    -0.00441141-0.0819444im    0.0055946-0.283299im       0.0797189+0.0716091im   0.00335012-0.214431im      0.0876845-0.00762401im   0.0959894+0.214611im        0.250192+0.0833858im    -0.102295+0.131897im     -0.071838+0.0854959im      0.0676894+0.140011im       -0.0487+0.0793703im   -0.0486015-0.108712im     0.0326252+0.0580968im   -0.00399714+0.148935im       -0.211599-0.0609845im      0.229696-0.173964im       0.0424402+0.104866im       0.0216228+0.0353474im     0.0774158+0.0451366im       0.200752+0.00453638im     0.138512+0.189513im     -0.166754-0.000397502im   -0.204618-0.218632im
   -0.257793-0.117094im     0.00339604-0.0552238im   -0.0255468+0.119057im      -0.112331+0.0797288im   -0.0205722+0.155155im      0.106647-0.213236im      0.083849-0.0173375im     0.203709-0.0222921im     -0.134162-0.0901041im    -0.0853293+0.174537im    -0.0302744+0.016183im       0.0176164-0.20093im     -0.0802949+0.0843393im     0.0384559-0.0120364im    -0.140994+0.030554im     0.000925926+0.162917im       0.12279-0.00142777im  -0.0936445-0.00527189im      0.122709+0.0322047im   -0.0212613-0.0918773im   -0.0346408-0.0744974im    -0.267208-0.0666829im   -0.00916976+0.1063im          0.120393-0.266204im      0.0377981+0.181114im         0.23259-0.186548im       0.0458313+0.0272524im     0.0959387-0.0611426im      -0.183405+0.0395384im       0.16082-0.0588569im     0.132301-0.120947im      -0.336339-0.0844785im
   0.0894977-0.0700303im     -0.141206-0.110882im     -0.044915+0.129891im     -0.0233677+0.0651572im    0.0779269-0.0574102im   -0.0199025-0.200577im     0.0423918-0.192652im       0.11915+0.215615im      0.0743523-0.160091im     -0.0781495-0.0882128im   -0.0118945-0.110196im       0.0112926-0.166581im      0.131006-0.195262im      0.0149386-0.1438im        0.101758-0.0892768im     -0.0898553-0.179904im     -0.266596-0.0687666im     0.065712-0.0577624im      0.0607543-0.00697954im  -0.0118698-0.317839im     -0.192129-0.0473238im    0.0106898-0.108659im       0.133531+0.17403im      0.000959395+0.0808942im     0.0350549-0.000823184im     0.131772-0.0243416im      0.0662842-0.203618im      0.0285729-0.138922im       0.0198725-0.0272746im     -0.154328+0.213399im     -0.207809-0.0238681im    -0.0191173+0.2599im
    0.147493+0.192724im     -0.0634515+0.00735272im    0.119313-0.229836im      0.0939104-0.0558489im    -0.049106+0.16199im     -0.0125133-0.0362752im     -0.25177-0.0405894im   -0.0423996+0.0289751im    -0.0897156+0.149818im      -0.215638+0.0733852im     -0.34292+0.14713im        0.0800938+0.0497376im    -0.109089-0.00716719im     0.119161-0.080132im     0.0661359+0.128261im       -0.255533+0.0182666im    0.0300887+0.103386im     -0.122576+0.0909716im     -0.0739984+0.0147045im   -0.0341111-0.0407606im    -0.206457+0.0703598im    -0.116092+0.178548im       -0.24593+0.125048im       0.0505655+0.0821328im      0.010661+0.0120978im     -0.0216388+0.0278545im      0.0535374-0.0213599im      0.223966+0.00492405im     -0.136405-0.00974945im    -0.274632+0.109464im    -0.0762119-0.0853878im    -0.0932514-0.0775359im
    0.089781-0.167228im      0.0953623+0.0416779im     -0.22769+0.00484408im    0.0502325-0.0342388im    -0.219497+0.20724im      -0.115443-0.0284944im   -0.0911956-0.0957822im     0.120866-0.077236im       0.107211-0.0631931im      0.165756-0.163724im    -0.0391743+0.0886609im     -0.0329957-0.0906306im     -0.24639+0.154269im      0.0973608+0.0717804im     0.121332+0.110448im       0.0209851-0.252811im     -0.193657-0.0919202im   -0.0779091+0.0915772im     -0.0355289+0.0151828im     0.039426+0.105423im      0.083999+0.14012im      0.0194606-0.10099im       -0.292484-0.142302im      -0.0833607-0.0749826im    -0.0590092+0.067061im        0.080262-0.20682im        -0.162792-0.0197515im    -0.0242409+0.112059im        0.135449-0.00356228im     0.102901+0.194485im     -0.029328-0.239115im     -0.0300967+0.149065im
   -0.171831+0.0641127im     -0.123925-0.102813im     -0.154601-0.147025im      0.0246093-0.0835021im     0.208738-0.167451im    0.00340281-0.050169im      0.187592+0.107648im      0.310288+0.0203615im    -0.0916911-0.134885im       0.114611+0.139799im      0.113847+0.0602364im     -0.0690474+0.0456221im   -0.0511079+0.149331im       0.159789+0.0977173im   -0.0845244+0.119663im       -0.168783-0.298939im     -0.168955-0.0607333im     0.113932+0.220018im       0.0686928+0.193565im     0.0216889+0.0075067im    -0.129188+0.0210109im   0.00681889+0.21097im      -0.0268105-0.0383687im        0.13475-0.0136884im     0.0207674-0.137786im      -0.0104182-0.0690885im      0.0329062+0.148233im    -0.00282436+0.0785332im     -0.0142928-0.0614071im     -0.159165+0.0405086im     0.141993+0.19798im        0.114014-0.110931im
  -0.0134132+0.129958im     0.00812177+0.0778869im   -0.0372308+0.101557im      -0.175503-0.0916799im    0.0102106+0.249842im      0.267831+0.00388621im  0.00214041-0.0234833im     0.099816-0.0624854im    -0.0518047+0.15648im         0.26239+0.0531015im   -0.0255373-0.00833265im    -0.0742135+0.178525im     -0.130091-0.18687im       -0.170448-0.287771im     0.0364634+0.0334187im       0.158262-0.169049im    -0.0972999+0.0906957im    -0.114512-0.0729759im    -0.00182165-0.119855im      0.130081-0.0868456im    0.0292549+0.167677im    0.00710622-0.0144627im    -0.0944989+0.168815im        0.277064-0.0696147im       0.21396+0.0832567im      0.0358697-0.0488066im       0.145988-0.0259948im    -0.0845103-0.0642487im       0.196139-0.0186808im    -0.0509739-0.109102im    -0.0116417+0.0959541im      0.174429-0.120483im
   -0.162511+0.115568im       0.229332-0.0187036im     0.180718-0.0886536im     -0.109676-0.236813im      0.104578-0.0388621im    -0.128374-0.0656061im    0.0312719-0.0572141im    -0.113525+0.0924101im      0.172396+0.0477794im      0.151592+0.0385695im    0.0167595+0.0286116im       0.251554-0.0729539im    0.0819625+0.00987273im    -0.020675-0.142184im     -0.156861-0.0332357im      -0.206824+0.0905503im    -0.154033-0.116681im     -0.170551-0.0471866im       0.254901-0.0234072im    -0.120346+0.0154474im   -0.0178449+0.228976im     0.0584664+0.104145im       0.081704+0.0300809im     -0.0827999+0.148498im     -0.0869261+0.0840418im       0.258228-0.0937215im      -0.183023+0.0813513im     0.0139157+0.0778938im       0.149791-0.228061im      0.0389993-0.147931im    -0.0293133-0.128248im      0.0401835-0.0616531im
   0.0363934+0.00608711im     -0.19527+0.15348im      0.0661116+0.178937im      -0.025481-0.012611im     0.0147751+0.0363014im    -0.187284+0.163464im     0.0736793-0.0115253im    0.0396796+0.06781im       0.0581404+0.0588787im     -0.188682+0.12495im      0.0952742+0.255724im       -0.135297+0.314082im     0.0389539+0.00598021im    -0.119325+0.125514im     0.0110249+0.111472im        0.137529-0.115782im    -0.0325963+0.172809im     -0.113736-0.0383457im       0.268577-0.12521im      -0.045905-0.0781142im     0.106087-0.249674im      0.149789-0.00777946im     0.019733+0.0842643im       0.121097+0.00569173im    -0.109607+0.0454669im       0.139499-0.0302347im       -0.22484+0.100818im       0.128118+0.106171im       0.0749354-0.102121im      -0.179299+0.0300875im     0.113856-0.0571588im     -0.169491+0.149162im
  -0.0600252+0.21886im     -0.00884734-0.0253255im   -0.0586451-0.0419314im     -0.222612-0.0816891im   -0.0873416+0.189209im    -0.0140579-0.168855im     0.0917904+0.0417431im    0.0230251+0.0839788im     -0.143173+0.111445im     -0.0967865+0.112042im      0.103232+0.0268871im       -0.10859+0.0033488im    0.0652164-0.108754im      0.0652233+0.15061im       0.162517-0.0214042im     -0.0970633+0.0579593im    0.0768141-0.0548342im    -0.216463-0.00646749im     0.0115207+0.289685im     -0.202249-0.0588588im     0.221891+0.0588974im   -0.0639129-0.181356im         0.1025-0.210722im       0.0413372-0.0980808im     -0.146283-0.103447im         -0.1549+0.122929im        0.259847+0.135783im     -0.0171326+0.0357568im       0.176392-0.160367im     -0.0121567+0.0980282im    -0.184765-0.102784im      0.0533152+0.150861im
   0.0539068+0.201698im      -0.219865+0.115581im    -0.0797324-0.247101im      0.0356201+0.172256im     -0.197519+0.100622im     0.0470601-0.0826377im    -0.208624+0.0747486im   0.00413119+0.0403473im      0.302456+0.0148452im     0.0378778+0.10309im       0.231346-0.0282009im     -0.0432818-0.128542im    0.00772606-0.0600023im     0.0680191-0.130976im      0.180483+0.0236006im      -0.116308-0.0237642im   -0.0144618-0.042812im      0.192633-0.0546134im     -0.0298174+0.0203963im    -0.130252-0.199595im    -0.0334682-0.149157im     -0.115661-0.0118861im      0.035902+0.0415993im     -0.0116349+0.0478079im      0.125855+0.159734im       -0.132966+0.015917im       -0.180283+0.0646288im    -0.0688081+0.171974im       0.0987292-0.14865im        0.180305-0.188577im      0.221198+0.0821988im    -0.0959918-0.0248615im
    0.163828+0.00988196im   -0.0668658-0.00683075im  -0.0840545+0.0197423im     0.0662614-0.0172847im   -0.0680763+0.0152761im     0.140625-0.169851im     -0.164555+0.177174im    -0.0313912-0.11327im       -0.105316-0.144846im      -0.116061-0.035831im      0.052935+0.164834im      -0.0942651+0.0749932im     0.176335-0.151917im       0.194489-0.0825818im    -0.187583+0.0793556im      0.0169087-0.14826im      0.0331363+0.0168695im    -0.167233+0.15242im         0.047716+0.0914312im   -0.0881926+0.224794im     -0.106234-0.0163588im     0.271166-0.199175im       0.110869+0.0959748im      -0.195524-0.0672232im     -0.064389+0.0723912im     0.00342413-0.130038im      -0.0272918-0.163952im      -0.128315-0.260719im      -0.0610138-0.207711im     -0.0152179-0.204647im     0.0658184-0.10384im       0.0747492-0.134754im
    0.142817-0.104026im     -0.0436962-0.111293im    -0.0714293-0.0481372im      0.102042-0.0927926im   -0.0249701-0.0223863im    0.0976742+0.0472474im    -0.132618-0.0194429im      0.30549-0.0313312im      0.135941-0.0145075im     0.0262143+0.0136002im    0.0293307+0.144118im        0.195941+0.233469im    -0.0746838-0.0391296im    -0.0910333-0.10328im      -0.282678+0.042669im       -0.095961-0.039449im   -0.00576003+0.0244515im      0.10888-0.215541im       0.0717056-0.0567559im   0.00672375-0.0377664im     0.068234-0.132881im      -0.15691+0.102144im      0.0248672-0.105991im       -0.034057+0.0943277im      -0.22416-0.200034im       -0.154708-0.0922044im       0.246691+0.0494453im     -0.137932-0.0460542im      0.0646675+0.0166885im      0.124956-0.176562im     -0.272602-0.108634im       -0.23868+0.0263808im
  -0.0121816+0.029436im       0.108252+0.200911im     -0.209559-0.18191im        0.126629-0.072799im     -0.148336-0.134665im     -0.122278+0.154042im    -0.0730229+0.056353im       0.15791-0.205484im      0.0328365+0.0830644im    -0.0339253+0.147254im    -0.0572044-0.183505im       0.0160687-0.0422114im      0.11332+0.0883399im    -0.0251247+0.132im       -0.0648094-0.179902im      -0.0333438+0.096616im     0.0592107+0.00665722im  -0.0308678+0.0935572im      0.0961315+0.0647091im     0.265798-0.305714im     0.0894618-0.0143286im   -0.0534461-0.179446im    -0.00412497+0.00559569im    -0.0179167-0.195307im      0.0757593-0.0331903im      0.0781063-0.0824992im      -0.152477-0.125233im      0.0164977-0.0961668im      0.0770793-0.0696991im     -0.285501-0.186201im      -0.25335+0.0311109im     0.0612828-0.043563im
   -0.048454+0.19997im      -0.0577766-0.0260561im    0.0424978+0.0714083im      0.234845-0.210323im    -0.0779969-0.01757im     -0.0424497+0.101452im     0.0285125+0.119264im      0.127372-0.0635145im     0.0522517+0.110837im     -0.0181501-0.277667im      0.208805+0.154399im     -0.00227885-0.310539im     0.0699532-0.00159806im    -0.182759+0.0407008im    0.0567681+0.0819298im     -0.0314935-0.165639im      0.172848-0.0579906im   -0.0842834+0.0361362im       0.227017-0.177065im    -0.0882018+0.0571242im   -0.0208511-0.0025422im    -0.245333-0.135222im      -0.137802-0.00301913im     0.0241361+0.0964784im      0.150807-0.207769im        0.143373+0.228988im        0.073595-0.0292709im      0.023629-0.22243im        -0.075812+0.00768507im    0.0665455+0.0430992im    0.0656861-0.00470053im    0.0508847-0.0363827im
   0.0734293-0.022499im      0.0196878+0.372288im      0.058431-0.04257im       -0.118994+0.184239im       -0.0194-0.287424im       0.12428-0.163929im      0.187878+0.0944496im   -0.0636787+0.0941406im     0.0556899-0.156558im      0.0914839-0.0740055im   -0.0676826+0.0845777im      -0.194825+0.115354im     -0.124058+0.20118im      -0.0211574+0.0433925im   -0.0485278+0.26784im       -0.0254346+0.195096im     0.0274959+0.00257341im  -0.0907952+0.0392729im      0.0404424+0.0343008im   -0.0176227-0.221619im    0.00218912-0.0415821im    -0.162627-0.0654106im     -0.179004+0.0739965im     -0.0944133+0.303909im    -0.00487179+0.0149762im     0.00878488-0.046938im       0.0974346+0.0228437im    -0.0152506-0.199486im        0.103254-0.000373384im   0.0691393+0.00507937im  -0.0484049-0.10044im        0.170764-0.0148915im
  -0.0107569-0.00893877im    -0.235037-0.0275298im   -0.0770535-0.105656im      0.0736087+0.0570114im    -0.164576+0.0368417im    -0.145892+0.0796838im    -0.106294+0.0873869im     -0.17621-0.028763im      -0.213325-0.0526081im      0.201195-0.0189585im   -0.0121667+0.069804im      -0.0474256-0.0445593im    -0.149133+0.137072im    0.000424831+0.0873473im    -0.101216-0.150181im      -0.0323739-0.0299508im   -0.0150317-0.203845im     -0.147745-0.0641945im      0.0912984-0.192024im      0.114988+0.00959991im  -0.0298242-0.137806im    -0.0586204-0.0233522im      0.352065+0.302047im      -0.0451816+0.0511043im    -0.0586051+0.0909919im      0.0707545+0.00585803im      0.279536+0.0542276im    -0.0506283+0.25942im        0.0628066+0.0224844im    -0.0169957+0.177243im    -0.0638344-0.0871069im      0.117877-0.17325im
 -0.00390561+0.0432444im     0.0634995-0.0507992im    0.0883506-0.00179249im     0.212736+0.0758343im    0.0743901+0.0702176im   -0.0920727-0.135059im     0.0346284+0.199164im    -0.0644879-0.118856im     -0.0981748+0.0563995im     0.0817997-0.0628107im      0.14609+0.134229im        0.113468-0.00534444im   -0.141614-0.273652im       0.164992+0.364488im     0.0719886-0.261299im       0.0254483+0.157984im     -0.339613+0.208079im     0.0136315+0.0142281im     -0.0269864-0.0762597im    0.0803959-0.169053im    -0.0208927+0.0501308im    0.0434901-0.0127913im     -0.128214-0.0365343im     -0.0141794+0.138998im     -0.0486446+0.0830116im      0.0572865-0.0664995im       0.145307+0.0999519im    -0.0501773-0.195913im        0.118257+0.0670579im    -0.0153082-0.0779679im     0.135786+0.0632919im     -0.164857-0.0162404im
    0.198121-0.0916109im    -0.0525776-0.0370512im     0.161331+0.0362992im     0.0397391+0.00945284im   0.0479663-0.0389645im    0.0486495+0.274769im    -0.0905472-0.253946im    -0.0464593+0.00218779im    -0.156482-0.204438im       0.198086+0.102959im      0.150958+0.0155432im     -0.0804911+0.0224431im    0.0260944+0.0522601im    -0.0209093+0.0648568im   -0.0267381+0.0409222im    -0.00821582+0.0230596im   -0.0310593-0.0785525im    0.0131911+0.104037im      -0.0503652+0.138111im     -0.100767+0.0721141im    0.0303249+0.349857im     -0.266321-0.245656im     0.00258658+0.167365im      -0.0379058+0.0282728im    -0.0815001-0.013876im      -0.0352909+0.0953992im      0.0276822-0.100016im        0.18135+0.00722989im      0.188745-0.0794128im     -0.111585-0.151401im      0.101528+0.181989im      -0.286184+0.0449778im
   0.0133523-0.181225im       -0.10632+0.116046im       0.03416-0.0666212im     -0.251222+0.128343im     -0.209024-0.0569577im     -0.21475+0.135242im      0.279193+0.106483im     0.0573424+0.0598686im     0.0031437+0.142537im      0.0715316-0.156255im     -0.188021+0.116111im       0.0195518-0.00195795im    0.142742-0.13619im       0.0186074+0.108785im      -0.20348-0.10641im        -0.200203-0.202942im    -0.0343787-0.0859001im   0.00500598-0.0381516im      -0.139861-0.0170498im    -0.070259+0.0724825im   -0.0155265+0.110089im    -0.0234376+0.120899im      -0.102173+0.150307im    -0.000391783-0.180253im       0.148066+0.20556im        -0.104159+0.218973im      -0.0114484+0.127371im      -0.106677-0.146268im      -0.0598581-0.0723049im     0.0410172-0.127835im    -0.0765553+0.0233166im     -0.132798+0.0960548im
  -0.0342646-0.16806im        0.258739-0.0737721im    -0.108174-0.0511083im     -0.107942+0.0796185im   -0.0248153-0.0322323im   -0.0927804-0.00404308im   -0.156256+0.049851im     0.0741527+0.0341581im     -0.236338+0.253096im      0.0631325+0.20951im      0.0937628-0.143978im      -0.0980704-0.110235im     0.0768454+0.00535338im    -0.191842-0.140551im     -0.161377+0.0595439im      -0.123693-0.0493923im    -0.129939+0.0936838im   -0.0451907+0.240817im       -0.230473-0.135435im     -0.171781-0.0865317im    0.0118254-0.258254im       0.13073-0.0668999im     -0.142664+0.103477im      -0.0887924+0.142371im      -0.081231-0.174883im        0.101495+0.175038im       0.0670143-0.0160901im    0.00622428+0.0499106im      0.0959179+0.066205im      0.0295177-0.0417466im     0.179008-0.10805im      -0.0214809+0.0747839im
  -0.0152189+0.110391im     -0.0701093+0.056923im     -0.102344-0.0368238im     0.0312627+0.0462744im    0.0136549+0.0141701im     0.276808-0.165191im     0.0233165-0.0838317im   -0.0469953+0.110876im     -0.0616677-0.163574im        0.19275-0.0922704im   -0.0490445+0.0768788im   -0.000566927-0.0143185im     0.191126-0.0947167im     0.0216191+0.0840235im    -0.146964-0.194875im       -0.121525+0.0962732im     0.160289+0.286121im    -0.0254398+0.301845im        0.159499-0.139047im     0.0470357+0.158242im    -0.0944039-0.049524im    -0.0386676+0.0287192im    -0.0805304-0.0184663im        0.12081-0.0352316im     0.0377188-0.0638686im     -0.0090089+0.148695im       -0.230973-0.022605im      -0.123029+0.248156im        0.228398+0.19459im        0.023771+0.0483172im    -0.174235-0.0558648im    -0.0988331+0.120765im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.16626095238907562 + 0.07680343625620648im
 -0.0005851500258873286 - 0.08486492386225758im
    0.19338176659890816 + 0.1020858737275007im
   -0.13647952999798577 + 0.03944834609564213im
  -0.006541431109981018 - 0.005306140426194687im
    0.15464219903798937 + 0.022091193011289416im
      0.115634151362941 - 0.10708720222393155im
    0.05008273986742255 + 0.007188316737863772im
  -0.031620710098091004 + 0.09457401684204116im
    0.13866639327671224 - 0.28712405598356766im
   -0.03324256964408946 - 0.12505236322657362im
    0.14145390344289638 + 0.0515416234424546im
    0.08093719722059721 - 0.2717984844577775im
   -0.25776028711579707 - 0.08804056610037554im
   0.032547226099369386 + 0.05608955404792448im
    0.08727479632685964 - 0.0012381860006536022im
    0.09963035776554331 + 0.11866111136170654im
  -0.022901218117811394 + 0.09434998073514844im
   -0.13368878565786285 + 0.04476501796486866im
    0.10559898231049289 - 0.11150366730393216im
    0.05723688505060012 + 0.0006330241929450811im
    0.24180587711192492 - 0.1486267753254101im
   -0.16347024848794417 + 0.007334819430477341im
     0.2825715253829933 - 0.17421486756509505im
   -0.04600058396906824 - 0.1533326126398582im
  -0.018048672519254516 + 0.1448874583101743im
  -0.008460055042374378 + 0.006212769268542972im
    0.17499197431141053 - 0.07584050708434772im
     0.1156188842307116 - 0.010453988531040412im
     0.3461641330407503 + 0.0im
     0.0701739346111662 + 0.01912033952664515im
    0.04656248741875517 + 0.004801284573160449im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 2 November 2022 20:38">Wednesday 2 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

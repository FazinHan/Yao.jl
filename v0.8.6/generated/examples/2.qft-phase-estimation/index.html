<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.6/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.6/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    -0.184193-0.00860176im     0.100067+0.0657817im     0.060832+0.120197im      -0.224232+0.157456im     -0.177597-0.12375im      0.00204374-0.162766im      0.054431+0.0130391im    -0.101307-0.208931im    -0.0500399-0.0664763im     0.0833569-0.0614235im   0.00107636+0.154618im       0.152691+0.121516im       -0.158516+0.00771954im  -0.0556072-0.198332im     -0.125387-0.198826im       0.141739-0.0374895im      0.174522-0.048265im    0.0982731-0.27613im       0.140397+0.0152027im    -0.0516874+0.0580871im     -0.109045-0.00762553im     0.030471+0.24218im       0.111833-0.064077im     -0.0687268-0.00571305im   -0.0921673-0.304258im    0.00742875+0.0113149im   0.0641397+0.180837im     0.0417531-0.0404243im    -0.149147+0.0474841im    0.154443+0.0398363im    -0.0657915+0.0191103im     -0.236811-0.119616im
    0.0383332-0.0690078im    -0.0547932-0.199475im    0.00592407+0.0594904im     -0.194685+0.021306im    -0.0448291+0.0145935im    -0.0787672+0.134056im      0.342934-0.138106im     0.0761239+0.029626im    -0.0566028-0.0662834im    -0.0442407+0.0194682im     0.141019-0.113272im      0.0203091+0.0871043im      -0.113237+0.00840505im   -0.142225-0.0806409im    0.0671526+0.0254763im    -0.0477177+0.056835im       0.104251-0.0114675im    0.050631-0.248002im    -0.0840899+0.185194im        0.08216-0.00340004im     0.189126-0.204606im      0.0381086+0.046385im     -0.194075-0.0452831im    -0.0128328+0.124161im      0.0920392+0.262795im     -0.126871-0.13196im     0.0970373-0.097884im       0.26947+0.0374891im     0.012581+0.160338im    -0.013212+0.103633im      -0.329146-0.145809im      0.0900979+0.00847851im
 -0.000929263-0.108461im      -0.224655-0.110586im    -0.0524836+0.210127im     -0.0496318-0.0248361im     0.312906-0.102465im     -0.0704609-0.192388im       0.18629+0.039585im    -0.0571315-0.101408im     -0.130731+0.199852im      0.0369852+0.0214599im    0.0916152-0.151815im     0.00357476+0.135442im      -0.0789329-0.04449im       0.178548+0.103732im     0.0593987-0.080408im       0.104471-0.0543343im     0.0773898+0.0306016im    -0.11433+0.173195im     0.0733055-0.00386648im    0.0771674-0.143261im      0.0276047-0.0215946im      0.145603-0.118757im     -0.047769+0.097166im     -0.0825221+0.148774im      -0.214641-0.0642705im     0.266726+0.0656777im   -0.114894-0.0164943im     0.189377-0.00633494im   0.0173431+0.0151674im    0.138061-0.35474im       0.0174797-0.078776im     -0.0770555+7.6458e-5im
     0.004025-0.0232003im     0.0330312+0.122903im      0.102534-0.103666im     -0.0629086+0.1133im      -0.0311505+0.272779im       0.329935-0.167793im     0.0454551-0.085835im     -0.107522+0.152156im    -0.0627704-0.0327463im   -0.00757253-0.0256241im    0.0769647-0.158632im     -0.0759291-0.189122im       0.0904829+0.0560229im      0.28301-0.144756im     -0.162851-0.127359im      0.0447703+0.06691im    -0.000972549+0.0179246im    0.096743+0.0179809im   -0.0777767+0.113687im      0.0752295+0.121451im       0.039263-0.100392im     -0.0782392+0.058482im      0.170969+0.095341im      -0.076672+0.0688381im      0.132817-0.0369513im     0.213062-0.0792058im   -0.151833-0.146258im     -0.115353+0.0492854im     0.136584+0.352431im   -0.0255861-0.0527431im    -0.0418699-0.158519im       -0.12258+0.100829im
   -0.0795927-0.0894084im      0.127066+0.0252566im    -0.265416-0.0797861im      0.152276+0.0881938im    0.0147213-0.0930171im      0.146522-0.0451254im    0.0946358-0.291448im     -0.191454+0.0384859im     0.194294-0.117357im     -0.0599005+0.0236683im     0.150206+0.0557911im       0.18363+0.0656083im     -0.0551598-0.212165im     -0.176362+0.223367im     -0.139563+0.0227388im     0.0457806-0.108946im     -0.0418211-0.0861812im    0.165685+0.130983im     -0.210269+0.231006im       0.125762-0.0564283im     -0.144066+0.0266035im    -0.0732598+0.180597im     0.0476182+0.115611im       0.147755-0.0696673im     -0.084733-0.0396546im   -0.0325125+0.0565457im   0.0519277+0.0100674im    0.0406087-0.0226026im     0.040205-0.0200268im     0.04594-0.183648im      0.0695218-0.187641im       0.210808-0.043503im
    0.0645717+0.26127im      -0.0136377+0.0985168im   -0.0873897-0.00842023im    -0.132425+0.074325im      0.107216-0.0314012im      -0.17472-0.0654357im    -0.109883+0.0174332im     -0.21506+0.0331606im   -0.0798947+0.106901im      0.0960123-0.20498im      -0.204708-0.0662108im     0.0116898-0.0319011im     -0.0300336-0.0230861im   -0.0144117+0.0514053im   -0.0189079-0.0308796im     -0.111019+0.142874im       0.195103-0.315558im    0.0951088+0.0704395im   -0.0686973-0.021198im      0.0500619+0.294571im      -0.138209+0.225502im       0.115372+0.0469739im     -0.19116-0.00346414im    -0.113533+0.0228393im      0.331321+0.0678669im    0.0102988-0.0257394im  0.00460474-0.113072im      0.123102+0.126078im     0.0418356-0.0651177im   0.0164099-0.0737723im     0.0386179-0.140341im      0.0668565-0.217188im
    0.0869869-0.190226im    -0.00790713-0.0451077im    0.0238909-0.0902149im    -0.0662695+0.167102im      0.118423-0.0507394im    -0.0524302+0.167156im     -0.338783+0.120686im     0.0664051+0.0569189im     0.062813+0.0400846im     0.0702611-0.0376017im     0.246399+0.126238im     0.00300886+0.0832382im      0.0725511-0.0297272im     0.226804+0.042849im    -0.0268222-0.11505im        0.101187-0.133766im       0.188799+0.0893724im  0.00476885-0.266915im      0.146245-0.0172356im      0.248836+0.0565344im     -0.192164-0.0450973im     -0.180751-0.0235381im    -0.223013-0.0779248im    -0.0193839-0.0268305im     -0.127598+0.0645404im   -0.0214411-0.165538im    0.0840636-0.188182im    -0.0875767-0.160855im       0.12301+0.0256981im  -0.0770707-0.0598335im      0.115179-0.109665im         0.1042-0.12356im
    -0.143573+0.0113769im    -0.0124446-0.208255im     -0.200533-0.0458468im    -0.0183061-0.0685549im   -0.0513671+0.00445763im    0.0501071+0.0250183im    0.0903205+0.0958419im    0.0285941+0.155063im      0.170029-0.0120372im     0.0152012+0.0359538im     -0.16028-0.192992im      0.0395134-0.27479im        -0.119476+0.15358im     -0.0151682+0.158108im      0.010537-0.0326105im     0.0613309+0.105229im       0.260951-0.0270473im    0.224055-0.214495im     -0.107908-0.0137376im    -0.0880282+0.0237797im     0.0293168-0.0457003im     0.0328816-0.192846im     -0.186402+0.200396im     -0.0124709+0.0701225im     -0.168063-0.110802im    -0.0458094-0.11896im    -0.0867069+0.200707im    -0.0779232-0.0930455im     0.224308-0.0500567im    0.148035+0.104614im       0.261275+0.0283183im    -0.0857108+0.0540806im
    0.0605577+0.0807583im      0.077447+0.0243632im    0.0277644+0.377255im       0.316945-0.0483462im   -0.0311484-0.088999im      0.0170381-0.0171944im   -0.0311719-0.0550272im    0.0164311-0.160737im     -0.168598+0.127041im      0.0633215+0.073764im    -0.0916047-0.0680612im     0.0314905+0.128755im        0.143451+0.0972609im    0.0892024+0.0025022im    0.0560124-0.0251236im      0.106148-0.0329676im     -0.112275-0.12521im     0.0687411-0.0768684im    -0.051224+0.0201551im     -0.076241-0.0605828im    -0.0726109+0.178463im     -0.0551284+0.116538im      -0.14007+0.0423438im     0.0435851+0.0595917im    -0.0931476-0.0500707im    -0.107594-0.189746im    -0.120403-0.0742074im    0.0448127+0.00852144im  -0.0329941+0.403998im    0.0830029+0.274129im       0.174628-0.0492404im      0.242843+0.0889094im
     0.126959-0.142479im       0.117871+0.178568im    -0.0757332-0.11987im       -0.146166-0.203297im     0.0199854-0.0981269im      0.116295-0.336163im    -0.0686001-0.152607im    -0.0483337-0.0990405im    0.0168451-0.0433019im     -0.139131-0.0231014im    0.0520953-0.0614462im     -0.104123-0.142837im       0.0932498-0.103269im    -0.0260254+0.0178507im     0.300169-0.0648518im     0.0378606-0.0315862im    -0.0404208-0.204528im   -0.0839671+0.0501784im    0.0540083+0.079634im       0.161564+0.101249im      0.0468231+0.0956725im     0.0106562+0.0801847im    -0.212843-0.0494997im    -0.0446259+0.0353525im     -0.156837+0.275893im      -0.11082-0.0931031im  -0.0553306+0.142404im    -0.0235865-0.25367im       -0.12768+0.0102395im  -0.0048173+0.0953358im     0.0129443+0.108936im      -0.251829+0.0549303im
   -0.0494589-0.0793934im      0.202834-0.0451513im     0.148842+0.127121im      0.0459661-0.0604844im   -0.0485181+0.0592852im      0.136805+0.0391654im     -0.22773-0.125555im      0.152412-0.15003im       0.212968-0.105345im      -0.195993+0.213749im    0.00725934-0.0403202im    -0.0656121+0.00119803im      0.076664-0.120089im    -0.0528761-0.0509824im    -0.276272-0.018319im      0.0525143-0.0605633im      0.109195-0.109855im   0.00519214-0.0288617im    0.0156353-0.0373691im     -0.204153-0.0625015im     0.0692262+0.11647im      -0.0239031-0.126321im    -0.0830731-0.0732393im     -0.324389+0.215514im       0.184907+0.0430552im    0.0851697+0.0382725im   0.0420781-0.0842914im     0.328331-0.0502602im     0.013095-0.15257im       0.04933-0.11909im        0.124612-0.0607211im    -0.0415321+0.115364im
    -0.231379+0.31701im     -0.00998743+0.134236im     0.0910116-0.131603im     -0.0924763-0.230119im     0.0276375-0.0898533im     0.0113404+0.0289205im   -0.0476971-0.0504079im     0.282237+0.253534im     0.0739582-0.111992im       0.239462-0.145746im      0.262045-0.0645771im     0.0642737+0.298259im        0.148972+0.0400393im    -0.131913+0.0409661im   -0.0436582-0.130564im       0.079718+0.0453627im      -0.16198-0.0725284im  -0.0369436+0.116735im      0.111801+0.185062im     -0.0462134-0.0357337im     0.0403052-0.000900963im    0.115208-0.0752673im    -0.155289+0.0895171im    -0.0514825+0.0439628im   -0.00703203-0.122522im     0.0381639-0.185025im     0.030448-0.0489022im   -0.0958865+0.0495906im   -0.0355051-0.0208105im    0.109024+0.0116511im     0.0174392-0.0671228im    -0.0879363+0.0592842im
    -0.182989+0.145331im       0.194657+0.185044im       0.01169+0.0307502im   -0.00997412+0.0288725im     0.180468+0.022193im     -0.0818674+0.142206im    -0.0332965+0.141705im     0.0904862-0.0896692im    0.0372231-0.185354im     -0.0421412+0.00294071im   -0.167853+0.00564299im    0.0735388+0.0825379im     -0.0638037+0.26236im       0.216805-0.0381631im  -0.00596921-0.0127491im     -0.216554+0.140285im     -0.0341023+0.194744im   -0.0427113+0.0870211im    -0.176845+0.199489im       0.134686+0.0171872im    -0.0301633-0.0439616im    0.00419453+0.192812im    -0.0747707-0.142474im       0.101654-0.00295098im    -0.100777+0.0754328im    -0.189484+0.193779im   -0.0889345-0.0232683im     0.227136-0.199516im      0.126839+0.0354252im   0.0495279-0.141001im      0.0930071-0.0370275im     -0.177597+0.151999im
   -0.0451635+0.0506473im   -0.00578946+0.183598im      -0.11156+0.0362416im     -0.200328+0.0706465im     0.186604+0.102987im    -0.00712092+0.359103im    -0.0930539+0.00158832im   -0.301614-0.176288im      0.107309-0.00678197im     0.101075+0.122674im     0.0226555-0.0677796im    -0.0888987-0.0495083im      0.0254917+0.00598507im   0.0309741+0.0123661im    0.0358825+0.0403353im     0.0223013-0.113813im     -0.0885684-0.0711353im    0.088784-0.0715077im    0.0199913+0.0432891im    -0.0385677-0.018126im       0.224179+0.0614577im      0.050793+0.135872im     0.0198632+0.0706685im     -0.246979-0.206832im      -0.159893-0.0348727im     0.053248-0.187978im    -0.186153-0.0422641im   -0.0743625+0.0413001im   0.00263182-0.17217im      0.158299+0.00396817im    -0.241105+0.139891im       0.160677+0.214659im
   -0.0710737-0.0107418im    -0.0406366-0.0570607im   -0.0696093+0.0237438im      0.200101+0.0172554im    -0.125444-0.075987im      -0.115311-0.029389im     0.0769916-0.0213729im   -0.0426444+0.00769985im   0.0866326-0.0632071im    -0.0511047+0.247149im      0.122584-0.0155369im      0.268213-0.182532im        0.168931+0.105206im      0.208112-0.0101141im    0.0492238-0.202527im       0.150215-0.0554788im     -0.154581+0.0727806im  -0.0315702+0.0372617im     0.126212-0.0994707im     0.0791291+0.363079im    -0.00865191-0.161154im       0.104347+0.0911257im    -0.105422-0.174772im       0.158936+0.109435im       0.146133+0.0119484im   0.00351915-0.0801161im   -0.188894+0.0218756im    0.0616487+0.222601im    -0.0793505-0.302325im     0.100442+0.0148883im    -0.0432809-0.0525884im     0.0228423+0.0468535im
    0.0593984-0.0534976im     -0.155049+0.105051im   -0.00783763+0.0391896im   0.000219695+0.0474514im    0.0477918+0.0855691im     0.0482105+0.126423im      0.142606-0.148378im       0.10894+0.142641im     -0.102671-0.153379im       0.185862+0.21624im      -0.114121+0.237124im        0.23658+0.0241299im      -0.142653-0.205628im     0.0189464-0.0999652im      0.18565+0.189108im     -0.0501188-0.156848im     0.00409338-0.111167im      0.18874+0.0825703im     0.195386-0.119199im      0.0521268+0.00806453im   -0.0833927+0.0830905im    0.00106262-0.120668im    -0.0770618-0.122979im      -0.207938+0.0635147im     0.0620245-0.0116118im    -0.229655+0.0998805im   -0.115954+0.0198649im    -0.170097+0.0495295im     0.132654+0.132438im    0.0568879-0.100274im      0.0630523-0.108921im      -0.181473+0.157615im
   -0.0902788+0.166674im       0.075809-0.0518131im   0.00766491-0.0892571im     -0.142176-0.0290275im     0.100181-0.00581142im    0.0263633+0.0366857im   -0.0588217-0.0124225im   -0.0460177+0.0618729im    -0.136044+0.164662im     -0.0382743+0.246272im      0.200324-0.0973472im      0.092072+0.0936816im     -0.0136561-0.0573085im    0.0225891-0.0666895im    0.0202489-0.143225im       0.105645+0.0400345im     0.0998274-0.107145im     0.034025-0.182635im     -0.223002+0.0724708im     0.0741904-0.0201259im   -0.00840155+0.262261im     -0.0197833-0.381404im      0.352756-0.19453im         0.20101+0.0345402im   -0.00877207+0.109433im     -0.188547+0.155912im    -0.217213-0.0520544im   -0.0362839-0.0191816im      -0.1328-0.0362921im    0.061808+0.0378563im   0.000348195+0.0636479im     0.0210395-0.023404im
     0.226142-0.0652885im       0.21678-0.0185566im    0.0635745+0.179293im      0.0418615-0.20422im    -0.00802025+0.079109im      -0.100732-0.0541408im    0.0909247+0.0850935im   0.00273881+0.151629im     0.0547993-0.0278633im      0.041494-0.0897382im    -0.126146-0.0880264im     0.0505963+0.037351im        0.182697+0.0639704im    -0.203877+0.166101im      0.144474-0.19185im       -0.166625-0.17936im        0.153776-0.0472571im   0.0671953-0.153672im     -0.131572-0.07816im      -0.0574124-0.144813im      -0.140338-0.145856im      -0.110967+0.108519im     0.0576962-0.129201im      0.0340957+0.0133935im      0.109582-0.0986829im    0.0436894-0.0231752im   -0.157805-0.240316im     -0.215901-0.104616im     -0.108681-0.0965824im    0.104087-0.25339im       -0.163112-0.000671227im  -0.0878815+0.106128im
     0.032488+0.0214973im     0.0529636+0.0555699im     0.263413-0.0345686im     0.0653099+0.0875007im     0.264267-0.164919im    -7.59978e-5-0.0178126im    0.0113987+0.0626921im   -0.0946091+0.229449im      0.122605-0.0327133im     -0.171674+0.168776im     -0.093358-0.210751im    -0.00378933-0.112342im      -0.0750678-0.0682002im   -0.0105841+0.0199461im     0.143628-0.0789827im     0.0439247-0.0050733im     0.0986839+0.178728im    -0.100397+0.0523448im    0.0913946+0.0990108im     -0.130315+0.150981im      -0.181854+0.186636im      -0.149156-0.0358124im   -0.0940441+0.127087im     -0.0462967+0.0103566im     -0.100767-0.184602im    -0.0922959+0.153863im     0.290811-0.00839857im  -0.0185761+0.097251im     -0.116717+0.0610833im   0.0625515+0.140186im       -0.29623-0.124445im      0.0343436+0.142511im
     0.148611+0.116862im      -0.076404+0.219273im     -0.168594-0.0097404im     0.0662465-0.0279421im     0.115497+0.0170818im     -0.280043-0.0757858im    -0.126568-0.0190525im   -0.0573832+0.0300883im   -0.0188243-0.355504im       -0.18542+0.181757im      0.128204+0.0778545im     0.0456814+0.0412977im       0.126126+0.027754im    -0.0698051-0.158056im    -0.0317018-0.112501im      0.0489177+0.0157938im     0.0931657-0.0775135im  -0.0649862-0.0846845im    -0.146512-0.104263im      -0.236931-0.0185434im      0.141246-0.193837im     -0.0270344-0.0841656im    -0.149449+0.15266im      -0.0311654-0.0153948im     -0.117743-0.0483295im     0.027829+0.196975im    -0.135882+0.0796734im   -0.0523722+0.0656604im    0.0813761+0.225671im     -0.13205-0.0722148im    -0.0576382+0.0499381im     0.0312382-0.270693im
     0.119017-0.123456im     -0.0839681-0.0332896im    0.0107747-0.15517im       0.0476938+0.264478im     0.0966162-0.189651im     -0.0117514-0.0759721im    0.0709014-0.0050385im    0.0107434-0.175033im    -0.0239451-0.180256im        0.20773+0.0306412im    0.0431253-0.0525498im     -0.068699-0.0629944im       0.329722+0.0081324im     0.169244+0.0169275im  -0.00360169+0.0490573im     -0.144088-0.0737948im     -0.152326+0.0557271im    0.226116-0.0928674im     -0.23399+0.0770668im     -0.202688-0.148905im    -0.00272687+0.188299im        0.18141-0.107402im    -0.0544507-0.0917209im      0.118333+0.0555867im     0.0942606-0.0187276im  -0.00683163-0.0758146im    0.266534-0.0238298im   -0.0295959+0.0225646im    0.0793425-0.0224151im    0.186324-0.0205575im    -0.0678386+0.111227im      -0.211738-0.10974im
  -0.00716943-0.114946im      0.0316771-0.0218942im   -0.0834389+0.0896714im     0.0146813+0.123014im     0.0586312+0.311237im     -0.0180068+0.0455158im    0.0610682+0.0328897im      0.22063+0.11414im     -0.0818262-0.120929im      -0.151055-0.104449im     -0.045855-0.030638im       0.178159+0.00773275im     -0.162945-0.0416423im   -0.0398909-0.335983im      0.113845-0.126543im     -0.0252028+0.0146321im     -0.178048+0.0236914im  -0.0328605+0.0542294im   -0.0488797+0.0361103im     -0.127121+0.132335im     -0.0787895+0.253429im     -0.0382768-0.0537386im   -0.0496551+0.0286402im     0.0706939-0.0468139im    -0.0136853+0.107053im      0.279805-0.193181im     0.055267+0.0755655im    -0.059209-0.263976im    -0.0605572-0.0725234im    0.256024-0.0957808im    0.00474768+0.088654im       0.207835-0.142699im
    -0.229115+0.0917542im      0.259966+0.0955616im    0.0431942+0.106865im     -0.0690069-0.0120945im   -0.0586498+0.145465im     -0.0764567+0.0222032im    0.0903325-0.12707im      0.0818447-0.0386423im    0.0786192+0.2274im      -0.00964464+0.0325866im    -0.105914-0.0569617im     0.0467907+0.0223231im       0.109384-0.136109im      0.185072-0.0271236im    0.0401809+0.328129im       0.180317-0.0113465im     0.0228617+0.0493698im   0.0616469-0.0509623im    -0.110186+0.0438739im      0.121726-0.00467346im    0.0422212-0.0472757im    -0.0842556+0.0580818im    -0.241778+0.0434995im     0.0262396+0.275223im     -0.0785472+0.030762im      0.108733+0.18399im      0.124427-0.0710499im     -0.29653+0.137611im    -0.0562759-0.053495im   -0.0179649-0.0708934im    -0.0793974+0.228344im     -0.0134761-0.239607im
    -0.197038+0.0904053im     0.0553913-0.151858im     -0.287027+0.0425608im    -0.0831473-0.127024im    -0.0897381+0.050071im      0.0117644-0.0142369im     0.161308+0.146078im      -0.16048-0.148964im      0.178051-0.0193837im     0.0448922-0.00257968im   0.0108576+0.14012im      -0.0350714-0.0596984im       0.180777+0.120981im    -0.0979123-0.0243443im     0.125166-0.119046im     -0.0894218-0.106084im      -0.208408+0.0853668im  -0.0666065+0.0094712im     0.147612+0.115735im       0.041024+0.0542429im     -0.267186+0.175863im      -0.211275-0.245067im     0.0417398-0.00684862im     -0.18648+0.146423im      0.0360683-0.0414577im  -0.00471213-0.0134906im   0.0207163-0.0346675im     0.111545+0.0127319im     0.191678+0.189328im    -0.208859-0.0762601im     -0.158568+0.130358im      0.0146411-0.0793181im
     0.030065-0.232807im     -0.0593686+0.279793im    -0.0710662+0.0621592im     -0.308141+0.0779225im   -0.0802205+0.00688984im    0.0385728-0.189744im    -0.0571267+0.0945981im   -0.0128045+0.173327im     0.0456262+0.033393im       0.129664+0.189167im     -0.128535+0.132838im       0.181213-0.0743074im       0.137783+0.158601im     -0.250874+0.0279647im   -0.0778736+0.21051im       0.0642812+0.134474im    -0.00533113+0.27107im     -0.145824-0.131193im     0.0181164+0.0426777im    -0.0399959-0.126053im     -0.0483669+0.190749im      0.0819339-0.00337936im  -0.0585677+0.132882im         0.1239+0.0293183im    -0.0267912+0.125435im      0.065432-0.0589619im   -0.136697-0.173966im      0.129051+0.134928im     -0.124642-0.0129981im  -0.0133286-0.00595463im    0.0935272-0.0890227im     0.0379745+0.0395535im
    0.0137014-0.0913661im     0.0996314-0.0806847im    -0.157435+0.0389946im     -0.259469-0.102632im     -0.148474-0.187041im      0.0784355+0.209457im     -0.133317-0.161493im    -0.0674813+0.0743934im    -0.139874-0.127074im     -0.0630143-0.0401769im   -0.0427687-0.103149im     -0.0141906-0.0723052im   -0.000736274+0.132945im     0.0739166-0.140158im      0.210784+0.0681541im      0.191905-0.0737862im      0.125545+0.0204051im   -0.318601+0.201657im     -0.156945-0.0763222im    -0.0440181-0.083714im       0.113408+0.0970573im     0.0652262+0.073736im      0.049797-0.195442im      0.0917049+0.0927665im     0.0691714-0.308371im    -0.0876356-0.148031im     0.151877-0.0119123im   -0.0655877+0.0561208im     0.154294+0.0491258im  -0.0337575-0.155397im      0.0559823-0.0931736im     0.0719928-0.0221176im
    0.0296186-0.050116im       0.136209+0.0968945im   -0.0648218-0.0358712im    -0.0727518-0.0726011im     0.201776-0.0472577im     -0.151174-0.00684857im    0.177339-0.114589im    -0.0180328-0.0364709im   -0.0308696+0.00912296im    0.0472843-0.126035im    -0.0411886+0.14066im       0.0290163-0.330946im       -0.119085+0.0172159im     0.071094-0.101766im     -0.219784-0.0755223im     -0.148592-0.237053im      -0.021477-0.0341328im    -0.12479+0.0919398im    0.0909354+0.196752im     -0.0710651-0.105258im      0.0405751-0.158976im      0.0750069-0.157806im      0.032879-0.0735831im    -0.0515961+0.167959im     -0.0633833-0.107351im    -0.0276604+0.0531442im  -0.0301014-0.299227im    -0.0767427-0.0907348im    -0.105018-0.0905347im   0.0539367+0.363115im       0.166438-0.09513im        0.121491-0.120771im
    0.0449387-0.0406243im      -0.11189-0.302918im    -0.0172379+0.0504403im     0.0105734+0.0947908im   -0.0372767-0.0879437im     -0.158409-0.141506im     -0.240409-0.203738im     0.0685314+0.00913556im   0.0596624+0.049784im      0.0900036-0.0646088im    0.0414991+0.0334002im      0.281511+0.0551771im        0.17267+0.112079im      0.017291-0.157616im     0.0432383+0.121051im      -0.220538+0.0185225im       0.11153+0.109629im   -0.0832346+0.120495im     -0.289712+0.106134im       0.180719+0.108057im      0.0520368-0.0090676im     -0.128949+0.0070484im     0.141927+0.203051im      -0.383369+0.0139768im    -0.0236407-0.0530542im   -0.0185882+0.0208503im  -0.0653788+0.0635353im   -0.0645637-0.0355206im    -0.121524-0.0559186im   0.0613155+0.137286im     -0.0344871+0.0401872im    -0.0239208+0.10051im
    -0.079544-0.166719im      0.0809204-0.0605804im    -0.218759-0.0549181im    -0.0619661-0.0829691im     0.240237+0.136854im      0.0125689+0.0928629im    0.0154845-0.0494912im    0.0390223+0.12515im      0.0620297+0.220295im       0.041054+0.0662618im    0.0466935-0.139208im       0.150385+0.0271321im       0.328706+0.0671229im    0.0502281-0.139523im     0.0395452+0.0376073im     -0.228149+0.0767758im    0.00448904-0.222137im     0.104582-0.068109im      0.302883-0.164289im      -0.118854+0.0799184im      0.148787-0.0272638im     0.0201758+0.180413im      0.158102+0.0967309im      0.131417-0.0275565im    -0.0331554-0.104478im    -0.0835682+0.133063im     0.245536+0.0196012im     0.150919-0.07716im      -0.129782+0.0915748im  -0.0891815-0.0409763im      0.117767-0.0500457im    -0.0152871-0.0124304im
     0.100207-0.293863im       0.081213-0.137483im      0.111177-0.0144741im     0.0794657+0.0184178im    0.0510219+0.196705im      -0.138491+0.0575888im    0.0186688-0.115658im     -0.107987-0.10356im       0.130451-0.248413im       0.319972-0.199345im     -0.043185-0.266458im     -0.0666055+0.091336im      -0.0553315+0.200245im     -0.102908-0.0880938im    -0.014459-0.0526097im      0.366845+0.189942im     -0.0875867-0.0210274im   0.0970205+0.119782im     0.0613936-0.0183782im   -0.00582756+0.0433511im    -0.0544272+0.092885im     0.00157098-0.0536179im    0.0379459-0.0295679im    -0.0486751+0.023231im        -0.1496+0.0812835im    -0.155948+0.17979im     -0.091784-0.0846415im   -0.0376196+0.0811868im   -0.0715915-0.0771972im    -0.15761+0.0159385im     0.0499808-0.0497027im    -0.0427817-0.0869393im
    -0.152876-0.100333im       0.109379-0.0267644im     0.289944+0.104577im     -0.0998467-0.0636311im    0.0677341-0.074392im    -0.00331343-0.181338im     0.0482229+0.107078im     -0.145231+0.0137863im    -0.116899-0.249341im      -0.101486-0.0401344im    0.0472072+0.00776202im     0.205627-0.091243im       0.0596142+0.0618245im    0.0508366-0.0254448im    0.0235208+0.152844im     -0.0359252+0.159373im     -0.0457538-0.276693im     0.073122+0.0655192im    0.0686054-0.0749367im      0.208993-0.156041im      0.0429882-0.130472im      -0.280614-0.212745im    -0.0437894-0.00779298im    0.0359668-0.294075im     0.00520321-0.0540134im  -0.00284292-0.0995692im    0.107945-0.10531im       0.119448+0.17223im       0.103795-0.0555182im    0.137778-0.00999984im    0.0742514+0.188096im       0.110769+0.00204172im
    -0.013141+0.0451193im      0.137415-0.0795991im    -0.155878-0.138993im       0.160145-0.0345613im    0.0374298+0.175im         0.0729469+0.0430548im     -0.13759-0.0912287im    -0.148126+0.00102746im   -0.115132+0.0516048im      0.154376+0.0793253im    -0.253717+0.186071im       0.174705+0.0305849im    0.000288121-0.122585im       0.11171+0.0977191im   -0.0793436-0.210118im   -0.000571044+0.311926im      0.0297136+0.0125687im   -0.151117+0.0917777im  0.000708991-0.123951im     -0.0389877-0.284502im      0.0448459-0.0739526im      -0.14819-0.0753391im   -0.0474488-0.0538967im   -0.00435978+0.083249im      -0.141473+0.111919im   -0.00633587-0.24892im      0.111449+0.0555687im    0.0433042+0.0509146im   -0.0647166-0.0346948im   0.0857912+0.0733953im       -0.2796-0.161069im      -0.175081-0.0874491im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.09299749593756018 + 0.017965549814348773im
  -0.08562694799252721 + 0.057149730477402474im
   0.08143107439911018 - 0.02813867547207841im
  -0.12382414173988175 + 0.1450228907025829im
   -0.0696527884002721 - 0.26059894820220364im
   0.19986511694560616 - 0.13569108248714012im
 -0.039723023965369184 - 0.07050798572012777im
 -0.004544285211200236 + 0.021663527485379606im
  -0.30304023057813567 - 0.03616932415439718im
   0.14787150688663372 - 0.07040759907498628im
  0.031200697730496142 + 0.03735475090337404im
   -0.1221347087040173 + 0.008860171018231038im
  0.042464556551675664 - 0.028766319764557825im
   0.01658866262172944 + 0.12172748742053405im
  -0.07172657122973694 - 0.11600896431555151im
   0.08548419840612435 + 0.19035828442352165im
  0.008562550104736154 - 0.1531110484239939im
   0.03447661129307297 - 0.12301080818732926im
   0.14216981114317592 - 0.07818393178282404im
   -0.3279617302611845 + 0.004848817593225523im
 -0.005814419194801216 + 0.06379197830829049im
  -0.06880816203791262 - 0.08111238867540778im
 -0.023065114593202388 - 0.09171767397827163im
  -0.06988175465687435 + 0.09589066228572302im
 0.0022815184544571266 - 0.02826445971315189im
  -0.24685549773988122 + 0.13102171661591425im
  -0.03813281936275304 - 0.17833686372505966im
   0.12765100561798726 - 0.1404984040318901im
    0.3585614236932513 + 0.0im
 -0.021344028894803475 + 0.044707991204503146im
   -0.1119409476248968 - 0.06151784053865448im
  -0.26210918510322667 + 0.06972822102240245im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 15 December 2022 06:03">Thursday 15 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.9/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.9/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0167194+0.243298im     -0.0642069+0.0207303im    -0.0794507-0.141414im     -0.0999704+0.085203im    -0.0774241+0.175117im      0.0802423+0.1037im        0.0670083-0.120311im       -0.045953-0.120214im    -0.0256161-0.028845im      0.0463949-0.0221409im    0.0155111+0.149898im    -0.0209224-0.214968im      -0.209723+0.115061im     0.0946605+0.256692im        -0.22535-0.24333im        0.117767+0.0989428im    0.0757588-0.100414im     0.0896881+0.151141im      0.201971-0.076612im    -0.00508595+0.129865im     0.0654246-0.033045im      0.155594+0.101457im     -0.0580928+0.0424075im    -0.0262918+0.206861im      -0.198549-0.302418im     -0.0729713-0.13214im      0.0804523-0.180296im      -0.129232+0.0513894im      -0.10204+0.0350597im    -0.0267533+0.0667503im     -0.121015+0.130531im       0.0458498+0.0493756im
   0.021421+0.0820907im     -0.128743+0.361587im      -0.095528-0.137578im       0.269111+0.259403im    -0.0143391+0.026463im       0.106196+0.0300211im    -0.0409695+0.226901im       0.0449824-0.0886841im   -0.0298133+0.0487818im     -0.190515-0.0672522im    -0.128423+0.147221im     0.0868932-0.0237333im     -0.114435-0.0992732im    -0.149981-0.127026im      -0.0631113+0.24804im      -0.0228334-0.0873808im    -0.133184+0.0599137im   -0.0710485+0.143396im    -0.0959731+0.0393445im      0.180001+0.135117im      0.052405+0.100941im       0.11402-0.0831688im     0.0374498+0.0336398im      0.040324+0.179836im       0.186878+0.0448617im  -0.000420636-0.0190498im    0.0411086-0.183824im      0.0456606-0.0511915im     -0.110583-0.0515512im    -0.0553878-0.192779im      -0.139932-0.150447im        0.141427+0.0586719im
 -0.0650046-0.0941806im      0.104469+0.243698im     -0.0393488+0.309806im      -0.110622-0.0702744im   -0.0798958-0.04856im      -0.0148922+0.170466im       0.141992-0.186025im        0.172079+0.189788im      0.139689+0.0143253im     -0.141676-0.0502757im   -0.0916489+0.0408546im     0.137543-0.0331028im     -0.275653-0.00298936im   -0.017137+0.130544im        0.152753-0.109146im     0.00471082-0.27694im      0.0199979+0.0248937im    -0.104573+0.00481951im  -0.0632399-0.121519im      0.0186173+0.123572im    -0.0723927+0.101562im      0.062796+0.113098im       0.100596+0.0240115im     0.0278871+0.0644391im     -0.219888+0.205743im      0.0651946+0.0363123im    -0.163934-0.172165im    -0.00693757+0.00489864im     0.270456-0.039102im      0.0832946-0.0440176im   -0.00613548+0.0292081im     -0.0803544+0.166649im
   0.116594+0.0517413im      0.268313-0.00435716im    -0.119637+0.102639im     -0.0592253+0.2502im       0.0294037+0.0815195im      0.224922+0.168458im     -0.0476226-0.037369im       -0.099565+0.0896126im    0.0179642-0.23894im       0.0931893+0.207861im      0.145377+0.0196684im   -0.0155797+0.141657im      0.0775364-0.208525im     -0.270176+0.0449401im     -0.0579723-0.147655im      0.0138019+0.137639im     -0.204169+0.0530013im     0.171451+0.0378219im   -0.0862225+0.0217845im     0.0549046-0.0728667im    -0.116686+0.066004im    -0.0587805-0.122385im      -0.118966+0.143192im       -0.28009+0.0582406im     0.0298112-0.041079im      0.0634226+0.109135im     0.0235516-0.100682im     -0.0813719+0.0654577im      0.125792+0.0615491im    -0.0810389-0.124557im       0.187097-0.0416197im      -0.108157+0.134311im
  -0.186626+0.0441686im     -0.151325-0.0907905im     -0.155056+0.290593im       0.103876-0.122431im     -0.174285+0.117758im      0.0835567-0.00369659im    0.0662308+0.0926318im       0.028941-0.0870381im     0.171394-0.172097im      0.0843578-0.0113103im   -0.0601917+0.0422961im    -0.159377+0.103808im      -0.156191-0.028559im    -0.0539094-0.0790319im     -0.0947668-0.16107im      -0.0144229-0.0783984im    0.0495246-0.181063im     0.0168179-0.161704im     -0.142207-0.0574257im      0.198388-0.117907im      0.135894+0.0914502im     0.120539-0.00719903im    0.0220621-0.10801im        0.178666+0.13719im      -0.0211415-0.0594065im      0.110585+0.206787im      0.200187+0.22391im        0.111788+0.179078im      -0.144513+0.138268im     -0.0393204-0.063177im      0.0150564-0.163297im       -0.148167-0.104123im
  0.0555285-0.0455313im     -0.111399-0.081211im     -0.0925848-0.262515im      0.0145297+0.0265092im   -0.0541137-0.136235im      -0.228704+0.258243im       0.277751-0.286418im       0.0621263-0.00359723im  -0.0520051+0.0022712im     -0.112922-0.0990864im   -0.0151433+0.0708773im    -0.169757+0.0140194im    -0.0872452+0.00990833im   0.0106722+0.0515428im      -0.125766+0.111071im      -0.090867-0.0391077im   -0.0911968+0.00772439im    0.221641-0.314084im    -0.0315273+0.0756877im      0.112155-0.208062im      0.134047-0.0163347im   0.00497789-0.03911im      -0.0482554+0.134964im    -0.00750409-0.0666371im     0.0725564-0.0139568im      0.205152-0.0784548im    -0.023439+0.121471im      -0.224979+0.0342374im      0.170887-0.000347605im   0.0478267-0.16646im      -0.0393558-0.0873707im       0.175398+0.0492306im
   0.186476-0.0595863im    -0.0855787-0.0881515im    -0.0434341-0.0898526im    -0.0895963-0.298903im    -0.0488038-0.159376im     0.00440028+0.0649762im      -0.19901+0.321174im      -0.0639314+0.0867516im     0.136885+0.0456247im    -0.0488021+0.00771287im  -0.0173542+0.152195im     -0.078033-0.164738im     -0.0807024+0.0790355im   -0.0204657-0.00735372im    -0.0864735-0.179485im     -0.0401263+0.123142im     -0.210491+0.206707im    -0.0220723+0.00586604im   -0.111269-0.00206609im  -0.00525491+0.162669im      0.133026+0.0730062im    -0.212393-0.0876252im     -0.104552-0.208528im      0.0171974+0.00410236im       -0.279+0.0478488im      0.107648-0.200213im     0.0865721-0.0105455im     0.0477821+0.0326786im       0.15031-0.0369187im     -0.141419-0.179396im       0.114184-0.0409676im       0.104354-0.0415703im
  -0.133035+0.0686739im      -0.12687-0.00969016im   -0.0488421-0.282496im       0.071092+0.00454511im   0.0970775+0.0496391im     0.0976824+0.0264837im    -0.0493972-0.123804im      -0.0322417+0.390319im     0.0413302+0.0870496im   -0.00437706+0.146764im      0.126609-0.0287457im     0.100905+0.0821267im    -0.0640387+0.133065im     -0.131595+0.0481995im      -0.157622+0.0285914im     0.0095753+0.189824im     0.0962149+0.0203589im    -0.202828-0.0108672im    -0.128516+0.108742im     -0.0248212-0.0909562im     0.153988+0.193697im    0.00143689+0.213154im     -0.0424535-0.119701im      0.0817789-0.0732338im    -0.0773758+0.0129037im    -0.0225808+0.11835im      -0.321289+0.0307989im   -0.00471702-0.104721im      -0.183187+0.142302im       0.081579-0.220089im      0.0062474+0.0390645im      -0.204975+0.0407116im
 -0.0633741-0.0292483im   -0.00262776-0.0323367im    -0.0194618+0.191307im      0.0116641+0.232987im    -0.0288823+0.00661548im    0.0511178+0.0570979im    -0.0171729+0.17933im         0.177542+0.118843im     -0.243135+0.164919im      0.0325907-0.11411im     -0.0257657+0.257357im     0.0198628-0.25484im       0.0636569+0.19647im       -0.14354-0.199489im        0.129401-0.126943im       0.032918+0.0629613im     0.115889-0.267023im    -0.0518145-0.182135im    -0.0640543-0.00320232im    0.0692951-0.0679189im   0.00699251-0.0847959im    -0.331642-0.0932963im    -0.0559316+0.239506im      -0.102158-0.0523349im     -0.118015-0.0241356im     0.0293598-0.0977257im   -0.0952148+0.0825645im     0.0321368+7.59083e-5im    -0.109818+0.131428im      0.0404934-0.0153804im     -0.122769+0.0907583im      0.0160432+0.117946im
 0.00737842-0.0205945im     0.0609192+0.0486785im      0.113101+0.0497958im     0.0930631+0.10726im      0.0340607-0.279256im      -0.165887+0.328849im      0.0169574+0.194947im       0.0210074+0.0258215im    -0.242062-0.2397im        -0.144636+0.175633im       0.03069-0.210996im     0.0693124-0.120966im      0.0333733+0.232858im     0.0649311+0.061603im      -0.0245209+0.0830615im    -0.0791765+0.131459im    -0.0867851-0.136895im    -0.0522237+0.101683im     0.0255661-0.0900986im     0.0585798-0.0173094im    0.0312833-0.0688482im   -0.0386071+0.178415im       0.271703-0.0572495im     0.0642317-0.01228im        -0.10087-0.110827im     -0.0946462+0.0918045im    0.0803839-0.0265883im      -0.12516+0.107201im      0.0207219+0.0626268im    -0.0800461+0.0639741im     0.0490708-0.290314im       -0.153591-0.0716046im
  0.0696082+0.0273284im    -0.0938886+0.0101621im    -0.0436483+0.107009im      0.0199785-0.0525799im    0.0640779-0.094615im      0.0129222+0.0951923im      -0.13176+0.188391im       -0.128465-0.0364865im    -0.175159-0.13331im       0.0188575+0.0532651im    -0.207163+0.231471im     -0.132382+0.160872im        0.13449+0.0390903im    -0.194035+0.161798im      -0.0607952-0.0309393im       -0.1195+0.128905im      0.310258+0.181256im    -0.0974864-0.00322346im   0.0143464-0.153185im     -0.0540409-0.0760982im    -0.154639-0.0554125im     0.190911+0.0677898im   -0.00737394+0.0312457im      0.161584+0.193944im      0.0734832+0.0401579im    -0.0497534-0.0118513im   -0.0582555+0.187006im      -0.113829-0.177087im       0.260715+0.0914826im      0.251313-0.00118485im   -0.0574456+0.108675im        0.110516+0.0503052im
  0.0563487+0.08334im        0.175258+0.0470916im    -0.0214712-0.200146im      0.0291803+0.0775064im   -0.0850682-0.124698im     -0.0105348-0.243109im     -0.0449043-0.0507254im      -0.035169+0.0577589im    -0.102224+0.0186851im     -0.114955+0.236281im     -0.303605+0.0731959im   -0.0860499+0.107042im       -0.11273-0.178989im     0.0981966+0.0101749im     -0.0235425-0.0693299im    -0.0595409-0.058103im     0.0723905-0.145253im     0.0569435-0.216973im     -0.218771-0.0549438im    -0.0194484-0.00848197im   0.0710361-0.104008im    -0.0416957+0.120785im       0.111404+0.0356073im     0.0536441-0.00666369im    -0.106266+0.0868421im     -0.193933-0.0703226im     0.213762+0.0548506im     -0.010669-0.220451im     -0.0186442-0.0298309im     -0.348705+0.0458109im     0.0677371+0.146365im       -0.164492+0.204475im
 -0.0879178-0.1509im        0.0894312+0.231855im       0.128677+0.0435406im    -0.0494666-0.0433897im    -0.141049+0.0144218im    -0.0570936-0.0816041im     -0.105062-0.152131im       -0.150045+0.0498393im    -0.161453+0.102466im    0.000400697+0.0984634im     -0.13561-0.138369im     -0.116888+0.0551484im     -0.307653+0.0334461im   -0.0620908-0.0999111im      -0.163721-0.0651636im       0.26335+0.113513im    -0.0664368+0.021605im    -0.0377709+0.154092im     0.0335619-0.00568986im     0.106579+0.0645667im     0.110363+0.092938im     -0.139705-0.0515576im    -0.0541184+0.0522722im    -0.0099935-0.136607im       0.195961-0.0482962im     -0.256816-0.00485893im    0.016245+0.214762im      0.0641697+0.206786im       0.201028+0.243422im      0.0985936+0.0564633im   -0.00849585-0.026998im        0.209369+0.0319531im
  -0.195288-0.0494602im     0.0473619+0.0406991im     -0.162227-0.00659213im   -0.0160341+0.064648im    -0.0573888+0.0786246im     -0.218389-0.00659189im   -0.0863186-0.0503685im      -0.146545-0.0427861im     -0.14055-0.0935991im     -0.129544+0.0179085im    -0.175137+0.113466im     0.0873327-0.0608033im      0.238491-0.201829im    0.00654022+0.297608im       -0.086019+0.0308598im    -0.0902282-0.00795376im  -0.0840582-0.219651im    -0.0227586+0.0362293im   -0.0392361+0.0547146im    -0.0883448+0.0518548im    -0.062829+0.0936382im    -0.112938+0.158237im      -0.239537-0.0232282im      0.077613-0.0203064im    -0.0879917+0.0821316im      0.173119+0.132919im     -0.229659+0.00577403im     0.239245+0.157808im      -0.005037+0.0340956im     -0.195834+0.105461im    -0.00514489+0.000954247im     0.239099-0.197504im
 -0.0684839+0.26173im        -0.19833-0.201972im      0.0832486+0.190839im       0.184285-0.0343327im      -0.1997+0.0149575im     -0.159811+0.188328im     -0.0171092-0.0375736im     -0.0265156-0.102416im    -0.0417629+0.0144092im    -0.0341019-0.0102266im   -0.0398063-0.0865579im   -0.0250779-0.170591im     0.00999454-0.0521127im    -0.130286+0.0389644im     -0.0447902+0.187566im   -0.000860229-0.0801883im    0.0302107+0.124007im    -0.0299731+0.0489959im    0.0185033+0.0675737im    -0.0999678-0.0281292im     0.136327+0.179909im    -0.0991316-0.264147im      -0.193723+0.0744469im     0.0130277-0.0234568im     -0.073318+0.0677305im     -0.370355+0.19965im     -0.0401037-0.0257411im    -0.0954039-0.0324255im     0.0903609-0.176958im      -0.140919+0.0134188im     0.0639218+0.205201im       -0.165293+0.0718476im
  -0.309191-0.200622im      0.0656976+0.0354857im   -0.00953724+0.0127542im     0.0976225-0.0684912im      0.11026+0.067214im       0.232043-0.0196922im     0.0654388+0.14733im         0.134111-0.0840394im     0.102158-0.122144im      -0.107765-0.138807im    -0.0370925-0.0964586im     0.136632+0.0314894im     0.0111343-0.038016im      0.157117+0.0376815im     -0.0459865+0.140048im      -0.221002+0.320347im     -0.148611+0.0222525im    0.0594779-0.238475im    -0.0862474-0.0808547im     0.0411037+0.196175im        0.2006-0.0428858im   -0.0264616+0.0710606im     -0.125106+0.0168222im    -0.0884328-0.0571991im    -0.0365989-0.119888im      -0.108896+0.160543im     0.0895299-0.0485947im    -0.0980372-0.033613im       0.126973+0.0267035im      0.166423+0.0892334im    -0.0104274+0.279188im        0.084141+0.103093im
 -0.0941882-0.180325im      -0.163438+0.0871901im    -0.0400858+0.0570239im    -0.0365503+0.211078im      0.142366-0.0168043im     -0.262359-0.138948im    -0.00501832+0.117033im       0.0224874-0.0931083im    0.0386657+0.0541314im      0.194013+0.263953im    0.00923338-0.00873156im   -0.151131+0.0227981im     -0.193622-0.0159791im      0.10054+0.128975im        0.141713-0.0144263im     -0.166054+0.0990674im    -0.191802+0.101185im     0.0644105+0.147347im      0.100822+0.0193968im    -0.0613147-0.215689im    -0.0689694-0.0856217im   -0.0155077+0.0334579im    -0.0457842+0.0811142im     0.0750127-0.0157714im     -0.174747+0.0632749im    -0.0321535+0.0768739im    0.0658114+0.0423326im     0.0988363+0.190209im      -0.129183-0.185121im       0.133453-0.27968im        -0.14517+0.14616im       -0.0404689+0.195475im
  -0.167602+0.13601im      -0.0722993-0.0861052im     -0.110035+0.0582872im     0.0882434-0.0629903im     0.252529-0.200217im      0.0396964-0.0570568im     0.0729323-0.140812im        0.127395+0.200289im    -0.0535087-0.096466im      0.0920792+0.0158612im   -0.0395934+0.0427668im     -0.22487+0.255641im    -0.00950258-0.0738587im     -0.18631-0.162552im      -0.0482421-0.0719013im    -0.0321853+0.0300922im   -0.0918278-0.150075im    -0.0376081+0.278426im     0.0729835-0.30063im      -0.0163134+0.0828013im      0.20294-0.0205249im    -0.117048-0.0783794im     0.0527542-0.0281601im    -0.0226241-0.0926389im    -0.0495669+0.0331266im     0.0728648-0.0319537im   -0.0501725-0.0929697im     -0.121251-0.0317432im    -0.0221536-0.291454im      -0.062687+0.170133im      -0.167073+0.00597359im      0.168592-0.0933804im
   0.219546-0.194311im      -0.224064-0.0580196im     0.0750754+0.0389096im     0.0173717-0.0616855im    0.0237606+0.0692116im     -0.089084-0.0155647im      0.020387-0.0543305im       0.121988-0.0411893im    0.0702948-0.111791im     -0.0510124+0.106643im      -0.11737+0.0366629im   0.00304666+0.0389981im     0.0552202+0.0354396im    0.0849832-0.187967im      -0.0214545-0.198166im      0.0598095+0.141947im    0.00228807-0.0256124im    0.0950627+0.117717im     -0.333993+0.231473im      -0.171171+0.111129im     0.0491952-0.0150609im      0.18425-0.0218202im      0.190405+0.315475im     -0.0827764+0.0164229im    -0.0195375-0.16344im      -0.0503515+0.167635im     -0.196124-0.0850992im     0.0836618-0.0465357im      0.143951+0.0129607im     -0.127356-0.0430337im     -0.231763+0.0501559im    -0.00988899-0.197888im
 -0.0848704-0.00310393im    -0.012806+0.170109im     -0.0158602+0.0515317im      0.150616-0.0904823im      0.11839-0.0336126im    -0.0703827-0.121196im      -0.210925-0.045576im       0.0900258-0.165382im     -0.171522+0.0319256im     -0.144442+0.0768098im      0.23608+0.0599187im    -0.200316+0.0292072im     0.0263425+0.187081im    -0.0511991-0.123152im       0.0703283-0.073758im        0.14794-0.0878359im    0.0494594+0.0670934im     0.182048-0.153393im    -0.0752215+0.0141491im     -0.135141+0.184025im     -0.138699+0.243448im     0.0296228+0.268878im      -0.332912+0.0317611im     0.0822353-0.0915175im      0.031876-0.164743im       0.128976+0.0400557im    0.0729086-0.0597282im     -0.138347+0.0157378im     0.0425545-0.162448im     -0.0205865+0.0588374im    -0.0126028-0.138347im       -0.147289+0.118815im
  0.0274722-0.157841im       -0.14705-0.234098im      0.0103358-0.111293im      -0.075798-0.073454im      0.125522+0.117233im      0.0709002-0.0105374im      0.199558-0.107714im      -0.0621078-0.114792im    -0.0823644-0.115696im      0.0682513+0.14105im     -0.0593012+0.179455im      0.221795+0.0421309im     0.0308189+0.226974im    -0.0919539+0.0136425im       0.156424+0.213287im      0.0297481-0.131952im     -0.156003+0.0963249im   -0.0800258+0.108164im    -0.0508884-0.256511im       0.158245+0.17329im      -0.132591+0.299198im    0.00821708+0.0740356im     0.0388613+0.163771im     -0.0542127-0.04575im      -0.0426347+0.0371653im   -0.00774107-0.0885637im     0.134196+0.240119im     -0.0253926+0.0721147im    -0.0849358+0.122779im      -0.191131+0.0183004im     0.0184359+0.113706im        -0.01188+0.0634891im
  0.0601626+0.0469253im      0.110373-0.0433256im    -0.0987798-0.10654im     -0.00300437+0.0752868im    -0.272629-0.107436im       0.108675-0.044675im      -0.106632-0.0331148im      -0.254246+0.00242278im   0.0677819-0.177459im       0.235217-0.303197im     0.0465474-0.188231im    -0.0478111-0.0883762im     -0.106029+0.0621598im    -0.116333-0.171149im         0.12859+0.118942im      -0.120664+0.060775im    -0.0436554-0.127558im     -0.014611+0.178284im    -0.0917089+0.190778im      0.0464925+0.0450764im   -0.0653052+0.0448091im   -0.0700208+0.278127im      0.0267633+0.206516im       0.287291-0.00945304im   -0.0518842+0.0523502im      0.141213-0.0271627im    0.0619814+0.03232im      -0.0926018+0.00151818im     0.143121-0.110954im      0.0400039+0.0132981im     -0.108653+0.189726im      -0.0456932-0.030173im
 0.00266135-0.0566627im    -0.0277427+0.121635im     -0.0101609-0.139845im       0.251319-0.164729im     0.0339047-0.235322im      0.0949097-0.0364852im      0.041938-0.101269im      0.00960758+0.195548im      0.208463-0.164205im      0.0287261+0.125074im     -0.162423+0.00461959im   0.0582662-0.188557im      0.0854505+0.207358im    -0.0544118+0.220282im      -0.0844842-0.130017im      0.0831062+0.0210623im     -0.10733-0.144093im    -0.0162465-0.104858im     0.0542944+0.102422im    -0.00121319-0.0127936im    -0.196172+0.0264029im   0.00263814-0.216178im      -0.147975+0.257565im      0.0336101+0.048694im       0.115721+0.146457im     -0.0834483-0.035928im      0.199339-0.018396im       0.156243-0.00123778im    -0.108273-0.153117im       0.234502+0.147023im     0.00517113-0.0463231im     -0.0807852-0.0759894im
  -0.230141+0.0857884im    -0.0717094-0.0723135im     0.0381909-0.10326im       -0.157762-0.095217im    -0.0210349-0.00960158im  -0.00734397+0.0290597im    -0.0733488+0.103638im       0.0770158+0.104819im     -0.105553+0.0602637im     -0.066628-0.0352803im    0.0456215-0.145096im     -0.296218+0.276492im      -0.107957+0.195319im      0.109061+0.19036im         0.300736+0.115646im     -0.0312627+0.0653561im   -0.0681194-0.21406im      0.0590774+0.0327378im   -0.0750094+0.205395im      0.0983967+0.0796942im    -0.199496+0.100243im   -0.00339691-0.223664im     -0.0216748-0.0277356im     -0.122435+0.3676im        0.0454661+0.0533513im    -0.0140341-0.0449677im   -0.0517064-0.0917665im   -9.08578e-5-0.0704789im     0.0479208+0.150314im      -0.111792+0.0287638im    -0.0158512+0.0435179im      0.0102465-0.0140227im
  -0.097687+0.0640931im      0.144232+0.145127im    -0.00667164+0.0470381im     -0.106162-0.00464874im    0.155552+0.172111im     -0.0200986-0.0412621im      0.143105-0.0328784im      0.0781101-0.102862im     0.0662214+0.17442im        0.281032-0.0254253im    -0.339068+0.0210358im    -0.129029-0.0793308im     0.0447939+0.0577156im     -0.16588+0.00790921im    -0.0310167+0.188344im      -0.174849+0.133678im     -0.018087+0.00257723im   0.0768826-0.0280948im     -0.15763+0.0656536im     -0.274722+0.093593im     0.0531258+0.0953725im  -0.00689263-0.0249697im     0.0827338+0.0565927im     0.0905143+0.0495313im    -0.0498318-0.027067im     -0.0842757-0.267403im    -0.0901179-0.0330356im     -0.153635+0.146622im      -0.012044+0.0107102im     0.0593394+0.00631141im     0.252558-0.24699im          -0.1623-0.146271im
 -0.0807539-0.0015429im     0.0432958-0.168098im      -0.195487-0.146895im       -0.26156-0.164256im      0.149893-0.139507im       0.215484+0.0617257im     0.0198678+0.11361im      -0.00323155-0.208271im     -0.200813+0.062789im      -0.119534+0.0132669im     0.134548+0.0113368im     0.133576-0.0740532im     -0.229619-0.00911223im   -0.209673-0.0954095im    0.000626498-0.0660258im    -0.0293096-0.0783015im   -0.0520292-0.145654im      0.194762-0.0430954im     0.136512-0.0102869im     -0.321326-0.0533295im    0.0964224-0.032769im      0.100824+0.0152694im     0.0583437+0.12802im        0.140991+0.00410755im     0.124866+0.247654im      -0.174577+0.161827im    -0.0168873-0.0831339im      0.188784+0.0279585im     0.0285552+0.0637786im     0.0273945-0.0765189im      0.026205-0.0493353im      0.0194486-0.0241059im
  0.0826369+0.0457506im     0.0722263+0.0708542im     -0.149892+0.141446im      -0.161386-0.244731im      0.128002+0.012788im      -0.058013+0.0853482im      0.121258-0.136378im     -0.00125043+0.15674im      -0.103543+0.185293im     -0.0720083-0.183905im     0.0312674-0.103654im     0.0500177-0.0705445im     0.0732293-0.00791597im  -0.0205901-0.140859im       -0.178117+0.0154995im     -0.189149+0.15398im     -0.0815979+0.0299717im   0.00389541+0.0852599im   -0.0768854+0.0487454im      0.123069-0.033165im     -0.241304-0.0347478im     0.036864+0.0581939im    -0.0278239+0.017668im       0.044778+0.215462im    -0.00765121-0.244385im      -0.149253+0.0997345im    0.0409491+0.247983im       0.223654-0.100361im      -0.127235-0.257083im      -0.126959+0.00485854im    0.0235564-0.0756631im       0.085713+0.257998im
  -0.177568+0.191159im     0.00326085+0.103511im       0.199736-0.0710206im     -0.130242-0.0544347im    -0.124303+0.0675825im     -0.101143-0.162823im     -0.0448502+0.12091im       -0.0783509+0.357122im      0.156542-0.0831016im    -0.0947676+0.0155929im      0.14296+0.135371im     0.0817832-0.140038im       0.093743-0.0517711im   -0.0214499-0.147599im      -0.0121135+0.060096im     -0.0272365+0.0261072im    -0.117903+0.135317im        0.1417-0.145592im     0.0339073-0.156282im      -0.213652-0.0565512im    -0.070989-0.021214im     0.0947224-0.0345923im      0.125525+0.0781131im     0.0199899+0.181121im      0.0632834+0.0866285im   -0.00591149+0.0584788im   -0.0270201+0.133794im      -0.226334+0.309464im     0.00619571+0.0437825im     -0.128954+0.113548im      -0.265086-0.0130226im      0.0268981+0.0531139im
  -0.223868+0.107035im     -0.0273771-0.139161im      -0.114751+0.00036181im     0.160834-0.00253542im  -0.0827555+0.176141im      0.0341425+0.00316568im     0.036407-0.0846417im    -0.00310905+0.079507im     -0.065991+0.00776256im    -0.133154+0.146534im     0.0815509-0.0943248im     0.105007+0.0938663im     0.0757142-0.0293583im     0.035778-0.000410894im   -0.0370008-0.102429im      -0.153094-0.144581im      0.121856+0.180373im      0.175567+0.178927im    -0.0737397+0.196263im     -0.0502825+0.316902im     -0.143316-0.2521im       -0.179064-0.116609im      0.0845572+0.100727im       0.163528-0.11369im       -0.212296+0.0805653im    -0.0160399-0.0603815im     0.176976+0.0893107im    -0.0834204-0.0538604im    -0.0388803+0.1577im         0.176716-0.103965im     -0.0358081-0.205562im        0.140913+0.0450989im
  -0.148192+0.0635702im    -0.0920665+0.0952309im     0.0741528-0.190994im     -0.0738734-0.0111946im     0.115213+0.0335716im      0.152177+0.095273im      -0.128102+0.13232im         0.123122-0.0276871im   -0.0184439-0.0456784im      0.176879-0.18184im     -0.0273927-0.0498657im    -0.066033-0.0529571im     -0.118482-0.131684im    -0.0282155+0.157581im       0.0608267-0.180396im      0.0282784-0.163116im     -0.149956+0.136644im     -0.127084-0.102315im     -0.130537-0.0406569im      0.158928-0.129125im     -0.293676-0.120977im      0.100268-0.0794989im   0.000875607+0.110356im       0.160717-0.381813im     -0.0832814-0.157515im      -0.170297+0.0877215im    -0.172952+0.04522im       -0.121847-0.0502256im   -0.00138895-0.00432429im    -0.189718+0.0754772im     0.0107009-0.105816im       0.0721538-0.0955669im
 0.00343415-0.0995094im      0.124393-0.119091im     0.00023415+0.130508im     -0.0543787+0.0204462im      0.32783-0.0693406im     0.0426485+0.145818im     0.00664588+0.000612639im   -0.0886124+0.132195im    -0.0985448+0.131867im     -0.0480563-0.0927392im     -0.19294-0.0472165im   -0.0767319-0.0555394im     0.0484668+0.00177979im    0.109045+0.0243304im       -0.11958-0.135138im       0.050368-0.237107im     -0.064327+0.136509im     -0.149984+0.0502024im   -0.0961323+0.193757im    -0.00643832+0.0774974im    0.0444293-0.126581im    -0.0287151+0.061229im      -0.121352-0.0288682im      0.105635+0.112413im       0.274863+0.0629032im     0.0705064+0.0890168im     0.168718-0.0772im        -0.293359+0.213755im      -0.169911+0.0988466im    -0.0939847-0.107054im       -0.10906+0.263552im       -0.119069-0.105399im
  -0.165472+0.0433659im    -0.0555317-0.120971im      -0.178852+0.0341218im    -0.0450817-0.0690767im     0.140397+0.068105im     -0.0398886+0.173893im     -0.0908002+0.142808im       -0.138369-0.139477im      0.276721+0.0179351im      -0.13595+0.0720695im   -0.0501221-0.0598819im    0.0277214-0.0482029im  -0.000570533-0.0201148im    0.0723963+0.077516im       -0.112854+0.103161im       0.312102+0.0497712im    0.0905214-0.0885277im     0.115542+0.114502im      -0.29462-0.0569845im   -0.00114137-0.178104im    -0.0944986+0.0105221im    -0.187913-0.00772476im     0.223442-0.00504097im    0.0658028-0.130313im       0.207081-0.0252902im      0.113693-0.214732im    -0.0814818-0.0705688im     0.0196471+0.0340226im     0.0279657-0.0891921im     0.0459546+0.148727im      -0.076416+0.0440858im     -0.0391405+0.327145im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.2079340475691128 - 0.0756196571938762im
  0.037353410782478905 - 0.07857139599397493im
   0.11881450668544014 - 0.14883896846975098im
  -0.09698837455965477 + 0.2200513578171758im
  -0.12767593046961986 - 0.16678384020200876im
   -0.0463854040737575 - 0.08345300111810104im
  -0.10074693947416864 - 0.05305453835540355im
 -0.005454506393597118 + 0.018078256826857545im
  -0.17140149079054878 - 0.1399622746245016im
 -0.025774251757130134 - 0.12880295502454484im
   0.11174169698040937 + 0.18959022352021254im
  -0.03634674674248924 - 0.17992387067508345im
   0.15382574710146657 + 0.24649298130275898im
   -0.1675678775344471 + 0.04332044626626809im
  -0.17742548413394066 + 0.07122897783812361im
   0.09375316850486559 - 0.12108171707215729im
 -0.015790777455735372 - 0.20496304402452384im
  -0.09194123982565726 - 0.03699890927279617im
   0.15355697957361505 + 0.015478922750102597im
  -0.22840237221344897 + 0.13225804617587963im
   0.08804725362951216 - 0.15844999440317237im
 -0.030973912860253743 - 0.15018343295149494im
   -0.1628699232956174 - 0.15522900795845768im
  -0.11963679901264221 - 0.07885129783034289im
   0.31209283867542914 + 0.0im
   0.09025120808433688 + 0.05450904917100559im
  -0.08221423194419519 + 0.06569189293830995im
 -0.029447432971542724 + 0.07219284219256296im
 -0.004679260516463342 - 0.13840679461242336im
  0.052013288541283426 - 0.1646390744125594im
    0.0540007145265816 + 0.024996840238540353im
   0.09342396635163946 - 0.008768116520771578im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 1 April 2023 00:18">Saturday 1 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

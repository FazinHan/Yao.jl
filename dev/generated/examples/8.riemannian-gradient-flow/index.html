<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Riemannian gradient flow optimizer · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li><a class="tocitem" href="../2.qft-phase-estimation/index.html">Quantum Fourier Transformation and Phase Estimation</a></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li class="is-active"><a class="tocitem" href="index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/8.riemannian-gradient-flow/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/8.riemannian-gradient-flow/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/8.riemannian-gradient-flow/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/8.riemannian-gradient-flow"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="Riemannian-gradient-flow-optimizer"><a class="docs-heading-anchor" href="#Riemannian-gradient-flow-optimizer">Riemannian gradient flow optimizer</a><a id="Riemannian-gradient-flow-optimizer-1"></a><a class="docs-heading-anchor-permalink" href="#Riemannian-gradient-flow-optimizer" title="Permalink"></a></h1><p>In this tutorial we will present the Riemannian gradient descent algorithm described in <a href="https://arxiv.org/pdf/2202.06976.pdf">Wiersema and Killoran (2022)</a>. As opposed to most standard optimization algorithms that optimize parameters of variational quantum circuits, this algorithm optimizes a function directly over the special unitary group by following the gradient flow over the manifold. Let&#39;s start by importing the necessary packages.</p><pre><code class="language-julia hljs">using Yao, Yao.EasyBuild, Plots, Random
using KrylovKit: eigsolve</code></pre><p>Variational quantum eigensolver (VQE) is one of the most celebrated near-term quantum algorithms. In the usual setting, VQE tries to reach the ground state by minimizing the energy cost function</p><p class="math-container">\[\mathcal{L}(\theta) = \text{Tr}\{HU(\theta)\rho_0U^\dagger(\theta)\},\]</p><p>with respect to parameters <span>$\theta$</span> which parameterize a quantum circuit <span>$U(\theta)$</span>, where <span>$\rho_0 = |\psi_0\rangle\langle\psi_0|$</span> is some initial state and <span>$H$</span> the Hamiltonian whose ground state we want to approximate. We can solve the optimization problem <span>$\text{min}_\theta\mathcal{L}(\theta)$</span> by following the direction of the steepest descent in parameter space which is given by the gradient of the cost function, i.e. by considering the following gradient flow</p><p class="math-container">\[\dot{\theta} = -\text{grad}\mathcal{L}(\theta).\]</p><p>Discretizing the equation above, we recover the well-known gradient descent algorithm</p><p class="math-container">\[\theta_{k + 1} = \theta_k - \alpha\text{grad}\mathcal{L}(\theta),\]</p><p>where <span>$\alpha$</span> is the learning rate. Let&#39;s demonstrate it on the example of finding the ground state of the transverse field Ising model.</p><pre><code class="language-julia hljs">n = 8
h = transverse_ising(n, 1.0)
w, v = eigsolve(mat(h), 1, :SR, ishermitian=true)

Random.seed!(0)
circuit = dispatch!(variational_circuit(n, 100), :random);
history = Float64[]
for i in 1:100
    _, grad = expect&#39;(h, zero_state(n) =&gt; circuit)
    dispatch!(-, circuit, 0.01 * grad)
    push!(history, real.(expect(h, zero_state(n)=&gt;circuit)))
end

plot(history, legend=false)
plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip380">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip380)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip381">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip380)" d="
M242.135 1423.18 L2352.76 1423.18 L2352.76 47.2441 L242.135 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip382">
    <rect x="242" y="47" width="2112" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  281.757,1423.18 281.757,47.2441 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  784.573,1423.18 784.573,47.2441 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1287.39,1423.18 1287.39,47.2441 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1790.21,1423.18 1790.21,47.2441 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2293.02,1423.18 2293.02,47.2441 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  281.757,1423.18 281.757,1404.28 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  784.573,1423.18 784.573,1404.28 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1287.39,1423.18 1287.39,1404.28 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1790.21,1423.18 1790.21,1404.28 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2293.02,1423.18 2293.02,1404.28 
  "/>
<path clip-path="url(#clip380)" d="M281.757 1454.1 Q278.145 1454.1 276.317 1457.66 Q274.511 1461.2 274.511 1468.33 Q274.511 1475.44 276.317 1479.01 Q278.145 1482.55 281.757 1482.55 Q285.391 1482.55 287.196 1479.01 Q289.025 1475.44 289.025 1468.33 Q289.025 1461.2 287.196 1457.66 Q285.391 1454.1 281.757 1454.1 M281.757 1450.39 Q287.567 1450.39 290.622 1455 Q293.701 1459.58 293.701 1468.33 Q293.701 1477.06 290.622 1481.67 Q287.567 1486.25 281.757 1486.25 Q275.946 1486.25 272.868 1481.67 Q269.812 1477.06 269.812 1468.33 Q269.812 1459.58 272.868 1455 Q275.946 1450.39 281.757 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M763.844 1481.64 L780.163 1481.64 L780.163 1485.58 L758.219 1485.58 L758.219 1481.64 Q760.881 1478.89 765.464 1474.26 Q770.071 1469.61 771.251 1468.27 Q773.496 1465.74 774.376 1464.01 Q775.279 1462.25 775.279 1460.56 Q775.279 1457.8 773.334 1456.07 Q771.413 1454.33 768.311 1454.33 Q766.112 1454.33 763.659 1455.09 Q761.228 1455.86 758.45 1457.41 L758.45 1452.69 Q761.274 1451.55 763.728 1450.97 Q766.182 1450.39 768.219 1450.39 Q773.589 1450.39 776.783 1453.08 Q779.978 1455.77 779.978 1460.26 Q779.978 1462.39 779.168 1464.31 Q778.381 1466.2 776.274 1468.8 Q775.696 1469.47 772.594 1472.69 Q769.492 1475.88 763.844 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M790.024 1451.02 L808.381 1451.02 L808.381 1454.96 L794.307 1454.96 L794.307 1463.43 Q795.325 1463.08 796.344 1462.92 Q797.362 1462.73 798.381 1462.73 Q804.168 1462.73 807.547 1465.9 Q810.927 1469.08 810.927 1474.49 Q810.927 1480.07 807.455 1483.17 Q803.982 1486.25 797.663 1486.25 Q795.487 1486.25 793.219 1485.88 Q790.973 1485.51 788.566 1484.77 L788.566 1480.07 Q790.649 1481.2 792.871 1481.76 Q795.094 1482.32 797.57 1482.32 Q801.575 1482.32 803.913 1480.21 Q806.251 1478.1 806.251 1474.49 Q806.251 1470.88 803.913 1468.77 Q801.575 1466.67 797.57 1466.67 Q795.695 1466.67 793.82 1467.08 Q791.969 1467.5 790.024 1468.38 L790.024 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1262.09 1451.02 L1280.44 1451.02 L1280.44 1454.96 L1266.37 1454.96 L1266.37 1463.43 Q1267.39 1463.08 1268.41 1462.92 Q1269.43 1462.73 1270.44 1462.73 Q1276.23 1462.73 1279.61 1465.9 Q1282.99 1469.08 1282.99 1474.49 Q1282.99 1480.07 1279.52 1483.17 Q1276.05 1486.25 1269.73 1486.25 Q1267.55 1486.25 1265.28 1485.88 Q1263.04 1485.51 1260.63 1484.77 L1260.63 1480.07 Q1262.71 1481.2 1264.94 1481.76 Q1267.16 1482.32 1269.63 1482.32 Q1273.64 1482.32 1275.98 1480.21 Q1278.31 1478.1 1278.31 1474.49 Q1278.31 1470.88 1275.98 1468.77 Q1273.64 1466.67 1269.63 1466.67 Q1267.76 1466.67 1265.88 1467.08 Q1264.03 1467.5 1262.09 1468.38 L1262.09 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1302.2 1454.1 Q1298.59 1454.1 1296.76 1457.66 Q1294.96 1461.2 1294.96 1468.33 Q1294.96 1475.44 1296.76 1479.01 Q1298.59 1482.55 1302.2 1482.55 Q1305.84 1482.55 1307.64 1479.01 Q1309.47 1475.44 1309.47 1468.33 Q1309.47 1461.2 1307.64 1457.66 Q1305.84 1454.1 1302.2 1454.1 M1302.2 1450.39 Q1308.01 1450.39 1311.07 1455 Q1314.15 1459.58 1314.15 1468.33 Q1314.15 1477.06 1311.07 1481.67 Q1308.01 1486.25 1302.2 1486.25 Q1296.39 1486.25 1293.31 1481.67 Q1290.26 1477.06 1290.26 1468.33 Q1290.26 1459.58 1293.31 1455 Q1296.39 1450.39 1302.2 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1764.06 1451.02 L1786.28 1451.02 L1786.28 1453.01 L1773.74 1485.58 L1768.85 1485.58 L1780.66 1454.96 L1764.06 1454.96 L1764.06 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1795.45 1451.02 L1813.8 1451.02 L1813.8 1454.96 L1799.73 1454.96 L1799.73 1463.43 Q1800.75 1463.08 1801.77 1462.92 Q1802.79 1462.73 1803.8 1462.73 Q1809.59 1462.73 1812.97 1465.9 Q1816.35 1469.08 1816.35 1474.49 Q1816.35 1480.07 1812.88 1483.17 Q1809.41 1486.25 1803.09 1486.25 Q1800.91 1486.25 1798.64 1485.88 Q1796.4 1485.51 1793.99 1484.77 L1793.99 1480.07 Q1796.07 1481.2 1798.3 1481.76 Q1800.52 1482.32 1802.99 1482.32 Q1807 1482.32 1809.34 1480.21 Q1811.67 1478.1 1811.67 1474.49 Q1811.67 1470.88 1809.34 1468.77 Q1807 1466.67 1802.99 1466.67 Q1801.12 1466.67 1799.24 1467.08 Q1797.39 1467.5 1795.45 1468.38 L1795.45 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2252.63 1481.64 L2260.27 1481.64 L2260.27 1455.28 L2251.96 1456.95 L2251.96 1452.69 L2260.22 1451.02 L2264.9 1451.02 L2264.9 1481.64 L2272.54 1481.64 L2272.54 1485.58 L2252.63 1485.58 L2252.63 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2291.98 1454.1 Q2288.37 1454.1 2286.54 1457.66 Q2284.73 1461.2 2284.73 1468.33 Q2284.73 1475.44 2286.54 1479.01 Q2288.37 1482.55 2291.98 1482.55 Q2295.61 1482.55 2297.42 1479.01 Q2299.25 1475.44 2299.25 1468.33 Q2299.25 1461.2 2297.42 1457.66 Q2295.61 1454.1 2291.98 1454.1 M2291.98 1450.39 Q2297.79 1450.39 2300.85 1455 Q2303.92 1459.58 2303.92 1468.33 Q2303.92 1477.06 2300.85 1481.67 Q2297.79 1486.25 2291.98 1486.25 Q2286.17 1486.25 2283.09 1481.67 Q2280.04 1477.06 2280.04 1468.33 Q2280.04 1459.58 2283.09 1455 Q2286.17 1450.39 2291.98 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2322.14 1454.1 Q2318.53 1454.1 2316.7 1457.66 Q2314.9 1461.2 2314.9 1468.33 Q2314.9 1475.44 2316.7 1479.01 Q2318.53 1482.55 2322.14 1482.55 Q2325.78 1482.55 2327.58 1479.01 Q2329.41 1475.44 2329.41 1468.33 Q2329.41 1461.2 2327.58 1457.66 Q2325.78 1454.1 2322.14 1454.1 M2322.14 1450.39 Q2327.95 1450.39 2331.01 1455 Q2334.09 1459.58 2334.09 1468.33 Q2334.09 1477.06 2331.01 1481.67 Q2327.95 1486.25 2322.14 1486.25 Q2316.33 1486.25 2313.25 1481.67 Q2310.2 1477.06 2310.2 1468.33 Q2310.2 1459.58 2313.25 1455 Q2316.33 1450.39 2322.14 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1238.66 1533.45 L1238.66 1538.98 Q1236.18 1537.71 1233.5 1537.07 Q1230.83 1536.44 1227.96 1536.44 Q1223.6 1536.44 1221.41 1537.77 Q1219.24 1539.11 1219.24 1541.79 Q1219.24 1543.82 1220.8 1545 Q1222.36 1546.15 1227.07 1547.2 L1229.08 1547.64 Q1235.32 1548.98 1237.93 1551.43 Q1240.57 1553.85 1240.57 1558.21 Q1240.57 1563.17 1236.62 1566.07 Q1232.71 1568.97 1225.83 1568.97 Q1222.97 1568.97 1219.85 1568.39 Q1216.76 1567.85 1213.32 1566.74 L1213.32 1560.69 Q1216.57 1562.38 1219.72 1563.24 Q1222.87 1564.07 1225.96 1564.07 Q1230.1 1564.07 1232.32 1562.66 Q1234.55 1561.23 1234.55 1558.65 Q1234.55 1556.27 1232.93 1554.99 Q1231.34 1553.72 1225.89 1552.54 L1223.86 1552.07 Q1218.42 1550.92 1216 1548.56 Q1213.58 1546.18 1213.58 1542.04 Q1213.58 1537.01 1217.14 1534.27 Q1220.71 1531.54 1227.26 1531.54 Q1230.51 1531.54 1233.37 1532.01 Q1236.24 1532.49 1238.66 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1255.69 1522.27 L1255.69 1532.4 L1267.75 1532.4 L1267.75 1536.95 L1255.69 1536.95 L1255.69 1556.3 Q1255.69 1560.66 1256.86 1561.9 Q1258.07 1563.14 1261.73 1563.14 L1267.75 1563.14 L1267.75 1568.04 L1261.73 1568.04 Q1254.95 1568.04 1252.38 1565.53 Q1249.8 1562.98 1249.8 1556.3 L1249.8 1536.95 L1245.5 1536.95 L1245.5 1532.4 L1249.8 1532.4 L1249.8 1522.27 L1255.69 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1305.94 1548.76 L1305.94 1551.62 L1279.02 1551.62 Q1279.4 1557.67 1282.65 1560.85 Q1285.92 1564 1291.75 1564 Q1295.12 1564 1298.27 1563.17 Q1301.46 1562.35 1304.57 1560.69 L1304.57 1566.23 Q1301.42 1567.57 1298.11 1568.27 Q1294.8 1568.97 1291.4 1568.97 Q1282.87 1568.97 1277.87 1564 Q1272.91 1559.04 1272.91 1550.57 Q1272.91 1541.82 1277.62 1536.69 Q1282.36 1531.54 1290.38 1531.54 Q1297.57 1531.54 1301.74 1536.18 Q1305.94 1540.8 1305.94 1548.76 M1300.09 1547.04 Q1300.02 1542.23 1297.38 1539.37 Q1294.77 1536.5 1290.44 1536.5 Q1285.54 1536.5 1282.58 1539.27 Q1279.65 1542.04 1279.21 1547.07 L1300.09 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1321.22 1562.7 L1321.22 1581.6 L1315.33 1581.6 L1315.33 1532.4 L1321.22 1532.4 L1321.22 1537.81 Q1323.07 1534.62 1325.87 1533.1 Q1328.7 1531.54 1332.62 1531.54 Q1339.11 1531.54 1343.15 1536.69 Q1347.23 1541.85 1347.23 1550.25 Q1347.23 1558.65 1343.15 1563.81 Q1339.11 1568.97 1332.62 1568.97 Q1328.7 1568.97 1325.87 1567.44 Q1323.07 1565.88 1321.22 1562.7 M1341.15 1550.25 Q1341.15 1543.79 1338.47 1540.13 Q1335.83 1536.44 1331.18 1536.44 Q1326.54 1536.44 1323.86 1540.13 Q1321.22 1543.79 1321.22 1550.25 Q1321.22 1556.71 1323.86 1560.4 Q1326.54 1564.07 1331.18 1564.07 Q1335.83 1564.07 1338.47 1560.4 Q1341.15 1556.71 1341.15 1550.25 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1379.66 1533.45 L1379.66 1538.98 Q1377.18 1537.71 1374.5 1537.07 Q1371.83 1536.44 1368.96 1536.44 Q1364.6 1536.44 1362.41 1537.77 Q1360.24 1539.11 1360.24 1541.79 Q1360.24 1543.82 1361.8 1545 Q1363.36 1546.15 1368.07 1547.2 L1370.08 1547.64 Q1376.32 1548.98 1378.93 1551.43 Q1381.57 1553.85 1381.57 1558.21 Q1381.57 1563.17 1377.62 1566.07 Q1373.71 1568.97 1366.83 1568.97 Q1363.97 1568.97 1360.85 1568.39 Q1357.76 1567.85 1354.32 1566.74 L1354.32 1560.69 Q1357.57 1562.38 1360.72 1563.24 Q1363.87 1564.07 1366.96 1564.07 Q1371.1 1564.07 1373.32 1562.66 Q1375.55 1561.23 1375.55 1558.65 Q1375.55 1556.27 1373.93 1554.99 Q1372.34 1553.72 1366.9 1552.54 L1364.86 1552.07 Q1359.42 1550.92 1357 1548.56 Q1354.58 1546.18 1354.58 1542.04 Q1354.58 1537.01 1358.14 1534.27 Q1361.71 1531.54 1368.26 1531.54 Q1371.51 1531.54 1374.37 1532.01 Q1377.24 1532.49 1379.66 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  242.135,1350.71 2352.76,1350.71 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  242.135,1084.25 2352.76,1084.25 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  242.135,817.787 2352.76,817.787 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  242.135,551.326 2352.76,551.326 
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  242.135,284.865 2352.76,284.865 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,1423.18 242.135,47.2441 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,1350.71 261.032,1350.71 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,1084.25 261.032,1084.25 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,817.787 261.032,817.787 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,551.326 261.032,551.326 
  "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  242.135,284.865 261.032,284.865 
  "/>
<path clip-path="url(#clip380)" d="M114.26 1351.16 L143.936 1351.16 L143.936 1355.1 L114.26 1355.1 L114.26 1351.16 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M154.839 1364.05 L162.477 1364.05 L162.477 1337.69 L154.167 1339.36 L154.167 1335.1 L162.431 1333.43 L167.107 1333.43 L167.107 1364.05 L174.746 1364.05 L174.746 1367.99 L154.839 1367.99 L154.839 1364.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M194.19 1336.51 Q190.579 1336.51 188.75 1340.07 Q186.945 1343.61 186.945 1350.74 Q186.945 1357.85 188.75 1361.42 Q190.579 1364.96 194.19 1364.96 Q197.825 1364.96 199.63 1361.42 Q201.459 1357.85 201.459 1350.74 Q201.459 1343.61 199.63 1340.07 Q197.825 1336.51 194.19 1336.51 M194.19 1332.8 Q200 1332.8 203.056 1337.41 Q206.135 1341.99 206.135 1350.74 Q206.135 1359.47 203.056 1364.08 Q200 1368.66 194.19 1368.66 Q188.38 1368.66 185.301 1364.08 Q182.246 1359.47 182.246 1350.74 Q182.246 1341.99 185.301 1337.41 Q188.38 1332.8 194.19 1332.8 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M144.515 1084.7 L174.19 1084.7 L174.19 1088.63 L144.515 1088.63 L144.515 1084.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M194.283 1085.12 Q190.95 1085.12 189.028 1086.9 Q187.13 1088.68 187.13 1091.81 Q187.13 1094.93 189.028 1096.71 Q190.95 1098.5 194.283 1098.5 Q197.616 1098.5 199.537 1096.71 Q201.459 1094.91 201.459 1091.81 Q201.459 1088.68 199.537 1086.9 Q197.639 1085.12 194.283 1085.12 M189.607 1083.13 Q186.598 1082.38 184.908 1080.32 Q183.241 1078.26 183.241 1075.3 Q183.241 1071.16 186.181 1068.75 Q189.144 1066.34 194.283 1066.34 Q199.445 1066.34 202.385 1068.75 Q205.324 1071.16 205.324 1075.3 Q205.324 1078.26 203.635 1080.32 Q201.968 1082.38 198.982 1083.13 Q202.362 1083.91 204.237 1086.2 Q206.135 1088.5 206.135 1091.81 Q206.135 1096.83 203.056 1099.51 Q200 1102.2 194.283 1102.2 Q188.565 1102.2 185.487 1099.51 Q182.431 1096.83 182.431 1091.81 Q182.431 1088.5 184.329 1086.2 Q186.227 1083.91 189.607 1083.13 M187.894 1075.74 Q187.894 1078.43 189.561 1079.93 Q191.25 1081.44 194.283 1081.44 Q197.292 1081.44 198.982 1079.93 Q200.695 1078.43 200.695 1075.74 Q200.695 1073.06 198.982 1071.55 Q197.292 1070.05 194.283 1070.05 Q191.25 1070.05 189.561 1071.55 Q187.894 1073.06 187.894 1075.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M144.26 818.239 L173.936 818.239 L173.936 822.174 L144.26 822.174 L144.26 818.239 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M194.607 815.924 Q191.459 815.924 189.607 818.077 Q187.778 820.229 187.778 823.979 Q187.778 827.706 189.607 829.882 Q191.459 832.035 194.607 832.035 Q197.755 832.035 199.584 829.882 Q201.436 827.706 201.436 823.979 Q201.436 820.229 199.584 818.077 Q197.755 815.924 194.607 815.924 M203.889 801.271 L203.889 805.53 Q202.13 804.697 200.325 804.257 Q198.542 803.817 196.783 803.817 Q192.153 803.817 189.7 806.942 Q187.269 810.067 186.922 816.387 Q188.288 814.373 190.348 813.308 Q192.408 812.22 194.885 812.22 Q200.093 812.22 203.102 815.391 Q206.135 818.54 206.135 823.979 Q206.135 829.303 202.987 832.521 Q199.838 835.738 194.607 835.738 Q188.612 835.738 185.44 831.155 Q182.269 826.549 182.269 817.822 Q182.269 809.628 186.158 804.766 Q190.047 799.882 196.598 799.882 Q198.357 799.882 200.139 800.229 Q201.945 800.577 203.889 801.271 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M143.936 551.778 L173.612 551.778 L173.612 555.713 L143.936 555.713 L143.936 551.778 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M196.551 538.12 L184.746 556.569 L196.551 556.569 L196.551 538.12 M195.325 534.046 L201.204 534.046 L201.204 556.569 L206.135 556.569 L206.135 560.458 L201.204 560.458 L201.204 568.606 L196.551 568.606 L196.551 560.458 L180.95 560.458 L180.95 555.944 L195.325 534.046 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M146.019 285.317 L175.695 285.317 L175.695 289.252 L146.019 289.252 L146.019 285.317 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M189.815 298.21 L206.135 298.21 L206.135 302.145 L184.19 302.145 L184.19 298.21 Q186.852 295.455 191.436 290.826 Q196.042 286.173 197.223 284.83 Q199.468 282.307 200.348 280.571 Q201.25 278.812 201.25 277.122 Q201.25 274.368 199.306 272.631 Q197.385 270.895 194.283 270.895 Q192.084 270.895 189.63 271.659 Q187.2 272.423 184.422 273.974 L184.422 269.252 Q187.246 268.118 189.7 267.539 Q192.153 266.96 194.19 266.96 Q199.561 266.96 202.755 269.645 Q205.949 272.331 205.949 276.821 Q205.949 278.951 205.139 280.872 Q204.352 282.77 202.246 285.363 Q201.667 286.034 198.565 289.252 Q195.463 292.446 189.815 298.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M44.7161 812.969 L47.5806 812.969 L47.5806 839.896 Q53.6281 839.514 56.8109 836.268 Q59.9619 832.989 59.9619 827.165 Q59.9619 823.791 59.1344 820.64 Q58.3069 817.457 56.6518 814.338 L62.1899 814.338 Q63.5267 817.489 64.227 820.799 Q64.9272 824.109 64.9272 827.515 Q64.9272 836.045 59.9619 841.042 Q54.9967 846.007 46.5303 846.007 Q37.7774 846.007 32.6531 841.296 Q27.4968 836.554 27.4968 828.533 Q27.4968 821.34 32.1438 817.17 Q36.7589 812.969 44.7161 812.969 M42.9973 818.826 Q38.1912 818.889 35.3266 821.531 Q32.4621 824.141 32.4621 828.47 Q32.4621 833.371 35.2312 836.331 Q38.0002 839.259 43.0292 839.705 L42.9973 818.826 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M42.4881 773.724 L64.0042 773.724 L64.0042 779.581 L42.679 779.581 Q37.6183 779.581 35.1038 781.554 Q32.5894 783.528 32.5894 787.474 Q32.5894 792.217 35.6131 794.954 Q38.6368 797.691 43.8567 797.691 L64.0042 797.691 L64.0042 803.58 L28.3562 803.58 L28.3562 797.691 L33.8944 797.691 Q30.6797 795.591 29.0883 792.758 Q27.4968 789.893 27.4968 786.169 Q27.4968 780.027 31.3163 776.876 Q35.1038 773.724 42.4881 773.724 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M44.7161 731.552 L47.5806 731.552 L47.5806 758.479 Q53.6281 758.097 56.8109 754.85 Q59.9619 751.572 59.9619 745.747 Q59.9619 742.373 59.1344 739.222 Q58.3069 736.04 56.6518 732.92 L62.1899 732.92 Q63.5267 736.071 64.227 739.382 Q64.9272 742.692 64.9272 746.097 Q64.9272 754.627 59.9619 759.624 Q54.9967 764.59 46.5303 764.59 Q37.7774 764.59 32.6531 759.879 Q27.4968 755.137 27.4968 747.116 Q27.4968 739.923 32.1438 735.753 Q36.7589 731.552 44.7161 731.552 M42.9973 737.408 Q38.1912 737.472 35.3266 740.114 Q32.4621 742.724 32.4621 747.052 Q32.4621 751.954 35.2312 754.914 Q38.0002 757.842 43.0292 758.288 L42.9973 737.408 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M33.8307 701.283 Q33.2578 702.269 33.0032 703.447 Q32.7167 704.593 32.7167 705.993 Q32.7167 710.959 35.9632 713.632 Q39.1779 716.274 45.2253 716.274 L64.0042 716.274 L64.0042 722.162 L28.3562 722.162 L28.3562 716.274 L33.8944 716.274 Q30.6479 714.428 29.0883 711.468 Q27.4968 708.508 27.4968 704.275 Q27.4968 703.67 27.5923 702.938 Q27.656 702.206 27.8151 701.315 L33.8307 701.283 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M45.7664 672.828 Q39.4007 672.828 35.8996 675.47 Q32.3984 678.08 32.3984 682.822 Q32.3984 687.533 35.8996 690.175 Q39.4007 692.785 45.7664 692.785 Q52.1003 692.785 55.6014 690.175 Q59.1026 687.533 59.1026 682.822 Q59.1026 678.08 55.6014 675.47 Q52.1003 672.828 45.7664 672.828 M59.58 666.972 Q68.683 666.972 73.1071 671.014 Q77.5631 675.056 77.5631 683.395 Q77.5631 686.482 77.0857 689.22 Q76.6401 691.957 75.6852 694.535 L69.9879 694.535 Q71.3884 691.957 72.0568 689.443 Q72.7252 686.928 72.7252 684.318 Q72.7252 678.557 69.7015 675.693 Q66.7096 672.828 60.6303 672.828 L57.7339 672.828 Q60.885 674.642 62.4446 677.475 Q64.0042 680.308 64.0042 684.254 Q64.0042 690.811 59.0071 694.822 Q54.01 698.832 45.7664 698.832 Q37.491 698.832 32.4939 694.822 Q27.4968 690.811 27.4968 684.254 Q27.4968 680.308 29.0564 677.475 Q30.616 674.642 33.7671 672.828 L28.3562 672.828 L28.3562 666.972 L59.58 666.972 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip380)" d="M67.3143 640.076 Q73.68 642.559 75.6216 644.914 Q77.5631 647.27 77.5631 651.216 L77.5631 655.895 L72.6615 655.895 L72.6615 652.458 Q72.6615 650.039 71.5157 648.702 Q70.3699 647.365 66.1048 645.742 L63.4312 644.692 L28.3562 659.11 L28.3562 652.903 L56.238 641.763 L28.3562 630.623 L28.3562 624.417 L67.3143 640.076 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip382)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  301.869,86.1857 321.982,173.337 342.095,256.341 362.207,334.198 382.32,406.575 402.432,473.665 422.545,535.988 442.658,594.185 462.77,648.872 482.883,700.554 
  502.996,749.584 523.108,796.167 543.221,840.38 563.334,882.21 583.446,921.591 603.559,958.453 623.672,992.748 643.784,1024.47 663.897,1053.67 684.01,1080.45 
  704.122,1104.93 724.235,1127.27 744.347,1147.63 764.46,1166.2 784.573,1183.12 804.685,1198.55 824.798,1212.62 844.911,1225.46 865.023,1237.18 885.136,1247.88 
  905.249,1257.65 925.361,1266.57 945.474,1274.72 965.587,1282.16 985.699,1288.96 1005.81,1295.16 1025.92,1300.83 1046.04,1306 1066.15,1310.73 1086.26,1315.04 
  1106.38,1318.99 1126.49,1322.59 1146.6,1325.88 1166.71,1328.89 1186.83,1331.64 1206.94,1334.16 1227.05,1336.47 1247.16,1338.58 1267.28,1340.52 1287.39,1342.29 
  1307.5,1343.92 1327.61,1345.42 1347.73,1346.79 1367.84,1348.06 1387.95,1349.22 1408.06,1350.29 1428.18,1351.28 1448.29,1352.19 1468.4,1353.03 1488.52,1353.81 
  1508.63,1354.53 1528.74,1355.19 1548.85,1355.81 1568.97,1356.38 1589.08,1356.91 1609.19,1357.4 1629.3,1357.86 1649.42,1358.29 1669.53,1358.68 1689.64,1359.05 
  1709.75,1359.4 1729.87,1359.72 1749.98,1360.02 1770.09,1360.3 1790.21,1360.57 1810.32,1360.82 1830.43,1361.05 1850.54,1361.27 1870.66,1361.47 1890.77,1361.67 
  1910.88,1361.85 1930.99,1362.03 1951.11,1362.19 1971.22,1362.34 1991.33,1362.49 2011.44,1362.63 2031.56,1362.76 2051.67,1362.89 2071.78,1363.01 2091.89,1363.12 
  2112.01,1363.23 2132.12,1363.34 2152.23,1363.44 2172.35,1363.53 2192.46,1363.62 2212.57,1363.71 2232.68,1363.8 2252.8,1363.88 2272.91,1363.96 2293.02,1364.03 
  
  "/>
<polyline clip-path="url(#clip382)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  301.869,1384.24 321.982,1384.24 342.095,1384.24 362.207,1384.24 382.32,1384.24 402.432,1384.24 422.545,1384.24 442.658,1384.24 462.77,1384.24 482.883,1384.24 
  502.996,1384.24 523.108,1384.24 543.221,1384.24 563.334,1384.24 583.446,1384.24 603.559,1384.24 623.672,1384.24 643.784,1384.24 663.897,1384.24 684.01,1384.24 
  704.122,1384.24 724.235,1384.24 744.347,1384.24 764.46,1384.24 784.573,1384.24 804.685,1384.24 824.798,1384.24 844.911,1384.24 865.023,1384.24 885.136,1384.24 
  905.249,1384.24 925.361,1384.24 945.474,1384.24 965.587,1384.24 985.699,1384.24 1005.81,1384.24 1025.92,1384.24 1046.04,1384.24 1066.15,1384.24 1086.26,1384.24 
  1106.38,1384.24 1126.49,1384.24 1146.6,1384.24 1166.71,1384.24 1186.83,1384.24 1206.94,1384.24 1227.05,1384.24 1247.16,1384.24 1267.28,1384.24 1287.39,1384.24 
  1307.5,1384.24 1327.61,1384.24 1347.73,1384.24 1367.84,1384.24 1387.95,1384.24 1408.06,1384.24 1428.18,1384.24 1448.29,1384.24 1468.4,1384.24 1488.52,1384.24 
  1508.63,1384.24 1528.74,1384.24 1548.85,1384.24 1568.97,1384.24 1589.08,1384.24 1609.19,1384.24 1629.3,1384.24 1649.42,1384.24 1669.53,1384.24 1689.64,1384.24 
  1709.75,1384.24 1729.87,1384.24 1749.98,1384.24 1770.09,1384.24 1790.21,1384.24 1810.32,1384.24 1830.43,1384.24 1850.54,1384.24 1870.66,1384.24 1890.77,1384.24 
  1910.88,1384.24 1930.99,1384.24 1951.11,1384.24 1971.22,1384.24 1991.33,1384.24 2011.44,1384.24 2031.56,1384.24 2051.67,1384.24 2071.78,1384.24 2091.89,1384.24 
  2112.01,1384.24 2132.12,1384.24 2152.23,1384.24 2172.35,1384.24 2192.46,1384.24 2212.57,1384.24 2232.68,1384.24 2252.8,1384.24 2272.91,1384.24 2293.02,1384.24 
  
  "/>
</svg>
<p>Let&#39;s now consider the energy cost function directly over the special unitary group <span>$\mathcal{L}: \text{SU}(2^n) \rightarrow \mathbb{R}$</span></p><p class="math-container">\[\mathcal{L}(U) = \text{Tr}\{HU\rho_0U^\dagger\}.\]</p><p>To minimize the cost function we can follow the Riemannian gradient flow defined through the following differential equation</p><p class="math-container">\[\dot{U} = -\text{grad}\mathcal{L}(U) = [U\rho_0U^\dagger, H]U.\]</p><p>Discretizing the flow we get the following recursive update rule</p><p class="math-container">\[U_{k + 1} = \exp\{\alpha[U_k\rho_0U^\dagger_k, H]\}U_k = \exp\{\alpha[\rho_k, H]\}U_k,\]</p><p>where <span>$\alpha$</span> is the appropriate learning rate and <span>$U_0 = I$</span>.</p><p>We can expand the commutator in the exponent in the basis of Pauli strings <span>$P^j$</span></p><p class="math-container">\[[\rho_k, H] = \frac{1}{2^n}\sum_{j = 1}^{4^n - 1}\omega^j_kP^j,\]</p><p>where</p><p class="math-container">\[\omega^j_k = \text{Tr}\{[\rho_k, H]P^j\} = \text{Tr}\{[H, P^j]\rho_k\} = \langle[H, P^j]\rangle_{\rho_k}.\]</p><p>It turns out that <span>$\omega^j_k$</span> can easily be evaluated with the help of a parameter shift rule</p><p class="math-container">\[\omega^j_k = \langle[H, P^j]\rangle_{\rho_k} = -i\langle V^\dagger_j(\pi/4)HV_j(\pi/4) - V^\dagger_j(-\pi/4)HV_j(-\pi/4)\rangle_{\rho_k},\]</p><p>where <span>$V_j(t) = \exp\{-itP^j\}$</span>.</p><p>Next, we write a function for generation of 2-local Pauli operators. We will restrict the Riemannian gradient to this subspace of the Lie algebra since otherwise the number of parameters to calculate would be <span>$4^8 - 1 = 65535$</span> which is too much for a reasonable runtime of the algorithm.</p><pre><code class="language-julia hljs">function generate_2local_pauli_strings(n)
    pauli_strings = []
    for i = 1:n
        push!(pauli_strings, kron(n, i =&gt; X))
        push!(pauli_strings, kron(n, i =&gt; Y))
        push!(pauli_strings, kron(n, i =&gt; Z))
    end
    for i = 1:n-1
        for j = i+1:n
            for P1 in [X, Y, Z]
                for P2 in [X, Y, Z]
                    push!(pauli_strings, kron(n, i =&gt; P1, j =&gt; P2))
                end
            end
        end
    end
    pauli_strings
end;</code></pre><p>Next we write functions for calculating the expansion coefficients and a single optimization step. We will absorb the factor of <span>$1/2^n$</span> into the learning rate.</p><pre><code class="language-julia hljs">function calculate_omegas(n, reg, h, pauli_strings)
    iω = []
    for P in pauli_strings
        push!(iω, real(expect(h, reg =&gt; time_evolve(P, π/4)) - expect(h, reg =&gt; time_evolve(P, -π/4))))
    end
    iω
end;

function step_and_cost!(n, circuit, h, α, pauli_strings)
    iω = calculate_omegas(n, zero_state(n) |&gt; circuit, h, pauli_strings)

    for (iωʲ, P) in zip(iω, pauli_strings)
        if abs(iωʲ) &gt; 1e-6 # we will only keep the ones that actually contribute
            append!(circuit, chain(n, time_evolve(P, -α * iωʲ)))
        end
    end

    real(expect(h, zero_state(n) =&gt; circuit))
end;</code></pre><p>Finally, let&#39;s try it out. We initialize the state <span>$|0\rangle$</span> and apply several optimization steps.</p><pre><code class="language-julia hljs">circuit = chain(n)
pauli_strings = generate_2local_pauli_strings(n)
history = Float64[]

for i=1:100
    cost = step_and_cost!(n, circuit, h, 0.01, pauli_strings)
    push!(history, cost)
end

plot(history, legend=false)
plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip410">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip410)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip411">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip410)" d="
M212.135 1423.18 L2352.76 1423.18 L2352.76 47.2441 L212.135 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip412">
    <rect x="212" y="47" width="2142" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  252.32,1423.18 252.32,47.2441 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  762.283,1423.18 762.283,47.2441 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1272.25,1423.18 1272.25,47.2441 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1782.21,1423.18 1782.21,47.2441 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2292.17,1423.18 2292.17,47.2441 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  252.32,1423.18 252.32,1404.28 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  762.283,1423.18 762.283,1404.28 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1272.25,1423.18 1272.25,1404.28 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1782.21,1423.18 1782.21,1404.28 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2292.17,1423.18 2292.17,1404.28 
  "/>
<path clip-path="url(#clip410)" d="M252.32 1454.1 Q248.709 1454.1 246.88 1457.66 Q245.075 1461.2 245.075 1468.33 Q245.075 1475.44 246.88 1479.01 Q248.709 1482.55 252.32 1482.55 Q255.954 1482.55 257.76 1479.01 Q259.588 1475.44 259.588 1468.33 Q259.588 1461.2 257.76 1457.66 Q255.954 1454.1 252.32 1454.1 M252.32 1450.39 Q258.13 1450.39 261.186 1455 Q264.264 1459.58 264.264 1468.33 Q264.264 1477.06 261.186 1481.67 Q258.13 1486.25 252.32 1486.25 Q246.51 1486.25 243.431 1481.67 Q240.376 1477.06 240.376 1468.33 Q240.376 1459.58 243.431 1455 Q246.51 1450.39 252.32 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M741.554 1481.64 L757.873 1481.64 L757.873 1485.58 L735.929 1485.58 L735.929 1481.64 Q738.591 1478.89 743.174 1474.26 Q747.781 1469.61 748.961 1468.27 Q751.207 1465.74 752.086 1464.01 Q752.989 1462.25 752.989 1460.56 Q752.989 1457.8 751.045 1456.07 Q749.123 1454.33 746.022 1454.33 Q743.822 1454.33 741.369 1455.09 Q738.938 1455.86 736.16 1457.41 L736.16 1452.69 Q738.985 1451.55 741.438 1450.97 Q743.892 1450.39 745.929 1450.39 Q751.299 1450.39 754.494 1453.08 Q757.688 1455.77 757.688 1460.26 Q757.688 1462.39 756.878 1464.31 Q756.091 1466.2 753.984 1468.8 Q753.406 1469.47 750.304 1472.69 Q747.202 1475.88 741.554 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M767.734 1451.02 L786.091 1451.02 L786.091 1454.96 L772.017 1454.96 L772.017 1463.43 Q773.035 1463.08 774.054 1462.92 Q775.072 1462.73 776.091 1462.73 Q781.878 1462.73 785.257 1465.9 Q788.637 1469.08 788.637 1474.49 Q788.637 1480.07 785.165 1483.17 Q781.693 1486.25 775.373 1486.25 Q773.197 1486.25 770.929 1485.88 Q768.683 1485.51 766.276 1484.77 L766.276 1480.07 Q768.359 1481.2 770.582 1481.76 Q772.804 1482.32 775.281 1482.32 Q779.285 1482.32 781.623 1480.21 Q783.961 1478.1 783.961 1474.49 Q783.961 1470.88 781.623 1468.77 Q779.285 1466.67 775.281 1466.67 Q773.406 1466.67 771.531 1467.08 Q769.679 1467.5 767.734 1468.38 L767.734 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1246.95 1451.02 L1265.3 1451.02 L1265.3 1454.96 L1251.23 1454.96 L1251.23 1463.43 Q1252.25 1463.08 1253.26 1462.92 Q1254.28 1462.73 1255.3 1462.73 Q1261.09 1462.73 1264.47 1465.9 Q1267.85 1469.08 1267.85 1474.49 Q1267.85 1480.07 1264.38 1483.17 Q1260.9 1486.25 1254.58 1486.25 Q1252.41 1486.25 1250.14 1485.88 Q1247.89 1485.51 1245.49 1484.77 L1245.49 1480.07 Q1247.57 1481.2 1249.79 1481.76 Q1252.01 1482.32 1254.49 1482.32 Q1258.5 1482.32 1260.83 1480.21 Q1263.17 1478.1 1263.17 1474.49 Q1263.17 1470.88 1260.83 1468.77 Q1258.5 1466.67 1254.49 1466.67 Q1252.62 1466.67 1250.74 1467.08 Q1248.89 1467.5 1246.95 1468.38 L1246.95 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1287.06 1454.1 Q1283.45 1454.1 1281.62 1457.66 Q1279.82 1461.2 1279.82 1468.33 Q1279.82 1475.44 1281.62 1479.01 Q1283.45 1482.55 1287.06 1482.55 Q1290.7 1482.55 1292.5 1479.01 Q1294.33 1475.44 1294.33 1468.33 Q1294.33 1461.2 1292.5 1457.66 Q1290.7 1454.1 1287.06 1454.1 M1287.06 1450.39 Q1292.87 1450.39 1295.93 1455 Q1299.01 1459.58 1299.01 1468.33 Q1299.01 1477.06 1295.93 1481.67 Q1292.87 1486.25 1287.06 1486.25 Q1281.25 1486.25 1278.17 1481.67 Q1275.12 1477.06 1275.12 1468.33 Q1275.12 1459.58 1278.17 1455 Q1281.25 1450.39 1287.06 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1756.06 1451.02 L1778.29 1451.02 L1778.29 1453.01 L1765.74 1485.58 L1760.86 1485.58 L1772.66 1454.96 L1756.06 1454.96 L1756.06 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1787.45 1451.02 L1805.81 1451.02 L1805.81 1454.96 L1791.73 1454.96 L1791.73 1463.43 Q1792.75 1463.08 1793.77 1462.92 Q1794.79 1462.73 1795.81 1462.73 Q1801.6 1462.73 1804.98 1465.9 Q1808.35 1469.08 1808.35 1474.49 Q1808.35 1480.07 1804.88 1483.17 Q1801.41 1486.25 1795.09 1486.25 Q1792.92 1486.25 1790.65 1485.88 Q1788.4 1485.51 1785.99 1484.77 L1785.99 1480.07 Q1788.08 1481.2 1790.3 1481.76 Q1792.52 1482.32 1795 1482.32 Q1799 1482.32 1801.34 1480.21 Q1803.68 1478.1 1803.68 1474.49 Q1803.68 1470.88 1801.34 1468.77 Q1799 1466.67 1795 1466.67 Q1793.12 1466.67 1791.25 1467.08 Q1789.4 1467.5 1787.45 1468.38 L1787.45 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2251.78 1481.64 L2259.42 1481.64 L2259.42 1455.28 L2251.11 1456.95 L2251.11 1452.69 L2259.37 1451.02 L2264.05 1451.02 L2264.05 1481.64 L2271.69 1481.64 L2271.69 1485.58 L2251.78 1485.58 L2251.78 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2291.13 1454.1 Q2287.52 1454.1 2285.69 1457.66 Q2283.89 1461.2 2283.89 1468.33 Q2283.89 1475.44 2285.69 1479.01 Q2287.52 1482.55 2291.13 1482.55 Q2294.76 1482.55 2296.57 1479.01 Q2298.4 1475.44 2298.4 1468.33 Q2298.4 1461.2 2296.57 1457.66 Q2294.76 1454.1 2291.13 1454.1 M2291.13 1450.39 Q2296.94 1450.39 2300 1455 Q2303.08 1459.58 2303.08 1468.33 Q2303.08 1477.06 2300 1481.67 Q2296.94 1486.25 2291.13 1486.25 Q2285.32 1486.25 2282.24 1481.67 Q2279.19 1477.06 2279.19 1468.33 Q2279.19 1459.58 2282.24 1455 Q2285.32 1450.39 2291.13 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2321.29 1454.1 Q2317.68 1454.1 2315.85 1457.66 Q2314.05 1461.2 2314.05 1468.33 Q2314.05 1475.44 2315.85 1479.01 Q2317.68 1482.55 2321.29 1482.55 Q2324.93 1482.55 2326.73 1479.01 Q2328.56 1475.44 2328.56 1468.33 Q2328.56 1461.2 2326.73 1457.66 Q2324.93 1454.1 2321.29 1454.1 M2321.29 1450.39 Q2327.1 1450.39 2330.16 1455 Q2333.24 1459.58 2333.24 1468.33 Q2333.24 1477.06 2330.16 1481.67 Q2327.1 1486.25 2321.29 1486.25 Q2315.48 1486.25 2312.4 1481.67 Q2309.35 1477.06 2309.35 1468.33 Q2309.35 1459.58 2312.4 1455 Q2315.48 1450.39 2321.29 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1223.66 1533.45 L1223.66 1538.98 Q1221.18 1537.71 1218.5 1537.07 Q1215.83 1536.44 1212.96 1536.44 Q1208.6 1536.44 1206.41 1537.77 Q1204.24 1539.11 1204.24 1541.79 Q1204.24 1543.82 1205.8 1545 Q1207.36 1546.15 1212.07 1547.2 L1214.08 1547.64 Q1220.32 1548.98 1222.93 1551.43 Q1225.57 1553.85 1225.57 1558.21 Q1225.57 1563.17 1221.62 1566.07 Q1217.71 1568.97 1210.83 1568.97 Q1207.97 1568.97 1204.85 1568.39 Q1201.76 1567.85 1198.32 1566.74 L1198.32 1560.69 Q1201.57 1562.38 1204.72 1563.24 Q1207.87 1564.07 1210.96 1564.07 Q1215.1 1564.07 1217.32 1562.66 Q1219.55 1561.23 1219.55 1558.65 Q1219.55 1556.27 1217.93 1554.99 Q1216.34 1553.72 1210.89 1552.54 L1208.86 1552.07 Q1203.42 1550.92 1201 1548.56 Q1198.58 1546.18 1198.58 1542.04 Q1198.58 1537.01 1202.14 1534.27 Q1205.71 1531.54 1212.26 1531.54 Q1215.51 1531.54 1218.37 1532.01 Q1221.24 1532.49 1223.66 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1240.69 1522.27 L1240.69 1532.4 L1252.75 1532.4 L1252.75 1536.95 L1240.69 1536.95 L1240.69 1556.3 Q1240.69 1560.66 1241.86 1561.9 Q1243.07 1563.14 1246.73 1563.14 L1252.75 1563.14 L1252.75 1568.04 L1246.73 1568.04 Q1239.95 1568.04 1237.38 1565.53 Q1234.8 1562.98 1234.8 1556.3 L1234.8 1536.95 L1230.5 1536.95 L1230.5 1532.4 L1234.8 1532.4 L1234.8 1522.27 L1240.69 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1290.94 1548.76 L1290.94 1551.62 L1264.02 1551.62 Q1264.4 1557.67 1267.65 1560.85 Q1270.92 1564 1276.75 1564 Q1280.12 1564 1283.27 1563.17 Q1286.46 1562.35 1289.57 1560.69 L1289.57 1566.23 Q1286.42 1567.57 1283.11 1568.27 Q1279.8 1568.97 1276.4 1568.97 Q1267.87 1568.97 1262.87 1564 Q1257.91 1559.04 1257.91 1550.57 Q1257.91 1541.82 1262.62 1536.69 Q1267.36 1531.54 1275.38 1531.54 Q1282.57 1531.54 1286.74 1536.18 Q1290.94 1540.8 1290.94 1548.76 M1285.09 1547.04 Q1285.02 1542.23 1282.38 1539.37 Q1279.77 1536.5 1275.44 1536.5 Q1270.54 1536.5 1267.58 1539.27 Q1264.65 1542.04 1264.21 1547.07 L1285.09 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1306.22 1562.7 L1306.22 1581.6 L1300.33 1581.6 L1300.33 1532.4 L1306.22 1532.4 L1306.22 1537.81 Q1308.07 1534.62 1310.87 1533.1 Q1313.7 1531.54 1317.62 1531.54 Q1324.11 1531.54 1328.15 1536.69 Q1332.23 1541.85 1332.23 1550.25 Q1332.23 1558.65 1328.15 1563.81 Q1324.11 1568.97 1317.62 1568.97 Q1313.7 1568.97 1310.87 1567.44 Q1308.07 1565.88 1306.22 1562.7 M1326.15 1550.25 Q1326.15 1543.79 1323.47 1540.13 Q1320.83 1536.44 1316.18 1536.44 Q1311.54 1536.44 1308.86 1540.13 Q1306.22 1543.79 1306.22 1550.25 Q1306.22 1556.71 1308.86 1560.4 Q1311.54 1564.07 1316.18 1564.07 Q1320.83 1564.07 1323.47 1560.4 Q1326.15 1556.71 1326.15 1550.25 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1364.66 1533.45 L1364.66 1538.98 Q1362.18 1537.71 1359.5 1537.07 Q1356.83 1536.44 1353.96 1536.44 Q1349.6 1536.44 1347.41 1537.77 Q1345.24 1539.11 1345.24 1541.79 Q1345.24 1543.82 1346.8 1545 Q1348.36 1546.15 1353.07 1547.2 L1355.08 1547.64 Q1361.32 1548.98 1363.93 1551.43 Q1366.57 1553.85 1366.57 1558.21 Q1366.57 1563.17 1362.62 1566.07 Q1358.71 1568.97 1351.83 1568.97 Q1348.97 1568.97 1345.85 1568.39 Q1342.76 1567.85 1339.32 1566.74 L1339.32 1560.69 Q1342.57 1562.38 1345.72 1563.24 Q1348.87 1564.07 1351.96 1564.07 Q1356.1 1564.07 1358.32 1562.66 Q1360.55 1561.23 1360.55 1558.65 Q1360.55 1556.27 1358.93 1554.99 Q1357.34 1553.72 1351.9 1552.54 L1349.86 1552.07 Q1344.42 1550.92 1342 1548.56 Q1339.58 1546.18 1339.58 1542.04 Q1339.58 1537.01 1343.14 1534.27 Q1346.71 1531.54 1353.26 1531.54 Q1356.51 1531.54 1359.37 1532.01 Q1362.24 1532.49 1364.66 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  212.135,1276.02 2352.76,1276.02 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  212.135,1016.65 2352.76,1016.65 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  212.135,757.272 2352.76,757.272 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  212.135,497.897 2352.76,497.897 
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  212.135,238.522 2352.76,238.522 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,1423.18 212.135,47.2441 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,1276.02 231.032,1276.02 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,1016.65 231.032,1016.65 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,757.272 231.032,757.272 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,497.897 231.032,497.897 
  "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  212.135,238.522 231.032,238.522 
  "/>
<path clip-path="url(#clip410)" d="M114.607 1276.47 L144.283 1276.47 L144.283 1280.41 L114.607 1280.41 L114.607 1276.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M154.515 1292.58 L154.515 1288.32 Q156.274 1289.16 158.079 1289.6 Q159.885 1290.04 161.621 1290.04 Q166.251 1290.04 168.681 1286.94 Q171.135 1283.81 171.482 1277.47 Q170.139 1279.46 168.079 1280.52 Q166.019 1281.59 163.519 1281.59 Q158.334 1281.59 155.302 1278.46 Q152.292 1275.32 152.292 1269.88 Q152.292 1264.55 155.44 1261.33 Q158.589 1258.12 163.82 1258.12 Q169.815 1258.12 172.964 1262.72 Q176.135 1267.31 176.135 1276.06 Q176.135 1284.23 172.246 1289.11 Q168.38 1293.97 161.829 1293.97 Q160.07 1293.97 158.265 1293.63 Q156.459 1293.28 154.515 1292.58 M163.82 1277.93 Q166.968 1277.93 168.797 1275.78 Q170.649 1273.63 170.649 1269.88 Q170.649 1266.15 168.797 1264 Q166.968 1261.82 163.82 1261.82 Q160.672 1261.82 158.82 1264 Q156.991 1266.15 156.991 1269.88 Q156.991 1273.63 158.82 1275.78 Q160.672 1277.93 163.82 1277.93 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M114.26 1017.1 L143.936 1017.1 L143.936 1021.03 L114.26 1021.03 L114.26 1017.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M164.607 1014.78 Q161.459 1014.78 159.607 1016.94 Q157.778 1019.09 157.778 1022.84 Q157.778 1026.57 159.607 1028.74 Q161.459 1030.89 164.607 1030.89 Q167.755 1030.89 169.584 1028.74 Q171.436 1026.57 171.436 1022.84 Q171.436 1019.09 169.584 1016.94 Q167.755 1014.78 164.607 1014.78 M173.889 1000.13 L173.889 1004.39 Q172.13 1003.56 170.325 1003.12 Q168.542 1002.68 166.783 1002.68 Q162.153 1002.68 159.7 1005.8 Q157.269 1008.93 156.922 1015.25 Q158.288 1013.23 160.348 1012.17 Q162.408 1011.08 164.885 1011.08 Q170.093 1011.08 173.102 1014.25 Q176.135 1017.4 176.135 1022.84 Q176.135 1028.16 172.987 1031.38 Q169.839 1034.6 164.607 1034.6 Q158.612 1034.6 155.44 1030.01 Q152.269 1025.41 152.269 1016.68 Q152.269 1008.49 156.158 1003.63 Q160.047 998.742 166.598 998.742 Q168.357 998.742 170.139 999.089 Q171.945 999.436 173.889 1000.13 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M115.07 757.723 L144.746 757.723 L144.746 761.658 L115.07 761.658 L115.07 757.723 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M169.005 755.918 Q172.362 756.635 174.237 758.904 Q176.135 761.172 176.135 764.506 Q176.135 769.621 172.616 772.422 Q169.098 775.223 162.616 775.223 Q160.44 775.223 158.126 774.783 Q155.834 774.367 153.38 773.51 L153.38 768.996 Q155.325 770.131 157.64 770.709 Q159.954 771.288 162.477 771.288 Q166.876 771.288 169.167 769.552 Q171.482 767.816 171.482 764.506 Q171.482 761.45 169.329 759.737 Q167.2 758.001 163.38 758.001 L159.353 758.001 L159.353 754.159 L163.565 754.159 Q167.015 754.159 168.843 752.793 Q170.672 751.404 170.672 748.811 Q170.672 746.149 168.774 744.737 Q166.899 743.302 163.38 743.302 Q161.459 743.302 159.26 743.719 Q157.061 744.135 154.422 745.015 L154.422 740.848 Q157.084 740.108 159.399 739.737 Q161.737 739.367 163.797 739.367 Q169.121 739.367 172.223 741.797 Q175.325 744.205 175.325 748.325 Q175.325 751.196 173.681 753.186 Q172.038 755.154 169.005 755.918 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M164.19 483.696 Q160.579 483.696 158.751 487.261 Q156.945 490.802 156.945 497.932 Q156.945 505.038 158.751 508.603 Q160.579 512.145 164.19 512.145 Q167.825 512.145 169.63 508.603 Q171.459 505.038 171.459 497.932 Q171.459 490.802 169.63 487.261 Q167.825 483.696 164.19 483.696 M164.19 479.992 Q170.001 479.992 173.056 484.598 Q176.135 489.182 176.135 497.932 Q176.135 506.659 173.056 511.265 Q170.001 515.848 164.19 515.848 Q158.38 515.848 155.302 511.265 Q152.246 506.659 152.246 497.932 Q152.246 489.182 155.302 484.598 Q158.38 479.992 164.19 479.992 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M169.005 237.168 Q172.362 237.886 174.237 240.154 Q176.135 242.423 176.135 245.756 Q176.135 250.872 172.616 253.673 Q169.098 256.473 162.616 256.473 Q160.44 256.473 158.126 256.034 Q155.834 255.617 153.38 254.76 L153.38 250.247 Q155.325 251.381 157.64 251.96 Q159.954 252.538 162.477 252.538 Q166.876 252.538 169.167 250.802 Q171.482 249.066 171.482 245.756 Q171.482 242.7 169.329 240.987 Q167.2 239.251 163.38 239.251 L159.353 239.251 L159.353 235.409 L163.565 235.409 Q167.015 235.409 168.843 234.043 Q170.672 232.654 170.672 230.062 Q170.672 227.4 168.774 225.987 Q166.899 224.552 163.38 224.552 Q161.459 224.552 159.26 224.969 Q157.061 225.386 154.422 226.265 L154.422 222.099 Q157.084 221.358 159.399 220.988 Q161.737 220.617 163.797 220.617 Q169.121 220.617 172.223 223.048 Q175.325 225.455 175.325 229.575 Q175.325 232.446 173.681 234.437 Q172.038 236.404 169.005 237.168 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M44.7161 812.969 L47.5806 812.969 L47.5806 839.896 Q53.6281 839.514 56.8109 836.268 Q59.9619 832.989 59.9619 827.165 Q59.9619 823.791 59.1344 820.64 Q58.3069 817.457 56.6518 814.338 L62.1899 814.338 Q63.5267 817.489 64.227 820.799 Q64.9272 824.109 64.9272 827.515 Q64.9272 836.045 59.9619 841.042 Q54.9967 846.007 46.5303 846.007 Q37.7774 846.007 32.6531 841.296 Q27.4968 836.554 27.4968 828.533 Q27.4968 821.34 32.1438 817.17 Q36.7589 812.969 44.7161 812.969 M42.9973 818.826 Q38.1912 818.889 35.3266 821.531 Q32.4621 824.141 32.4621 828.47 Q32.4621 833.371 35.2312 836.331 Q38.0002 839.259 43.0292 839.705 L42.9973 818.826 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M42.4881 773.724 L64.0042 773.724 L64.0042 779.581 L42.679 779.581 Q37.6183 779.581 35.1038 781.554 Q32.5894 783.528 32.5894 787.474 Q32.5894 792.217 35.6131 794.954 Q38.6368 797.691 43.8567 797.691 L64.0042 797.691 L64.0042 803.58 L28.3562 803.58 L28.3562 797.691 L33.8944 797.691 Q30.6797 795.591 29.0883 792.758 Q27.4968 789.893 27.4968 786.169 Q27.4968 780.027 31.3163 776.876 Q35.1038 773.724 42.4881 773.724 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M44.7161 731.552 L47.5806 731.552 L47.5806 758.479 Q53.6281 758.097 56.8109 754.85 Q59.9619 751.572 59.9619 745.747 Q59.9619 742.373 59.1344 739.222 Q58.3069 736.04 56.6518 732.92 L62.1899 732.92 Q63.5267 736.071 64.227 739.382 Q64.9272 742.692 64.9272 746.097 Q64.9272 754.627 59.9619 759.624 Q54.9967 764.59 46.5303 764.59 Q37.7774 764.59 32.6531 759.879 Q27.4968 755.137 27.4968 747.116 Q27.4968 739.923 32.1438 735.753 Q36.7589 731.552 44.7161 731.552 M42.9973 737.408 Q38.1912 737.472 35.3266 740.114 Q32.4621 742.724 32.4621 747.052 Q32.4621 751.954 35.2312 754.914 Q38.0002 757.842 43.0292 758.288 L42.9973 737.408 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M33.8307 701.283 Q33.2578 702.269 33.0032 703.447 Q32.7167 704.593 32.7167 705.993 Q32.7167 710.959 35.9632 713.632 Q39.1779 716.274 45.2253 716.274 L64.0042 716.274 L64.0042 722.162 L28.3562 722.162 L28.3562 716.274 L33.8944 716.274 Q30.6479 714.428 29.0883 711.468 Q27.4968 708.508 27.4968 704.275 Q27.4968 703.67 27.5923 702.938 Q27.656 702.206 27.8151 701.315 L33.8307 701.283 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M45.7664 672.828 Q39.4007 672.828 35.8996 675.47 Q32.3984 678.08 32.3984 682.822 Q32.3984 687.533 35.8996 690.175 Q39.4007 692.785 45.7664 692.785 Q52.1003 692.785 55.6014 690.175 Q59.1026 687.533 59.1026 682.822 Q59.1026 678.08 55.6014 675.47 Q52.1003 672.828 45.7664 672.828 M59.58 666.972 Q68.683 666.972 73.1071 671.014 Q77.5631 675.056 77.5631 683.395 Q77.5631 686.482 77.0857 689.22 Q76.6401 691.957 75.6852 694.535 L69.9879 694.535 Q71.3884 691.957 72.0568 689.443 Q72.7252 686.928 72.7252 684.318 Q72.7252 678.557 69.7015 675.693 Q66.7096 672.828 60.6303 672.828 L57.7339 672.828 Q60.885 674.642 62.4446 677.475 Q64.0042 680.308 64.0042 684.254 Q64.0042 690.811 59.0071 694.822 Q54.01 698.832 45.7664 698.832 Q37.491 698.832 32.4939 694.822 Q27.4968 690.811 27.4968 684.254 Q27.4968 680.308 29.0564 677.475 Q30.616 674.642 33.7671 672.828 L28.3562 672.828 L28.3562 666.972 L59.58 666.972 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip410)" d="M67.3143 640.076 Q73.68 642.559 75.6216 644.914 Q77.5631 647.27 77.5631 651.216 L77.5631 655.895 L72.6615 655.895 L72.6615 652.458 Q72.6615 650.039 71.5157 648.702 Q70.3699 647.365 66.1048 645.742 L63.4312 644.692 L28.3562 659.11 L28.3562 652.903 L56.238 641.763 L28.3562 630.623 L28.3562 624.417 L67.3143 640.076 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip412)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  272.718,86.1857 293.117,637.745 313.515,1111.08 333.914,1222.21 354.313,1251.4 374.711,1271.19 395.11,1286.03 415.508,1297.36 435.907,1306.17 456.305,1313.17 
  476.704,1318.82 497.102,1323.46 517.501,1327.31 537.899,1330.53 558.298,1333.25 578.696,1335.56 599.095,1337.53 619.493,1339.21 639.892,1340.64 660.29,1341.88 
  680.689,1342.95 701.087,1343.87 721.486,1344.67 741.884,1345.37 762.283,1345.99 782.682,1346.53 803.08,1347.01 823.479,1347.43 843.877,1347.81 864.276,1348.16 
  884.674,1348.47 905.073,1348.75 925.471,1349 945.87,1349.24 966.268,1349.45 986.667,1349.65 1007.07,1349.83 1027.46,1350.01 1047.86,1350.17 1068.26,1350.32 
  1088.66,1350.46 1109.06,1350.6 1129.46,1350.73 1149.85,1350.85 1170.25,1350.96 1190.65,1351.08 1211.05,1351.19 1231.45,1351.29 1251.85,1351.39 1272.25,1351.49 
  1292.64,1351.58 1313.04,1351.68 1333.44,1351.77 1353.84,1351.85 1374.24,1351.94 1394.64,1352.02 1415.04,1352.11 1435.43,1352.19 1455.83,1352.27 1476.23,1352.35 
  1496.63,1352.42 1517.03,1352.5 1537.43,1352.58 1557.83,1352.65 1578.22,1352.72 1598.62,1352.8 1619.02,1352.87 1639.42,1352.94 1659.82,1353.01 1680.22,1353.08 
  1700.62,1353.15 1721.01,1353.22 1741.41,1353.29 1761.81,1353.35 1782.21,1353.42 1802.61,1353.49 1823.01,1353.55 1843.4,1353.62 1863.8,1353.68 1884.2,1353.75 
  1904.6,1353.81 1925,1353.87 1945.4,1353.94 1965.8,1354 1986.19,1354.06 2006.59,1354.12 2026.99,1354.18 2047.39,1354.24 2067.79,1354.3 2088.19,1354.36 
  2108.59,1354.42 2128.98,1354.48 2149.38,1354.54 2169.78,1354.6 2190.18,1354.66 2210.58,1354.71 2230.98,1354.77 2251.38,1354.83 2271.77,1354.88 2292.17,1354.94 
  
  "/>
<polyline clip-path="url(#clip412)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  272.718,1384.24 293.117,1384.24 313.515,1384.24 333.914,1384.24 354.313,1384.24 374.711,1384.24 395.11,1384.24 415.508,1384.24 435.907,1384.24 456.305,1384.24 
  476.704,1384.24 497.102,1384.24 517.501,1384.24 537.899,1384.24 558.298,1384.24 578.696,1384.24 599.095,1384.24 619.493,1384.24 639.892,1384.24 660.29,1384.24 
  680.689,1384.24 701.087,1384.24 721.486,1384.24 741.884,1384.24 762.283,1384.24 782.682,1384.24 803.08,1384.24 823.479,1384.24 843.877,1384.24 864.276,1384.24 
  884.674,1384.24 905.073,1384.24 925.471,1384.24 945.87,1384.24 966.268,1384.24 986.667,1384.24 1007.07,1384.24 1027.46,1384.24 1047.86,1384.24 1068.26,1384.24 
  1088.66,1384.24 1109.06,1384.24 1129.46,1384.24 1149.85,1384.24 1170.25,1384.24 1190.65,1384.24 1211.05,1384.24 1231.45,1384.24 1251.85,1384.24 1272.25,1384.24 
  1292.64,1384.24 1313.04,1384.24 1333.44,1384.24 1353.84,1384.24 1374.24,1384.24 1394.64,1384.24 1415.04,1384.24 1435.43,1384.24 1455.83,1384.24 1476.23,1384.24 
  1496.63,1384.24 1517.03,1384.24 1537.43,1384.24 1557.83,1384.24 1578.22,1384.24 1598.62,1384.24 1619.02,1384.24 1639.42,1384.24 1659.82,1384.24 1680.22,1384.24 
  1700.62,1384.24 1721.01,1384.24 1741.41,1384.24 1761.81,1384.24 1782.21,1384.24 1802.61,1384.24 1823.01,1384.24 1843.4,1384.24 1863.8,1384.24 1884.2,1384.24 
  1904.6,1384.24 1925,1384.24 1945.4,1384.24 1965.8,1384.24 1986.19,1384.24 2006.59,1384.24 2026.99,1384.24 2047.39,1384.24 2067.79,1384.24 2088.19,1384.24 
  2108.59,1384.24 2128.98,1384.24 2149.38,1384.24 2169.78,1384.24 2190.18,1384.24 2210.58,1384.24 2230.98,1384.24 2251.38,1384.24 2271.77,1384.24 2292.17,1384.24 
  
  "/>
</svg>
<p>When we compare the final states achieved with the Riemannian gradient flow optimizer and with the standard VQE we can notice that the former has lower quality. This is because the Riemannian gradient flow optimizer has only a local view of the cost landscape while VQE can access these directions since the ansatz we used is universal. However, if we were able to calculate all of the <span>$4^n - 1$</span> projections, Riemannian gradient flow optimizer would be guaranteed to converge given the appropriate learning rate!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../7.variation-quantum-eigen-solver/index.html">« Variational Quantum Eigen Solver</a><a class="docs-footer-nextpage" href="../../../performancetips.html">Performance Tips »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.20 on <span class="colophon-date" title="Tuesday 12 July 2022 17:55">Tuesday 12 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0669976+0.00842102im    0.200337+0.0876898im      0.10106+0.177526im     -0.0417805-0.11749im      -0.0524284-0.043321im      0.0544772+0.180596im     -0.0967515+0.115359im     0.0274084+0.0734077im     0.161523+0.17863im     -0.00862981-0.12534im       -0.0855319+0.100464im       -0.111937+0.189867im       0.0363876+0.110352im      -0.161004+0.0482763im     0.0814454+0.169555im    -0.0899119+0.213801im      0.0121704+0.259387im      0.216599+0.00586732im   -0.000960298+0.16277im      -0.0591377-0.0496336im      0.18373+0.10133im      -0.0823504+0.162329im      -0.156219-0.0831253im      0.105927-0.114919im      -0.182442-0.0232632im   -0.0225109+0.212351im        -0.151824+0.232096im      0.074524+0.189313im      0.0615858-0.09812im        0.120269-0.0350701im    0.00276866-0.118197im       -0.17212+0.0207239im
   0.0967442-0.00654229im  -0.0228217-0.0345136im     0.241375-0.344394im      -0.154368-0.0139048im    -0.0802214-0.0809066im     0.0888053+0.187888im     -0.0918257-0.150453im    0.00607493-0.0414872im    -0.246237+0.0395655im      0.090183-0.153259im        0.133891+0.259356im      -0.0249732+0.0204488im     -0.0512654+0.0526958im      0.101589-0.102928im      0.0756337+0.108242im     0.0714295-0.00882901im    0.0275821-0.139662im    -0.0635963-0.109291im        -0.123664-0.0106805im     -0.163009-0.0114394im    0.0222087+0.094826im     -0.0864386+0.135375im      0.0388956+0.19028im        0.130024+0.208206im       0.115173-0.0764153im   0.00911468+0.0463229im      -0.0522644+0.115977im     -0.132558+0.0507364im      0.304025-0.0871291im     -0.169243-0.0345981im     -0.196069+0.156061im     -0.0428168-0.0789234im
   -0.113411+0.0249572im     -0.18288-0.153371im      -0.19193-0.0631998im      0.102184+0.0277408im     -0.112724+0.011653im      0.0679559+0.176595im        0.12903+0.124071im     -0.147605+0.160005im      0.125643+0.0991005im      0.131443+0.18557im        -0.201474+0.038162im       0.0646445-0.0293434im      0.0552891-0.101394im       0.178409-0.167253im       0.154106+0.200585im     0.0952769+0.0916441im    -0.0143728+0.0172732im     0.247458-0.0757215im       0.0225262-0.0711064im     -0.126208-0.0139277im    -0.228411+0.129305im       0.140229+0.10811im      -0.0904894+0.0662261im      0.226876+0.0838652im     -0.103419+0.122455im     -0.163492-0.137613im         0.127127+0.0759895im    -0.152476+0.151942im     -0.0707173+0.0549073im    -0.0203833+0.0694449im    0.00598785-0.0185481im      0.221694+0.0867384im
    0.198989+0.0338916im     -0.01656+0.121163im      0.107042+0.0184395im     -0.203892-0.212552im     -0.0511161-0.00617331im     0.192252+0.0128386im     0.0620969+0.099512im     0.0989014+0.221605im     -0.025049-0.0425413im     0.0377162-0.0476542im      -0.151079-0.23462im        -0.126213+0.10859im       -0.0758515+0.142313im       0.153062+0.193777im      -0.196366-0.0947922im    0.0640738+0.199092im      -0.162949+0.0775757im    -0.230699-0.0307922im      -0.0215519-0.0257648im     -0.193327+0.0856264im    0.0380743+0.0998527im      0.172136+0.0127176im       0.14446+0.0551764im      0.157424+0.0415549im     0.0176108-0.132084im    -0.0517372-0.0632746im      -0.0967166-0.0512507im    -0.017091-0.136911im      -0.167287+0.112769im      0.0435556+0.054022im     -0.0432349+0.127898im       0.148965+0.278803im
   -0.128076-0.154679im    -0.0786456-0.0452874im  -0.00815249+0.180596im     -0.0729823-0.157978im      -0.230015-0.258392im      -0.173966-0.168704im     -0.0816498-0.0653687im    0.0667516+0.0975201im    -0.151169+0.0127485im   -0.00431828+0.13445im       -0.0497001+0.0188154im       0.114134+0.216174im       0.0770157+0.160313im       0.133793-0.00830394im     0.212454+0.111482im      0.092623-0.188809im     -0.0629471+0.0304549im    -0.146867+0.0428493im       0.0896742-0.0686785im    -0.0545814-0.1946im        0.080688+0.1684im        0.0622789-0.110938im      0.0618599+0.16985im       -0.188641+0.0997769im     0.0146834-0.12077im      -0.234652+0.0703179im        0.176529+0.0780751im    0.0819279+0.03064im       -0.123508-0.145208im     -0.0131088+0.0112349im      0.120744-0.0562286im     -0.208652+0.0357103im
    0.100572-0.160729im     0.0135885+0.100424im     0.0406604-0.0752101im      0.180607-0.0259454im     -0.122101-0.0161436im     0.0777687+0.0391623im     -0.042058+0.150776im     0.0807267+0.0554093im    -0.256724+0.0983814im     -0.018371-0.162227im       -0.132829+0.0286802im      0.0810569-0.0816967im        0.24888-0.128658im     -0.0969231-0.124152im      0.0614974-0.171308im    -0.0394363+0.161876im     -0.0500489-0.114552im     -0.031128-0.111051im         0.388447-0.234234im       0.284556-0.0756622im    0.0948839+0.108505im      0.0199247-0.0621932im      0.132664+0.0352856im     -0.018622-0.0475105im     0.0785988+0.104109im     0.0627151-0.139837im        -0.179249+0.123889im      -0.21555-0.00548462im    0.0217354+0.00801279im     0.166377+0.0076258im    0.00230172-0.14127im      -0.0532653+0.0691043im
    0.264885+0.0711002im    0.0527719+0.0380795im     0.122826-0.0122216im      0.130279+0.0544855im     0.0105217+0.0853076im       0.10198+0.011552im      0.0211116+0.0508533im    0.0484189-0.237124im      0.129668-0.0834982im     -0.169497-0.00710276im    -0.0281395-0.0294425im      -0.063878-0.178714im       0.0595641+0.12692im      -0.0743045-0.096167im    -0.00668381+0.0485629im    -0.124632+0.12282im       -0.093982+0.0416087im    0.0594814-0.00261528im      0.0350085-0.124411im      -0.059273-0.192752im    -0.0896255-0.124117im    -0.00949707-0.0449609im     0.0793529+0.451421im      -0.220512+0.065613im      -0.205533-0.160998im     -0.164519+0.172989im         0.163892-0.0152906im   -0.0128871+0.0646288im     0.0784175+0.00324059im    0.0877038+0.200522im       0.182469+0.112918im       0.168371-0.0553908im
  -0.0700225+0.0286389im    0.0301428-0.0460756im    -0.175595-0.078946im       0.205911+0.230485im     -0.0903592+0.05491im        0.212895+0.167755im     -0.0944928+0.0300944im     0.277981-0.0391915im  -0.00258666+0.00607493im   -0.0716728-0.182909im       -0.145962-0.0312436im      -0.101651+0.149314im       -0.171226-0.0459816im      0.096885+0.11905im       0.0878936+0.126744im      -0.11893-0.164852im     -0.0245182+0.121171im      -0.17577-0.0335606im       0.0915713-0.115587im      0.0281846+0.0262374im    -0.325192+0.0472221im     0.0959761+0.0681764im     0.0440271-0.0723906im     -0.103057+0.0788347im     0.0153691-0.0315555im    0.0190471+0.22333im         0.0401599-0.148255im     0.0841399+0.00918284im     0.132582+0.135148im      0.0248549-0.314977im   -0.000969464-0.058678im      -0.132112+0.128595im
   -0.136912+0.153348im    -0.0117634-0.131081im    -0.0131955+0.125131im      -0.105069-0.0355842im     0.0367376-0.124771im       0.140664+0.0957929im     0.0789433-0.0402398im    -0.179067-0.0284284im    -0.169432-0.0461919im      -0.10642-0.225561im        0.233746-0.00735178im    -0.0202819+0.227749im     -0.00788479-0.210958im      0.0342858-0.0578863im    -0.0345861+0.10977im    -0.00159157+0.128154im      0.0362217+0.0143668im   -0.0646735-0.030698im       -0.0357878-0.143755im       0.200783-0.116142im      0.188032-0.163027im       0.281306-0.0386003im     -0.171616-0.0904386im      0.135952+0.203317im      -0.058467+0.0500985im   -0.0574142+0.249835im        0.0273066-0.157131im     -0.154178-0.127411im      -0.042464+0.045044im      0.0959706+0.143261im       0.215935+0.00740022im    0.0372483-0.0760134im
  -0.0675409-0.176882im     0.0410725+0.132238im     0.0516096+0.202292im       0.182008+0.184456im     -0.0171807-0.00340242im    -0.114689-0.0675893im     0.0075873-0.179052im      -0.13311+0.13423im      -0.141543-0.10707im       -0.117639-0.148231im      -0.0687893+0.137263im       -0.242121-0.160504im        0.217564-0.0650385im    -0.0304912-0.11134im      0.00330934+0.0188148im    0.0736307-0.0903374im     0.0670731+0.0620628im   -0.0631697-0.0225825im        -0.15306-0.0723267im      -0.15817-0.095834im    -0.0177769-0.0455583im      0.151125+0.181216im      -0.087006+0.119723im      0.0934098-0.123371im     -0.0618243-0.122943im      0.265519+0.00620858im      -0.097775+0.0564147im    0.0157139+0.0728745im      -0.18904+0.222653im      -0.226643-0.0179115im      0.114235+0.133369im     -0.0708596+0.184368im
   -0.187154-0.166673im     0.0119557-0.0566424im     0.232836+0.0659336im    -0.0584115+0.127929im      -0.150299+0.0860358im     0.0533201+0.00398263im   -0.0109629-0.0699195im    -0.113121+0.22666im       0.120616-0.0734882im     0.0838632-0.0272193im     -0.0674257-0.012705im       -0.241343-0.0400229im      -0.238674-0.0152064im   -0.00122593+0.00488218im    0.0142363-0.309586im    0.00920159+0.0283394im   -0.00566912+0.186512im      0.184484+0.265665im         0.132868-0.111071im        0.11883+0.0535092im    -0.163181+0.0425619im      0.122433-0.23643im       -0.013334+0.00894923im   -0.0119525+0.0816037im    -0.0123859-0.0113791im    0.0985153+0.0895707im       0.0749367+0.140973im     -0.123698-0.0857708im     0.0984512-0.275823im     -0.0343874+0.0427003im    -0.0474084+0.207593im     -0.0484097-0.107817im
   -0.139377-0.0292948im   -0.0526038-0.28993im     -0.0568142+0.0356711im     -0.102429-0.0631722im     0.0374792-0.0127865im     0.0794566+0.0999734im    -0.0759327+0.226138im    -0.0803388+0.0830653im   -0.0569791-0.0947809im     -0.072069-0.16801im        0.0786836-0.134112im       -0.104755-0.299925im     -0.00221358+0.147105im     0.00137712-0.178041im      0.0857903+0.101144im    0.00110614+0.109115im      0.0599552-0.0937726im   -0.0384226+0.036913im       0.00107117+0.112483im      -0.272121+0.0591122im     0.162085+0.150444im     -0.0707756-0.242384im     -0.0612805-0.154994im      -0.341952+0.0117848im     0.0972794-0.00983825im    0.112169-0.0116035im       0.0082697+0.0156168im   -0.0861705+0.15421im       0.0303089+0.126786im       0.149233-0.191029im        0.12818+0.131035im      0.0512424+0.0588141im
  -0.0180237-0.136715im     -0.185909+0.0176595im    0.0913149+0.247385im     -0.0488017+0.00690952im   -0.0449906-0.0245493im      0.116846+0.10098im      -0.0367626+0.115531im    -0.0944388-0.0804366im     0.120159-0.129056im       -0.13003-0.21122im        -0.273674+0.288192im        0.117438+0.197891im       0.0748473+0.0138376im     -0.171235-0.0294915im     -0.119462+0.0281676im    0.0227168-0.166371im     -0.0915253-0.302462im     0.0559838+0.019364im        -0.167927+0.0941226im     -0.103826+0.059756im     -0.167423-0.190427im      0.0265676-5.79022e-5im    0.0747667-0.0965676im    -0.0726962-0.0258578im      0.112258-0.0240348im   -0.0448412-0.101736im       -0.0171008-0.138098im    -0.0950909-0.0125322im     0.0460374-0.248245im        0.18337+0.110245im     -0.0566542+0.0195864im   -0.00655672+0.164027im
    0.177101-0.0633296im    -0.248088-0.0847333im    -0.026797+0.0193201im    0.00270915+0.095454im     -0.0641504-0.137144im      -0.367601-0.101321im    -0.00574868+0.119878im      0.238551+0.0706899im   -0.0569626-0.128132im     -0.0896906-0.144726im        0.175241-0.0823414im       0.108546-0.0698378im      0.0295506-0.191359im      0.0412909+0.0742471im     -0.227348-0.193178im    0.00220422+0.177572im      0.0619119-0.0684879im     0.182733+0.0261825im       -0.137732-0.000867061im  -0.0752491+0.0513994im    -0.054216+0.138251im       0.212148+0.0807935im    -0.0303457-0.0164201im     0.0200374-0.0575215im     -0.180991+0.0235403im    -0.200173+0.118676im       -0.0445952-0.0212319im    0.0197262+0.104136im       0.231274-0.143208im      -0.062102-0.188193im       0.054862-0.0398835im    0.00248674+0.0750257im
     0.15968+0.11862im      -0.114922+0.114642im   -0.00143876-0.213437im       0.111765-0.168127im      0.0468513+0.0390429im     -0.115732-0.124273im      -0.126486-0.111446im    -0.0754469+0.265058im      0.232444+0.287108im      0.0605653-0.0936822im      -0.121918+0.146122im       0.0667948+0.0227589im     -0.0072437-0.0382387im    -0.0783254-0.00653507im   0.00142814+0.157159im     0.0815387+0.00934694im    -0.138026-0.186708im     0.0919024+0.0043075im          0.0783-0.069675im     -0.0638244-0.0409105im    0.0665551-0.0456225im     0.0823294-0.0241646im    -0.0321881-0.0923104im     -0.208505+0.0442071im     -0.048568+0.0984441im     0.102764+0.174996im       -0.0408121-0.0108896im     0.050982-0.341039im     -0.0337641-0.0318603im     -0.112109-0.213976im       0.230358+0.198238im      0.0793154-0.0235915im
  -0.0403005+0.0166344im   -0.0312683-0.129509im     -0.117739-0.0161698im     -0.124008+0.204815im       0.113141+0.330635im      -0.195506+0.00640865im    0.0690206-0.0590562im     0.052976-0.025731im      0.102838-0.0654617im    0.00875953+0.244002im      -0.0189465-0.00489007im     -0.102039+0.167965im       0.0893843-0.114831im      -0.237799-0.102132im     -0.0464367+0.148908im     -0.170868+0.0249607im     0.0684371-0.0170223im    -0.250722-0.148186im        0.0963027-0.0811499im     -0.215141+0.0154755im    0.0774572+0.119765im        0.11478-0.135841im      -0.142628+0.163008im      0.0595381+0.0121833im   -0.00502884-0.110744im    -0.0565586-0.0368335im       -0.255975+0.0849614im    -0.117211-0.200067im      0.0311138-0.185811im       0.156345-0.0687707im    -0.0724105+0.0374137im     -0.106311+0.0169614im
    0.252993+0.0114552im    -0.116885+0.166657im    -0.0173339+0.105443im     -0.0753759-0.0429021im    -0.0193627+0.157425im       -0.20498-0.0922944im     -0.174015-0.110858im     -0.161994-0.119016im   0.000940251+0.109613im      -0.127275-0.0683686im      0.0621206+0.104434im       -0.204566+0.202048im       -0.122439-0.191939im       0.320655-0.13408im      -0.0015084-0.0571257im   -0.0823123+0.14745im        0.101071+0.0248559im   -0.0844712+0.000670554im       0.20336+0.0400481im    -0.0701813+0.149635im     -0.082165+0.0389505im     -0.140108+0.0979222im     -0.101842-0.0100355im    -0.0724126-0.0424154im      0.167022-0.0322773im    0.0865784-0.00499441im        0.30749-0.00550981im   -0.132164+0.14332im       -0.143804-0.0329942im      0.164804-0.0525163im    -0.0185971-0.0853961im      0.101447+0.0129902im
   -0.151627+0.213631im    -0.0344248-0.0221425im    -0.188282-0.0518888im     -0.216583+0.048886im    -0.00667636-0.14816im      -0.0617861+0.179102im     -0.0763115+0.114669im     -0.185003+0.0527649im     0.204138+0.118853im      -0.233757-0.0598068im      -0.103695+0.237592im      -0.0940163-0.0749195im       0.130433-0.019457im      0.0781065+0.187969im      -0.122773-0.14024im      0.0543385+0.026121im       0.240832-0.0362207im    -0.131517+0.0675916im       0.0355358+0.153204im       0.186973-0.0853286im   -0.0542003+0.14006im       -0.015789-0.109035im       0.229513+0.301701im      0.0067364-0.0540438im     0.0351526-0.0538158im   -0.0414841+0.083343im        -0.173098-0.0307638im     0.024221+0.0161374im     -0.108971+0.0374466im     -0.106796-0.0856496im     -0.016587-0.0720954im     0.0697999-0.138137im
  -0.0330854+0.08913im     -0.0554517-0.149051im     0.0690469+0.265292im      -0.118087+0.106119im     -0.0210972+0.17863im       -0.027718+0.114402im      -0.207792-0.0765816im    0.0834648+0.0732889im    -0.157037+0.0682135im    0.00753749-0.014825im      -0.0538831-0.0213348im       0.108589+0.00561765im      0.145524+0.160495im      0.0618983+0.109764im     0.00556872+0.0626606im    -0.196317+0.222823im      -0.121824+0.0608247im   -0.0545921-0.158116im       -0.0274949-0.169426im     -0.0600893-0.066542im    -0.0947889-0.155607im       0.143643+0.0790685im      0.169331-0.14233im      -0.0430428-0.0665516im      0.082692+0.0545663im    0.0958154-0.174475im     -0.000611265+0.0467292im     0.151439+0.0978683im    -0.0444014-0.150556im      -0.185314-0.0606251im     0.0456923+0.00618672im     0.185751-0.418635im
  -0.0228361+0.205234im      0.238254-0.114257im    0.00375588-0.0272728im       0.23317-0.0034066im     0.0638287+0.055596im     -0.0969552-0.0284289im     0.0722703+0.0628304im     0.181622+0.0943437im    -0.125722-0.0457326im      -0.10432-0.0789929im      0.0144046+0.038813im       -0.174841-0.0266757im       -0.04132+0.201438im     -0.0087044-0.213346im       0.108059-0.0986654im     0.179478-0.0126119im    -0.0754147-0.0827707im   -0.0432056+0.24652im       -0.00800027+0.156733im      -0.115725-0.0425054im    0.0109694-0.112288im        0.13243+0.214014im      0.0346747+0.0102788im   -0.00996508-0.00569485im    0.0406286+0.119726im     -0.166293+0.0810211im      -0.0208839-0.0132094im    -0.204802-0.14102im       -0.261837-0.204607im      0.0282972-0.104483im      -0.226581-0.219439im       0.112283-0.122049im
    0.170324+0.0666896im      0.10532-0.250433im    -0.0649817-0.277015im     -0.0112943+0.0151097im    -0.0774573+0.0950598im     -0.152902+0.119791im       0.199295-0.0955738im     -0.14468+0.108326im    -0.0748019-0.237078im     -0.0186273-0.133219im       -0.171506+0.0211844im      0.0680703+0.185453im     -0.00723168-0.206863im     -0.0268116-0.0851654im      0.164678-0.0298655im   -0.0129804+0.176436im      -0.253835+0.147263im     0.0177675+0.0796803im      -0.0803162+0.0687634im     0.0727329-0.078938im     0.0257685+0.0208219im     -0.134009-0.143167im       0.013394-0.0565533im       -0.1312-0.178851im       0.153408-0.160135im    0.00665167+0.0127718im      -0.0484764-0.124885im      0.208014+0.0851826im    -0.0374374-0.0604301im     -0.204984+0.15139im       0.0145371-0.0846888im    0.00554891+0.123876im
    0.179506-0.123297im     -0.086353+0.109843im    -0.0092139+0.0169583im     -0.100725-0.132096im      0.0160826+0.0741065im     0.0597348+0.214369im       0.311592-0.110009im     0.0402981+0.187932im    -0.0534655+0.145514im      0.0429581-0.0227828im       0.284137+0.0568614im      -0.126029-0.0433779im       0.181853+0.174568im     -0.0498393+0.00822339im    0.0499847+0.158973im     -0.114343-0.00986357im     0.267802+0.0843041im    -0.100599+0.157925im        0.0244298-0.0461818im     0.0903013-0.0965301im    -0.187153-0.102928im     -0.0664703-0.13579im     -7.57751e-5-0.0621667im    -0.0694587-0.16386im       -0.136054+0.129598im      -0.11204-0.141444im        0.0801516-0.245906im    -0.0834319-0.0125823im     0.0220958-0.171605im      -0.133532-0.0996708im     -0.011981-0.0136538im    -0.0325755+0.171565im
   0.0104926-0.00111869im  -0.0932509+0.0534154im   -0.0153607+0.0568335im      0.133829-0.16597im       0.0801534+0.185123im     -0.0303325+0.1004im        -0.268277-0.0585386im    0.0303819+0.0635948im    0.0891304-0.204942im     -0.0603871-0.10364im         0.123925-0.213907im      -0.0216699+0.00697442im      0.359401-0.0925172im      0.072037-0.0314846im     0.0542278+0.155205im      0.192127-0.0961156im    -0.0552308+0.0988582im    0.0804137+0.0941775im      -0.0831761+0.107603im       0.220054-0.150346im   -0.00449651+0.00370858im   -0.0462803-0.143858im      0.0354665+0.0388535im      0.227782+0.121529im      0.0832586-0.154233im      0.025987-0.0457189im        0.113204+0.114853im      0.158103-0.119936im       0.113717-0.041208im       0.170825-0.18703im       -0.213441+0.0580003im      0.163419+0.0321622im
  -0.0127266+0.0852556im      0.30536-0.0327967im   -0.0776088+0.245243im       0.057741+0.176996im      0.0768023-0.170628im    -0.00944566+0.0665636im     0.0998435-0.0297417im    -0.120302-0.0268757im   -0.0765321+0.212215im     -0.0980858-0.0840858im       0.181621-0.00676132im     0.0968215+0.0457803im       0.102006+0.0498306im      0.029221-0.042202im     -0.0888639-0.0649178im      0.16609+0.010926im      -0.139364+0.125463im      0.204884-0.145637im        0.0732944-0.163526im      -0.245457+0.197551im      -0.12474+0.0996409im      -0.22064-0.157624im      0.0683701+0.0978717im      0.100372-0.106737im       0.211806+0.0155978im   -0.0973626+0.000658634im     0.0696856-0.011673im     0.0513461-0.307274im       0.135465-0.0429411im    -0.0151274-0.0733471im     0.0794346+0.0192492im     0.0155419+0.102873im
  -0.0861526+0.0846348im    0.0439118-0.0124391im   -0.0216967+0.0340221im     0.0327332-0.0734576im     -0.206828-0.206143im       0.039928-0.0780302im     0.0785713-0.173777im      0.111232-0.23881im       0.153803+0.0178625im      0.220015-0.258646im         0.10202+0.000486324im   -0.0202686-0.00678948im     -0.102593-0.137029im     -0.0168378-0.116917im     -0.0147912+0.10566im       0.103836+0.121117im      0.0192994-0.00412367im    0.089883-0.0553256im        0.150588+0.0539241im     -0.100445+0.023363im    -0.0551237-0.0518584im      0.060041-0.143264im       0.107421+0.0260365im    -0.0186674+0.0554592im     -0.298857-0.336229im      0.146763-0.339342im        -0.128135-0.111153im     0.0313231+0.00444961im    -0.175474-0.0880918im    0.00737514-0.147408im     -0.0686652-0.0960549im    -0.0030582-0.0995301im
    0.104416-0.0454978im     0.155624+0.106698im    -0.0649109+0.000520204im    0.177892+0.2134im       -0.0997724-0.216414im    -0.00363578+0.0851394im     0.0409159-0.114506im    -0.0354764+0.0855835im    0.0991634+0.0494876im    -0.0183445+0.0530277im     -0.0847689-0.0191887im      0.0713461+0.163454im        0.125877+0.0397139im    -0.0322466-0.0856087im    -0.0429099-0.310945im     -0.121544+0.0705291im    -0.0243298+0.0475916im    -0.225343-0.252156im        -0.158151+0.300977im     -0.0184556-0.171541im     0.0800335+0.00126991im   -0.0257451-0.190896im      -0.104616-0.152132im     -0.0680671+0.247286im      -0.158142+0.123081im    -0.0308821-0.0856876im        0.183174+0.0153043im    -0.113997+0.0538735im     0.0197684+0.0289499im   -0.00768172-0.127565im      -0.124162+0.182422im       0.100166-0.0578988im
   -0.080423-0.0686504im   -0.0993736-0.0307452im   -0.0665986+0.105162im     0.00606208+0.00700225im    -0.243687+0.244705im      0.0682326-0.0568242im     -0.104186+0.232687im    -0.0261708-0.145912im    -0.0821905+0.0509137im      0.280468+0.147392im        0.202066+0.0561228im      -0.130485+0.221527im       0.0411956+0.00423747im    0.0524043+0.0171503im     0.0306743-0.117124im      0.228205+0.125386im      -0.197848+0.0629971im    0.0533233-0.0954241im       -0.193402+0.169267im       0.143361-0.0911682im   -0.0405447-0.0962707im     -0.108297+0.0645011im    -0.0220467+0.178284im      -0.202975-0.175972im     -0.0295418+0.0411256im   -0.0136097+0.0266368im       -0.171872-0.109396im     -0.201371-0.103478im      0.0369833+0.125804im     -0.0713831-0.150112im      0.0838133+0.106289im     -0.0238935+0.0104386im
  -0.0613803+0.169916im      0.126176+0.0745128im    0.0217414+0.0783018im     0.0384359-0.0879952im   -0.00297465+0.17607im       -0.185466+0.20854im        0.177663-0.225764im      0.107627-0.0743382im    0.0442327+0.0154003im     -0.206514+0.129763im      -0.0917777-0.00344896im     0.0898653-0.0807791im   -0.000685253+0.0282748im      0.171989+0.194621im        0.27966-0.121052im      0.248686+0.0854935im     0.0214305-0.105135im     0.0455948-0.0111187im       0.0417209+0.0496691im     0.0420893+0.0154954im    0.0659472+0.0265018im     0.0789951+0.125078im       0.079896-0.110181im      0.0232781+0.0255052im   -0.00692758-0.103738im     0.0241294-0.115934im       -0.0689699-0.170887im     -0.150958+0.119519im       0.168558-0.0369721im      0.195915-0.0102545im      0.215445+0.298245im      -0.200605+0.0143858im
    0.319363-0.00450985im    0.231342-0.0539715im   -0.0794392+0.111684im      0.0613222+0.0580672im     -0.110173+0.0855914im     0.0190826-0.069167im      0.0213535+0.182576im   -0.00157966+0.0968885im    -0.117018+0.105425im      0.0726175-0.0559484im     -0.0319783+0.0332441im    -0.00596152-0.0363537im     -0.0874538-0.200516im       0.129948+0.0844171im     0.0622063+0.107818im     -0.116302-0.209354im       0.220055+0.0687931im     0.172733+0.0415915im       -0.221372-0.0142685im      0.067782+0.13733im       0.147274-0.0882314im     0.0630027-0.0875355im       0.02798+0.196263im     -0.0728145+0.277471im       0.148883+0.121052im    -0.0785793-0.172732im        -0.201178-0.034563im      0.137683+0.0913549im     -0.179301-0.115292im       0.111813-0.0510577im     0.0195316+0.202031im      -0.030406-0.0433im
 0.000609754-0.255284im    -0.0950533-0.104573im     0.0761904-0.0458904im      0.168448+0.122773im       0.119573+0.160956im      0.0823437+0.00135776im    0.0190586-0.0554861im    -0.153639+0.0342448im      0.06844+0.107316im     -0.0488234-0.150513im    -0.000252761+0.0063045im     -0.0375259+0.0140404im      0.0248346+0.0457383im        0.2334+0.346866im     0.00534827-0.0155451im     -0.10139-0.147768im      -0.188694-0.0492046im     0.142942+0.0158001im       0.0955169+0.0359265im     -0.176687-0.0663126im     0.396743+0.0652067im      0.068114-0.093102im     -0.0715463+0.115614im      0.0539424-0.0906416im     -0.099133-0.0536777im   -0.0819636-0.0985817im       0.0612473-0.272157im     -0.118729-0.000980064im    0.059704+0.0764993im    -0.0439128-0.0234528im     -0.132542-0.221071im     -0.0480286-0.156541im
   0.0529046+0.0191145im    -0.140209-0.177284im      0.194978+0.0783722im    -0.0486148+0.25345im         0.17403-0.185715im      -0.150389-0.118742im      -0.150976+0.0334764im     0.146446-0.107148im      0.112963+0.107526im    -0.00941466+0.040127im       0.0471863+0.135701im       -0.167016-0.0675576im      -0.143882-0.0185897im     -0.114481-0.0173424im      0.114466+0.150965im      0.116839+0.0198476im     -0.129226+0.234801im    -0.0373935-0.0363604im        0.175338+0.081549im       0.100098-0.212625im      0.122807+0.0508905im   -0.00176418-9.52334e-5im     0.179314-0.0610085im      0.112335+0.0621831im     0.0945596+0.245144im     0.0227958-0.104777im       -0.0512513-0.245704im     0.0209257+0.0779036im    0.00633147-0.0274235im    -0.0135571+0.0932102im    -0.0589057+0.150849im        0.12978+0.270479im
  -0.0480886-0.0248393im    -0.203003-0.0478686im    0.0787449-0.0475935im    -0.0638549-0.0372182im    -0.0302338-0.111595im      0.0521005+0.174501im       0.211515-0.125985im     0.0679817-0.108832im      0.133107-0.0137334im     -0.120971-0.0845897im      0.0283397-0.0636736im      0.0624514+0.0633826im     -0.0147586-0.0554006im     0.0643882-0.191268im     -0.0823469-0.0652044im    -0.183825-0.0793205im     -0.217136+0.162273im    -0.0413381+0.243927im        -0.152832-0.0139512im    0.00721516-0.0404205im    0.0713398+0.182389im     -0.0493557+0.256282im      0.0152747+0.214201im     -0.0408074-0.0800891im     0.0240244+0.320393im      0.127572-0.234483im       -0.0043201+0.112229im     0.0941285-0.16011im      -0.0808475+0.0529486im        0.1973-0.149634im       0.142982+0.0713093im     -0.112473-0.131915im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  0.015007161347287053 + 0.04359228727416836im
   0.05353898398997136 + 0.035285459358962im
  -0.04305661862164322 - 0.12243861261769352im
   0.14102288399406976 - 0.2905974852450601im
   0.14619552710751701 + 0.13538174569141254im
   0.02382334187000336 + 0.1484556091322391im
  0.043337159430852944 - 0.12425490626961276im
 -0.035408052232992995 + 0.15976660135398554im
  -0.03688437223614728 - 0.029448821918296075im
    0.2160234468004358 - 0.06705188782245912im
   0.05434343721303522 - 0.17462191016032946im
   0.01192226829725096 - 0.08679085115002157im
  -0.12350124757658114 + 0.09254599788470166im
 -0.008777200072534665 - 0.06432503738330643im
   0.04109126801959692 - 0.14859226761879152im
  -0.17023244867542142 + 0.19084158189762845im
  -0.01032434983884694 + 0.09069670750605995im
  -0.07080063646584404 + 0.0588858189899261im
   0.16550699000988053 - 0.09997731024704029im
   0.09702640098917856 + 0.12553186954586096im
   0.18335210894071635 - 0.04627946102959464im
 -0.012132333809052157 - 0.10791413413736974im
  0.020086883796366833 - 0.17587160890689274im
  -0.04269753032826237 + 0.008815840009529492im
    0.3611969278365083 + 0.0im
 -0.001554710555455779 - 0.07784697356450794im
   -0.1552534193889775 + 0.07659428035475424im
  -0.10583385321027605 - 0.17171358323429373im
  -0.03554665959629444 + 0.23308646920064394im
   0.06564254678775708 + 0.20220146250784962im
 -0.052253675506826594 + 0.2690424642411547im
  -0.08968123433444111 - 0.056402969832606474im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 04:00">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

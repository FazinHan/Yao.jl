<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0165468-0.0494951im     0.0342497-0.0663436im       -0.182122+0.00953001im     0.152697+0.0238903im    0.0962146+0.14648im       -0.107794+0.0579289im     -0.0122043-0.214495im       0.235732-0.258165im       -0.162132+0.00123476im      0.166683-0.183237im      0.119815+0.0573082im    0.0913494+0.0745843im     0.0689944+0.0109039im   0.0561256+0.121357im       0.214458+0.18984im       0.104065-0.00955939im   -0.130976-0.153159im     0.0123083-0.0425019im     0.0288193+0.00972499im    0.134076+0.0490078im   -0.0124999-0.0456925im     0.112375+0.0583835im   -0.00704401-0.100268im    -0.140888-0.173269im      -0.20924+0.0567903im    -0.0837412+0.131287im     -0.0134832-0.0680625im     -0.0641513+0.339172im      0.0479307-0.0215666im     0.0337014+0.236208im     -0.223526+0.118528im    0.0266463+0.154336im
 -0.0755521-0.0219646im      0.282567-0.257932im     -0.000261328+0.0933487im     0.0722097+0.129383im     -0.098741+0.130543im      0.0594692-0.0733574im      -0.133323-0.183009im      0.0164078-0.1252im      -0.000570095-0.153164im       0.0738022+0.235707im     -0.189344-0.0162629im    0.0145529-0.100201im      0.0601444+0.0641252im   -0.141965-0.104925im     0.00825073-0.133382im      0.128284+0.0306693im    -0.212522-0.0402338im    0.0171018-0.164063im       0.100007-0.156162im    0.00638984-0.0112701im    -0.127048-0.19053im      -0.175542-0.376852im      -0.212517-0.0123593im   0.0766751-0.0988702im   0.00905057-0.0917559im     0.0499834-0.00394269im    0.0936381+0.134446im      -0.0335604-0.0227505im      0.135546-0.188735im      0.0620103-0.0117042im     0.108807-0.0605722im  -0.0233688-0.023217im
 -0.0204491+0.202981im      0.0211653+0.0301175im       -0.188717-0.19915im       -0.107637-0.269886im     -0.249717+0.00348415im      0.11447-0.192315im      -0.0246435-0.0720889im   -0.00163245-0.116537im        0.038443+0.132015im       -0.171694-0.0620701im    0.0351605+0.132984im    -0.0907015-0.0290333im    -0.0351344+0.0789933im   -0.103054-0.0378569im      0.263915+0.125045im     -0.138165+0.0812238im    -0.114725-0.0214373im    0.0770037+0.0814716im    -0.0228999-0.148329im     0.0937711-0.0277263im   -0.0432432+0.166576im     -0.128199-0.109088im      0.0137352+0.227959im     0.052344+0.00761959im   0.0828146-0.152752im      -0.104087+0.0665012im     0.0750769-0.203242im       -0.103025+0.157357im     -0.0115455+0.16671im        0.083032-0.0956326im      0.17874+0.0916073im   -0.267039+0.0136618im
  -0.122767+0.0832488im     -0.183527+0.0401155im       -0.010382-0.0152411im     0.0348548-0.365618im    -0.0637444+0.0326589im     0.0293454+0.118113im        0.111044-0.0651218im     0.0328116-0.0849195im     0.00421776-0.171358im       0.0247373+0.0708353im    0.0770425-0.0694591im    -0.025306+0.0646398im    -0.0951524-0.188343im   0.00906918-0.0796678im    -0.0346797-0.0911916im    -0.040249+0.120328im    -0.0620586+0.202122im     -0.114437-0.184684im       0.139802-0.0305911im   -0.0502268+0.0829614im    0.0151371-0.214735im    -0.0154731+0.176862im      -0.202815+0.117978im     0.365155+0.173051im     -0.057522-0.12966im      -0.0230316+0.0406858im     -0.313097+0.0807043im     -0.0207916+0.062139im     -0.0516818-0.106751im      -0.104576+0.183682im    -0.0179302+0.0727228im  -0.0320391+0.144904im
 -0.0419372-0.00899335im    0.0440188-0.158785im         0.168892+0.303394im       -0.21034-0.209571im     -0.115235-0.323784im      0.0410286-0.256186im       0.0966452-0.210708im       0.149254-0.0407589im      0.0302469-0.0694797im      0.0752293-0.125734im     0.0739088+0.0262209im       0.0725+0.147806im       0.248414-0.0862758im  -0.0848382-0.0211958im     -0.276276+0.0248452im    0.0608947-0.079187im     0.0184544+0.0592534im     0.131348+0.0463969im    -0.0509676-0.060258im     0.0652022-0.00319656im  0.00540616+0.114991im     -0.144631-0.0816775im      0.178132-0.0551445im   0.0515575+0.0929587im    -0.120112+0.106573im      0.0955563-0.00849742im   -0.0311467-0.00142952im     0.0479087-0.0875559im      0.172612+0.115885im      0.0144566+0.0917998im    -0.139355+0.18153im    -0.0634058+0.0121053im
  -0.135965+0.0876131im      -0.18155+0.197485im         -0.13803-0.0593094im     0.0616297+0.0675829im    -0.150029-0.136006im       0.112053-0.213381im      -0.0899517+0.175212im     -0.0571847+0.052416im      -0.0578219-0.127526im       -0.163357-0.184804im     -0.165108+0.195921im     -0.197836+0.140614im      0.0144743-0.0746963im  0.00332441-0.0105166im   -0.00215792-0.0180445im    -0.036317+0.160919im    -0.0780496-0.209415im      0.152877-0.174409im      0.0431019+0.0732855im    -0.219029+0.0287515im   -0.0497807-0.0108006im   -0.0585628-0.071059im       -0.01486+0.0162687im  -0.0457722-0.0239545im    -0.136221+0.147461im      -0.051821-0.0516742im      0.143713+0.281246im        0.228069+0.0713369im     0.0939256-0.081855im     -0.0672764-0.0180014im    -0.163053-0.0311975im    0.112068+0.227125im
  -0.131111-0.0431863im    -0.0364725-0.103293im       -0.0251703-0.00159658im    0.0460728+0.110617im    -0.0742353+0.0762069im     0.0489527-0.0334217im      0.0941234-0.27771im        0.116458+0.222487im       -0.213869-0.148051im       -0.158055+0.00921093im   0.0131463-0.161128im     0.0069538-0.260317im       0.129243+0.219225im     0.218691+0.185699im       0.117241+0.0374189im    -0.189125-0.061532im     0.0392552+0.119362im    -0.0538655-0.137696im       0.210604-0.075737im     0.0440588+0.0338439im    0.0259269+0.166724im     -0.130157-0.0495733im      0.150791+0.188541im    0.0318486-0.0178318im     0.144421+0.250723im      0.0549369-0.00726093im    -0.119371+0.0769329im       0.113956+0.00571767im    -0.158475+0.0884029im     -0.187523-0.0341168im   -0.0379342-0.0429417im   0.0622882+0.0831647im
  -0.041914-0.123649im       0.106441-0.043549im         0.278501-0.00720886im      0.10074-0.00778563im   0.0226571-0.00238051im    0.0693828-0.0149348im   -0.000222701+0.00239482im    0.0669154-0.440608im      -0.0762341+0.0240526im     -0.0345013+0.081707im     0.0430125-0.0110327im    -0.123965+0.030546im      -0.267682+0.192771im    -0.197614-0.268626im      0.0280206+0.166561im     -0.088276+0.139087im     0.0676195+0.178236im     0.0259964-0.094514im      -0.128331+0.114125im     -0.201668+0.11111im      0.0803158+0.167219im     0.0886116-0.0581606im      0.168037+0.0990014im  -0.0746067-0.014658im     0.0128389+0.0195065im      0.172636+0.120104im     -0.0582983-0.0191066im      0.0247913+0.0261829im   -0.00623583-0.063283im      -0.205204-0.152826im      -0.14489-0.0357024im   0.0967837+0.0245832im
  -0.143949-0.00348118im    0.0861829+0.0459694im        0.118393+0.0477153im     0.0976643-0.109114im    -0.0323381-0.0979874im     -0.147385+0.0781149im      -0.263916+0.0208022im       0.19183+0.115468im        0.291043-0.109088im       -0.173908-0.106504im     -0.116824+0.0568232im     0.141873+0.101075im      -0.142264+0.227263im    0.0115554+0.0576666im    -0.0554524-0.0467735im    0.0730406-0.0582102im    0.0647847+0.0432059im    -0.321373-0.117963im     -0.0507358-0.0177868im    -0.150235+0.0868003im     0.223144-0.178541im     -0.103702+0.0304809im    -0.0297196+0.115344im   -0.0865817-0.221994im    -0.0132673+0.0512589im   -0.00851619-0.156787im     -0.0351362-0.0929678im       0.058657+0.20383im        0.124759+0.242787im      0.0762589-0.0124686im   0.00927931+0.0125887im   -0.105021-0.0624629im
 -0.0634517+0.0128395im        0.1481+0.167622im         0.071357-0.0125981im     -0.168901-0.0832878im     0.198876+0.072574im      0.0129803-0.0947048im      -0.133598-0.0567101im     0.0333355+0.151924im      -0.0768055-0.241356im        0.218352-0.0904494im    0.0340957+0.0780509im    -0.230916+0.000606837im  -0.0184044-0.138093im    -0.191326+0.00229405im   0.00179604+0.0313108im    -0.328161-0.0351529im   -0.0207521-0.0600156im    -0.110267-0.115741im         0.1847+0.0562513im     0.195487-0.0454189im     0.133486-0.0760278im    0.0543382-0.00157435im    -0.055527-0.143804im   -0.0956965-0.158188im    -0.0548216-0.0741515im     0.0120835+0.172066im    -0.00408552-0.175943im        0.282227-0.0813058im    -0.0394979-0.0530513im     -0.143139-0.178409im     0.0828143+0.144723im    -0.056943-0.156405im
  -0.252527-0.270154im      -0.257528-0.0325894im      -0.0114392-0.0758601im    -0.0602794-0.173487im    -0.0150936+0.0917888im     0.0414431-0.123221im       0.0269026+0.0341147im     0.0440225-0.0736912im     0.00354231-0.136036im      -0.0059036+0.117467im      0.167143-0.293501im     0.0296451+0.267923im      -0.019435-0.0305028im   -0.048134+0.0558832im     -0.135556-0.0992234im    0.0834254-0.101656im    -0.0727418-0.278034im      -0.11157+0.0963353im     0.0662076-0.0773475im    -0.109114-0.142583im     -0.101891-0.0158606im    0.0509835-0.0319718im    0.00717447-0.0564787im   -0.108903-0.0835226im     0.238274+0.00936082im    0.0879214+0.149412im       0.167292-0.0859634im      -0.120008+0.0678349im    -0.0367407+0.145628im     -0.0915095-0.125316im       0.16148-0.0626111im    0.154306+0.15839im
   0.126893-0.000518575im   0.0723006-0.130334im        0.0631775-0.116853im     -0.0328539-0.0122714im      0.21642-0.0470439im      0.112268-0.183936im       0.0355601-0.170689im      0.0935628-0.0314838im    -0.00847818-0.00215141im  -0.000502202-0.080919im    -0.0178273+0.0889589im     0.187226-0.226738im      -0.174001+0.0862367im   -0.114714-0.037006im      0.0635445-0.154867im     -0.194126-0.0343554im   -0.0338166-0.121993im     0.0277218-0.000783378im   0.0469872-0.0113971im    -0.189729+0.111943im      0.039982-0.195203im     -0.122225+0.216198im      0.0603859-0.133873im    0.0338207+0.243723im     -0.155566-0.0920239im    -0.0562131-0.0987383im      0.190633-0.088471im       0.0131876-0.0933281im     -0.117946+0.186825im       0.140169+0.0269168im     0.117745-0.0217741im    0.284681+0.269021im
 -0.0361211+0.155736im       0.276203-0.0631794im       0.0525791+0.0030732im   -0.00528028-0.0607711im    -0.089473-0.0477337im     -0.147759-0.214085im      -0.0371832-0.016438im      0.0325226+0.00876148im      0.170393-0.123164im      -0.0438781+0.0382085im     -0.10945-0.277324im     0.0264555-0.0275505im      0.206513-0.211556im   -0.0317006-0.0683964im      0.183722-0.0329972im   -0.0371884+0.119426im     -0.020485-0.205894im     -0.226076+0.136698im      -0.120822+0.210984im    -0.0870421-0.0369353im   -0.0551012+0.110177im   -0.00035617+0.136589im     -0.0445908+0.101156im   -0.0775974+0.0748998im    -0.152332+0.0716008im    -0.0630817+0.086786im      -0.103946+0.132404im       -0.142665+0.0783971im     -0.342756-0.063044im      0.0426454-0.0956923im    -0.133778-0.0514737im    0.114083-0.162495im
  -0.148534-0.140732im     -0.0457669-0.147463im         -0.16426-0.164065im      -0.152518+0.0347702im    0.0612922+0.111782im    -0.00410025-0.166455im      -0.0746275+0.231312im       0.144374+0.285645im        0.117706-0.0639735im     -0.0197068-0.132179im     0.0303342+0.15663im       0.135791-0.12505im      -0.0406897-0.0837175im  -0.0286428-0.442238im      0.0971758+0.124156im      0.162806+0.0641142im      0.11106+0.175565im     0.0494255+0.0681966im     -0.081519-0.0406628im     0.196813+0.0827918im   -0.0452081-0.050029im     -0.086166-0.0735427im    -0.0653049-0.0872325im  -0.0186804+0.0401898im    0.0909224+0.101472im       0.226586+0.102395im      -0.115685-0.0168211im     -0.0306467+0.105134im     -0.0400907+0.00795297im    -0.057104+0.11615im     -0.0153134+0.0123953im    0.185336+0.000639635im
  -0.171232+0.0329818im      0.137214+0.0619526im      -0.0929678+0.0671518im     0.0168981+0.0739625im    -0.307528+0.147467im       0.116372+0.0553095im      0.0604755+0.0476402im    -0.0463813-0.146052im       0.0807266-0.0452104im       0.191246-0.159251im    -0.0271215+0.205363im     0.0970235+0.0346876im     -0.147619+0.184776im     0.106846+0.0512878im     0.0313914-0.342271im       -0.2538-0.0616258im    0.0841179+0.0569871im    -0.155528+0.09324im       -0.116679-0.0187948im    0.0575482-0.17002im      -0.116254+0.15051im     -0.0704438+0.150162im     -0.0977319-0.323902im     0.131128+0.0300487im    0.0332735+0.0995149im      0.106749+0.067913im      0.0384986+0.0962104im      -0.129091-0.00918575im    0.0426714+0.0531971im     -0.113527-0.0503331im    -0.137022+0.0697253im  -0.0041319-0.0383607im
  0.0535614-0.0656333im     -0.147221-0.018166im        0.0427805-0.0921676im     -0.180222-0.145249im    -0.0150342+0.14873im      0.00767796+0.128983im        0.140246-0.171164im       0.147099+0.0735504im        0.15664+0.0831512im      0.0713173+0.0581789im    -0.104062+0.148009im      -0.12265+0.0533873im     0.0720026+0.248433im    0.0992855+0.0472994im      0.122359+0.202429im      0.117146+0.0986599im      -0.2121-0.123047im      0.033561+0.100885im       -0.09779-0.0768396im    -0.144424-0.286321im     0.0495537-0.186386im    -0.0381639+0.138728im     -0.0400421+0.0652299im   0.0747671+0.0463802im   -0.0815503+0.0852492im        0.2983-0.0973046im     0.0314968+0.0136206im       0.144575-0.1081im       -0.0448082-0.167745im      0.0458363-0.191929im     -0.113045+0.122692im     0.102145-0.167894im
  -0.183522+0.14397im        0.160872-0.000820939im    -0.0957655+0.120875im      -0.131093+0.0613907im    0.0260774-0.133665im     -0.0405426+0.136215im       -0.211561-0.097043im     -0.0156354+0.0962177im     -0.0214158+0.290576im        0.102733-0.0960417im   0.00133853+0.0446415im    0.0227779-0.17375im      -0.0306956+0.046648im    -0.122297-0.0737144im     -0.148263+0.0104674im      0.21704-0.00935255im   0.0440357-0.231825im     -0.108065-0.0884662im      0.102984+0.110057im    -0.0421388-0.106206im     -0.104344-0.0853433im    0.0661202+0.137398im       0.186857+0.117071im     0.164536+0.231911im      0.231389+0.0758288im     -0.034845+0.0941257im     0.0642249-0.121006im      -0.0179567+0.146715im      0.0237906-0.205887im      -0.238208-0.110015im    -0.0267656+0.0161871im  -0.0910448+0.171696im
  0.0510785-0.283283im        0.15127+0.0541846im       -0.113475-0.20493im       -0.150344-0.00199411im   -0.223023-0.14791im      -0.0312967+0.219328im      -0.0827185+0.10535im       0.0451112+0.0246797im     -0.0533956+0.0408721im       0.137789+0.107122im      0.167034+0.100562im      0.111897-0.172078im       0.190888-0.0591094im   -0.144444+0.062968im      -0.139266-0.0676107im   -0.0867819+0.11979im      0.0217935+0.108595im     0.0326759-0.120675im       0.150312-0.108109im     -0.312429-0.184134im     0.0360212+0.152974im    -0.0410158+0.0347662im   -0.00416244+0.0959625im   -0.195272-0.0302598im    0.0218792-0.199986im     -0.0355449+0.0274429im   0.000361446+0.0906945im       0.048631+0.148712im      -0.055106+0.0279351im     0.0892662+0.143229im    -0.0588731+0.169907im      0.16665-0.0982851im
  -0.192836+0.00846791im    0.0273026-0.0639732im      0.00720413+0.161571im      0.0993642-0.0792356im   -0.0359229-0.16483im      -0.0790393+0.011538im       -0.033067-0.0823873im     -0.256964+0.18754im        -0.095111-0.22784im        0.0147713+0.0972739im     0.162184+0.0812602im   -0.0105886-0.0424871im    -0.0670217-0.0422097im  -0.0884611-0.140959im       0.322588+0.138153im     0.0386188+0.0264492im   0.00184882+0.127446im    -0.0772549+0.248177im       0.178668-0.264482im     -0.188148-0.135995im      0.108435+0.0963848im     0.220083+0.124534im        0.06893-0.144148im     0.032665-0.0378458im   -0.0647483+0.0386484im   -0.00766987-0.133675im       0.147595-0.0577337im     -0.0434668-0.0247877im      0.138375-0.102227im       0.115314+0.0136446im   -0.0921314-0.209781im   -0.0618599+0.0605564im
  0.0759333-0.0778455im    -0.0518316+0.0425257im       -0.013523+0.128424im      0.0701023+0.231009im    -0.0539259-0.069136im       0.171572+0.117305im      -0.0981661+0.0881587im     -0.163953+0.0795555im      -0.175028-0.230039im       -0.037518+0.117364im    -0.0623912-0.086807im      0.101411+0.0951544im      0.162819+0.111918im    -0.192492-0.0822517im    0.00708435+0.1824im       -0.124341+0.0379819im     -0.13553-0.0266872im   -0.0545376-0.118897im      -0.422228-0.0737369im     0.115266-0.14898im      0.0998705-0.181177im     0.0558345+0.0684577im    -0.0253029+0.0789817im    0.159611+0.18412im      0.0207315+0.0516822im    -0.0220353+0.163464im       0.134751-0.0916204im      0.0272397+0.0564248im     -0.136061+0.234867im     0.00676049+0.133037im    -0.0537346+0.110455im   -0.0677375+0.0227512im
 -0.0367906+0.130677im      0.0647067+0.00368371im      -0.117315-0.0059958im      0.038545+0.137679im     0.0182793-0.0723187im     0.0260477-0.0803523im       0.150563+0.0247127im     -0.158545-0.0376435im       -0.10977-0.0699408im      0.0170228-0.166899im     0.0840438-0.0703826im    -0.160871+0.0384236im    -0.0780933+0.065175im    0.0406612-0.0658584im     -0.148208+0.0344303im    0.0353361-0.00577379im   -0.169068+0.187233im     0.0554146+0.145747im      0.0806015+0.0663737im   -0.0876002-0.136017im      0.169685-0.374246im      -0.26205-0.0132489im      0.270307-0.083126im   -0.0210704-0.161899im      0.199335-0.00891419im    -0.168198+0.0691626im     -0.196721+0.0412863im      -0.212927+0.0939175im    -0.0837523-0.0197785im      0.202301-0.154508im    -0.0811203+0.130223im     0.122939-0.0877589im
 -0.0171201-0.0335462im    -0.0105187+0.161616im        -0.152867+0.00556464im     0.066933+0.0179826im    -0.158327-0.158982im     -0.0879997+0.108117im      -0.0675364-0.280052im     0.00386102-0.115521im      -0.0331552-0.128034im       -0.208573-0.0397321im    -0.022898+0.208789im    -0.0869953-0.0680372im      0.101423-0.125994im    0.0592682+0.141199im      -0.089181-0.0571143im    0.0545567-0.0858255im     0.213511+0.114641im   -0.00150192+0.237181im     -0.0916166+0.156255im     0.0287439+0.0869805im     0.150542-0.170969im   -0.00624306-0.139464im     -0.0573808+0.0417815im  -0.0165649-0.00147438im  -0.0369349-0.173406im       0.350694+0.20274im        0.183474-0.133624im      -0.0565132-0.0423575im     -0.223461-0.129796im    -0.00939679+0.014438im     0.0438384-0.134607im    0.0769849+0.100027im
 -0.0150251+0.00252404im   0.00714641-0.0453417im      0.00530645-0.0479423im    -0.0777294-0.121612im     0.0390719-0.0571073im     -0.200327-0.136369im        0.126661-0.119225im      -0.144314+0.0475876im       0.015273+0.016994im       0.0330047+0.144398im       0.22515+0.195632im    -0.0754777-0.217887im      -0.166358-0.0476305im    0.137931+0.0393375im    -0.0997792+0.0118675im    -0.117133-0.00414042im    -0.13062-0.158469im    -0.0952697-0.173321im        -0.3568-0.0063094im    -0.138717+0.0580725im    -0.159384-0.127692im      0.105467-0.155727im      0.0916378-0.185067im     -0.11304-0.041731im      0.183686+0.0430464im     0.0980051-0.00572429im    -0.100447+0.147736im        0.107854+0.0800247im     -0.154042+0.0550952im     0.0604567+0.183298im    -0.0620639-0.120515im    -0.273991-0.0233017im
    0.29794-0.187837im        0.07862-0.0308101im        -0.28748+0.0890107im    -0.0159704-0.171424im    -0.0468178-0.161803im     -0.0255801-0.0941231im    -0.00386473+0.17742im      -0.0957322-0.0698554im     -0.0771605-0.0103232im      0.0630826-0.126625im    -0.0508829-0.288782im     0.0190618-0.216223im     -0.0579235-0.0404268im   0.0634018-0.0519777im      0.129175+0.0370376im   -0.0464628-0.163876im    -0.0230644-0.134187im    -0.0170762-0.00579577im    -0.059484-0.0370009im   -0.0812272+0.160423im      0.082569-0.0842357im    -0.118001+0.164701im      -0.120883+0.103504im    0.0545067-0.265968im      0.128258-0.0340548im       0.21554-0.0828333im     0.0785038-0.000762438im    -0.038565-0.180586im       0.149957-0.0643938im     -0.192968-0.027769im     -0.175956+0.127617im    -0.106601+0.0518143im
  -0.236011-0.0309797im     0.0892898-0.0766731im        0.133063+0.0728668im     -0.107526+0.0436847im     0.160487-0.155117im     -0.0969601+0.030644im      0.00737681+0.188176im     -0.0472861-0.0487294im      -0.134189-0.156794im       0.0101298+0.0360215im    -0.106593+0.157319im     0.0415508+0.0822953im     0.0622395+0.141097im     0.274454+0.0514452im      0.121581-0.0217681im     0.148345+0.0989132im    0.0917957-0.197892im      0.192905-0.169547im       0.036431-0.0383456im   -0.0138626+0.159177im    -0.0112352+0.181801im    -0.0307031+0.161891im     -0.0491484-0.0183989im    0.167127-0.0987806im     0.134292-0.250156im      0.0924875+0.189095im      -0.113066-0.0576934im     -0.0132631-0.0941373im     -0.169247+0.0269418im      0.296957-0.132615im    0.00522746+0.127184im   -0.0630313+0.08563im
  0.0714852+0.0409297im      0.163844-0.133452im       -0.0359886-0.163221im       0.115864+0.107867im     0.0110266-0.196372im    -0.00967832-0.0707829im       0.144844-0.0564494im   -0.00440027-0.0444751im       0.140031-0.157642im        0.140763+0.0357044im   -0.0252027-0.0679698im   0.00243005+0.144475im       -0.10121-0.191531im     0.174242+0.121145im     -0.0106946-0.00917896im  -0.0185854+0.198761im      0.142922+0.111585im   -0.00791737-0.0230947im     -0.149527-0.138801im      0.210614-0.0705415im    -0.103831-0.020085im      0.126586-0.0131959im     0.0400777+0.0797525im   0.0493203+0.0194833im     0.208536-0.0969775im     0.0112909-0.351672im        0.12752-0.151305im        0.233413+0.254855im      0.0124918-0.0915679im    -0.0575232-0.170032im     -0.017345+0.14209im      0.175561+0.109414im
 -0.0323571+0.0986716im    -0.0943597+0.13071im         -0.051043+0.0742353im      0.131411-0.0711812im    -0.050279-0.206276im       0.248956-0.120338im       -0.188406+0.0306873im      0.155562+0.0431465im      0.0407523-0.0771931im       0.108906+0.283303im     0.0261562-0.0951475im    0.0734452-0.217883im      -0.198119+0.129808im    0.0302439+0.139155im      -0.100962+0.00829863im    0.188008+0.205166im      -0.18543+0.0796417im     0.161402+0.0542881im    -0.0338743+0.103595im      0.162356-0.00351555im    0.110348+0.118175im    -0.0247309+0.208582im     0.00809319-0.188269im      -0.1898-0.0756539im    -0.076564+0.0842586im     0.0774629-0.0428058im     0.0123564+0.0671761im     -0.0656817+0.0411239im       -0.1552-0.146012im     -0.0642733+0.0393651im     0.233239+0.137714im     -0.10274+0.0185234im
  -0.117739-0.022968im       0.103835+0.00537313im      0.0558132-0.0793131im     0.0651581+0.0897146im   -0.0878663+0.0927012im      0.178362-0.101404im      -0.0523328-0.245429im      -0.143456+0.0150587im       0.150461+0.0476702im       -0.03241-0.00254501im  -0.0154125+0.0929338im   -0.0229769-0.0317055im     -0.104752-0.126674im    -0.166462+0.129852im     -0.0241724+0.0161339im     0.230248-0.0768732im   -0.0704142+0.0272525im     0.118097+0.0550017im    -0.0488472-0.0619477im     0.115749-0.0117486im    0.0149389-0.0175838im    0.0932197+0.274336im      -0.218767+0.17567im     -0.242285-0.0444954im     0.225494-0.0887139im     -0.102508+0.0931022im     -0.221367+0.0642342im       0.128261-0.28537im       0.0515408+0.21872im     -0.00547141+0.00462712im   -0.281418-0.0497372im   0.0523854+0.113966im
  0.0925043-0.194859im       0.120357-0.00361357im     -0.0987543-0.174079im       0.140264+0.0955838im   -0.0771882-0.0431369im      0.027245-0.160697im       -0.111522-0.121566im      0.0583985+0.11107im         -0.21014+0.0599009im      0.0742885+0.0313736im   0.00613389+0.0491072im    -0.083156+0.329712im     -0.0332945+0.0951458im  -0.0420488-0.118214im     -0.0829773-0.104994im    -0.0817965-0.275011im     -0.100044-0.11197im     -0.0407714+0.177495im     -0.0410959+0.0160202im   -0.0150178+0.170016im      0.120982+0.148398im     0.0226166+0.18306im      -0.0130804+0.0912335im    0.100129+0.145049im     0.0852834+0.0588035im      0.113653-0.0605485im      -0.24548+0.0757693im       0.148016+0.150099im      0.0482669-0.236457im       0.210113+0.0767409im     0.199303-0.0618977im  -0.0617134-0.0622718im
  0.0227059-0.29326im       0.0418154+0.3119im           0.132876+0.0812218im     0.0950025+0.0301im       0.0996014+0.110671im       -0.15741-0.165121im      -0.0520137+0.0635202im    -0.0371924-0.0442969im      -0.111453+0.0266435im      -0.100419-0.00738845im   0.0385569+0.100112im   -0.00435222-0.189149im      0.0154144-0.0097029im  -0.0306409+0.0867808im    -0.0447006+0.0592672im     0.178619-0.0104872im    -0.043949-0.0504485im    -0.159907+0.254564im     -0.0309225-0.226461im     0.0453485+0.00151681im    0.024664+0.0479391im   -0.0704498-0.179102im     -0.0610472-0.0846425im    0.144354+0.181071im     -0.122741-0.139122im      -0.102237-0.170052im      -0.161713+0.163193im     -0.00904703+0.106821im     -0.0936169+0.0685352im     -0.158251-0.251819im    -0.0466248+0.246219im   -0.0455685+0.143523im
   0.109782-0.0359388im      0.216747-0.0225196im      -0.0435211+0.0354865im    -0.0592726-0.3446im       0.0989405+0.0717274im      0.186228+0.294666im      -0.0456726-0.025178im       0.021637+0.0695367im      -0.157532-0.175269im       -0.153302-0.246826im    -0.0598585+0.0687668im   -0.0694013+0.0268436im     0.0361355-0.100329im    -0.125917+0.17992im       0.0108601+0.0889629im      0.11228+0.0548536im    -0.119979-0.022187im    0.00564984-0.163466im      -0.202477+0.0296775im     0.076215+0.0371398im    0.0452401+0.167291im    -0.0219601+0.0059008im     0.0744221-0.188948im   -0.0112827+0.0824594im     0.194934-0.017383im      0.0172939-0.168006im     -0.0558886+0.16689im        -0.202278+0.0454713im     0.0761792+0.00186582im  -0.00367794-0.102312im      0.113303-0.232301im     0.193316-0.0395269im
    0.12277-0.00320303im     -0.17668+0.0295856im        0.162041+0.349313im     -0.0172102+0.0786195im   -0.0623251-0.107648im      0.0207323-0.00711517im    -0.0220715-0.031541im     -0.0355809+0.00711476im      0.099863-0.0119646im       0.323727-0.046296im      0.200067+0.206233im      0.095025+0.0358363im    -0.0452239-0.0103914im   0.0542452+0.0788929im      0.244897+0.0710266im    -0.110843+0.146576im     0.0271299-0.165279im     0.0125705+0.131452im      0.0371154+0.0201285im    0.0145079+0.183755im     0.0890269-0.101441im     -0.118565-0.0722902im    -0.0891112+0.248708im   -0.0508351+0.058878im      0.219355-0.0375975im    -0.0546513+0.0940245im    -0.0219196+0.214289im      -0.0539868+0.113807im      0.0803432+0.0440771im      -0.12906-0.00116291im    0.196302-0.103672im     0.211062-0.148906im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.02255121107079723 + 0.06889597388463853im
 -0.015827839646993636 - 0.16379919261515774im
 -0.011490285992354849 - 0.015564373170158071im
  0.004974666102356445 + 0.1946826298790596im
   0.10460026042680441 - 0.2677335139274245im
  -0.01996538805643132 - 0.23701337412411302im
  0.023578661934941257 - 0.12929048137335508im
   0.17245195449486433 - 0.08431741192225156im
   0.07773289114524487 - 0.018479837197886765im
   0.23740644647662446 + 0.03241703691357284im
  -0.10682849650426705 - 0.07337611958994342im
     0.305610417784641 + 0.0im
 -0.010736739600799405 + 0.11928537749904648im
   0.03259001433571092 + 0.06160655728699053im
    0.1179683106768055 + 0.007527295296183345im
   0.03155844736652707 + 4.695299640865465e-5im
 -0.004703642055371455 + 0.040218866190941185im
  -0.08502169996569572 + 0.1459780507254453im
  0.017748918088347616 - 0.0045732098040426545im
 0.0005701033751974796 - 0.046209237545794396im
   0.09975772223565497 - 0.2856680227888919im
   0.16213607015753514 - 0.10956066118494852im
   0.04272527755134216 - 0.0021308506727865766im
   0.07824506542334168 - 0.18986099294842623im
   0.06275443495225166 + 0.2549627534468864im
  -0.08538013994568984 - 0.09972171944736702im
  -0.09497321796401417 - 0.019697662979499604im
   0.05770660257381312 - 0.09152435339028714im
  -0.25592172123590445 + 0.1301856722041323im
     0.256444556852199 - 0.0007179951568344611im
  0.057065680420908316 + 0.22097759874139095im
  -0.10842976094771441 + 0.04516703656397177im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Thursday 25 August 2022 16:39">Thursday 25 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0590811-0.301978im     -0.103318+0.0230052im       0.215028-0.0271455im    0.0727987-0.050511im     -0.0875735+0.116715im       0.110931+0.138073im        0.135495-0.086951im     0.0419694-0.0610581im    -0.112171+0.00667287im    -0.217373+0.273522im     0.00630854+0.0808689im    0.0270994-0.110753im      0.0531121-0.175531im      0.0555861-0.11195im        -0.151736-0.0347524im   -0.0893116-0.227755im     -0.0958229+0.116889im     -0.0154343+0.129548im      -0.103484+0.106302im       -0.102634+0.0637099im    -0.0982653-0.239358im    -0.00980588+0.107695im    -0.065726-0.0210654im      -0.292546+0.0466047im    0.107194+0.0522814im    -0.0639566+0.122891im    -0.0219041-0.225333im    -0.0384727+0.0325536im     0.193587+0.126992im      -0.0533864-0.206101im     -0.0303555+0.00467787im     -0.18095-0.0124584im
   0.0108775+0.0266239im    -0.149369-0.411746im       0.0880246+0.100235im     0.0859464-0.034475im        0.14114+0.19017im      -0.0335795+0.0181782im      -0.104929-0.0352032im   -0.0348964+0.0548486im    -0.018533-0.0349608im    -0.0823195+0.0881334im      0.122627+0.0970382im   -0.0896087+0.0304753im     0.0910488+0.0105609im     -0.048846-0.0692148im      -0.146826-0.053081im     0.0202003+0.161914im     -0.0404721+0.141109im       0.102896-0.163045im      0.0782333-0.0891704im      -0.235974-0.312604im       0.177438+0.14846im        0.161044-0.0740062im   0.0221707+0.241303im      -0.0751752+0.265495im     0.193204-0.113318im       0.119193-0.070749im    -0.0315867-0.0365957im  -0.00139567+0.0534123im    -0.164518-0.00933132im      0.120404-0.0221797im    0.00372776-0.074115im      -0.108413-0.104261im
  -0.0375194+0.0859804im   -0.0268748-0.219196im       -0.135192+0.0352144im    0.0787109-0.0269609im      0.147349+0.0495449im    -0.0470919+0.0108006im      0.0249244+0.054456im     -0.131046+0.024656im    -0.0679849+0.245425im       0.019568+0.0329483im     0.0645976+0.184004im     0.0604127+0.358614im      0.0297927+0.163289im      -0.194844-0.140151im       0.0776024-0.108716im      0.060976-0.232236im      -0.259685+0.0425642im     0.0570457-0.0162138im     0.0157231+0.0708502im       0.178626-0.108787im      0.0781201-0.150091im       0.088702-0.0526302im   0.0278738-0.0263835im     -0.0143714-0.0903047im    -0.20372-0.179028im      -0.219803-0.0930693im   -0.0188498-0.0445591im    0.0914912-0.0550423im     0.302441-0.0112603im      -0.197709+0.0593648im    -0.0718714+0.0570241im    -0.0173918+0.113086im
   0.0239519+0.28006im       0.030412-0.0253995im       0.311093-0.220279im    -0.0108703-0.271335im     -0.0689452-0.148852im     -0.0794567+0.00328392im    -0.0246288+0.189494im    -0.0608771-0.142736im     0.0955354+0.133956im        0.12569-0.0467845im    -0.0935444+0.112418im     0.0960972+0.0833396im     -0.180464+0.00298923im     0.208743-0.0679905im      0.0582388+0.05978im       -0.20146+0.0894513im      0.066469-0.0381702im      0.021714+0.117794im    -0.00991353+0.125877im      -0.0528362-0.145323im      0.0799344+0.0185412im     0.0200558+0.166984im   -0.0276245+0.117913im      -0.0159392+0.0691674im   -0.088195-0.0844492im     -0.247699+0.198839im    -0.0358758-0.0167682im     0.208077-0.0432705im  -0.00824529+0.0690285im       0.191398-0.163893im     -0.0414165+0.0615971im    -0.0172497-0.190071im
   0.0569169+0.0707573im    -0.166956+0.0626832im      0.0146346-0.0438937im     0.115489+0.124583im     -0.0870593-0.106245im     -0.0529317+0.298335im        0.130862-0.255125im     -0.209338-0.10015im     -0.0474043-0.112989im       0.164761+0.149241im     -0.0593865+0.145667im     0.0787073+0.19069im       -0.135603+0.0441923im     0.0625861-0.018555im      -0.0975558-0.155667im    -0.0943916+0.21849im        -0.16292-0.151684im      -0.227835-0.0739051im       0.14838-0.030902im       0.0589839+0.0970372im    -0.0195759+0.10744im       -0.214043-0.164641im    0.0398973+0.0960243im      -0.119576-0.0306014im    0.153567+0.110782im     -0.0401534-0.172005im     -0.231583-0.0217958im   -0.0691706-0.128533im    -0.0259937+0.000930509im    0.0657106-0.0178665im    -0.0949208+0.0986767im      0.105793+0.063842im
    0.180411-0.05212im      -0.222025-0.0398701im      -0.101358-0.0113431im    -0.035226-0.151744im      -0.126927+0.276469im      0.0104699-0.455727im       0.0905715-0.00275041im   -0.015627+0.040421im    0.00412162+0.124514im     -0.0199571+0.0197688im     0.0397103+0.0055073im   -0.0663362-0.0713501im   -0.00256885-0.0842422im      0.139507-0.0181714im      -0.121107+0.0658697im   -0.0419156-0.0515917im    -0.0569236-0.198056im      -0.326497-0.0713343im     -0.254967+0.0318987im       0.229354-0.00305454im    0.0824347+0.0794093im     0.0437708-0.0257505im  0.00358483+0.132905im     -0.00538851+0.0691967im   -0.125715+0.0563531im    -0.0430176-0.025095im     -0.111774-0.10897im      0.0175398-0.121274im     -0.193288-0.0541921im     -0.0540296+0.0806064im     0.0918703+0.24558im       0.0174821+0.0210442im
    0.276547+0.0257118im    0.0203164+0.293974im      -0.0342925-0.0266346im    0.0137055+0.0822831im     0.0898211-0.125399im      -0.181983-0.0537276im      -0.282346-0.363342im    -0.0790404-0.0640538im    0.0501583+0.0984722im    -0.0257592+0.00310072im    0.0762504+0.239951im     -0.251503-0.0759612im     0.0903211-0.0309805im      0.121456+0.0523366im     -0.0709511+0.0298627im     0.084578-0.142225im       0.106583+0.0318968im      0.291092-0.0814525im     0.0318643-0.0934908im    -0.00186823+0.0593238im     0.0152906+0.0583256im      0.149842-0.123497im    0.0693455-0.00148108im     -0.185378-0.074569im     -0.17055-0.143217im     -0.0858153+0.0601439im    -0.043236-0.171849im      0.018388-0.0692759im   -0.0666455-0.00713022im     0.0231531-0.0778583im    -0.0101392+0.00904263im     0.150539-0.076984im
   0.0589484-0.112367im     0.0762359-0.0671428im      -0.176208-0.048539im     0.0484762-0.0152711im    -0.0645206+0.0473128im     0.0531169+0.00820953im     0.0255166-0.0941744im   0.00630255-0.250418im     0.0805834+0.0231189im   -0.00135528+0.182533im      0.0314707-0.435057im    -0.0530458+0.0178481im       0.08506-0.0880425im      0.164862-0.119901im         -0.1531-0.0982875im   -0.0745423-0.0398236im     0.0417314+0.0759139im       0.08126-0.0515672im       0.22117-0.0709646im      0.0261473-0.10911im     -0.00125678-0.104874im      0.0274159+0.120357im     0.139292+0.0265091im      0.0417906-0.183917im    -0.120139-0.138403im      0.0468526-0.168657im    -0.0283651+0.27589im       0.144293-0.0534309im     0.129418+0.0262037im       0.299143-0.0415103im      0.122674+0.267817im    -0.00476807-0.00329813im
  -0.0325028-0.116761im     -0.162823+0.163048im        -0.18584+0.104601im      0.116156-0.037285im      -0.291789+0.00647805im    -0.103018-0.135986im        0.101571-0.0514217im      0.21652+0.163692im     0.0136023-0.246367im       0.160397-0.0862051im      0.132789+0.0542315im   -0.0117247+0.243839im     -0.0147477-0.0692666im     -0.129484-0.00535614im     0.0193703+0.0593664im    -0.108548+0.015972im    -0.00366324-0.153682im       0.267695+0.00450001im    -0.105458-0.129531im      -0.0483691-0.110319im      0.0320494-0.145933im       0.118741+0.185869im     -0.16789-0.0148025im       0.152405-0.0192251im    0.152241-0.0216571im    -0.0890328-0.0756408im    -0.173388-0.0879248im     0.084254-0.0560244im    0.0921362-0.116888im        0.189477-0.15725im       -0.129876-0.105973im      0.0365725-0.0271022im
    0.128939+0.0895961im    0.0149143+0.00422748im    -0.0299655+0.0213242im    0.0106653+0.0800325im   -0.00933423-0.0109893im     -0.119904-0.0968248im      -0.111017-0.0791465im    -0.109422+0.195368im      0.225092-0.0125019im     -0.112125-0.264799im     -0.0350346-0.119506im    -0.0343771+0.137386im     -0.0302093-0.0569499im     -0.081897-0.151164im      -0.0209076+0.106895im    -0.0544012-0.0608496im     0.0247018+0.231177im      -0.267775-0.103053im      0.0758163+0.25152im       -0.0417032+0.0549849im      -0.13677+0.0102451im    -0.0285926+0.265492im     0.135027+0.10882im        -0.132002-0.0615446im      0.1228+0.0132682im      0.141235-0.108314im      0.065952-0.0555439im       0.1331+0.206819im   -0.00694222-0.0692689im     -0.0491841-0.230202im      -0.316837+0.0584326im     0.0859726+0.123966im
   0.0423478-0.173223im    -0.0167694+0.0122347im       0.136917-0.0459484im    -0.018979+0.144256im      0.0225579+0.0801235im    0.00842012-0.0383045im     -0.0653313-0.104368im     -0.408552-0.0588803im    -0.135241+0.137828im      -0.178165-0.0952844im    -0.0352208-0.167918im      0.218314+0.100868im      -0.217971+0.179039im      -0.029308+0.104028im       -0.111345+0.190121im     -0.119447-0.16234im       0.0881769-0.181027im       0.136704+0.180434im     -0.0423175-0.189581im      -0.0819013-0.100226im       0.131688-0.0173345im      0.114173-0.0164712im  -0.0361839-0.090826im       0.0701937-0.0526191im   0.0283568+0.121218im       0.104506+0.0461246im   -0.0455325+0.0227069im    0.0463646+0.057174im     -0.116211-0.0111914im        0.09511+0.153179im      -0.276449+0.034418im      -0.120948+0.128569im
  -0.0382715-0.0815409im   -0.0452721-0.0211503im      0.0430831+0.111957im      0.186356-0.197516im      -0.077271-0.160329im       -0.11861-0.0547016im       0.162081-0.0110676im   -0.0516988+0.104566im      0.009736+0.246309im      0.0833679-0.113984im     -0.0985489-0.16224im     -0.0607942-0.30005im        -0.29672-0.175969im      0.0170479-0.165641im          0.1255-0.178392im       0.07478+0.0881226im     -0.084395+0.0918854im      0.150884-0.0782471im     0.0731961-0.206106im      -0.0558791-0.0552489im     0.0621203-0.0669397im     0.0730406-0.0171467im    0.152565-0.0458969im      0.0200085-0.0459365im   0.0119802+0.137021im     0.00757932-0.0807802im    -0.168146-0.0732963im   -0.0901676+0.133235im     0.0286884+0.0946224im      -0.268299+0.101817im      -0.151056+0.0782937im     0.0881384-0.20047im
  -0.0628941+0.0241781im    0.0297872+0.0123181im      -0.189782-0.0331064im    0.0533072-0.0523594im     -0.148531-0.207219im      -0.100214+0.0830209im      0.0468221-0.252938im    -0.0771565-0.0504847im    -0.033125+0.158481im     -0.0722507-0.0351329im     0.0132953+0.0104731im   -0.0161746+0.0697871im     0.0713184-0.364726im      -0.287166+0.127883im    -0.000321616-0.0207519im   -0.0949019-0.0297226im    -0.0585035-0.130462im      0.0685255+0.13827im       -0.188169+0.120675im          -0.131-0.0169595im      0.158555+0.146598im      -0.151835-0.0634502im  -0.0309995+0.13729im         0.039911+0.136286im    0.0654061-0.00697485im     0.104897+0.0325834im     0.346714+0.164591im      0.161215-0.0244688im    0.0123339+0.0165667im      -0.152975+0.00039076im    0.0802724+0.198696im      -0.100382-0.119615im
   0.0896924+0.170582im     0.0582065-0.0162789im      0.0112865+0.036471im    -0.0471328+0.0507761im    -0.0718983+0.0219508im     -0.107786+0.0231469im       0.015728+0.0426098im    0.0830981-0.166381im      0.168029-0.0221491im      0.159117-0.0265738im     0.0763216-0.00991887im    0.349286-0.127984im      0.0936427+0.032199im      0.0270247-0.311044im         -0.2688+0.17638im      -0.128894-0.198831im     -0.0674502-0.0596363im      0.136978-0.0780772im     -0.077163-0.0278613im     -0.0943924+0.0208693im    -0.0582232+0.184163im     -0.0763428-0.0471475im  -0.0587474-0.170851im       0.0575945-0.0863758im     0.20205-0.130126im      0.0338235-0.192799im    -0.0525947-0.131076im      0.150445+0.0632241im   -0.0823638+0.183888im       -0.256886+0.106811im       0.172222-0.0658189im    0.00639086+0.0120465im
  -0.0388707+0.0538437im    0.0427688+0.0947441im      -0.142693+0.133919im    -0.0496979+0.240348im     -0.0576032-0.00995274im  -2.53451e-5-0.134271im       0.0215221-0.00858049im   -0.137357-0.0707762im    -0.130286-0.00491078im   -0.0375072+0.0926664im     0.0221007-0.0499642im    0.0110724+0.0210148im     0.0334333+0.142799im       0.119825-0.188432im      -0.0203637-0.170673im      -0.15673+0.254343im       0.103759+0.288154im     -0.0450585+0.0721827im     -0.254169+0.0284504im     0.00723236+0.0233937im    -0.0780028-0.289809im     -0.0540008-0.074562im    0.0345366-0.111197im       0.0418291+0.224851im   0.00770727-0.109871im    -0.00325516-0.0233196im     0.141707-0.0496535im     0.197633-0.230422im      -0.11216+0.0253088im     -0.0512634+0.135146im        -0.2002-0.101022im      0.0600209-0.269867im
    0.038052+0.135949im     0.0988911+0.153617im       -0.039383+0.0060584im    0.0958416+0.107425im       0.106413+0.192155im       0.043989+0.149267im        0.157808-0.0639046im   0.00190802+0.17503im       -0.14886-0.0497922im      0.132602-0.165327im      -0.162202+0.00974411im   0.0858335-0.121583im      0.0151918-0.0415356im    -0.0156665-0.0619993im       0.143808-0.131287im     -0.187924-0.345299im     -0.0561911-0.000256295im   0.0115546-0.103023im       0.041349+0.0250511im       0.100115+0.088757im        0.02833+0.0573337im     0.0557956-0.0859538im    0.278605-0.0601391im       0.132153+0.31535im    -0.0767135+0.0273654im    0.00255668-0.0359483im   -0.0244848-0.107976im     0.0845049+0.113037im    -0.0527459-0.110911im        0.295612-0.060161im      0.0832683+0.0356826im     -0.241448-0.126835im
   -0.100686+0.01202im      0.0709985+0.0891359im      0.0254629+0.0262602im    -0.190246-0.224453im     -0.0379728-0.0122847im    0.00445031+0.0356026im      0.0119107-0.185547im     0.0098524+0.123957im      -0.14183-0.0157891im      0.140478+0.037658im      0.0671814+0.0661786im    0.0265795-0.146212im      0.0768312+0.00861726im  -0.00988182+0.0418077im     -0.0199382+0.00264822im   0.0291691-0.0838499im     0.0794216-0.310038im      -0.163915-0.252634im       0.257492+0.0775468im      0.0043097-0.336882im     -0.0461511-0.204865im      0.0564865+0.118393im     0.025835-0.150309im       -0.132754+0.168125im   -0.0264911-0.00377752im     0.061484-0.0510513im     0.194912+0.0497595im     0.109327-0.120833im    -0.0401821+0.299407im      -0.0158801+0.105428im      -0.180905-0.0802578im     0.0883272+0.119094im
    0.176046+0.0322191im   0.00906588+0.187351im       -0.110506-0.0825356im    -0.216335-0.0823459im      0.030702-0.0754498im    -0.0580897-0.155772im       0.0740425+0.182779im     -0.125195+0.250224im      -0.26056-0.0873985im    -0.0450835+0.0305241im    -0.0383717-0.128362im     0.0202113+0.117856im     -0.0245877-0.0870942im      0.100518+0.228017im       -0.175394+0.0194865im    -0.103386+0.139322im      -0.034511+0.20994im        0.100841-0.124328im      0.0790574+0.00906352im      0.140496-0.121309im      -0.104699+0.238328im       0.042427-0.197257im   -0.0660912-0.00678273im    -0.0658464-0.0728786im    0.154342-0.00171069im    -0.162887-0.0626559im    0.0722831-0.0201182im   -0.0155252+0.114655im       0.24705+0.21209im        -0.020721+0.00996532im   0.00677517+0.00393648im     -0.22252-0.053185im
    0.172073-0.0356633im     -0.15381+0.253378im          0.2063+0.135696im    -0.0054504-0.0385283im     0.0043247-0.0891592im     0.0528933+0.027274im      -0.0131059+0.0665369im    0.0814625-0.0789328im    0.0370527-0.0105051im      0.113344-0.0720571im   -0.00497423-0.0703206im   -0.0616131+0.119608im     -0.0143835+0.0439848im    -0.0309983-0.165323im         0.25811-0.0962512im   -0.0840157+0.150731im      -0.147754+0.0339718im     0.0462903+0.0579555im    -0.0392173-0.166924im        0.107445-0.133542im     -0.0392083+0.0297811im    -0.0444477+0.0257132im   -0.203786-0.0569945im      -0.202756+0.0648948im   -0.157431-0.258823im       0.308283-0.060192im      0.187888-0.0951853im   -0.0797581+0.0754523im    -0.127089-0.00202777im    0.00843096+0.0512256im     0.0443502+0.193294im      -0.246884+0.250393im
 -0.00245109+0.100932im    -0.0726648+0.118053im       0.0837991-0.114748im     0.0486256+0.255414im      -0.242552+0.170823im      -0.165247+0.157897im        0.075208+0.267988im     -0.181825+0.0775618im    -0.157477+0.211312im       0.106191+0.174811im        0.19284+0.0657416im    -0.181356-0.0969749im     -0.107411-0.0832626im     -0.127188+0.0995691im    -0.00955855-0.0835873im    0.0043677-0.0698825im     0.0353477+0.149843im      -0.131948-0.0850141im   -0.00760126+0.0692333im     -0.0839058-0.129754im      0.0709301+0.0530663im      0.136362+0.105408im    -0.120946-0.304764im       0.0444736-0.156505im    0.0389092-0.0740872im     0.0579891-0.00537787im   0.0312245+0.101982im   0.000725244+0.0250402im    -0.152391-0.107511im      0.00909037-0.135096im       0.157575+0.0325663im       0.15208+0.0351634im
   0.0900532-0.105284im     0.0601401-0.14451im       -0.0590649-0.322018im      0.126837+0.118683im      -0.057286-0.0408566im     -0.210075+0.0307105im      -0.107579-0.00851141im    0.206524-0.0052783im    0.0705347+0.0243982im      0.191792-0.0182993im     -0.231317+0.135868im      0.174031+0.0577762im    0.00890693-0.236641im      0.0252934+0.0617024im       -0.15584-0.0702017im   -0.0585486+0.0398494im    -0.0870103+0.143376im     -0.0876121-0.0371118im     -0.109532-0.105462im        0.135953+0.1044im       -0.0102128-0.136878im       0.324066+0.071236im    0.0488456+0.0112379im     0.00748983+0.0257375im   0.0232133-0.0917886im    0.00186626+0.100224im      0.120004+0.158317im     -0.212407+0.0039118im    -0.119659+0.118854im       0.0572231+0.236189im      -0.143341-0.0934231im    -0.0788824+0.151996im
   -0.285182+0.0787031im    0.0128924+0.248691im      -0.0339007+0.0181756im    -0.112472-0.108291im      -0.142479+0.0586875im     0.0571095-0.11861im         -0.11283+0.0432851im    0.0155497+0.00280211im    0.137856+0.104679im      -0.148372+0.0549138im    -0.0605458+0.109496im      0.176782-0.0423137im     0.0859591-0.150887im      -0.060105-0.231897im      -0.0458726-0.0488145im    0.0566449-0.0502869im     0.0021829+0.152414im     -0.0980862+0.0686032im      0.303647+0.000696045im    0.0657238+0.144849im        0.35959+0.0649898im     0.0918659-0.224439im    -0.276111+0.00591975im    -0.0324858-0.0720441im  -0.0455078+0.0592448im     0.0767867-0.133119im    -0.0308126+0.0423193im   -0.0643362-0.118933im    -0.0270181-0.0421798im       0.137891-0.0577683im     -0.187726-0.0870649im     -0.126039-0.0592203im
    0.122343-0.00236362im   0.0775354+0.00541318im    -0.0180119-0.00589118im   -0.014526-0.040594im       -0.10384-0.0278233im       0.14155-0.124279im       0.0989738-0.0621155im   -0.0813722-0.239007im    -0.0131721+0.0590715im   -0.00642148-0.0877785im     -0.139167+0.110054im    -0.0101657+0.179955im       0.208436+0.0313282im     0.0155897+0.0347341im       0.196415+0.169016im     -0.155844+0.0269155im      0.197473+0.0386599im    -0.0216956-0.136917im       0.119894+0.184419im       -0.140503-0.058475im        0.16304-0.250404im      0.0643406-0.0771739im   0.0064007-0.147381im       0.0653422+0.0664578im    0.235609-0.0546605im    -0.0787707-0.108923im    -0.0276205-0.053164im     -0.432422+0.197395im    0.00234077-0.0500572im     -0.0563776+0.0626052im      0.123718+0.189038im      0.0726805-0.0761238im
   0.0173313+0.110371im      0.282149-0.136223im        -0.15516+0.0998327im   -0.0493523-0.196946im      0.0719233-0.184667im     -0.0508802+0.00164181im     0.0136198-0.137115im      -0.13534-0.0308718im     -0.02284-0.177626im       0.275475+0.202492im      0.0777889-0.104799im     0.0318282-0.046811im       0.090917+0.0061225im   -0.00928166+0.141633im       0.0967984+0.0620636im     0.194914+0.0516413im     -0.099521+0.141842im      -0.189008+0.141923im      -0.183992+0.0327993im      -0.101447+0.0628402im       0.15476-0.0342746im      0.237069+0.0136416im  -0.0890987-0.196882im          -0.102-0.0734452im   0.0119845+0.0991691im     0.0688426+0.0402391im    -0.206726-0.20672im       0.155353+0.099574im    -0.0791818-0.0409806im      0.0836238-0.0228552im    -0.0215714+0.118734im      -0.181775+0.0666262im
   -0.119757-0.139601im     0.0672115-0.142518im        0.106055-0.0771057im    0.0641447+0.020418im      -0.090096-0.0770786im    -0.0666852-0.253877im        0.122669-0.147125im     0.0498988+0.0404768im    -0.154013-0.0834316im     0.0978567-0.0200713im     0.0620847+0.265721im     0.0796163+0.0702518im     -0.146467+0.148118im     -0.0380794+0.120903im        0.121026+0.221027im    -0.0725193-0.187479im     0.00287504+0.316361im     -0.0949621-0.0612326im      0.116406-0.140449im      -0.0756115+0.0212664im     -0.112272+0.0198776im     -0.171651+0.0204314im  0.00864411+0.103901im       0.0195845-0.184908im    -0.179477-0.0193625im      0.288095-0.0788386im    0.0105221+0.0180878im  0.000567478-0.162127im    -0.0408747+0.180271im       0.0312266-0.0340811im      0.128968+0.0609489im    -0.0781736-0.23271im
   -0.169377-0.303442im     0.0248308-0.0891671im   -0.000660853-0.0503208im    -0.367878+0.130581im       0.171344-0.148432im      0.0950259+0.124612im        0.125422+0.0324531im   -0.0807744+0.0560872im     0.237451+0.0225338im     0.0783174-0.109039im      0.0478514+0.0876im       0.0400222-0.101124im     -0.0197444-0.0927398im      0.074042+0.15037im        -0.064567-0.0877606im   -0.0132437-0.0328149im     0.0112462-0.0865724im     0.0141957+0.0318511im     -0.142584+0.0852479im       0.100378-0.138239im    -0.00626028+0.0549554im   -0.00379115+0.102486im    0.0318186-0.0354136im      -0.038387-0.0812381im  -0.0278266-0.28183im      -0.0815653-0.314288im    -0.0725292-0.0450161im    -0.146671-0.0677942im    -0.141269-0.159565im      -0.0369003-0.144932im      -0.139662+0.0518461im     -0.135024-0.222843im
    -0.15302-0.0860399im   -0.0740788-0.0803605im      -0.178052-0.0481766im    -0.253564-0.0409473im     -0.154941+0.167336im      0.0489331+0.218467im       0.0111073+0.019397im     0.0654184-0.0362712im   -0.0700615+0.207956im      0.0628541-0.0202828im     -0.113363-0.0742107im    -0.130518+0.140371im       0.240753-0.0223341im     -0.143669-0.00452407im     0.0936819+0.132231im    -0.0485687+0.0669918im    -0.0252341+0.154233im       0.124758+0.00392484im     0.116033-0.152524im       0.0611165+0.0421167im    -0.0780546+0.0690489im     -0.175477+0.0504985im   0.0941235+0.0279497im    -0.00896616-0.109539im   -0.0314866+0.0843854im     -0.200257+0.173045im    -0.0583087-0.261262im     0.0918846+0.0682261im    -0.400552+0.199404im       0.0325387+0.00756298im    -0.105015+0.0620679im     0.0237521+0.0364689im
    0.182429+0.105019im    -0.0153834+0.0183412im      -0.194095-0.0419473im    -0.118388-0.0813052im      0.267344+0.0276276im      0.090379+0.153743im    -0.000347598+0.0108061im    0.0663981+0.0618816im    -0.203981+0.022188im      -0.133179+0.0726986im      0.026049+0.223345im     0.0424208+0.0866237im     -0.187394-0.233534im       0.151948-0.21865im        0.0910324+0.139887im      0.082716+0.00279331im    0.0238162+0.0603962im      0.132855-0.0652088im    -0.0580107+0.0162003im      -0.173946+0.0488387im     -0.121123-0.0423705im    -0.0447085+0.259522im    -0.220531-0.0213376im   -0.000886207-0.0018563im  -0.0868511+0.252123im     -0.0456324-0.253652im     -0.024393+0.189606im     0.0093149-0.0129388im    -0.160888-0.11202im        0.0398906+0.20205im     -0.00795328+0.0956125im    -0.0169066-0.0212745im
  0.00491927-0.0812979im      0.04068-0.0446334im     -0.0122727+0.283025im    -0.0335122-0.00890892im    0.0243218+0.0129406im     -0.188178-0.115054im         0.20059+0.197934im    0.00759431-0.119145im    0.00378197+0.153141im      0.0499247-0.103474im       0.056391+0.164195im    -0.0547401-0.00653556im    0.0632739+0.123446im    -0.00332787+0.195809im       -0.284892+0.0508381im   -0.0726154+0.152604im      -0.153238-0.056343im       0.151144+0.0111909im      0.164889+0.0204366im     -0.0651597+0.40297im       0.0663945+0.00709876im   -0.0284468+0.1699im      0.0261985-0.174718im       -0.192156+0.2776im      -0.148983+0.0569681im     0.0345844-0.067532im    0.00161494+0.17863im      0.0272988+0.105853im     0.0240547+0.0510245im      0.0886566-0.0702756im    -0.0638283+0.0784599im     0.0119526+0.0288558im
    0.204349+0.0511434im   -0.0320683-0.0995746im     -0.0264627+0.186477im     -0.161511-0.0625015im     -0.192571+0.0866013im    0.00545148+0.0708448im     0.00920944-0.203853im     0.0193911+0.0855211im     0.132474-0.0412329im    -0.0143414+0.382701im      -0.149659-0.01826im      0.0561418-0.0111991im     -0.049754+0.126873im      0.0238437+0.0448554im       0.124798-0.0283428im    -0.118315-0.0873472im    0.00660399+0.0612515im     0.0321913+0.0404155im     -0.128471+0.0314583im    0.000112016-0.0206332im    0.00453087+0.233707im    -0.00799047+0.0202077im   -0.094304-0.0248545im       0.241861+0.124272im    -0.301613-0.0659311im    0.00358066-0.0154537im   -0.0110873+0.199978im     -0.205764+0.227532im     0.0403438+0.152021im      -0.0689698-0.16358im       -0.215259-0.119417im       0.136914-0.0288981im
   0.0309087+0.110121im      0.132633+0.0851017im       0.186323+0.212099im    -0.0559225+0.0302651im     -0.209038-0.084823im       0.219223+0.120184im        0.111026+0.0532086im    0.0109853+0.14772im     -0.0207853+0.154913im     -0.0421498+0.0574328im     0.0498595+0.172595im    -0.0906279+0.0592666im      0.160467-0.101752im     -0.0166566-0.0587043im     -0.0599194+0.234701im     -0.114293+0.160558im     -0.0106892-0.0886368im    -0.0429771+0.165624im      -0.110386-0.0305052im      0.0183141-0.0366282im     -0.118933-0.0635761im      0.290294-0.114355im     0.359181+0.203755im      -0.0332831-0.207714im   -0.0993467+0.0367603im      0.129525-0.154351im     -0.100352+0.117227im     0.0811257+0.0791402im     0.038945-0.0222585im       0.023697+0.122225im       0.052791-0.154836im     -0.0415358+0.0126764im
    0.120336+0.0938131im    -0.173618-0.0136092im     -0.0869983-0.145871im    -0.0111162+0.216351im     -0.0413482-0.110701im      0.0170865+0.0129662im      -0.180141-0.0448164im     0.235983-0.123862im     -0.061929+0.225545im     -0.0292578+0.0614366im     -0.157058-0.140609im      0.123554-0.0798354im    -0.0703279+0.118568im      -0.224261+0.140936im      -0.0429954+0.181529im      0.134235+0.132995im     -0.0972486-0.093745im     -0.0258684-0.0740354im     0.0453669+0.100186im        0.199271-0.14137im      -0.0465793-0.218018im      0.0041544-0.0167443im   -0.125983-0.0104198im      -0.117975+0.111233im    -0.102262+0.119025im       0.126988-0.142816im     -0.157537-0.0500712im     0.113548+0.178886im     0.0210155-0.0442091im    -0.00150454-0.145993im      0.0910433-0.116835im      -0.102742-0.295953im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.05490846677239014 - 0.08383720921661686im
    0.07649071731242177 + 0.20327693126285615im
  -0.031055785571157807 - 0.000455708510866763im
   -0.08715447050856336 + 0.06864425516372435im
    0.21156342215156032 + 0.13153626735337148im
   -0.22198007642578813 - 0.26998906849224474im
    0.07523836482567231 - 0.10843714081664496im
    0.06767981326382075 + 0.09891821257808085im
    0.14279612471567868 - 0.20240341872073064im
    0.03481470156743367 - 0.12540601449853478im
    -0.0684152156990235 - 0.11614186950335458im
  -0.006801477255145145 + 0.035451571565548935im
   -0.05624236092918126 + 0.0895276681561012im
  -0.011760262053423723 + 0.07817903532009052im
   0.055992943966229704 - 0.034431730932694346im
   0.006078605242219783 - 0.10823149691297058im
    -0.2057290509010916 - 0.005401729575342669im
   -0.09554357600714412 - 0.15521635151940305im
    0.25340512657744746 + 0.14834916107076077im
    -0.0987810182574934 + 0.014915213021459746im
  -0.043100421290702906 + 0.1426269663438073im
   -0.05867649069817369 + 0.11878628393694847im
   -0.13044597071365577 - 0.08766203798820067im
  -0.019813754622599843 + 0.07601127361954142im
    0.16638780341303275 + 0.13192567737330957im
    0.40935167678826656 + 0.0im
   0.061376038462442266 - 0.04283136957758235im
    0.04202633338240061 + 0.1287316220116208im
  0.0012477046321332347 + 0.04102306394456902im
     0.1896639357670377 - 0.1635796093702716im
     0.1275722317672962 + 0.10311563404002075im
 -0.0046558234166599296 + 0.1090157814200921im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 15 May 2023 16:22">Monday 15 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

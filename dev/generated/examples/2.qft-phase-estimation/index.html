<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.396855-0.179827im       -0.12261-0.0416509im    -0.0741396+0.0327804im     -0.0154954-0.0715917im      0.0817974-0.148548im      0.121117+0.173588im     0.0315557+0.0961903im   0.0242498+0.162982im     -0.0409004+0.0524169im    -0.0571391+0.0186957im         -0.12+0.168518im      0.0903212-0.120392im     -0.087425+0.0955379im     0.0657274+0.0186007im      0.161511-0.02602im        0.197622+0.185896im     0.0840388+0.153483im       0.151388-0.208188im     0.0800565+0.0420341im     0.0232324-0.103836im     0.0310864-0.0310587im   -0.0686133-0.0747366im      0.179101-0.11714im        0.156038-0.119137im    -0.0274263-0.054306im       0.0739538-0.122107im       0.142143+0.0436613im   -0.160714+0.302828im       0.195579+0.167217im     -0.0665764+0.0099286im    -0.148178+0.0702878im    0.0160325-0.0253547im
  0.0878592-0.0754486im      0.442474-0.166603im       0.203852+0.239571im      -0.0648371+0.13996im         0.136977+0.0104282im    -0.119959+0.0444522im    0.0384235+0.111198im    0.0872664-0.112078im      0.0751878+0.082776im      0.0304626-0.0553241im    -0.0215862-0.025988im      0.0492062-0.172669im      0.183053-0.0995158im      0.128563-0.0800687im      0.188122+0.190411im      -0.127041+0.0222788im    0.0646827-0.0722966im    -0.0863375+0.0451491im     0.168414+0.00453108im    0.0730782-0.0369592im   -0.0031315+0.126047im    -0.0793056-0.01898im        0.180734+0.106476im     -0.0239457+0.172769im    -0.0643769+0.00617017im   -0.00372942+0.0593037im    -0.0752986-0.0423643im   0.0137599-0.0546159im      0.291565-0.0973016im     -0.028257+0.210026im     0.0131695+0.163244im      0.175196+0.0180983im
 -0.0985329+0.14823im       0.0898493+0.0214379im      0.164443-0.328655im       -0.102313-0.082268im        0.265297+0.0310196im     0.121356-0.141576im    -0.0898241-0.0226649im   -0.131612+0.105943im     -0.0740585+0.0392078im    0.00659255+0.0923202im     0.0258071+0.159484im       0.133163-0.109579im   -0.00764855+0.286829im      0.0324524-0.141728im      0.0795515-0.0445024im    -0.0206481-0.21892im      -0.141228-0.00951361im    -0.185268-0.220155im    -0.0552898-1.1732e-5im     0.0452139+0.0512989im     0.117171+0.205229im     -0.161308-0.00532655im     0.240869+0.0502525im   -0.00342655+0.0997884im     0.195454-0.00392769im    -0.0894523-0.107078im       0.216363+0.0294307im  -0.0385918-0.0629545im     0.0127194-0.139654im      0.0316636+0.0235509im   -0.0702193-0.133746im    -0.0973535+0.0733881im
   0.115582+0.106135im     0.00377744+0.0248449im    -0.0303326+0.0934113im       0.314779-0.30654im         0.265307+0.0626043im   -0.0705632-0.047185im    -0.0725686+0.0683898im   -0.340495-0.0989449im  -0.000328601+0.00707973im    0.0365192-0.054464im      -0.164489-0.00575235im   -0.0449683-0.0851593im     0.115055-0.0701802im      0.036104+0.110748im      0.0693214-0.0565362im     0.0368442-0.0826452im     0.109815-0.0431851im     -0.186852-0.249256im     -0.185443-0.0614443im      0.183452-0.0253133im   -0.0864916-0.19784im       0.145283+0.172116im      -0.114341+0.0271742im    -0.0656372+0.053496im     0.0342987-0.031198im      -0.0902451+0.102588im     -0.0228124-0.122706im      0.01361+0.134696im      0.0198359-0.0799374im     0.0809243-0.135809im     0.0585183+0.205529im     0.0468559-0.173507im
  -0.136781+0.165287im     0.00734005+0.0430491im    -0.0106984+0.0657187im      0.0813529+0.113871im        0.290561-0.298363im     0.0363503+0.157073im      0.107854+0.157232im     0.162228-0.166229im       0.252626+0.0476807im      0.172863+0.167337im     -0.0538111-0.0557396im     0.0496705+0.179092im     -0.148881-0.0499406im      0.127983+0.048888im      -0.058142-0.00900611im    0.0117534-0.0657521im    -0.175529-0.0661466im    -0.0483149-0.0689816im   0.00158901+0.0284001im     -0.245116-0.132618im     -0.128391-0.181368im    -0.0971298+0.257104im     -0.0182806+0.127611im       0.143299-0.0187972im    -0.021508-0.0985116im        0.10546-0.0979416im     0.0996082-0.0817207im   0.0729496+0.0435531im      0.117822-0.0165666im    -0.0313099-0.131179im     -0.025307-0.201905im     0.0580361+0.0862046im
  -0.199541+0.0589214im    -0.0524383-0.114362im     -0.0817077+0.207293im        0.110928-0.0869378im      0.0807222+0.0368827im     0.288282-0.200606im    -0.0146969+0.0536418im   -0.115473+0.301438im       0.161556+0.149682im      0.0707312-0.0895239im    -0.0339504-0.0224325im     -0.106033+0.0821064im   -0.0565053-0.0411495im     0.0461913-0.154318im     -0.0167624+0.18248im       -0.117904+0.137498im      0.104299-0.213666im       0.178791-0.0570599im    0.0782579-0.12938im     -0.00322405+0.0336751im     0.286125+0.00723997im    0.127082+0.0213908im      0.074951-0.0596739im     0.0824396+0.0456825im   0.00674119-0.0585778im      0.0778645-0.200738im      0.0025111-0.127872im     0.179468-0.138019im     -0.0382474+0.0493617im     -0.236715-0.0330883im    -0.115923+0.138886im     -0.101599+0.024332im
  0.0569533+0.0374898im     0.0192203-0.00964085im     0.109596+0.028763im       0.0273972+0.0894663im     -0.0684333+0.0775855im   -0.0290908-0.0314252im     0.220476-0.0159948im   -0.182977+0.143698im       0.281404-0.041516im      -0.220947-0.128251im      0.0692422+0.130908im       0.114593-0.136771im     0.0826882-0.209476im      -0.309385-0.0346268im    -0.0235243+0.0855211im      0.140675-0.209036im     0.0925615+0.0975506im      0.178761+0.0346172im   -0.0235486+0.164066im     0.00994119-0.0829311im    -0.105959-0.248926im     -0.272109+0.0209713im     0.0191385+0.070746im     -0.0864047+0.131955im      0.139179+0.029619im    -0.000651119-0.0439927im     0.0246649-0.0383236im    0.093539+0.0705665im      -0.13922-0.131438im      -0.219253-0.0671231im    -0.154388-0.137539im     0.0622896+0.0368837im
   0.141469-0.00288341im    0.0300234+0.0112873im    -0.0446396-0.189754im      -0.0862168-0.201678im        0.136027+0.211418im     -0.211313-0.149918im    -0.0183557+0.109973im   -0.0427231-0.116303im    -0.00243749+0.0528419im    -0.0833732+0.220592im       0.280325-0.0804712im    -0.0615805+0.102271im     0.0327327-0.0952824im     0.0276656-0.220489im       -0.13457+0.0732798im      0.114928+0.0662422im       -0.166+0.0518554im      0.190228+0.145225im      0.125325+0.0175126im    -0.0514172+0.2238im       -0.176128-0.0920853im     0.127692+0.134827im       0.125457-0.0509384im      0.155526-0.0869136im   0.00464559+0.131949im       0.0449319-0.0804975im     0.0744815+0.117792im     0.121133+0.100045im       0.154361-0.178012im      -0.104879-0.0649448im   0.00662273+0.222032im    -0.0755221+0.0162707im
 -0.0760576+0.0256572im     0.0282487-0.0330392im     -0.146974-0.0498724im      0.0626433+0.0478882im      0.0174954+0.0416955im    0.0569374+0.0685553im   -0.0428747+0.0892887im    0.100923+0.0987487im      0.111323-0.342404im       0.111873+0.0727519im      0.225964-0.0659521im    -0.0044768-0.052087im      0.193928-0.0288342im      0.216191-0.000975717im    0.108824+0.0504074im       0.28767+0.163924im     0.0556669-0.0729614im     -0.239534-0.0101578im     0.168335+0.0716069im      0.275729-0.0312169im   -0.0147418-0.136194im     0.0358692-0.0474699im      0.125531+0.0794902im     -0.119989-0.192819im      0.178936+0.139151im        0.147512-0.0963968im    -0.0809323+0.0656175im    0.011866-0.162363im     -0.0872819+0.0343022im     0.0110172-0.0592476im    -0.100962-0.17667im     -0.0205664-0.245931im
  -0.121093-0.119803im      0.0764291+0.0786102im    -0.0624362-0.0691843im      -0.079999+0.0408552im      0.0755305+0.0827022im   -0.0657894-0.0248984im   -0.0127153-0.217189im    -0.104828-0.146877im      0.0531881+0.0525072im        0.1971-0.499522im       0.131957+0.103552im     0.00607992+0.0780345im   -0.0514603-0.214457im      0.0970782+0.061184im      0.0677908-0.122894im    -0.00083866+0.0782596im  -0.00339241+0.104088im      -0.060808-0.162517im     0.0711049+0.066344im     -0.0181573-0.076474im    -0.0604598-0.062181im     0.0250722-0.011328im     -0.0716554-0.0161471im      0.340488-0.0887041im     0.181201+0.0861343im      0.0281242+0.168032im      0.0469003-0.0219931im  -0.0684548-0.0841413im     0.0725818+0.0164648im    -0.0352335+0.140836im      -0.17707+0.0234282im    -0.262254+0.154543im
   0.196508-0.180088im     -0.0509224+0.13104im        0.171099+0.199696im      -0.0891817-0.147956im       0.0368652+0.0351702im     0.122132-0.122191im       0.04527-0.0813086im   -0.042178-0.128439im     -0.0188378-0.0149415im    -0.0149719+0.205723im      0.0440017-0.152588im      0.0857984+0.0411423im   -0.0778978+0.0225479im    -0.0362327+0.162233im      -0.284746-0.0182828im    -0.0442121+0.15832im     -0.0415728-0.00575485im    0.0309159+0.0402864im   -0.0884867+0.0289977im     0.0516842-0.274337im      0.140411+0.0230196im   -0.0840452+0.0717641im      0.180165-0.0504838im    -0.0489792-0.0964555im     0.173325+0.130703im        0.138845+0.073285im      -0.108129-0.336486im    -0.183405-0.200625im     -0.0237932-0.237478im      0.0976957+0.00896636im   -0.142861-0.00260134im  -0.0022612+0.05544im
 -0.0815747+0.0273987im     0.0989348+0.119771im     -0.0956042-0.0482813im       0.152529+0.134922im      -0.0659238+0.0866335im    -0.352686-0.0990858im     0.334508-0.0678179im  -0.0763912+0.231806im     -0.0105637-0.182149im     -0.0841012+0.137252im       -0.23188+0.0644545im      0.277728+0.0758196im    0.0773529+0.0594735im      0.248911+0.0745082im      0.154094-0.130466im     -0.0282742+0.0563163im    -0.028652-0.0624691im      0.146574+0.154114im    0.00547535-0.085399im     -0.0355656-0.146069im      0.126264+0.119688im     0.0169508-0.00113516im   -0.0148711-0.0321765im     0.0577038-0.124514im     0.0507842-0.0575063im     -0.0434596+0.0813568im     0.0399076-0.111907im     0.180572+0.058986im       0.112055-0.102207im       0.092717-0.0982251im   -0.0405246+0.0540476im    -0.175074-0.00664922im
  -0.048593+0.0341396im     -0.097817+0.187602im       0.112711-0.0104827im      0.0723743+0.0738742im      -0.171501+0.0606552im    -0.101463+0.143838im     -0.274807+0.166433im   -0.0720863+0.0757181im    0.00532474-0.0980865im      0.184753+0.103322im      0.0317395-0.0840141im      0.137461-0.12839im      0.0400049-0.209028im      -0.117104+0.0835572im     0.0267634+0.0674048im    -0.0788673-0.136346im    -0.0608909+0.0153432im     -0.218315+0.0171124im    -0.272094-0.218439im     -0.0773365-0.0809221im    0.0509921+0.0610992im    -0.122406-0.230278im      0.0659386-0.0335286im      0.265054-0.0853686im     -0.17568+0.104636im        0.236708-0.131871im      0.0297126+0.0559133im   0.0593613+0.0438704im   -0.00865147-0.0738362im     -0.140283-0.00704938im   -0.124264+0.21696im     0.00292365+0.00349186im
  0.0977056-0.133268im       0.117708-0.05652im      -0.0421645-0.154638im        0.238572+0.0894454im     -0.0616431-0.0233537im    0.0661468-0.00302655im   -0.101926-0.068996im    0.0538514-0.031055im       0.139455-0.0474826im     -0.130709+0.0326775im   -0.00412715+0.0639774im     -0.153575+0.175396im     -0.156872+0.0607601im      0.318899-0.125984im     -0.0164299+0.347218im      0.0253653-0.0493345im   -0.0876122+0.0946198im    -0.0540315-0.013526im     -0.149451-0.0685762im      0.139545-0.184807im     -0.110804+0.00295489im   -0.180165-0.0812874im    -0.0135502-0.209697im     -0.0395656+0.0189275im    -0.140435+0.0837657im       -0.17419+0.262504im       0.127296-0.0486846im  -0.0733434-0.114094im      -0.107065-0.013386im      -0.220344-0.174079im     0.0510599+0.0798367im   -0.0307629+0.0893701im
 -0.0405452-0.008925im       0.211807+0.0495666im      0.136504+0.219525im        0.106764-0.0638673im     -0.0114642-0.0797134im    0.0106413-0.0938999im     -0.18186-0.0267285im   0.0870174-0.0279174im   -0.00649237+0.0616175im    -0.0289049+0.00614376im    -0.161265-0.153362im      0.0543471+0.0331355im    0.0225699+0.0268927im    -0.0413053+0.0862268im     0.0715987-0.377602im       0.122398+0.0200604im     -0.15393-0.118773im    -0.00841176+0.0355655im     0.228665+0.138946im       0.132328+0.154423im     0.0070872+0.144739im     -0.106919+0.00240751im    0.0363675-0.204494im       0.202604-0.0449931im     0.086878+0.142864im      -0.0768364+0.0928537im   -0.00375128+0.0811827im   0.0678284+0.140688im       -0.29957+0.0241541im     -0.274074-0.197665im    0.00970436-0.0224483im     0.161072+0.0637662im
  0.0143243-0.00272579im     0.161898-0.0898775im    0.00193567-0.0833989im      -0.191958+0.0301304im      -0.127056-0.00991696im    0.207757-0.0116645im     0.039728+0.0862477im   -0.128607+0.0489947im     -0.156076+0.0910796im    -0.0042994+0.160173im      -0.014988-0.120562im    -0.00286794-0.0714428im   -0.0596823-0.0293897im     0.0664934+0.0801918im      0.183195-0.0523201im       0.46977-0.0609421im    0.0854244+0.00145194im    0.0462931+0.125964im     -0.242711-0.133478im      0.0373212+0.185158im     0.0162884-0.126728im    -0.0126854+0.138061im    -0.00141312+0.179721im        0.26279+0.0311724im   -0.0889355-0.140785im      -0.0398791+0.216281im      -0.103631-0.16252im     0.0685555-0.220194im     0.00295743+0.104915im     0.00584414+0.0216438im   -0.0534538-0.00940365im  0.00276763+0.150381im
 0.00244153-0.0230183im    -0.0737704-0.0549592im     -0.109453+0.110691im       -0.039142+0.251208im        0.207533-0.0532168im    -0.166711-0.00974976im  -0.0725934-0.118023im    -0.155842-0.0531873im     -0.102079-0.196925im       0.183799-0.03796im     -0.00045955+0.118385im     -0.0647681+0.0698676im     -0.18696+0.361694im     -0.0323001-0.0367848im     -0.240064-0.139026im       0.110215+0.141831im      0.158456-0.150061im     -0.0121896+0.212345im     -0.160009-0.00915035im    0.0321443-0.022057im    -0.0189774-0.149867im     -0.137036-0.0436147im      0.121388+0.0945258im     0.0442649+0.192975im     0.0167837+0.064778im      -0.0613006+0.0156747im     0.0379202+0.0900903im    0.141222+0.05408im      -0.0230468-0.0268167im     -0.187299+0.213221im    -0.0276871+0.149166im      0.105912-0.117232im
 -0.0987495+0.177999im       0.214465-0.139387im     -0.0755048-0.0740014im      -0.020071-0.11208im       -0.0815853-0.0967955im    0.0388995+0.0368072im     0.145841-0.0820719im   -0.165657-0.102138im     -0.0586614-0.205122im     -0.0383884-0.0103927im      0.209591-0.142685im      -0.223174+0.0868025im     0.141716+0.104596im      0.0726803+0.219794im      -0.047174-0.0909488im    -0.0477688-0.0796272im    -0.103513+0.043752im       0.171269-0.174841im    -0.0905945+0.00107817im    0.0305993-0.0279907im    0.0328838-0.0360384im    -0.107175-0.297141im      0.0881756-0.16177im       0.0280098+0.121455im     0.0115805+0.018554im        0.148878-0.165872im      -0.199913-0.196844im    0.0263011+0.194207im       0.199644+0.117783im      -0.107347+0.0041939im     0.181295-0.0387754im    0.0109715+0.103074im
 0.00634058+0.264127im      -0.131556+0.398849im       0.127972-0.00266685im     -0.176363-0.000578412im   -0.0213016+0.0939781im     0.157008+0.184244im     0.0278549+0.0110011im  -0.0476358+0.144088im       0.079466-0.0983754im      0.176114-0.0350195im     0.0962078+0.061208im     -0.0386399+0.0762909im   -0.0331908+0.0201354im      0.133572-0.220994im      0.0129864-0.0734385im    -0.0835107-0.0832904im     0.131843+0.0774863im       0.13663+0.0660509im     0.289394-0.186857im       0.158348+0.00223517im  -0.0217574-0.0225491im     -0.19097+0.0904588im    -0.0116501-0.043732im       0.118521+0.0510844im    0.0186813-0.0754028im     -0.0430753+0.180829im      -0.159074-0.0972204im   -0.160947+0.0708787im     0.0215038-0.0494164im     0.0461155-0.0601011im     0.205961+0.11965im       0.154559-0.0908773im
  0.0795974+0.131376im      0.0804931-0.00301615im    0.0834151+0.0776761im      0.0606075-0.0675866im      -0.213751+0.146672im       0.01128+0.0520162im    0.0242154-0.0809334im   0.0414085-0.0830885im      0.217484+0.051039im       0.129585+0.0842478im      0.184151+0.0313431im     0.0262365+0.0627196im    -0.058395+0.000503523im     0.12664-0.0709893im    -0.0156002-0.0232112im      0.139339+0.0518535im     0.043758-0.0208047im    -0.0096649+0.0397902im    -0.164988+0.158484im       0.281515-0.248283im     0.0476369+0.164293im         0.198+0.0989576im    -0.0433779+0.0193127im     0.0937728+0.135466im    -0.0266588-0.203803im      -0.0302902-0.237358im       0.120261+0.0964547im   0.0699954+0.254564im      -0.236343-0.0252652im      0.187065+0.228366im     0.0276331+0.0190405im   0.00640499+0.243959im
   0.170874+0.0862327im     0.0149085-0.0318829im    -0.0727755-0.0530606im      0.0863256-0.0175679im    -0.00201864-0.077449im      0.002975+0.125946im     0.0551898-0.0259883im  -0.0470142-0.036229im     -0.0279236+0.139976im    -0.00332093+0.00687985im    0.0664098-0.0614409im    -0.0130308+0.0669954im    -0.132998+0.197094im      -0.084852+0.160324im       0.104444+0.122362im      0.0630965-0.248171im     -0.111887-0.0506581im    -0.0831448+0.0238489im     0.348616+0.0117681im       0.02203-0.0968314im     0.351773-0.114027im    -0.0400609+0.0285601im     -0.106761+0.248456im     -0.0489702-0.0816805im    -0.173745+0.182551im      -0.0129859+0.045883im      -0.247652+0.0962535im   0.0149694+0.124153im      -0.116515-0.16855im       -0.072617+0.129139im    -0.0375515+0.130624im     -0.302687+0.0382074im
  -0.212125+0.0743802im      0.119367-0.061313im       0.245682-0.00319819im  -0.000450794+0.0634986im      -0.028362+0.0762357im    0.0883312+0.11552im     -0.0237004+0.0316581im    0.116437+0.0983112im     -0.340278+0.0702461im    -0.0704068+0.0707387im    0.00518321+0.0422885im    -0.0844662+0.216845im     0.0448884+0.121668im     -0.0555474+0.0769797im      0.108071+0.00817226im    -0.127322+0.0151796im     0.126758+0.214195im     0.00555655+0.0445836im     0.042857+0.037731im      0.0509069-0.189087im    -0.0612757-0.30923im       0.358984-0.124686im     -0.0320918+0.0625523im     0.0934338-0.0919756im    0.0505608-0.00591835im    -0.0830477-0.0299612im      0.190838-0.0858976im  -0.0555228+0.0561593im  -0.000159507-0.270453im      -0.161245-0.0185387im    -0.129715-0.0237074im     0.148365-0.0550496im
   0.046914+0.0112906im    -0.0788357-0.232159im      0.0810546-0.0268947im      -0.155646-0.0514644im      0.0383583+0.174751im    -0.0158167+0.159348im     -0.122897-0.152143im     0.190888+0.160701im      0.0958344+0.08215im        0.088776-0.283529im        0.15268-0.0495669im      0.285086+0.222685im    -0.0932742+0.0790539im    0.00617289+0.25922im        0.119785+0.00402406im    0.0874251-0.0778414im    -0.128951+0.0190986im    -0.0524161+0.169558im     -0.128647-0.0822941im      0.037687+0.110316im     0.0203411+0.0448105im    0.0278876+0.205901im      0.0414919-0.179301im      -0.243385+0.129064im    -0.0141587+0.00705171im      0.103196+0.00107605im    0.0382419-0.164545im    0.0878056+0.0974173im      0.139261+0.000764948im  -0.0369765-0.164084im    -0.0319113+0.0626842im    0.0313814-0.152067im
  0.0286504+0.121352im     -0.0798909-0.132911im      0.0252065+0.22344im         -0.13993+0.0511679im        0.23599+0.0152458im     0.026943-0.122208im    -0.0888859-0.170919im    0.0963726-0.172641im     -0.0865135-0.0772072im    -0.0391806+0.0502089im    -0.0713928+0.365352im      -0.123038-0.0510869im    0.0851737-0.00114387im   -0.0195627+0.0633885im      0.126368+0.274905im      -0.020689-0.122614im     0.0477692+0.0800847im     0.0257193+0.225108im    -0.0448423-0.144733im      0.0988445+0.0344265im   -0.0981078+0.118919im    -0.0706696+0.00524304im   -0.0733744+0.00369265im     0.198407-0.251006im      0.086759+0.133054im      0.00740666-0.172188im      -0.146151-0.153474im     0.111525+0.150784im       -0.12739+0.09491im        0.143378-0.134284im    0.00651063-0.0708418im   -0.0913991+0.0678433im
   0.225409-0.277559im     -0.0862621-0.00630642im    0.0244234-0.0714699im       0.260678+0.0164471im     -0.0155392+0.0892426im    0.0803244-0.0574861im    0.0588273-0.0337604im    0.109502-0.0140408im    -0.0385499-0.0386953im       0.12877-0.0310693im     0.0217973-0.012109im     -0.0133359+0.05114im     -0.0604521+0.0283082im    -0.0257682-0.035706im      0.0245598+0.0952227im     -0.096912-0.0781539im    -0.205144-0.114877im      -0.078988+0.105124im     0.0193775+0.0233611im     0.0844038+0.249097im     0.0563167-0.0743583im   -0.0534222-0.270152im      -0.145036+0.199949im       0.135645-0.012016im      0.368798-0.431729im        0.123495+0.0236937im      -0.03533-0.0809001im   0.0550388+0.0755181im     0.0661338-0.100334im     -0.0343879-0.0218152im    0.0815646-0.0259566im     0.123539+0.0171523im
  0.0163758+0.046074im       0.154457+0.0869864im    -0.0463948-0.0292414im       -0.11041-0.0919274im     0.00283876-0.299121im     0.0521155-0.0994404im     0.144886-0.294681im   -0.0545706-0.0774392im    -0.0805012+0.126987im     -0.0729048+0.069812im       0.123673-0.0150952im      0.178878-0.0276401im    -0.092046-0.0410365im     0.0766358-0.0351821im      0.107251+0.050218im     -0.0783524-0.0766203im     0.032294-0.0981776im     0.0320872+0.0758927im  -0.00151514+0.0560018im      0.127964-0.0080654im    0.0597676-0.152757im    -0.0999435-0.0899859im     -0.313237-0.0842288im     0.0590555+0.0519145im  -0.00313235+0.0981223im       0.242538-0.146228im       0.255577+0.146144im   0.00711083-0.190906im     -0.0315875+0.0811742im      0.152528-0.077383im    -0.0611882+0.233779im      0.205881-0.23492im
 -0.0851643+0.172112im      -0.153322-0.0417281im   -0.00906204-0.104806im       -0.173696+0.0865422im      -0.208876-0.044671im     0.0814051-0.0647812im   -0.0427782-0.0179643im   0.0480406-0.20922im       -0.217604-0.111604im      0.0130572-0.00971407im    -0.189896+0.0167982im      0.134379-0.0797879im    -0.110472-0.137143im     -0.0864935-0.0339026im      0.047453+0.175699im     -0.0792215+0.104058im    0.00126441-0.164136im      -0.038215-0.152742im     0.0776408+0.242747im       0.176737-0.0625737im    0.0220505-0.163521im    -0.0138657+0.105944im       0.270949-0.026817im      -0.110573-0.0543525im    0.0479662-0.076339im        0.168901+0.230012im       0.113345-0.0369365im    0.266325+0.125006im      0.0293097+0.0156602im    -0.0370849-0.0815323im     0.196629+0.164934im     -0.082758+0.147639im
  0.0846341+0.0528861im   -0.00143072+0.102334im       0.051798-0.090322im      -0.0582904-0.0388208im      -0.117048-0.0637701im    -0.221696+0.0351125im   -0.0463743+0.0909126im    0.209976+0.0282088im     0.0122354+0.073292im     -0.0398293-0.168859im         -0.215-0.129978im      -0.385346+0.0743333im   -0.0484386+0.164097im      0.0166703-0.199974im       0.102477-0.0460096im     0.0596827+0.01753im     -0.0345667+0.143343im      0.0911927-0.177245im    -0.0613481-0.00404165im    0.0139074-0.0332369im   -0.0556974+0.085788im    -0.0825926-0.00770599im  -0.00560956+0.147222im     -0.0466559+0.132588im      0.134035+0.111118im        0.247327-0.0185846im    -0.0708807-0.146898im     0.298791-0.0435436im     -0.110603-0.0416534im       0.20248-0.0499224im    -0.303317+0.10744im         0.0481-0.0574952im
 -0.0354475+0.089479im      0.0334439+0.0903632im    -0.0358683-0.18889im          0.24015-0.243986im      -0.0532432-0.18258im     -0.0922938-0.12887im      -0.185022-0.194485im     0.192263+0.020074im       0.108518+0.105063im      0.0893138-0.0172789im     -0.120051-0.0631143im    0.00332925-0.0565575im    -0.104923-0.0267963im     -0.120542+0.110617im     -0.0537682+0.0972424im      0.165056-0.0666151im     0.407846+0.169892im      0.0161043+0.205618im     0.0576671-0.0145203im    -0.0201928-0.122678im     0.0790326+0.0472228im     0.034818-0.033807im       0.164595-0.00654687im    0.0924092+0.0423212im     0.163432+0.0416227im      -0.025012-0.0260972im    -0.0751976+0.10767im     0.0717483-0.091622im       0.305599-0.05827im      -0.0161551-0.0177194im     0.200046-0.122996im     0.0471901+0.0322968im
 -0.0682561-0.011004im       0.232251-0.0402381im     -0.229337-0.0263373im      0.0130019+0.02277im      -0.00792512-0.0728197im     0.289279-0.0594119im    -0.308716+0.150101im   -0.0269671+0.1237im        0.0740773-0.130936im       0.108392+0.119431im     -0.0676458+0.27314im       0.0913739+0.0883951im    -0.104197-0.125066im      -0.194654+0.0780723im    -0.0112516-0.0881485im    0.00400123+0.0448609im    -0.276288+0.0858276im       0.19533+0.0368135im    0.0505391+0.0603125im     0.0578871-0.107139im     -0.135784-0.0018858im    0.0120802-0.0950755im     -0.118473-0.0330476im     -0.106177+0.106476im     0.0590287+0.021644im       -0.101059+0.0589281im     -0.182112+0.075895im     0.100352-0.0115378im      0.145039-0.139093im        0.26653+0.0614705im    -0.125382+0.164022im     0.0253957+0.00314406im
  0.0292002-0.185224im      0.0412401+0.0424406im    -0.0902731-0.0889163im      0.0815229+0.0367086im     -0.0655269-0.123959im     -0.170121-0.106732im     -0.115649+0.145208im    0.0565614+0.0247752im     -0.244585-0.0194739im    -0.0440638-0.0834674im     0.0427756+0.166662im       0.194475+0.193076im     -0.162283-0.31416im        0.175578-0.0673361im    -0.0906792-0.0340278im    0.00256732-0.16256im      0.0643226-0.0555623im     0.0443688-0.0951132im    0.0828238-0.0911375im     0.0654813+0.114549im      0.122338-0.0919926im    0.0461359+0.0341575im       0.15974+0.122319im     0.00286291+0.173956im     -0.067372+0.210319im      -0.0608312-0.228826im     -0.0308396-0.320953im   -0.0769286+0.0989302im     -0.177371+0.0407907im     0.0853599+0.0947917im    0.0984987-0.134866im      0.137508-0.00425954im
  -0.108061+0.0376596im     -0.137594+0.0894305im     -0.290014-0.0837558im      -0.112549-0.0447867im     -0.0321509+0.0042341im    0.0807428+0.027325im      0.122799-0.113356im    0.0600387-0.0255987im    -0.0528375+0.101569im      -0.107237-0.124607im    -0.00314272+0.0415509im    -0.0674297-0.0948832im     0.141665-0.104798im      0.0449737+0.0999338im    0.00976343+0.118503im       0.145338+0.0512539im      -0.3004-0.121704im      0.0349569-0.0281749im    -0.103906-0.12018im      -0.0799463-0.243849im       0.06414+0.239695im     0.0883592+0.0814021im     0.0693049+0.262046im      0.0468283-0.0299679im     0.161636+0.09457im        -0.159258+0.018634im     -0.0194779+0.0580274im  -0.0613274+0.0814663im     -0.017563-0.089325im      -0.200947+0.0208776im     0.049165+0.117938im      0.423248-0.0841678im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.1545139167322883 - 0.0646942732682985im
  0.028439844363852954 - 0.1296332605457395im
   0.11086539276681459 + 0.1570888000643723im
  -0.15716040187402602 - 0.17957260268079805im
 -0.020870737512836385 + 0.21541775328884483im
    0.0706851764642654 - 0.01432741212125388im
   0.04296227111904179 - 0.0010987870828304096im
  0.052402254362065984 - 0.08628757516897197im
  0.025734894257359697 + 0.11461247149116717im
  -0.08820563063069178 - 0.1253451634320242im
   -0.1631782764973661 - 0.1002649670263726im
  0.032622279718352354 + 0.22752304560502523im
    -0.100642508750463 + 0.0019467981209720514im
    0.3404574391909667 + 0.0im
   -0.3139569120407544 - 0.10921177785048866im
    0.1570282868436902 + 0.08867447894529923im
 -0.035498244227552884 + 0.106467252885383im
  -0.01242731211568257 - 0.15165487377694542im
  0.020220903796959865 + 0.033001075937707944im
  -0.06320194472498952 + 0.06893765138705737im
    0.1325005490227707 + 0.012615144402231347im
   0.04407143412911305 + 0.061959652290344586im
   -0.2306379136728859 - 0.23294447129000787im
    0.1228610512884725 + 0.11806721591280259im
   0.15661592261672524 + 0.0758241728377701im
  -0.16524916520659857 + 0.17430313008704276im
   0.17866400103309096 - 0.018887384630101783im
   0.14445111085582912 - 0.052820885669044054im
  -0.04729895802992626 + 0.051893745941619im
   0.03579138513458511 - 0.020525960371811893im
   0.04327087838077185 + 0.07486920283708969im
  -0.05890832268624703 + 0.18167723451804418im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Thursday 9 June 2022 07:43">Thursday 9 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

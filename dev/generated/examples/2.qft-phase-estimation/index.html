<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.200335+0.0101402im   -0.00954807+0.106477im       0.109312-0.0501425im   -0.0239978+0.106883im     -0.123976-0.00891438im    0.0273033-0.123473im     0.193734+0.161119im     0.00570655+0.117724im      -0.132098+0.0291558im     -0.196485+0.0300043im     0.316196-0.0294925im   -0.00548168+0.00498829im  -0.0687425+0.00133586im  -0.0128805-0.144085im      0.027098-0.10799im       -0.152477+0.0142563im     -0.0127372-0.0265797im      -0.126573-0.0248952im      0.123142-0.0422473im   -0.0536242+0.210124im    -0.00862719-0.279047im       0.156892+0.0412474im     -0.225684+0.195452im       0.146939-0.0379717im    0.0942666-0.112672im       0.0357893+0.0268936im    0.0513076-0.120517im      -0.350126-0.0930474im     -0.0669906+0.117785im      0.0118135-0.262357im   -0.0836832-0.124888im      -0.113935+0.00460053im
   0.215459+0.05836im        0.123527-0.073435im     -0.0261459-0.0117731im    -0.109401+0.0359079im    0.0209177+0.0797024im    -0.0415823-0.0742896im  -0.0442176-0.214788im      -0.105316-0.125285im       0.072925-0.0888488im     -0.112785-0.0217535im    -0.121406+0.19954im      -0.0926037+0.074887im     0.0507167+0.057919im    -0.0480764-0.0548986im     0.143082-0.115088im       0.231242+0.287955im     -0.00527364+0.000926917im     0.117821+0.158508im       0.117893-0.0886745im    0.0648137+0.077634im      -0.135788+0.0154352im      0.175124-0.0645619im    -0.0161244+0.062345im      0.0633906+0.120836im      -0.24063-0.0898462im      -0.153377+0.0797138im   -0.0177894-0.0128679im     0.0908935-0.253476im        0.245852+0.259987im       0.299042-0.0225996im   -0.105321-0.0139936im     0.0555569-0.0389763im
   0.107674+0.0286864im      0.151613+0.0757668im      0.172864+0.0970001im    -0.250263-0.0473367im   -0.0543768-0.141034im      0.0163034-0.0251954im   0.0205677-0.181797im     -0.0226847+0.0619688im      0.287467-0.0345434im     0.0615518-0.0332107im      0.10879+0.0569759im     0.0847908+0.0882668im    -0.236651+0.0886425im    -0.122735+0.0482861im   -0.0853514+0.0332751im     -0.312305-0.14503im       -0.0882074+0.153453im        0.262718+0.000533504im   0.0470602-0.173659im     0.0853962+0.0979166im    -0.0768049+0.00757288im   -0.0473836-0.104546im      0.0978118+0.00296778im   -0.0567036-0.0299781im    -0.193734-0.0267867im      0.0928201+0.0807647im    0.0889246-0.0070874im      0.233134-0.0162088im      -0.220992-0.0715461im    -0.0568506-0.239009im     0.139781-0.0709453im   -0.00426336-0.169789im
  0.0519837+0.0925077im      0.145824+0.0213128im    -0.0376364+0.254505im      0.193384-0.0257656im   -0.0219513-0.11408im       -0.196453+0.0649467im   0.0333702-0.164494im      0.0382731-0.229327im       0.188291+0.0776774im    0.00405564-0.162018im      -0.10971-0.118516im     -0.0601898+0.0646888im   -0.0113364-0.0384219im   -0.0740751-0.0664398im   -0.0243209-0.0427396im      0.123618-0.128938im         0.21788+0.0682665im      0.0557464-0.000719487im    0.236718+0.04454im      -0.123951-0.127439im     -0.0055968-0.0277235im     -0.075997+0.0599046im     -0.109664+0.155483im       0.235625+0.0564875im      0.11708+0.146686im        0.273861+0.155021im     -0.151162-0.195195im     -0.0327045-0.169396im      0.00547663+0.0774279im     -0.240333+0.0744177im   0.0888513-0.0574295im     -0.117081+0.0873309im
 -0.0816961+0.234019im      -0.102984-0.121687im      0.0141818+0.0856066im     0.175362+0.0584194im     0.300602+0.163235im       0.130789+0.0525048im   0.0772739-0.206994im     -0.0060727+0.212027im       0.147557-0.118072im     -0.0273352+0.180249im     -0.123028-0.26532im      -0.0620559+0.0858825im   -0.0277332+0.0673998im   0.00986116+0.0982013im   -0.0954599+0.24619im       0.0381241-0.107061im      -0.0114252-0.0316588im      -0.143249-0.110718im       -0.11673-0.00105664im   -0.110407+0.190291im       0.144071+0.0871515im   -0.00710423-0.1311im       -0.0448094+0.0350823im      0.244423+0.0224108im    -0.129105-0.0463798im      0.0250225+0.0446392im      0.24786-0.00865894im  -0.00425039-0.0630082im    -0.00120712+0.0694267im      0.104665-0.0870588im  -0.0662495-0.21632im       0.0176732+0.10284im
  -0.134883-0.0318751im     0.0503842+0.209034im      -0.195375+0.0210446im   -0.0504128-0.0549988im    0.0694128+0.0744697im     0.0667605-0.069272im     0.136778+0.0733745im     0.0735512+0.012276im       0.105249+0.0239381im     0.0186519-0.27595im      0.0874804+0.00855323im    0.0761181+0.0246969im   -0.0133864+0.0227732im    -0.137685-0.199303im      0.150069-0.0696281im     -0.119589-0.108346im      -0.0850699-0.149866im        0.148775-0.0397208im     -0.270985+0.0186989im    -0.039705-0.232452im      0.0265845+0.115639im     -0.0801464-0.0417246im      0.146566+0.122851im    0.000365671-0.122682im      -0.26482+0.0762727im      -0.015443+0.015544im      0.025742-0.0704731im     -0.315905-0.160125im      -0.0682517+0.127798im      0.0918637+0.181807im   -0.0983101-0.146772im       0.238814+0.105626im
   0.135708-0.142215im       0.169361+0.0198964im    -0.0804277+0.187225im       0.29532-0.100939im      0.240199+0.0980093im      0.205647+0.112832im    -0.159859-0.0949593im    -0.0576463+0.130925im       -0.13579+0.0321726im     0.0283183-0.175481im     0.0592113-0.134156im     -0.0132101-0.109846im     -0.143327+0.214924im     0.0294346-0.296908im      0.142492+0.0281166im    0.00419608+0.026844im       -0.214607+0.0397174im      0.0456522-0.0575535im     0.0343812-0.144701im    -0.0137904+0.0116674im      0.123387+0.075452im       0.202551-0.00676973im  -0.00959866-0.109224im    -0.00642322-0.0797274im     0.112513+0.045814im       -0.173796-0.118733im     -0.197993+0.0172032im     0.0424117-0.00382247im    -0.0466645+0.118365im     -0.0729356-0.10447im       0.18185+0.115788im     -0.0936024-0.0983636im
 -0.0274249+0.0220813im      0.262865-0.0337233im     -0.310708-0.194487im     0.0109022+0.0659778im   -0.0233225+0.014184im       0.117427+0.230989im    -0.170532+0.0372135im      0.229843+0.0230714im     0.0419048-0.0219998im    -0.0240612-0.0877804im    -0.056387+0.0713365im    -0.0937216+0.182654im     0.0921376-0.114018im    -0.0353684+0.0107163im   -0.0595397-0.0132192im     -0.157245+0.112341im      -0.0279187+0.137289im      -0.0267978+0.0245767im      0.182215+0.233218im     -0.115306+0.0781395im     -0.103773+0.0269308im     0.0895643-0.289086im      0.0390249-0.0729055im    -0.0372427-0.0705447im     0.127607-0.0587508im      0.0903328-0.143991im    0.00801052+0.125577im     -0.0640152-0.185153im      -0.0296965-0.153138im      -0.047567-0.241183im    0.0180406-0.0451051im      0.174916+0.21981im
    0.23483+0.06874im        0.228859+0.169298im     -0.0817837+0.0401216im   -0.0293469+0.0636348im      0.19848-0.059716im      0.0141557+0.134034im   -0.0674123+0.248372im      0.0381781-0.133549im      0.0312345-0.140183im       0.244461+0.0779775im     0.215455-0.290442im       0.133867+0.110086im      0.124942-0.0631164im    -0.052817+0.0772912im    -0.169803+0.0667344im     0.0596941-0.0140954im      0.0895702+0.149361im       0.0683847-0.00447329im   -0.0965655-0.182156im     0.0338234+0.0898399im   -0.00227413-0.316748im     -0.0250518+0.148876im     -0.0142166-0.0998547im   -0.00560913-0.0331916im    0.0123481+0.0277854im      -0.126965+0.135844im     -0.105953+0.11871im        0.056393-0.0204325im      0.0197703+0.00440056im     0.200212+0.172174im   -0.0655432+0.00497026im    0.0801519+0.141633im
 -0.0126171+0.0425354im      0.211625-0.138941im      0.0621553+0.00649874im   0.0940987+0.121327im      0.045159-0.111862im       0.153332-0.168079im     0.105414+0.0909054im      0.295197+0.174234im      0.0912213-0.0735824im      -0.12694-0.0970403im    0.0149495+0.147929im     -0.0499545+0.0669971im     0.128714+0.0274391im      0.13693+0.139398im     -0.145912-0.0662268im      0.203977-0.169469im       -0.362663-0.161171im       0.0806492+0.0275485im    -0.0608234-0.0989254im    0.0380628+0.0814353im    -0.0708475-0.0100393im     0.0761584+0.295868im       0.163617+0.128317im     0.00425001+0.212073im      0.104391-0.0118329im      0.0346859-0.0434519im    0.0117574-0.0402458im      0.111473-0.0806857im     -0.0411885+0.0394746im     -0.198069+0.0506465im   -0.058234+0.118977im      0.0799095+0.0811738im
 -0.0299149-0.0438647im     -0.106879-0.00384155im    0.0434267+0.0752043im    0.0163475-0.132536im      0.190838+0.0166889im    -0.0424207-0.124773im    0.0807758+0.122126im     -0.0386291+0.207492im       0.265093+0.155963im      -0.106933-0.18888im      0.0910393+0.161897im     -0.0903133+0.00521566im  -0.0472234-0.157858im     0.0690135+0.159262im    -0.0520455+0.238909im     -0.0145991+0.278012im        0.108973-0.0622581im      0.0374967-0.095255im     -0.0228234-0.0244636im    0.0733389+0.0809655im     -0.162775-0.0652361im      0.129608-0.0890054im     0.0425151-0.369283im       0.103697-0.0468998im   -0.0173315+0.0406362im   -0.000901684+0.0733158im    -0.290622-0.286896im     -0.0615786+0.020745im      -0.0194651-0.117502im      0.0151317+0.030211im   -0.0499278+0.0325866im    -0.0501652+0.125523im
  0.0780283-0.147045im    -0.00262801+0.190854im       0.237209+0.00445141im    0.246095+0.0579817im    0.0354933+0.0307195im      0.140452-0.228387im    -0.111797-0.00755884im   -0.0225622-0.00569684im    -0.150668-0.043448im      -0.190341-0.0729163im    0.0929385+0.0524665im      0.321066+0.0568736im    0.0496135-0.0422274im     0.180528-0.0540804im    -0.205454+0.0566536im     -0.138196+0.0760228im    -0.00811136-0.032658im       0.0343045+0.112966im       0.159875+0.0930298im    -0.183263-0.149833im      -0.081966+0.0964304im    -0.0771233-0.210774im     -0.0484158+0.114442im      0.0181617+0.0937314im   -0.0463838+0.126237im     -0.00468602+0.140249im    0.00643962+0.0354549im      0.244428+0.179613im       0.0806142+0.0270094im     0.0866663+0.0623725im   0.0367346-0.160461im      0.0827792+0.233721im
 -0.0526026-0.129045im       0.104995-0.0519197im     -0.265619+0.0710324im   -0.0403409-0.231197im     -0.172226-0.110083im       0.113971+0.092071im   -0.0987494+0.0132006im      0.178214+0.054257im        0.11435-0.133245im     -0.0190173+0.287781im    -0.0115854+0.0379708im    -0.0405066-0.0213001im     0.103744-0.0688886im     0.190497-0.160367im     -0.068795+0.00263769im    -0.129043+0.163304im       0.0609462-0.230892im      -0.0814003+0.0122545im    -0.0542313-0.0468229im     -0.16583+0.053095im     -0.0739146-0.0209598im     0.0950977+0.245515im     -0.0396831+0.0284747im      0.109456-0.0111426im    -0.291015+0.16634im       -0.0220959+0.172192im      0.024731-0.0418431im    -0.0381764+0.133934im       0.0888995-0.043031im     -0.0185621-0.010374im     0.293618-0.115839im      -0.081517-0.12388im
   0.134473+0.027655im      0.0392498+0.0249393im      0.156862+0.174773im    -0.0988033+0.0324316im    -0.118807+0.0300873im      0.153555+0.184245im    0.0209142+0.105003im      0.0227821+0.292117im      0.0332067+0.170592im      0.0126172+0.204828im    -0.0181305-0.194532im      0.0235902-0.0364571im      0.12553+0.0366457im     0.157325-0.204046im    -0.0346836-0.164115im     -0.0778163-0.127995im       0.0670869-0.0371383im      0.0466426+0.111564im      0.0717174+0.205968im      0.044221+0.102511im       -0.09386+0.142517im     -0.0309662-0.196337im      0.0236793-0.19594im        -0.03514+0.152483im    -0.0333677-0.00421563im      0.102745+0.0293194im     -0.12136-0.0395543im   -0.00402782-0.184751im       0.0802922+0.0115177im    -0.0571427+0.280874im    -0.258562+0.0353943im     0.0486266-0.248862im
  -0.254768-0.0691272im     0.0311275-0.0129981im     0.0657933+0.0829052im     0.176439+0.0984499im    -0.230008-0.0606467im      0.158585+0.019169im   -0.0955676+0.0123251im    -0.0781607+0.152775im        0.18007-0.0658696im    -0.0458914+0.133641im     0.0681735+0.0130982im      0.233086-0.124215im     -0.128872+0.00522865im    -0.17365-0.00923133im   0.0817429-0.00114825im     0.205194-0.0248271im     -0.0533753+0.185583im       -0.200952+0.163939im       0.197753+0.184812im      0.125506-0.0432274im    -0.0894792-0.0913582im    -0.0400492+0.169363im       0.202727-0.144415im     0.00731451-0.261306im    -0.0909051-0.0353794im    -0.00882617+0.0963115im    0.0935417-0.0302546im    -0.0357151-0.138607im      -0.0964387+0.126209im       0.146608+0.0264932im   0.0630211+0.109733im     -0.0965853+0.185971im
  0.0126417-0.101428im      -0.165543-0.238925im      0.0335846-0.252857im      0.119181-0.165528im       0.12618+0.121421im       0.153375+0.0938647im   -0.113008-0.109469im    -0.00386365-0.0668798im      0.123448+0.173641im    -0.00194339-0.0607154im     0.106717-0.0186701im     -0.132381+0.0986726im   -0.0759292-0.205423im      0.181067-0.0717908im   -0.0906627-0.23662im        0.084097-0.00639281im    -0.0502912+0.0796171im      0.0702612+0.0322695im    -0.0586659+0.0331051im    0.0750575-0.0614899im    -0.0668995-0.256711im      -0.132961+0.0952267im    -0.0228526-0.0635311im    -0.0745072-0.0641169im    0.0085523+0.156137im        0.245357+0.0207241im     0.014428+0.110859im      0.0471835+0.0894076im      -0.177059+0.303702im      0.0806572-0.063929im    -0.129821-0.193071im       0.047027-0.149633im
  -0.239077+0.0933939im   -0.00747823-0.0447352im     0.0953054+0.228426im    -0.0440074+0.0210778im    0.0900859-0.0251565im     -0.155057-0.0116219im  -0.0363873-0.12137im       0.0801361+0.185159im     -0.0547919-0.0412322im     0.0717457-0.025777im      0.192807-7.82061e-5im     0.106828-0.00788361im    0.270134-0.160134im    0.00349028-0.161706im    -0.0482791-0.037374im    -0.00175959+0.0776911im       0.296298-0.186334im         0.13402-0.10109im       0.0206306+0.0938556im     0.245694+0.0225875im     0.0682335-0.200678im      0.0494547-0.0999094im     0.0972615+0.138505im     0.00811625-0.00493324im   0.0707228-0.0438775im      0.0471494-0.299879im     0.0674091+0.00171465im     0.104125+0.00716723im      0.028196+0.203306im      0.0845953-0.0925418im    0.261627+0.112606im       0.155187-0.0235834im
 -0.0834747-0.1858im         0.057125+0.058094im      0.0274883-0.0608658im   -0.0132831-0.0621438im    -0.278645+0.0546742im     0.0107578+0.0463292im    0.112847-0.0459958im     0.0386745+0.0725092im    -0.0308335+0.0103388im     0.0458333-0.0358177im    -0.170527-0.0593026im      0.154542+0.125559im     -0.102043+0.139007im     0.0594523+0.0970822im   -0.0742644-0.100292im        0.24341-0.021575im      -0.0684066+0.074267im        0.367456-0.0904065im    -0.0522715+0.167764im    -0.0679593+0.0962357im      0.109473-0.20529im      -0.0437759+0.0177754im     -0.258857-0.146341im       0.210908-0.123756im    -0.0195239-0.0345483im      -0.202801-0.251368im     0.0108289-0.23185im       0.0544446+0.0818086im       0.123677-0.0674889im    -0.0173313+0.0099063im   0.0302306-0.178859im       0.137492-0.0010631im
 -0.0766361-0.275349im     0.00252234+0.119104im       0.130619+0.195219im     -0.112059+0.00567744im   0.0632914+0.100429im     -0.0163482+0.167552im    0.0767157+0.0927687im      0.219217-0.175187im      0.0278373+0.182955im     -0.0560937+0.110676im     0.0162946+0.0101474im    -0.0316224+0.140115im      0.120674+0.0869223im     0.100369+0.242221im     0.0435614+0.0751313im    -0.0589391+0.0321591im     -0.0414164-0.105758im      -0.0642025-0.0430396im      0.175735-0.164725im     -0.068656-0.298945im       0.128719+0.00752305im     0.216385-0.0135808im    -0.0237911-0.080155im      0.0542832-0.299241im     0.0485356+0.0165645im      0.0398255+0.0437644im     0.265502-0.00571521im     0.125541-0.110994im        0.043083+0.15653im     -0.00311178-0.0785843im   -0.170167+0.115859im      0.0470105-0.105698im
  0.0156377-0.109108im     -0.0574139-0.0482245im     -0.182428+0.104807im    -0.0848106-0.111617im      0.129087-0.0587702im    -0.0481237-0.163498im    0.0525158-0.0856078im    -0.0964456-0.0304055im    -0.0194767+0.0226576im     0.0355937-0.0469454im    0.0721933-0.177029im       0.070995-0.153763im     0.0582019+0.127826im     0.0908416+0.290227im     -0.266957-0.199665im     -0.0556894+0.0552781im      -0.207744-0.0527387im       -0.28657+0.209267im      0.0754597+0.0156407im      0.11523-0.0715746im   -0.00116541-0.0183906im    -0.0665962-0.0364628im     -0.104232+0.0849335im     0.0131005-0.0595504im   -0.0752375+0.0421759im      0.0817852-0.282457im     -0.157977-0.041377im      0.0142872-0.320258im      -0.0345394-0.182635im        0.15633+0.0403199im    0.133302-0.131493im     -0.0117562-0.0805259im
   0.134317+0.0221367im     -0.249719+0.0919917im   0.000487242-0.0185528im     0.081835+0.0281245im    -0.239062+0.0490899im      0.141932-0.0480982im   0.0863988-0.0278356im   -0.00904301-0.0709204im      0.334308-0.0870229im      0.111759-0.281902im      0.126227-0.0728765im    -0.0262501-0.134406im      0.165443+0.148176im     0.0943624-0.066371im     -0.118416+0.0456035im     0.0842897+0.153016im       0.0405608-0.0115814im      -0.046171+0.0238156im    -0.0267158+0.090139im     0.0261875+0.0458903im      0.282865+0.0247557im     0.0198263+0.0565189im      0.164928+0.0298373im     -0.012866-0.131256im     0.0951733-0.198875im        0.051749+0.201633im    -0.0655993+0.188494im      0.0306644-0.000667999im     0.258884-0.0997372im     -0.122583-0.164503im   0.00529434-0.0445869im      0.175764-0.128087im
  -0.159235+0.140855im      0.0625168+0.072352im     -0.0806487-0.182601im     -0.115731-0.00969146im  -0.0833549-0.256728im       0.187194-0.066732im    -0.174716-0.217773im       0.136735+0.0187949im    -0.0983025+0.192126im    -0.00544749-0.248567im      0.124633-0.17073im       0.0927189-0.0729933im    -0.147751+0.00829391im    0.162054+0.176056im     0.0644605-0.0261459im      0.141441+0.000172826im     0.163098-0.0225282im      0.0356665-0.03234im        0.170462-0.16337im      0.0431017+0.131973im       0.120317+0.0229112im      0.261254-0.124218im      0.0959225+0.0393445im      0.114425+0.0316282im   -0.0493277+0.127653im       0.0385652+0.0259743im     0.147395+0.108539im       -0.12602+0.110498im       0.0166479-0.089607im      0.0831046+0.23025im     -0.107926+0.0196104im     -0.131511-0.0628899im
 -0.0136551-0.00251133im    0.0165977-0.0749175im    -0.0372616-0.0158384im    -0.125239+0.058487im      0.248107+0.0723587im     -0.208818-0.0146455im   0.0689242-0.0129746im      0.167865-0.0269563im     -0.186137-0.0323535im    -0.0812944-0.144387im    -0.0443398-0.0477708im      0.132474+0.0799027im   -0.0728995+0.044615im      0.188448-0.0461523im   -0.0561611-0.170353im     -0.0346287-0.0189107im      0.0736474-0.12193im         0.156481+0.127646im      0.0151265+0.0888882im   -0.0322738+0.255272im       -0.04621+0.208831im      -0.178148+0.154729im       0.133257-0.189178im     -0.0783774-0.322208im      0.109476-0.248153im       0.0293992+0.217063im     0.0808582+0.0147642im    -0.0284843-0.048719im       0.0849172+0.0518265im     0.0379481+0.0194309im    0.144431-0.0941297im     -0.289131+0.043274im
  0.0845079+0.119233im       0.134303-0.0442192im    -0.0390472+0.0622295im    0.0945095-0.177054im     0.0305518+0.0635562im      0.199562-0.0914712im    0.190549-0.0243644im     0.0300467-0.0838273im     0.0354131+0.00399201im    -0.101076+0.307498im     0.0277066+0.0144128im     0.0881638-0.0409654im    -0.188879-0.0834174im      0.12895+0.129361im      0.128358-0.0711853im     -0.050757+0.053193im        0.196188-0.0720235im       0.254956-0.00945183im    -0.113884+0.196098im     0.0834116-0.242256im       0.204889-0.0948433im     0.0592716+0.00170549im      0.17959+0.118758im     -0.0847372+0.0195977im    0.0418245-0.0195472im     -0.0940635-0.0800588im    -0.135401+0.152054im      0.0483084-0.150868im       0.0305806-0.155212im     -0.0283145-0.143865im    -0.150275-0.0517497im     -0.297521+0.130654im
   -0.18466-0.170497im      0.0217331+0.326255im      0.0287963+0.199386im      0.108825+0.166902im     0.0617546-0.00107614im     0.105303-0.130626im    -0.193815-0.209203im      0.0830026-0.0998908im     0.0341195-0.0384197im     0.0725755+0.164254im    -0.0400937+0.054493im      -0.131988-0.0611174im   -0.0666721-0.0575148im    0.0757791+0.0318339im     0.126697-0.256198im     -0.0785275+0.0415317im      0.0655379+0.0841311im     -0.0371225-0.131504im      -0.123398-0.136666im      0.119106+0.00439453im     -0.18066+0.0634803im    -0.0346417+0.130896im      0.0321694-0.109728im       0.101333+0.171918im      0.276161-0.245956im        0.043864+0.0217516im  -0.00429741-0.0425248im    -0.0862149+0.0104576im      0.0171008-0.154259im       0.114435-0.0377158im  -0.0516287-0.238317im       0.141171-0.0467102im
  -0.225366-0.0634118im     0.0255966-0.0757874im     0.0398656-0.113437im     0.0495264+0.35198im       0.224384-0.103502im    -0.00817231-0.0748396im   0.0897936+0.226556im       -0.17988-0.185301im       0.111776-0.0323049im    -0.0349699+0.0306773im   -0.0160726-0.0089825im     -0.209479-0.0299487im   -0.0698863+0.172994im     0.0738296-0.0714413im     0.167181-0.0302359im     -0.202332-0.143353im       0.0699112-0.0962335im      0.0662301+0.147958im       0.194683+0.0817157im     0.114824+0.104852im    -0.00777174-0.149488im      0.0342095+0.0140064im     0.0703562-0.0826621im      0.222512-0.0456234im    -0.139646+0.215234im       -0.105651-0.10488im     -0.0732426+0.193293im      0.0673068+0.0568231im       0.152894-0.0425163im     -0.146652+0.0208618im   0.0468634-0.123227im      0.0860343-0.0438588im
 -0.0606015-0.17638im       0.0412034-0.322729im     -0.0798949+0.0958308im    0.0806503+0.0696579im   -0.0803797-0.0872786im     -0.048979-0.0284237im   -0.162564-0.06813im       0.0787038+0.0883967im   -0.00986388-0.0590637im      0.110718-0.0554497im     0.339647-0.0822306im     -0.282312+0.113798im    -0.0863182+0.11315im     -0.0119347+0.0357142im     0.161031+0.257178im      -0.109134-0.072286im      -0.0468622-0.0787817im       0.118478+0.0825824im     0.0819511+0.110066im    -0.0978703-0.11614im       0.0162527-0.105im         -0.143195-0.017187im     -0.0775773+0.147426im      -0.184553+0.0262256im    0.0196174-0.2394im         0.0173142+0.0481649im   -0.0161809-0.192955im      0.0523044+0.0674298im       0.176529-0.110788im       0.212137+0.126223im     -0.15389-0.0347474im    -0.0678257-0.0284545im
 -0.0360089+0.0366098im     0.0635755-0.197233im      0.0312723-7.21426e-5im   -0.233309-0.0521979im    0.0110224+0.0283602im      0.145166+0.136959im     0.175926-0.25956im       0.0309252+0.00418862im   -0.0943139-0.0313908im      -0.10481-0.168758im      0.169792+0.0100056im     0.0672441-0.0445155im     0.138355-0.011696im    -0.0528433-0.244969im     0.0380497-0.0584199im    -0.0575064-0.0777675im       0.154128+0.0893498im      -0.203383+0.231496im     -0.0776043-0.197399im    -0.0178436-0.176036im     -0.0201191+0.00162045im    -0.134784+0.156787im     -0.0298823-0.216629im       0.236195+0.0442462im    0.0110506+0.0234528im      -0.103152-0.0901538im    0.0303952-0.0834159im      0.155192+0.0853439im      0.0811366-0.206157im     -0.0561285-0.1464im      -0.223971+0.0241486im     0.0161516+0.200201im
  -0.166586+0.174631im      0.0112875-0.0367876im     -0.159826+0.153931im    -0.0209055+0.119225im      -0.09294+0.120628im      -0.101587-0.052938im   -0.0744282-0.0381702im     0.0311058+0.190038im      -0.156881+0.0921401im     0.0482259-0.0288944im    -0.151684+0.127284im        0.20604-0.00364445im   -0.201526-0.0536156im    0.0335005+0.0386026im   -0.0117454+0.0825358im     -0.174855+0.0772857im      -0.204361+0.013695im     -0.00391787+0.0709341im    -0.0962426-0.174293im    -0.0182177-0.118674im       0.052852-0.323763im     -0.0784185-0.0277165im     -0.129273-0.103313im       0.122888+0.0405348im   -0.0712084-0.11185im         0.240335+0.137637im     -0.164283+0.307385im     -0.0243092-0.0480052im       0.263435+0.109538im      -0.139004+0.0104879im  -0.0561137+0.0677194im     0.0197233-0.0336511im
  -0.137996+0.085801im     -0.0920674+0.0473999im     0.0294638-0.0463074im    -0.137836-0.0621856im     0.115139-0.0673685im      0.246887+0.27193im       0.08707+0.122108im     0.00485182-0.0684385im     -0.258761-0.260283im      -0.139811+0.029991im    -0.0544197+0.0232204im     -0.223399-0.165182im     -0.160008+0.196534im     0.0349407-0.033633im     -0.225561-0.0168247im     0.0357266+0.178057im       -0.038841+0.0902724im       0.153849-0.00708959im    0.0267071+0.0167831im     0.102156-0.156479im     -0.0234034-0.123583im     -0.0875559-0.146432im        0.13014+0.160136im       0.196264-0.00335378im   0.0493114-0.107063im        0.148154+0.20212im     -0.0501438-0.205381im     9.54619e-5+0.0137706im     -0.0635459-0.012571im      0.0599317+0.0737308im    0.090473+0.159538im      0.0786311-0.0239944im
  -0.115979+0.0868339im     0.0533515+0.094862im    -0.00951262-0.0442393im    0.0112443-0.231918im    -0.0286744+0.0675785im      0.100021+0.0887922im   -0.110268-0.0910969im     -0.128194-0.265477im      0.0171846+0.0792935im   -0.00625282+0.0286689im     0.178723+0.0122558im      0.132224-0.0560356im     0.311634+0.196291im    -0.0806403+0.165315im     0.0844562+0.222753im     -0.0494377-0.0596732im      -0.200395-0.247642im        0.188891+0.142449im     -0.0489207+0.177621im      0.154237+0.098256im      -0.198422+0.00379684im    -0.113306-0.0285718im      -0.12183-0.12379im        0.184927+0.173329im      0.146861-0.0344347im     0.00702759+0.0755295im    0.0462665+0.0721824im     -0.175779+0.0306353im     -0.0415044+0.112441im     -0.0407798-0.10806im     0.0115159+0.0409944im     -0.135708-0.0155491im
 -0.0369374+0.0778847im      0.176863+0.0145515im      0.186913-0.0307606im    -0.111306-0.119348im    -0.0501768+0.221346im      0.0219738-0.0685322im  -0.0786646-0.0636697im       -0.1239+0.0117876im    -0.0380115+0.167635im     -0.0989857+0.00336668im  0.00485022-0.129199im      -0.114509+0.391726im      -0.20665+0.0678633im     0.107352-0.0686592im   -0.0649089+0.118482im     -0.0668655+0.103922im      0.00293223+0.0245908im      -0.135063+0.0102795im     -0.013076+0.0817964im     0.313965-0.0130777im     0.0688544+0.0332438im    -0.0532556+0.226918im       -0.03168+0.0703286im     -0.118473+0.0459436im      0.11204+0.202257im       -0.064296+0.113442im      0.117779-0.0231683im     -0.157197-0.130135im        0.172414-0.15im         -0.0221882+0.0575884im    0.203273+0.105999im        0.22221+0.071487im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
     0.3529502127592771 + 0.0im
    0.05787960193641776 + 0.13333923004951917im
    -0.1101999231928906 - 0.00997851289487721im
 -0.0031892761180797166 + 0.05619287299486325im
    0.04373024414831265 - 0.03668284638223897im
   0.006712814551419152 - 0.14736662532036368im
     0.0605879482146054 + 0.15501432514497138im
   -0.04557043396149566 + 0.0837395213737168im
   -0.10566679396060845 + 0.13317951197811034im
    -0.2059896672031035 + 0.16846020671476808im
    0.09069024579106695 - 0.09836201159226803im
  0.0004884297262309271 + 0.052962490294802204im
    0.16212082072858772 - 0.043290974314598635im
     0.2871329796909262 + 0.04084022053561445im
  -0.028857872968527893 - 0.044664504068912696im
   0.025600881949593236 + 0.17048681559091786im
   -0.03515857188703977 - 0.1262698271553631im
  -0.022000690508186323 - 0.08277549944666641im
    0.01446854766143165 + 0.055542638590649285im
   -0.10843249844805228 + 0.010101515056249549im
   -0.11922584537705028 + 0.06944189144242664im
   -0.08788316808006093 - 0.12851268324322457im
    0.09703093879786616 + 0.28877216359938507im
   -0.10632248197375402 - 0.053881484850875315im
     0.3387920963829432 - 0.024018903253858123im
   -0.12743885087655243 - 0.1322087676562202im
    0.23796196989637405 - 0.02732937791767148im
    0.11010178487172184 + 0.2619819902111002im
   -0.02516403619353125 - 0.11871952454246795im
 -0.0018535602226739374 - 0.024075572920104555im
     0.0771000913353745 + 0.11208207981990742im
    0.01584726975250115 + 0.024610238645958016im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Thursday 18 August 2022 01:02">Thursday 18 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

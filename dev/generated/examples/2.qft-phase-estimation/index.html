<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.169011+0.0953358im    -0.0935313-0.226758im   -0.00488983-0.263091im     -0.0126097-0.0811385im    -0.162378-0.109892im       0.115367+0.117311im         0.14374+0.0683333im    -0.230461+0.048592im      0.16551-0.0220888im    -0.0584782+0.182666im    -0.0101817-0.078148im     -0.0646877+0.170523im     -0.0248693-0.0516437im     0.0911886-0.21193im       -0.185492+0.00552111im     -0.148725-0.0244511im    0.0997014-0.0773117im   -0.00519621+0.0167518im   -0.0259439-0.1424im         0.249716+0.104769im      0.0610465+0.118585im      -0.072297+0.0663154im    -0.0752948+0.0566542im      -0.10471+0.0325765im      0.120609+0.292501im       0.143039+0.00949858im      -0.18906+0.286886im     -0.039878+0.0867864im      0.110974+0.114457im     0.0732919-0.0290089im    -0.0797454+0.125087im     0.0379046+0.0185006im
  -0.142397+0.166362im      -0.134195-0.0563367im    -0.138851+0.00687182im   -0.0621029-0.070673im      0.165247-0.00796639im    -0.123788+0.0211255im      0.0132883+0.0658858im   -0.0876769-0.180437im     0.183839+0.0674632im    -0.0930978-0.184016im     -0.106108+0.178673im      0.0594226-0.0578553im      0.052082+0.037323im      -0.112851+0.0981777im     0.0524995+0.0312236im       0.036466-0.0994021im    0.0220378-0.0255295im     0.0709472+0.0832174im     0.177198-0.0289653im    0.00898455+0.230164im      0.0576304+0.1255im        -0.239905+0.00548993im   0.00184048+0.0152052im      0.341458+0.0174122im      0.229956-0.151176im       0.261717-0.0389705im      0.0782177+0.193583im      -0.14046-0.064963im     -0.0202619+0.0537649im   -0.0850079+0.110669im       0.300578+0.0526903im    0.0414823-0.139062im
 -0.0774899+0.0183159im     -0.173887+0.0692775im    -0.192885-0.115067im      -0.129958-0.104504im      0.193002-0.17621im       0.0235154+0.0782067im       -0.11388-0.138121im      0.265466+0.0447622im  0.00115342-0.184212im     -0.0935148+0.0916471im    0.0404057+0.0950467im    -0.0861674-0.0321091im     -0.112945+0.108265im     -0.0574934+0.00929344im    -0.171758-0.118719im        0.213643-0.174404im     -0.187793-0.00183109im   -0.0275493-0.0725147im      0.17592-0.0312114im      0.033286+0.0459996im     0.0933592-0.128845im       0.135704-0.106867im       0.239779+0.144482im     0.00264005+0.0100157im     -0.122523+0.277275im     -0.0758831-0.096923im        0.106823-0.00239431im  -0.0655146-0.0187091im    -0.0140761+0.240754im      0.010291+0.116128im     -0.0103637+0.141009im      0.118055+0.210485im
   0.215424+0.0908537im     0.0767898-0.0235388im   -0.0149459+0.146826im      -0.177217-0.132289im     0.0926853+0.00436977im   -0.0885713+0.107668im        0.051188+0.14807im     -0.0309179+0.24138im     0.0132021-0.010826im       0.167072-0.00599709im  -0.0857237+0.288638im      0.0111626+0.033976im     -0.0788261+0.0532278im       0.21087+0.11437im      0.00330331-0.0478093im       -0.11544+0.00645301im  -0.0751851+0.28395im       0.0678629+0.109066im     -0.040982+0.212175im        -0.3012+0.0677761im     0.0076066-0.0953294im     -0.127577+0.244476im      0.0344361+0.0701442im      -0.22542-0.00615676im   0.00626041-0.0107859im    -0.0355188+0.0595698im     -0.0266313+0.100888im      0.154788+0.0393678im      0.100916-0.0263594im    0.0727509+0.204403im      0.0663451+0.232232im     0.0893192+0.037179im
 -0.0835869+0.129783im      -0.155656-0.0359925im    0.0766713-0.0518567im      0.119289+0.207697im      -0.26139-0.162279im      -0.132911+0.0978153im      0.0880057+0.0631126im    0.0777805-0.0244599im   -0.214108+0.0753908im      0.158162-0.221965im      0.182578+0.062307im      0.0166855+0.0271895im     -0.118085+0.0109423im       -0.0296+0.0696384im    -0.0904367+0.0725288im     -0.0354373+0.0607089im    -0.088807+0.181019im     -0.0539623-0.153317im     -0.225012-0.0987254im    -0.0164493+0.0473083im    -0.0116456+0.215159im       0.135025-0.0333796im    -0.0238205+0.211861im    -0.00946205+0.00249372im   -0.0762697-0.133044im       0.292321-0.0768983im       0.100052-0.118413im    -0.0344032+0.068356im      0.0969162+0.122902im     -0.203413+0.0858657im    -0.0738202+0.253056im    -0.0822594+0.0816874im
  0.0215661+0.000850593im   0.0893683+0.012613im     0.0955577+0.19733im       -0.108224-0.165526im     0.0892478-0.0664824im     -0.131384-0.21337im        0.0208199-0.00714869im   0.0170981+0.153007im   -0.0580061-0.00843243im   -0.0830439-0.099219im      0.103443-0.18989im        0.319585+0.0923348im     -0.150566+0.156239im       0.114197-0.0429125im      0.068689-0.000132759im    0.0621825-0.0337359im    -0.141831+0.0373341im     -0.212112-0.0759704im     0.048658+0.11192im         0.13628+0.00220028im     0.195339+0.154103im       0.129462+0.0182539im      0.145287-0.237229im     -0.0472281+0.08013im        0.124497-0.141402im       0.025878+0.0938421im      -0.195496+0.122191im     -0.255958+0.0536337im      0.107731+0.228022im     0.0586628+0.0330935im     -0.074035-0.0226866im    -0.208185-0.0282727im
  0.0527582-0.2231im         0.214398-0.238062im     0.0136816-0.0806938im     0.0193577+0.0772804im     0.133259+0.00586229im   -0.0432077-0.0375355im      -0.194045-0.113119im    -0.0886359-0.161839im      0.15953-0.0401881im   -0.00261255-0.00887678im    -0.14266-0.168075im      0.0891957-0.0643504im      0.082076-0.213861im      0.0810785-0.120862im      -0.104349-0.10201im       -0.0920409-0.103683im     0.0383856+0.0233465im     -0.256714-0.0896287im   -0.0504128-0.0574528im    -0.0502525-0.00910794im    -0.176635-0.0419542im    -0.0127238+0.198957im       0.343914+0.15288im       -0.111089+0.0457504im   -0.00646547-0.163327im     0.00808889-0.134985im        0.146877-0.102377im    -0.0546525+0.210344im     0.00133074+0.0898483im    -0.099711+0.0176035im      0.136763+0.177927im    -0.0100395-0.133794im
  0.0161536-0.234596im      -0.181855+0.105934im     0.0947627+0.159995im      -0.015388-0.124901im     0.0141975+0.0448071im      -0.29848-0.224611im        0.109063+0.103073im    -0.0349901-0.134396im     0.214726+0.0315331im    -0.0134815-0.00365262im  -0.0950098-0.149006im      -0.235802-0.104372im       0.322832-0.0425209im     0.0283378-0.0138435im     -0.111354+0.191925im       0.0135481+0.0287396im    -0.109918+0.0133354im      0.259677+0.0447777im   -0.0616288+0.00199013im    0.0376372+0.09754im        0.170939+0.145437im      0.0802323-0.0015554im      0.011948+0.0394502im     -0.173756+0.0699515im     0.0755827+0.0670574im       0.02178+0.0191425im       0.171692-0.199833im     0.0565892-0.0246337im     0.0238751+0.148019im       0.19833+0.0911285im     -0.111575+0.0725414im   -0.0260182+0.0367008im
   0.156198+0.202314im      -0.088818-0.100666im      0.118194-0.117523im       0.139756-0.0177021im    0.0953647+0.0186242im      0.017923-0.020836im      -0.0205456+0.111214im    -0.0482874+0.119579im    -0.214689+0.0132796im     -0.136658-0.0798603im    -0.100848+0.0695766im    -0.0978093-0.0843655im   -0.00429466+0.143429im     -0.0896875-0.30466im        0.042634+0.0882754im      0.0393007+0.0398328im    0.0295149-0.0144136im    -0.0353077-0.0099775im    -0.200892+0.00164491im    -0.136052+0.145635im      0.0395256-0.244017im     -0.0985779+0.0491867im      0.175001+0.15064im        0.187255+0.171907im       0.165381-0.130436im     -0.0557707+0.0860538im      0.0876648-0.159647im     -0.160654+0.0736142im      0.041719+0.0863362im     0.157473-0.00808413im    -0.291754-0.216312im      0.180916-0.0230615im
   0.128371+0.21377im       -0.067279-0.0236525im    0.0609927-0.0314258im      0.141716+0.382445im      0.347243-0.164142im     -0.0501627-0.0474531im     -0.0256616-0.0249058im    0.0460883-0.0132637im   0.0630941+0.058532im      -0.203015-0.0702305im     0.116442-0.0555789im     -0.160416-0.0485006im    -0.0681393-0.181141im     -0.0437103-0.0360174im    -0.0101962+0.0269245im       0.210054+0.040653im     -0.137973+0.0453038im    -0.0388657+0.143574im    -0.0714836+0.107935im       0.141944-0.17721im      -0.0332298-0.0954693im     0.0485994-0.0369888im    -0.0692687-0.118284im      -0.273946+0.00150452im     0.247697-0.0547718im      0.022983-0.0889151im     -0.0786643+0.121313im      0.166281-0.169012im    -0.00241281-0.0720843im   -0.0295422+0.10669im      -0.0100991+0.0973161im     0.045775-0.148041im
 -0.0663293-0.153872im     -0.0105674+0.10188im      -0.168387-0.187456im      0.0778997+0.155669im      0.148082-0.122136im      -0.015801-0.0910864im      0.0111829-0.0109929im    -0.168444-0.0980095im   -0.132618+0.117715im     -0.0422082+0.0188942im    -0.131633+0.0038581im      0.115726-0.176484im      -0.190817+0.159961im      0.0869376-0.102528im      0.0921887+0.121485im       -0.352522+0.048046im    -0.0982874+0.0527495im      0.215617-0.178746im     0.0295443+0.0498835im    -0.0124802+0.12028im        0.149971-0.194243im     0.00713156-0.0969016im      0.143407-0.0319257im      -0.11842-0.182811im     -0.0593387+0.164782im        0.12348+0.0250916im   -0.000581629+0.0363211im    -0.132813-0.0609213im    -0.0958566-0.257832im     0.0306602+0.0282718im    -0.0496325+0.0974672im    -0.203187-0.105911im
   0.238667+0.0431882im     0.0320641-0.0303026im    -0.115508+0.112403im      0.0237189-0.129267im     0.0786006+0.126211im      0.0988971-0.130747im       0.0832852+0.00299663im  -0.0285172-0.0842379im  0.00294708+0.0342643im     0.0508793+0.00083095im  -0.0296846+5.70668e-5im    -0.247587-0.154748im      -0.240564-0.0956946im     0.0765906+0.0771853im      0.134373+0.0137078im       0.119063+0.125322im    -0.0472252+0.206784im      0.0401356+0.135302im      0.219559-0.249965im       0.143046-0.0172674im    -0.0264505-0.01341im     -0.00942087+0.00088768im     0.165628+0.0473748im    -0.0744775+0.198633im      -0.104511+0.0386831im      0.209525+0.0951568im      0.0124653-0.0933298im    -0.106166-0.00321688im     0.303374-0.126713im     -0.259759-0.235042im     0.00834536-0.111447im    -0.0590052+0.104659im
 -0.0264257+0.308016im       0.123062-0.100269im      -0.10501+0.119874im      -0.219277-0.159367im     -0.118566-0.0632802im     -0.159678-0.0428895im       0.069935-0.24801im       0.127616-0.112017im     0.122975+0.0700811im    -0.0126607+0.108827im     0.0119439+0.0698162im    -0.0681493+0.085537im      -0.220679-0.10862im        0.151867-0.0611319im     -0.238138+0.169687im       -0.050956+0.0920599im     0.173789-0.178444im      0.0228218+0.0711543im   -0.0180617+0.240303im      0.0195842+0.0694304im    -0.0548618-0.100755im      0.0700966-0.298902im    -0.00133369+0.0299171im    -0.0379793+0.0334519im   0.000325791-0.0999168im   -0.00578592+0.0195606im       0.190075-0.0675467im   -0.0341602+0.158092im      -0.071624-0.132456im    -0.0633447+0.0716233im     -0.137893-0.0393737im   -0.0893322-0.165648im
  -0.137013-0.0878086im    -0.0522057-0.0591114im   -0.0328711+0.154465im     -0.0964806-0.177822im     0.0109405+0.178713im     -0.0105698+0.254302im      0.00458374+0.0386368im    0.0154004+0.0647063im  -0.0961522+0.226823im      0.0161345+0.194615im      0.258262-0.138116im     -0.0608588-0.0690679im    -0.0774102-0.156103im      -0.220493-0.305482im      -0.135454+0.0308017im    -0.00132189-0.224873im      -0.21103+0.0415577im     -0.084613-0.0282014im   0.00894333-0.12532im      -0.0815542+0.221592im      0.0479177+0.0125255im     -0.127234+0.0522292im    -0.0571205-0.0360944im     -0.158018-0.0265059im     0.0710641-0.174953im     -0.0640109-0.114024im      -0.0268691-0.00930885im  -0.0905513-0.17414im      -0.0184546-0.272876im    -0.0603002+0.0727124im   -0.00716276-0.0105575im   -0.0509228+0.086467im
 -0.0337425+0.003309im      -0.100031+0.204696im     -0.088989+0.0321499im   -0.00848532+0.0657572im     0.195531-0.0252372im      0.252867+0.0748233im       0.351276+0.0407136im    -0.119919-0.225359im     0.115494+0.153051im      0.0450535-0.0278903im    0.0691976+0.152204im       0.152293-0.0481911im     0.0639246-0.00976793im    0.0865947-0.0563033im     -0.290568-0.144054im     -0.00706758+0.049097im     0.0020006-0.112752im     -0.0204626-0.13334im     -0.0101861-0.122448im      -0.111838-0.20016im       0.0539263-0.066932im      -0.149891-0.0420004im     0.0617667-0.0932777im     0.0644692+0.310873im     -0.0907244-0.178404im       -0.12634+0.103035im      -0.0627634-0.0059759im     0.149921+0.0310786im     0.0532618+0.0995557im   0.00211505+0.0625868im     -0.141874+0.0619415im    -0.192117+0.0657035im
  0.0824885+0.0121189im    -0.0597872+0.0147673im   -0.0549394+0.0563105im    -0.0546638+0.0480942im   -0.0956071-0.0225772im     -0.124726+0.0474418im      0.0311352-0.165402im     0.0255667-0.0074739im   -0.186634-0.078807im     -0.0632443+0.170353im     0.0231491-0.0994086im     0.0824794-0.342698im      0.0463426-0.194959im     -0.0612368+0.134652im      -0.150213+0.0300483im      -0.177242+0.0875285im    0.0994849+0.160423im       0.159952-0.0780483im     0.162206+0.188252im     -0.0184088-0.158364im     -0.0689707+0.181958im     -0.0695903+0.115228im       0.212858+0.0309092im      0.120555+0.122278im       0.118966-0.0174674im      0.110601-0.117245im       -0.303707+0.0747935im    0.0199902-0.0144031im     -0.208258+0.0375916im   -0.0520368+0.0864282im     -0.175936-0.170398im      0.186526+0.114599im
   0.187072+0.0525531im     -0.258384+0.147311im    -0.0729743+0.00375159im    -0.114868+0.149207im     -0.331291+0.116625im      -0.200201-0.0243229im       0.123329-0.164886im    -0.0875363+0.0312018im   0.0249666+0.132785im     -0.0999232-0.1965im       -0.316915+0.104415im      0.0150588+0.00826159im   -0.0216154-0.081207im      0.0983062-0.0432963im    -0.0495252-0.0316189im       0.126756-0.231469im     -0.153903+0.0736145im     -0.175025-0.0215655im   -0.0168906-0.194685im     -0.0255221+0.0711488im     -0.130895-0.0587078im      0.146542+0.0212853im     0.0801153-0.0603132im    -0.0820104-0.0214542im      -0.07776-0.0116515im     -0.107002+0.175058im      -0.0774509+0.129696im    -0.0156972-0.049481im      -0.287902-0.0338023im    0.0210188-0.0906763im     0.0659255-0.102967im     0.0288731-0.0401954im
  0.0975466-0.0192202im     0.0804038+0.0654886im     0.195282-0.0558331im     0.0173505-0.163049im     0.0129575+0.0290002im     -0.136297-0.160328im        0.113482+0.342689im      0.190581+0.0577233im  0.00445758+0.0686519im    -0.0440244-0.145994im     0.0101961+0.0889703im    -0.0110761+0.10544im      -0.0826557-0.135886im      -0.017959+0.00953476im   -0.0294365+0.191637im       -0.343804-0.0582026im   -0.0880701-0.193551im       -0.25408-0.069712im      0.194469-0.0756667im     0.0725174-0.195967im       -0.13928-0.18511im      -0.0564217-0.00718141im    0.0397694-0.0435126im     0.0791353+0.0527893im     -0.109669+0.0968234im      0.153399-0.250949im       0.0989543+0.0521883im    0.0958535-0.180832im     -0.0944166+0.0175399im    0.0222793+0.0763186im    -0.0111222-0.055991im     0.0605823+0.0882123im
  -0.215527+0.0925902im      0.018601+0.0242411im     0.116051+0.0577745im    -0.0553991-0.0912895im    -0.190263-0.099347im       0.115414-0.0528842im     -0.0614835+0.0337253im     0.159613-0.0946417im   0.0327253-0.175998im      -0.234834-0.0682003im     0.116144+0.133983im     -0.0135025-0.0999435im      0.141612-0.0138515im     -0.039064+0.00645071im     0.291501+0.224324im       0.0345649-0.0916024im    0.0285493-0.0487514im     0.0829039+0.0620473im    -0.132169-0.127206im      -0.109767+0.025864im      0.0500079+0.0325804im     -0.123515+0.115025im       0.247227+0.0649384im     -0.191456+0.194213im      -0.113594+0.0593001im     -0.130707-0.0820855im     -0.0540011+0.319821im      0.083823+0.0651751im    -0.0516448-0.0922497im    -0.128972-0.104169im      -0.165663+0.10539im      -0.162705-0.147299im
  0.0988918-0.00171237im    -0.141822+0.288444im    -0.0338533-0.0112052im    -0.0928574-0.201635im      0.102954-0.00118288im    -0.215525+0.189146im       -0.190121+0.176934im     -0.125367-0.141927im   -0.0547114-0.113283im       0.115017-0.0589046im     0.128336-0.193255im       0.144775-0.224im         -0.122348+0.0403957im     0.0662176+0.115089im      -0.103567+0.0327335im       0.128059+0.0605809im     0.214801-0.171952im     -0.0483868+0.106169im     -0.224457-0.0310429im   -0.00858467+0.0958208im     -0.166445-0.279891im       0.120858+0.138813im       -0.14737+0.0589862im    -0.0152242+0.0735176im     0.0512502+0.0954223im     0.0759114-0.0834786im      -0.108422+0.0344158im   -0.0225593-0.0428987im    -0.0489099+0.0466271im   -0.0397971-0.178995im      0.0216477+0.0508318im    -0.111974-0.0493219im
 0.00217254+0.115622im      0.0936579+0.0296907im  0.000131137-0.141453im     -0.0585331+0.0475185im   -0.0462284+0.178382im       0.034755-0.0454777im      -0.104128+0.0228046im    0.0943264+0.0908372im   0.0499162-0.154505im     0.00923926+0.213603im     -0.245577+0.00911331im     0.109543-0.0119918im      0.207135+0.10769im       0.0163887+0.122125im      -0.134147+0.00972574im      0.130091+0.172168im     -0.081373+0.0691787im   0.000785222-0.170438im    -0.0987893-0.133067im      0.0909003+0.186693im      -0.242959-0.00222763im    0.0122433-0.0753249im    -0.0218465-0.0815802im    -0.0236125+0.147008im      -0.148725-0.0746767im     0.0862804-0.143014im      -0.0752144+0.0333878im   -0.0945524-0.313421im       0.235647-0.106191im     0.0438004+0.329329im       -0.10349-0.0463904im    -0.110082-0.172297im
  -0.114481-0.161955im      -0.118666-0.178342im      0.111162-0.00210992im   -0.0916416-0.15465im      -0.133613+0.0359693im     0.0992832+0.052619im        0.133543-0.00479558im  -0.0531258+0.0978373im  -0.0239525-0.0920192im      0.121627-0.131521im      0.106928-0.0913363im    -0.0773854-0.18642im      -0.0520797-0.120347im      0.0111079-0.028357im      0.0604728-0.0787858im       0.113068-0.0166919im     0.119739+0.165771im      0.0710272+0.0855821im     -0.14037+0.0183164im      0.141771-0.23686im       -0.144742-0.235249im      -0.235334-0.250861im       0.188885-0.0480891im     0.0219369-0.231462im     -0.0544854-0.0249506im     0.0998952+0.201471im       0.0722612+0.0837882im   -0.0693092-0.183131im     -0.0458209+0.191018im      0.124113+0.197001im      0.0224978+0.0409584im   -0.0919281-0.141845im
  -0.123284+0.0627697im     0.0184127-0.0904116im    0.0237111-0.114405im       0.271643-0.194027im      0.115439+0.178522im      0.0708098+0.192681im        0.249937-0.143229im     0.0527756-0.0886113im   -0.151555-0.150742im      0.0565657+0.0437705im   0.00419314-0.0698493im   -0.00656022+0.0119421im     0.0855691+0.128335im       0.150037+0.0534349im   -0.00684359+0.311614im        0.119404-0.16567im      -0.175483+0.0606748im     0.0203832-0.042302im      0.124582-0.0346838im     0.0225482-0.0598542im     -0.107865-0.115412im       0.149545+0.221613im      -0.100476-0.172832im     -0.0312341+0.0155876im     0.0644479+0.0396607im      0.180046+0.106716im       0.0359258-0.0305598im     0.112419+0.300865im      -0.148477-0.00546134im  -0.0285562+0.16743im       0.0382948-0.0600496im   -0.0123728-0.127392im
  0.0548081+0.0196309im      0.232287+0.171268im       0.13983-0.168142im     -0.0695723-0.13328im     -0.0969036-0.0423479im     0.0838636+0.0341006im     -0.0756893+0.061931im    -0.0470275-0.239582im     0.056992-0.00331716im   -0.0236404+0.00883109im  -0.0568501+0.214636im      0.0855122-0.0527016im     -0.111133-0.0231349im     -0.295793-0.0289949im     0.0110879-0.0024814im       0.161409+0.0586055im     0.134267-0.102646im     -0.0202646+0.0211309im    0.0356216-0.109961im     -0.0276882-0.134134im       0.024526+0.128829im       0.233438+0.0839201im      0.147243+0.0326673im     -0.196616-0.175759im       0.200516-0.0983374im      0.170329+0.242934im       0.0168009-0.0201654im   -0.0200196-2.92391e-5im   -0.0279312-0.165016im      0.194011+0.248224im     -0.0071185-0.00731563im  0.00886866+0.247388im
  0.0672295+0.0753212im      0.081452+0.0416105im   -0.0464263+0.107691im       0.205323+0.00305005im     0.14545-0.0214935im     -0.296327+0.0434981im        0.14844-0.144683im    0.00427968-0.104767im   -0.0743148-0.0207016im      0.294137-0.0946831im     0.031512-0.084169im      0.0564579+0.0490438im   -0.00893076-0.0563207im     -0.260085-0.106809im        0.15378-0.135324im      -0.0491141-0.0138424im   -0.0240366-0.204813im       0.176092-0.0761699im   -0.0874639-0.0496758im    0.00441969+0.129912im      -0.154906+0.0449821im    -0.0320804-0.129708im       0.114871-0.00813728im    -0.143922+0.0144633im     -0.228061+0.0560887im    -0.0563041-0.00289581im   -0.00383242+0.327654im     0.0552068+0.148806im        0.21367+0.0547131im     0.111907+0.098462im      0.0719108-0.196458im      0.166436+0.025042im
  0.0907416-0.00689582im    -0.106611-0.103633im     0.0830674-0.0517315im      -0.11951-0.090594im      0.108945+0.107477im      0.0439577-0.000896943im    -0.196561+0.153499im     -0.154515-0.107536im   0.00840227+0.0599283im     -0.183821-0.0643999im     0.148127+0.00686374im   -0.0124332+0.239873im       0.149059-0.0855777im    -0.0963472+0.00198426im     -0.20319+0.181042im       0.0547954+0.249053im     -0.138621+0.263413im       0.167947-0.211457im     -0.010712+0.083856im      -0.204528-0.119237im      -0.122138-0.0668262im      0.155622-0.167665im      0.0236708-0.0145907im     0.0478449-0.0999575im    -0.0953053+0.00389574im   -0.0641639+0.0138227im      0.0153374+0.277104im     -0.128371+0.184092im     0.00246388-0.00176677im  -0.0652627-0.113069im       0.142766-0.126468im    -0.0508977+0.0951391im
   0.101039-0.166538im     -0.0126528+0.0330183im    0.0712754-0.261874im     -0.0799499+0.0548492im    0.0528969+0.00195924im    -0.127622-0.0523032im     0.00139651-0.172953im     0.0480052+0.13417im    -0.0674634-0.0124604im     0.0550349-0.0148918im     0.173638+0.00563897im    -0.327478-0.0232181im     0.0596501+0.0529121im    -0.0864277+0.298945im     -0.0354875+0.0133867im       -0.13928+0.0132144im   3.05195e-5-0.0827719im     -0.246927+0.00516137im   0.0382112-0.0937446im     -0.118762+0.0962547im     0.0779499-0.0114964im     -0.106128-0.128239im     0.00297278+0.207687im      0.0234717+0.0803649im      0.202349+0.0142392im     -0.102142+0.157852im       -0.164433+0.0536171im    0.0670932+0.152925im       0.055795-0.0563211im    0.0138147+0.16534im        0.140127-0.171463im      -0.36071-0.0527035im
  -0.176845-0.11415im       -0.216846-0.0991046im     0.171668-0.0780932im     0.0244624+0.0623646im    -0.129099-0.0237165im     0.0144395-0.0570031im       -0.11057-0.105618im     -0.137474-0.120072im     0.260594+0.299869im       0.206503+0.137054im      0.141703+0.238714im      0.0744771-0.0836066im    -0.0439029+0.0299894im      0.147967+0.116089im       0.175681+0.0533433im      0.0388389-0.171257im     -0.116959-0.0566995im     -0.027904-0.0338246im   0.00223585+0.25834im        0.060721-0.0414741im     -0.141645-0.155297im       0.112199+0.129381im     0.00744247+0.052872im    -0.00581987+0.0788904im      0.100077+0.0621605im    -0.0451572-0.0926131im      -0.011423+0.0505857im    -0.112694-0.031262im       0.259803+0.0168977im   -0.0254245+0.0625543im      -0.10869-0.235669im     0.0716209+0.102635im
  -0.161099-0.0675695im     -0.153572+0.240031im      0.353044+0.0585959im     0.0160221-0.0733466im    0.0471408-0.000216652im   0.0651445-0.171112im       0.0401692-0.0866454im    -0.229068-0.150811im    -0.319819-0.0907661im    -0.0176005+0.235236im     -0.024895+0.102744im     -0.0461912+0.097951im     -0.0273075+0.0839874im      0.103154-0.0506224im    -0.0879827-0.160729im       0.0390478+0.181695im     -0.129702+0.0268261im     -0.216532+0.215197im     0.0843412+0.102164im       0.120281+0.108365im     -0.0760242+0.0908898im     -0.126868-0.092031im      0.0339373+0.16661im      -0.0706881+0.0150587im      -0.08444-0.0952989im     0.0950517-0.0955426im      0.0611714+0.119607im     0.0369969+0.0731933im     -0.102123-0.0866154im    0.0801617-0.0641142im     0.0758876+0.0645199im     0.154439-0.0875905im
   0.176591-0.0605358im    -0.0813596+0.0149703im    0.0490826-0.167567im      0.0248228-0.0827508im    0.0157245-0.0962304im      0.109281+0.0304732im    -0.00403787-0.188972im    -0.0995249-0.0395071im   -0.135502-0.174924im       0.149534-0.24689im     -0.0258357+0.0966631im     0.0320309+0.0786563im      0.264543-0.0906941im   -0.00400383+0.0577211im     -0.013991+0.0901507im      -0.103808+0.0155716im     0.110748-0.0736845im    -0.0211631+0.164202im      0.112944+0.0729208im     0.0110115+0.16937im       0.0758537-0.0650114im    -0.0698108-0.0760659im    -0.0568016-0.30962im       -0.244141-0.0313052im     0.0304273-0.12153im       -0.138066-0.0819242im      0.0712958-0.0457508im    -0.267058-0.120794im      -0.023164+0.048757im     -0.342444+0.063969im      -0.122478+0.0457379im    0.0723508+0.216632im
 -0.0856448-0.105847im       0.177203-0.0513964im    -0.206274+0.117167im     -0.0482049+0.156301im     -0.146169+0.121003im     -0.0192156-0.0898462im       0.109445+0.0590823im    -0.217563-0.209874im     -0.10113-0.134193im     -0.0284782-0.194915im    -0.0098303+0.00113486im    -0.061595+0.172545im     -0.0483923+0.0240908im     -0.288986-0.036124im     -0.0829001-0.074758im       0.0946035-0.0739327im    0.0922323+0.219869im     -0.0950243+0.127114im       0.23234+0.158211im     0.00850339+0.0675688im     0.0618501-0.212879im      0.0780533+0.149356im      -0.128262+0.13318im       0.0199066+0.00231115im  -0.00829002+0.113808im     -0.0158063-0.191357im     -0.00305562+0.0766512im    0.0712711-0.0181803im     0.0788355+0.0944738im    0.0459954+0.122043im      -0.286924-0.0758709im    -0.177318-0.0842334im
  0.0660363-0.00116658im     0.012304+0.110851im      0.191718+0.105775im       0.108305+0.0772065im    -0.102437-0.0431268im      0.242114+0.026392im       0.0111944+0.00865026im    0.100864+0.135198im    0.0922857+0.0444738im      0.119834-0.0163811im   -0.0849431-0.0404198im      0.149379+0.0259995im    -0.0350465-0.327798im     -0.0191623+0.0466685im     0.0091495-0.151268im       0.0824013+0.0374838im    -0.178013-0.023693im       0.159024+0.2153im       0.0450742-0.0784972im     -0.243584+0.201532im    -0.00308243-0.115856im      0.0485396-0.15966im       0.0782005-0.111251im        0.12171+0.0222086im       0.19509+0.198258im       0.168818-0.270993im      -0.0446582-0.0658543im    -0.103294+0.263742im     -0.0849999+0.0041856im     0.137447+0.0281796im     -0.025617+0.00730808im   -0.191865-0.0216064im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
     0.130475422464627 + 0.15052478910415507im
   0.05509778788879645 - 0.017784180783460217im
  -0.07461505020091819 - 0.1406069506846006im
 -0.017082298229231005 + 0.2846435920948698im
  -0.21359823329053698 + 0.03405668865410546im
  -0.11563886590600081 - 0.09070178097817753im
   0.10925285006114352 - 0.09444511126892091im
 0.0018683597598491974 + 0.22479487802550824im
 -0.018105763847547113 - 0.2542174380824458im
  -0.07242636231487454 - 0.12772579474837395im
 -0.025121583730132558 - 0.09309786883852238im
  -0.11945323975700287 - 0.014674523470392345im
   0.20915110331927156 + 0.013184047690886963im
    0.4162164833500539 + 0.0im
 -0.015459605688804702 + 0.11969374914662455im
 -0.057983714156815414 + 0.016675499944125656im
  0.027287737241646036 + 0.005577150670238963im
  0.034944839017077026 + 0.087423608842402im
  -0.15484661162515584 - 0.11050460859787314im
  -0.10643008673609045 + 0.0826258636631033im
   0.04946808831418163 - 0.006594480293783341im
   0.10515766864067493 - 0.04599634722090326im
  -0.20469645192994787 + 0.015519118882156104im
   0.04214901910601851 - 0.0008446122165140166im
  0.015348741478834894 - 0.05863616854768188im
   0.16523310554400372 + 0.01755835540014159im
    -0.103233428386142 - 0.08556711485830984im
   0.24118071441120958 + 0.14677782205930218im
    0.2017039939059434 - 0.02647177276930008im
 -0.021822448819067173 - 0.11414296148884884im
   0.15643768251226156 - 0.08732595516277843im
   0.05596662265366352 - 0.14906783624781678im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 29 April 2023 02:21">Saturday 29 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
     -0.1428-0.355104im      0.209309-0.0887484im     0.0603075+0.0628417im    0.0591349+0.031338im    0.0282716+0.0432189im     0.0558435-0.102785im       0.0242025-0.135523im    -0.110788+0.106756im        0.248848+0.0770413im     0.241305-0.0455171im     -0.146089+0.043619im    -0.0285931+0.114858im     0.00627864-0.0796363im    -0.307131+0.0780245im     -0.315242+0.0262457im      0.0351576+0.046088im    -0.0332471-0.00989401im     -0.168205-0.0227726im   -0.0151133+0.0586724im    -0.0940065+0.115336im     -0.0124635-0.0461997im     -0.112207-0.216025im     -0.0263806-0.0349354im      0.056458-0.0788743im  -3.44041e-5-0.0959326im   -0.0890246+0.0245169im     -0.0482092+0.0597359im    0.0584543-0.0885399im     -0.256652-0.0228659im     -0.0392292+0.204883im    -0.0322934-0.24194im       -0.138566+0.0536677im
  -0.0254063-0.124471im     -0.157153-0.281939im      0.0602453+0.0125628im   -0.0223718-0.0479977im   -0.144187-0.28007im      -0.0166375+0.0867357im      0.0616774+0.0299729im    0.162589+0.0875877im      -0.246294+0.0416762im     0.122947+0.121355im     -0.0690502-0.0999544im    0.0884743+0.0612005im     -0.249315+0.0175676im   0.00851934-0.228795im       0.139664+0.113879im      -0.0873854-0.00613448im   -0.201504-0.0104891im      -0.122472-0.0308097im    0.0500482+0.231942im      0.0755133-0.0644549im     0.0542902-0.101316im       0.168323+0.019272im       0.124287+0.0277592im      0.125571+0.156772im    -0.0122926-0.0740674im   -0.0848808-0.0655321im     -0.0175744+0.254049im    -0.0326493-0.200612im      -0.216286-0.109407im        0.067517+0.114475im     -0.103709+0.139061im      0.0407905+0.0294949im
  -0.0489709+0.0970153im    0.0914849-0.168727im      -0.212264-0.145811im     0.0279802+0.0376878im   -0.170376+0.217547im      -0.308796-0.00246506im     -0.157367+0.197198im    -0.298927-0.169226im       0.0555014+0.109411im     -0.184824+0.115837im       0.129241+0.0435961im   -0.0196938+0.131365im      0.0814105+0.20692im        0.03299-0.161908im     -0.0866162+0.00502108im     -0.124641+0.0925032im    -0.018122-0.0292881im     -0.0492516+0.0896464im     0.225181+0.0156922im    -0.0228948+0.0922772im   -0.00838683+0.276059im    -0.00650165+0.0690914im     -0.045464+0.0307675im      0.169895+0.231515im    -0.0575901-0.0667127im    0.0254771-0.0499009im     -0.0317237+0.0663461im      0.11509-0.0910419im     -0.139314+0.0261505im      0.0532149+0.00615823im  -0.0612647-0.112025im     -0.0693112+0.04577im
  -0.0611031-0.181316im     0.0778478+0.0681034im    -0.0584203+0.129647im     -0.230524-0.306131im    -0.127882-0.13157im       -0.038072+0.00698976im      0.188285+0.165159im    -0.126186+0.0793284im      -0.066835-0.0893438im    -0.130073+0.0902535im     -0.236602+0.0433447im   -0.0249525+0.0862537im     0.0295621+0.0199494im    0.0454251+0.0317342im   0.000113689+0.156638im      -0.0388482-0.118381im      -0.12307+0.00750803im    -0.0593926+0.107031im      0.134142+0.083049im      0.0127346+0.00703147im    0.0323582+0.0590234im    -0.0817642+0.0807843im     -0.101891-0.0804387im     0.0972713-0.240232im     -0.106875+0.0094091im    0.0774689-0.168696im      -0.0191201-0.0869607im   -0.0294599+0.385127im     0.00335967-0.129466im        0.282493-0.0560292im     0.135114-0.092981im     -0.0110801-0.175461im
     0.13747+0.102695im      0.118033-0.244402im      0.0872872-0.014025im      0.113028+0.037898im   -0.0603023+0.0143803im       0.20335-0.262548im      0.00422181+0.21607im     0.0775555+0.127035im       -0.191176-0.0639754im    0.0831682-0.0620574im    -0.0157639-0.0590625im     0.114592+0.0725206im     0.0867368+0.0982889im    0.0163777-0.229431im      0.0487972-0.0358455im       0.302403-0.039279im    -0.0560005-0.133502im        0.163689+0.0551865im    0.0400115-0.116957im       0.157659+0.0730991im    -0.0479332+0.0488376im     0.0134108-0.131364im      -0.272229-0.0779423im    0.00296021+0.0359934im    0.0533393+0.0607313im   -0.0806855+0.276803im       0.0894063-0.0405073im      0.14203+0.160063im     -0.0970129+0.132821im       0.0555392+0.162611im     0.0379152-0.0828014im     0.0177667-0.203551im
  -0.0937527-0.124682im     0.0592703-0.021168im       0.132847+0.00842195im  -0.0142536-0.0360192im  -0.0272553+0.0541231im     -0.324397+0.0161579im       0.150969-0.103127im     0.217908-0.0310735im      0.0342625+0.102453im   -0.00482348-0.0724675im     0.0779302+0.0515255im     0.115715+0.1503im        -0.149297-0.0248601im     0.117268-0.0922072im     -0.175503-0.126283im        0.104622+0.175653im     0.0220793-0.0431109im       0.261489-0.111023im     0.0331346+0.10609im        -0.11199+0.239763im       0.197286+0.0459713im      0.161915+0.00668203im    -0.228782-0.162816im      0.0254263-0.105558im    -0.0134657-0.230988im   -0.00684211-0.133207im        0.189988-0.159144im     0.0109836-0.00507077im     0.207651+0.000723999im  -0.00333475+0.0641482im   -0.0518808+0.133414im       0.202256+0.0342229im
  -0.0505939+0.133603im      -0.28472-0.199377im      -0.141719+0.179025im     -0.065801-0.0813191im    0.138217-0.00598751im      0.12658-0.202498im      -0.0730305-0.332726im   -0.0971738+0.0447612im     -0.0277893+0.0835771im   -0.0495357+0.12596im       0.0347599-0.0799614im   -0.0728898-0.125773im       0.137149+0.107703im      0.183121+0.172755im      -0.288223-0.100389im       0.0922182-0.0420203im    -0.210802+0.11357im        0.0437594-0.00840286im    0.207485+0.235933im     -0.0212587-0.123979im     -0.0639715-0.0404873im      0.154422+0.0486899im      -0.03031-0.0735638im     0.0947233-0.0100369im    0.0819524+0.0569242im   -0.0716828-0.0978145im      -0.093773-0.0639391im     0.136674+0.0623357im     0.0577915+0.0967512im      -0.103072+0.119715im     -0.052835-0.0680422im      0.109124-0.0414637im
  -0.0160785+0.0104988im   0.00197517-0.048345im       0.280702+0.00617658im   -0.146617-0.0152919im   0.0103253-0.0161405im    -0.0529392+0.00575252im     0.0295235-0.0272075im   -0.192909-0.297684im       -0.222014-0.173436im     0.0874887+0.0606159im    0.00937039-0.0298115im    -0.127854-0.162597im      0.0773622+0.0829597im    -0.136898+0.0264441im      0.068151+0.0991285im      -0.111622+0.144946im      0.139258-0.0368639im     -0.0743627+0.108153im     -0.213242+0.070891im       0.230577+0.0471347im     0.0466191+0.101581im      0.0637507-0.11016im      0.00274842-0.101438im      0.0540614-0.194442im      0.190473-0.183415im   0.000737525-0.0829953im      -0.148595+0.0509125im     0.107048-0.191561im       0.125464+0.262138im       0.0347955+0.0502197im     0.100692-0.14069im         0.21216-0.122565im
   -0.213756+0.0453269im   -0.0142851+0.0276211im    -0.0977398+0.0616706im    -0.134362+0.101733im   -0.0982911-0.0149905im      0.155049-0.148406im       0.0445641-0.0235463im    0.123978-0.115613im       0.0958188-0.181im       -0.0798438-0.00113798im  -0.00291092-0.150308im     0.0169508+0.220506im       0.134125-0.0526574im   -0.0264839-0.156189im      0.0723902-0.175121im      -0.0465413-0.166454im     0.0519799+0.137181im         0.21422+0.206127im    -0.0816944-0.00498598im    0.0786706-0.00804098im   -0.0541465-0.00626245im   -0.0636894-0.117312im      -0.129869+0.0041572im      0.166504-0.102397im     -0.288981-0.0854094im     0.243796-0.044424im       -0.261099+0.0898412im    -0.127493-0.15273im     -0.00741495-0.16794im        -0.243268+0.0414119im    -0.146241-0.00321064im     0.116182-0.00311969im
   -0.164037-0.0153857im    -0.251662-0.0433988im     0.0354205+0.10207im      0.0104003+0.066722im     0.103102+0.0433273im    -0.0837751-0.0510581im      -0.111734+0.0706893im   0.0144331+0.0722456im       -0.13988-0.108979im    -0.0604741-0.355877im     0.00240649+0.0664301im    -0.167784-0.0991423im    -0.0207704-0.0649787im    -0.195973-0.237246im      0.0499596+0.0739107im     -0.0305512+0.0923112im   0.00165069-0.300361im        0.095268-0.263971im      0.154093+0.0410922im     -0.136694+0.0731387im    -0.0249358-0.0670238im    -0.0245958+0.101908im      0.0836388-0.125867im       0.208015-0.0531643im   0.00208905+0.0919923im   0.00207117+0.0397498im      -0.117496-0.00340395im  -0.0500714+0.078948im     -0.0196057-0.101404im       -0.166291-0.272043im    0.00812832-0.271368im      0.0518854-0.0253102im
    0.114998+0.0308529im   -0.0904334-0.0657168im    -0.0502071-0.127477im     0.0102178+0.0390457im  -0.0273137-0.0451395im     -0.343112-0.178976im     -0.00802832-0.0513548im   0.0444581+0.204057im       0.0871437-0.126389im     0.0546731+0.0215982im    -0.0620586-0.201342im      0.244827-0.00357973im    0.0709391+0.201079im     -0.132563+0.155812im      0.0482783-0.102728im       -0.189794+0.138533im     -0.113538-0.0385416im     -0.0260805+0.0569197im   -0.0996543-0.164585im      0.0124951-0.0724227im     -0.172233+0.00656424im    0.0675318+0.118007im      0.0263481-0.0283653im    -0.0990442-0.103824im    -0.0468298-0.243985im     -0.259925+0.173472im       -0.209869-0.0190347im    -0.047623+0.148199im      0.0319408-0.214272im      -0.0346276-0.00788122im       0.179-0.0352672im       0.12121+0.11003im
   0.0678303-0.0920185im     0.159162-0.0342792im    -0.0240534-0.0686679im   0.00924877-0.145605im    0.0372703+0.349546im     -0.0142371-0.0340293im    -0.00404905-0.300343im     0.115713+0.115567im      -0.0713266-0.108977im     -0.165556+0.14986im      -0.0383721-0.243625im    -0.0515539-0.0249664im    -0.0887015-0.217644im     0.0393019+0.139852im       0.315168+0.0249619im      -0.245646+0.144122im     0.0411793+0.0655607im     -0.0623511-0.154478im      0.225525-0.0564296im    -0.0114069+0.0164791im    -0.0196217-0.063444im      -0.110532-0.177504im      -0.192884-0.0956631im      0.146636+0.158472im     0.0637499+0.0613091im     0.028094+0.106619im       0.0058866-0.0185618im   -0.0597732-0.0670641im    -0.0081189+0.00185904im     0.0849887+0.0130186im   -0.0510528-0.0463136im     0.0807271-0.164746im
  -0.0711453+0.191634im     0.0999241+0.061616im      -0.062159-0.0376531im    -0.011411-0.218587im    -0.144425+0.025939im    -0.00974687+0.00277727im     -0.210122+0.135754im    -0.103097+0.00556713im     -0.161007+0.122365im      0.410521+0.0596004im      0.124235-0.181383im      0.292461+0.0145466im     -0.178676-0.255242im     -0.124983+0.0722641im    -0.0440296+0.000555999im   -0.0463399-0.0354612im    -0.010958+0.0589902im      -0.116855-0.00350333im  -0.0275029+0.155664im     -0.0837894+0.0987581im     -0.136272+0.00308433im     0.166488+0.033281im    0.000735701-0.0960973im     0.0232738-0.080131im     -0.150805+0.121177im      0.168503+0.105493im      -0.0770596-0.193778im     0.0802819+0.00331954im     0.171479+0.0537026im     -0.0872203-0.132432im    -0.0991708-0.071531im      -0.053401-0.0358954im
   0.0888953+0.0925095im     0.127343-0.0497364im     -0.255635+0.15443im        0.11317+0.129841im    0.0412276-0.3452im        -0.108642+0.00658024im        0.0123-0.234864im    0.0150515+0.0950964im      0.0360906+0.264009im    -0.0214193-0.13483im       0.0656653-0.0351867im   -0.0602232+0.114799im     -0.0455711+0.00835252im  -0.0615649-0.183438im       0.131696+0.0193599im     -0.0887841+0.134666im      0.159159+0.0169365im      -0.165353+0.0315687im     0.109891-0.0281722im      0.112362-0.0823638im     0.0789087-0.0606511im    -0.0524313+0.0295787im    -0.0483781+0.0359383im      -0.12561-0.141243im     -0.141585+0.147693im      0.263462+0.0219589im      0.0203695-0.021562im        0.1094+0.00398255im    0.0353913+0.149329im       0.0990844+0.119516im      0.179863-0.191518im       0.251048+0.0996235im
  -0.0823465+0.0596148im   -0.0912005+0.0143861im      0.056606-0.0714142im   -0.0105522+0.0857252im  -0.0360044-0.239659im      0.0345637+0.182761im       0.0564938+0.0294209im   -0.211286+0.21985im        -0.011268-0.183166im     -0.141177+0.00220594im    -0.156981+0.0114416im    -0.159194-0.0413632im     -0.239543-0.0590451im   -0.0755319-0.0905298im     -0.280395-0.363576im       -0.234005-0.0255159im   -0.0606003+0.158018im       0.0983362+0.00259929im  -0.0581288-0.0617587im     0.0851748+0.126045im      -0.116099+0.043416im      0.0616489-0.0362365im     -0.223634-0.0670168im    -0.0290944+0.137503im     0.0343272+0.175759im    -0.0651777+0.142815im    -0.000346381-0.105267im    -0.0653034-0.15754im        0.069043+0.0945113im        0.20206-0.0767645im    0.0262378-0.0317678im    -0.0336425+0.0712106im
 -0.00755995-0.226127im      0.136445+0.0741739im      0.215685-0.0472081im   -0.0318906+0.0227617im  0.00829678-0.150394im        0.07071+0.0862943im      -0.108938-0.181683im   0.00229321-0.0862805im      -0.151499-0.0367563im     0.112466-0.126169im      -0.130224-0.0844081im     0.118175-0.0198465im      0.312254+0.0508589im   -0.0594373-0.0666484im      -0.08865+0.00460161im     -0.196157+0.0372681im    -0.187796-0.122883im      -0.0621189+0.0919006im     0.260559-0.118166im       0.116265-0.101851im       0.188112+0.27154im      -0.0935428+0.159873im    -0.00598852-0.0305217im    -0.0167288+0.149373im    -0.0434986+0.15517im      0.0323615+0.0489565im      0.0271025-0.19933im     -0.0604053+0.0427492im      0.102997+0.0323347im      -0.209891+0.0413307im    -0.161913+0.187947im    -0.00833045+0.100174im
   -0.191984+0.0878948im    0.0191129+0.0804852im     -0.200778+0.200481im     0.0761344+0.124234im    0.0016216+0.00822932im    -0.133645+0.0924642im       0.010869-0.0323322im  -0.0306902-0.0640136im      0.0361722+0.0171625im     0.143607+0.109731im    -0.00203096+0.22275im        0.05931+0.105501im     -0.0130598-0.0733381im    0.0475211+0.0517074im     0.0977222-0.0620752im     -0.0229804-0.120097im     -0.267579-0.355391im         0.02849+0.0448698im     0.032674+0.0709565im    -0.0282489-0.0850446im     0.0191453+0.12424im      -0.0813437-0.377779im     -0.0154022-0.0614215im    -0.0635717-0.0217139im      0.33276+0.0665366im    0.0382599+0.166243im        -0.22801-0.0091733im   -0.0415063-0.00255679im   0.00941443-0.038489im        0.110705-0.0673656im    0.0559997+0.224453im       0.135371+0.00102089im
   0.0339154-0.111643im     -0.175962-0.167992im       0.222615-0.0207246im     0.151654+0.0936322im   -0.162724+0.0026477im      0.131606-0.00723998im     0.0116745-0.145076im    -0.225297+0.151057im      -0.0764101+0.0223213im    -0.138535+0.121431im    -0.00504234+0.11053im       0.211992-0.10282im        0.137279-0.0677957im     0.112753+0.007584im       0.149492-0.075345im        0.226342-0.0131877im     0.146304+0.0262275im      -0.192853-0.104107im     0.0729092+0.0237122im     -0.096758+0.2684im        -0.157073+0.249619im      -0.043671+0.0160766im   0.000200576-0.032742im     -0.0118882-0.192331im     0.0178933+0.0191525im     0.244896+0.0111212im     -0.0402058+0.0235193im   -0.0313485-0.112249im      0.0254593-0.220096im       0.0198175-0.0260604im     0.144714+0.103206im       0.017976+0.199472im
  -0.0528056-0.0501645im    0.0264844-0.0271889im     -0.120015+0.188304im     0.0598311-0.0291007im    -0.12119-0.146266im      0.0907265-0.0352342im     -0.0450002-0.0297557im   -0.088483-0.0167231im    -0.00595263+0.0504846im    0.0954682+0.0247733im      0.176118+0.0443968im    -0.141917-0.261195im      -0.061787+0.0990951im    -0.131364+0.00699262im     0.240099-0.124968im     -0.00416331-0.0143425im       0.1357+0.160233im       0.0890393-0.236764im    -0.0522769-0.0516459im    -0.0325177+0.11154im        0.164237+0.225391im     -0.0244435-0.0436466im     0.0265313+0.0546746im    -0.0368073+0.0626375im   -0.0616299-0.184276im     -0.154937+0.04213im         -0.18514-0.0795039im    -0.114049+0.311879im      0.0178356-0.0101979im       0.159873+0.140241im     -0.407843+0.00949059im   -0.0039026+0.0397175im
  -0.0675308-0.0666499im    0.0365411+0.03997im      -0.0859934-0.0540787im    0.0826734-0.116914im    0.0166507-0.120758im      0.0644438-0.180718im        0.117922+0.0507286im   -0.161173-0.166303im        0.154973-0.163292im     0.0575859+0.068673im      -0.106708-0.0972253im   -0.0355004-0.0612504im     -0.168431+0.0800425im   -0.0726804+0.0321155im     0.0695984+0.0612835im       0.143957-0.0338847im     0.067938+0.0264477im     -0.0392023-0.0622419im     0.142926+0.0408291im     -0.293561-0.181775im       0.222532+0.125021im      0.0913918+0.230235im      -0.332838+0.14072im       -0.149265-0.0848102im    0.0573987+0.0352007im   -0.0591907+0.203403im       0.0427037+0.130664im     0.0257407-0.20254im      -0.0987634+0.0245529im       -0.14414-0.235657im       0.01365+0.0696333im      0.192231-0.0455622im
   0.0920047+0.0753171im   0.00116883+0.0814884im      0.108219-0.00195291im   0.0676961-0.0176888im   -0.043533+0.0733029im     -0.288055+0.155297im        0.136821-0.187894im     -0.20442-0.000846513im    -0.121476-0.0464806im    0.0672849-0.0436805im    -0.0568313-0.0497545im   -0.0807982-0.0292675im    -0.0821146-0.134285im    -0.0987967-0.159367im     -0.0392928+0.0351317im       0.320761-0.0803294im     0.190527+0.104618im      -0.0015831+0.278604im     0.0740977+0.026553im      0.0391419-0.166296im       -0.18263-0.212795im      -0.109133+0.0914453im    -0.0975242-0.00618244im    0.0666369+0.148526im       0.18238-0.111im         0.050889-0.00218275im      -0.11978-0.121793im    -0.0103781+0.226488im      -0.210107-0.0267548im     -0.0797669-0.0140517im    -0.170878+0.109997im      0.0828846+0.142761im
   -0.219884-0.0619908im   0.00483158+0.0437724im    -0.0917374+0.28245im     -0.0657068+0.335064im    -0.215048-0.0408041im    -0.0497205+0.0133788im     -0.0352353+0.159978im    0.0729513+0.0928849im      -0.148462-0.0117079im    -0.162264+0.160372im      0.0407715-0.265141im    -0.0026594-0.287789im      -0.162733-0.0820644im   -0.0494732+0.156239im     -0.0691393+0.0615522im      0.0787277-0.0510589im     0.069831-0.13472im       -0.0309872+0.0640666im    0.0550445-0.0187784im   -0.00400169-0.121871im      0.0152691+0.0396596im     -0.220877-0.0152722im    -0.0237257+0.0480626im     0.0637826+0.0444858im   -0.0656668-0.197853im    -0.0589545+0.0170186im       0.235783-0.167677im      0.132835-0.0751373im     0.0733232+0.024773im       -0.166944+0.0995423im       0.1749+0.0164905im    -0.0867989+0.0283054im
    0.093191-0.101155im     -0.136729+0.0206631im    -0.0533427-0.0273237im    -0.195201+0.173181im   -0.0142987-0.0250426im     0.0092576+0.0246295im       0.046094-0.0138445im  -0.0654848-0.0810009im     0.00432281+0.131796im    -0.0100511+0.11444im      -0.0193546+0.0335873im     0.236833+0.100743im      -0.154186+0.106641im     0.0543924+0.14738im       -0.117251+0.0363684im      0.0241034-0.185118im      0.198671-0.0185255im      0.0740803-0.101882im     0.0340752-0.159997im      0.0676818+0.0674294im      0.236727-0.133191im      -0.136375+0.248069im        0.12698-0.449505im     -0.0355627+0.121025im      0.088113+0.0121907im     0.134289+0.223289im       -0.178666+0.0398408im    -0.101605-0.0544605im    -0.0786674+0.0356834im     0.00718437+0.0691234im    -0.041554-0.114842im      0.0165242-0.194561im
  -0.0906644-0.259584im    -0.0282067+0.0288793im     -0.165137+0.307949im      0.240057-0.135955im    0.0548117+0.225246im      0.0239311-0.00911322im      -0.05277+0.0599633im  -0.0330579-0.0851211im      -0.402628-0.0493025im   -0.0368732-0.196469im      0.0470526+0.00561589im   0.0182034+0.234366im     -0.0343003+0.0675634im    0.0190049+0.0477227im    -0.0322319-0.0198404im      0.0451466-0.0511815im    0.0660402+0.169994im      -0.0441462-0.02492im      0.0564316-0.175406im       0.112892-0.106068im     -0.0391831-0.0161907im      0.162764+0.0010178im    -0.0869167-0.117729im      -0.271481+0.0391273im   -0.0579096-0.0516137im    -0.129207-0.120326im       -0.160738+0.0205715im   -0.0734215-0.147269im      0.0415602+0.0247279im      0.0400814-0.0263047im     0.160058+0.0260424im     -0.129003+0.148817im
    0.202996+0.156427im    -0.0948644-0.112959im      0.0549082+0.0116199im    -0.142658+0.0880579im  -0.0252527+0.0625109im     0.0924899-0.0818052im      -0.163774-0.102171im    -0.152786-0.0418329im     -0.0173688-0.0798488im   -0.0779872-0.0482018im     -0.179232-0.0469783im   0.00347825+0.100169im      -0.167652-0.0164061im    0.0325368+0.0129397im    -0.0303088+0.118341im     -0.00634151-0.0281636im    -0.151249-0.0850991im     -0.0676485-0.118165im     -0.198671-0.182352im      -0.114977-0.199405im       0.172772+0.0932168im      0.125215-0.28649im     -0.00601369-0.150415im      -0.101255+0.0143475im    -0.186425-0.193052im      0.187521-0.142727im        0.165273-0.203341im    0.00107191+0.0760646im     -0.240857+0.036539im        0.041168-0.175541im     -0.106943-0.0298737im     0.0658195+0.200103im
    0.281556-0.00818502im   0.0636202-0.0535046im    -0.0802917+0.134335im      0.212165-0.0489606im   -0.109838-0.121923im      0.0368312-0.0788066im   -0.000614536-0.0827048im  -0.0599668-0.189426im      -0.0792013+0.158466im     -0.126781-0.104628im     -0.0444162+0.210065im     0.0687568-0.131647im      -0.042964-0.211718im      0.177345+0.136842im      -0.105038-0.0174299im      -0.187926-0.074202im     0.0362775-0.126714im    -0.000443472+0.22261im      0.0261465-0.084608im         0.1623+0.177658im      0.0437674-0.132328im      0.0298706-0.0185013im    -0.0357238+0.0970639im      0.226616-0.185479im     -0.115859-0.102795im     -0.275724+0.134975im       0.0473354-0.0218882im   -0.0305866-0.0951685im     -0.106007-0.0767684im     -0.0860393-0.236531im     -0.133135+0.00245442im    0.0456845-0.0665452im
    0.167325-0.0706166im    0.0788592-0.105555im       0.134399-0.00282902im    -0.21368+0.137931im   0.00504878+0.143967im      0.0659184+0.0767783im      0.0554867+0.268489im     0.119287-0.0134671im    -0.00544668-0.134726im   -0.00402187+0.00236503im     0.238057+0.252126im     0.0341346-0.0423817im     0.0180836-0.138788im     0.0423866+0.0181288im     -0.134834-0.222434im      -0.0657839-0.0660348im    0.0356066-0.0607632im      -0.286063-0.0654583im     0.249436+0.0309688im     -0.119785-0.296495im      -0.056324-0.101956im       0.126885+0.0401097im    -0.0599932+0.148796im    -0.00553093-0.0938403im    -0.074717-0.0859187im    0.0276716+0.0892271im      -0.112896-0.0500331im    -0.187716+0.0252853im     0.0260621+0.0945548im      0.0896095+0.166075im    -0.0657455-0.108116im       0.210044+0.0795406im
  -0.0383255-0.042365im      0.420173+0.00421137im    0.0772612+0.101782im    -0.0452745+0.214748im     0.183868-0.0152927im      -0.12587-0.15994im        -0.115076+0.0540389im    0.042278+0.152568im      -0.0548026+0.152306im     -0.115155+0.032022im      0.0148895-0.0782618im   -0.0448111-0.14739im        0.134995+0.0869894im    -0.118448+0.0263758im    -0.0329002+0.00218977im      0.137398-0.0664929im    -0.122531+0.18288im        0.0759363-0.036816im    0.00989801+0.104394im       0.079769+0.0316874im     -0.104343+0.00433574im     0.168228+0.0837755im      0.171046-0.0458172im    -0.0230162-0.0454068im   0.00816494-0.0285107im     0.108551-0.0107527im     -0.0184075-0.097738im     -0.226817-0.178313im      -0.213297+0.0202822im       0.183063-0.311534im    -0.0449713+0.14956im        0.120433-0.167695im
   0.0161117+0.00489942im   0.0537002-0.131642im    -0.00877132-0.0822396im   -0.0490994-0.0790827im  -0.0749215-0.0935783im      -0.16071+0.154844im      -0.0783976-0.0766493im   0.0492115+0.0636526im      -0.170791-0.0287596im    0.0907492-0.115686im       0.374074-0.0734436im    -0.117456-0.00149352im    0.0975561+0.217562im     0.0814254+0.0902078im     -0.033211-0.0316466im     -0.0391516-0.186059im     0.0682652+0.0429146im     -0.0189776+0.0205148im    -0.224386-0.0945193im      -0.22145-0.158944im      0.0794916+0.0319169im     -0.121031-0.0580695im     -0.166824-0.123155im       0.169294-0.256608im      0.122558+0.280736im     -0.077641-0.0386221im       0.129738-0.0989641im   -0.0715489-0.148097im      -0.194148-0.229374im      0.00935753+0.0634138im   -0.0149668-0.026381im     -0.0711796-0.039402im
    0.101221+0.118828im      0.147171-0.114551im      -0.195308+0.0201751im    -0.259653-0.140438im     -0.21416+0.0350797im    -0.0198866-0.0311017im      0.0876327-0.132616im     0.109099-0.0263036im     -0.0551544+0.077791im     0.0389908+0.0786408im    -0.0540896+0.0471384im    -0.180341-0.155774im       0.105217-0.101694im    -0.0551021-0.179229im      -0.132095+0.0977776im       0.174375-0.016242im     -0.159731-0.133963im       -0.119213-0.098376im     -0.129991-0.207723im      -0.128448+0.127149im      -0.177391-0.00570386im    -0.201285+0.117019im     -0.0833087-0.179742im      -0.120176+0.0444936im    -0.132766+0.0291811im    -0.148355-0.0560947im     -0.0744199+0.223984im     -0.180324-0.12613im        0.175792+0.162819im      -0.0240132-0.0414774im   0.00963827+0.109149im       0.046216+0.113109im
  -0.0861371+0.0220532im      0.15659+0.089043im    -0.00934736-0.0407179im    0.0846044+0.0995761im   -0.120355+0.16078im      -0.0608323+0.038677im     -0.00363615-0.188166im   -0.0098334+0.114382im       0.0623324-0.0760792im    -0.193452-0.182492im      -0.127172-0.126527im      0.174174+0.00572912im    -0.159736+0.0108533im     0.213535-0.267825im     -0.0218615-0.067011im        0.128866-0.156679im    -0.0508104+0.0960404im      -0.250931-0.00749251im   -0.155089+0.0649738im    -0.0103596-0.148001im       0.185051+0.175036im        0.07959+0.00658078im     0.219206+0.0265146im      0.167543-0.19661im      0.0810842+0.0363843im    -0.181341+0.0803223im      -0.103725+0.126372im     -0.053427+0.0795536im      0.180642+0.211318im      -0.0337939-0.00310375im  -0.0558109-0.111208im      -0.119254-0.107314im
   0.0172545+0.212163im     -0.123477+0.0220615im    -0.0044742+0.139588im    -0.0252486-0.0855656im    0.114778+0.00293305im    0.0603455-0.0676226im       0.139426-0.116372im    0.0825615+0.104196im       0.0728447-0.0162671im   -0.0928391-0.0888369im     0.0866266+0.187699im     0.0364979+1.63103e-5im  -0.00129178-0.100825im     -0.133037-0.109767im     0.00189975+0.045575im      -0.0536273+0.199676im       0.12839-0.0897801im      -0.193008+0.172025im     -0.111868+0.112314im      -0.111852-0.0817169im     0.0242038+0.236862im      0.0681258+0.135845im     -0.0706695-0.112268im     -0.0271187+0.122646im     -0.126555-0.11227im     -0.0256892+0.0345783im      -0.131514-0.259367im    -0.0495521-0.148581im      -0.153144-0.0313914im      0.0312174+0.127641im     0.0892458+0.209403im      -0.270756-0.365072im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.17494531073653685 + 0.1785563755957869im
 -0.016718036457901653 + 0.13372911283879008im
   0.03720544683860243 - 0.10101549990917694im
   0.20852932788532388 + 0.13432573469925083im
  -0.16264132650023594 + 0.09791288254602704im
   0.02706484829709951 + 0.058864160068519536im
  0.059583012426796395 - 0.21666728337052663im
    0.3885593876948632 + 0.0im
  0.018962413683176135 + 0.1334348192458485im
  -0.09749299013109425 + 0.2815043336154202im
   0.01961698207217834 + 0.027967553391886165im
   0.14040697872330304 - 0.05860112035845547im
  -0.06768442563045467 + 0.05815865652752665im
   -0.2676914459582082 + 0.10157071406761042im
  -0.10481309434455864 - 0.005986323676978746im
   -0.0794678527565774 + 0.12031628308013631im
  0.049374364239809315 - 0.0006285675977916904im
  -0.15990952815471302 + 0.034773194169348154im
    0.0401189151579093 + 0.10669260536367563im
  0.053606788613167276 - 0.0935104379287225im
   0.09559462118429422 - 0.17928455987424974im
 -0.029747383908211574 + 0.010924472592526593im
    0.2640420240712139 + 0.07936483099155554im
   0.05372829873499338 + 0.12560036254456752im
   0.10911123163936312 - 0.12417508869508045im
   0.08476238941998618 - 0.011945410891459046im
  -0.11355003399604797 + 0.133994818124579im
   -0.0900487848715292 - 0.002046152597557042im
 -0.010495778373082312 + 0.0818418648419101im
   0.05399343211234577 - 0.12087509287297753im
  -0.05137287194276625 + 0.18269447303510025im
   0.15748334529025282 + 0.04452900682098213im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 31 March 2023 20:07">Friday 31 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

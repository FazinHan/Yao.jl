<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    -0.237655+0.0181875im   0.0734724+0.106621im     0.0164673-0.195595im      -0.132385+0.0270828im     0.0321999-0.0628055im    -0.0077326+0.0499165im     -0.0350294-0.241726im        -0.122606+0.205737im        0.227562-0.0497326im      0.0913511+0.115477im      -0.192595+0.0208001im    0.0304975-0.265857im    -0.0136275-0.095091im    -0.0529245-0.0113704im      0.144259-0.152344im     0.00177805-0.093879im       0.11898+0.116147im     -0.085823-0.0183084im      0.024454-0.0748658im     0.144059+0.105899im      -0.209116-0.182777im        0.208799-0.0003695im      0.107744-0.00293367im    -0.073529+0.0972302im    0.0319784-0.162977im      -0.0696111+0.0854267im      0.247668-0.105575im       -0.158587+0.165202im        0.131058-0.0327943im    -0.0296219+0.118145im     -0.116461+0.00464374im   -0.247934+0.0386074im
     0.152904+0.16122im     0.0707011+0.0421862im    0.0563582-0.0939279im     -0.112969-0.0645902im      0.013816-0.0383648im      0.260895+0.0665617im      0.0116453+0.0975839im        0.231618-0.103485im       -0.113605-0.123777im       -0.185421-0.0600809im     0.0267365-0.105493im      0.109521-0.137748im   -0.00272299-0.0553723im     0.235862-0.120832im       0.223636-0.223447im       0.110358+0.109038im     -0.227241-0.20372im     -0.0281655-0.13459im       0.0668461+0.00365586im   0.0283004+0.163267im       0.161982-0.147495im       0.0794123-0.00926824im    -0.177489+0.0411989im   -0.00279462+0.0911439im   -0.0046964+0.00443622im    -0.0390128+0.0905754im      0.132236-0.122517im       -0.129167+0.118907im       -0.278777-0.197797im      0.0359668-0.0591884im     0.108432+0.118433im    0.00168152+0.000989145im
    0.0424363+0.202471im    0.0433399+0.0115215im     0.206407+0.0654245im      0.272496+0.173027im    -0.00441591+0.0694293im    -0.0558572+0.114854im       0.0477111-0.037736im       -0.0174869+0.0312708im       0.207445+0.360025im      0.00510367-0.0206931im    -0.0344137+0.0538287im      0.11259-0.0937634im     -0.16131+0.0396185im   -0.0375985+0.0664705im    -0.0346808+0.0711284im     0.0102572+0.0311971im    -0.239168+0.0156805im   -0.0485179-0.0455517im     0.0964008-0.121295im     0.0696393-0.051044im      -0.383346+0.101574im        0.068511+0.146909im      -0.178369-0.124291im      0.0127137+0.0850015im   -0.0122977-0.0428502im       0.101385-0.163435im      0.0542528-0.00133507im     0.0256238+0.00750795im      -0.12394-0.0919056im     -0.156949-0.040746im      0.168439+0.230531im      0.157273-0.0896743im
    0.0922257+0.0326221im  -0.0508519-0.0464477im    0.0186922-0.054545im      -0.028036-0.0418135im      -0.01424-0.4324im       -0.0670913-0.0866144im   -0.000529986+0.0570575im       0.0458393+0.0739326im       0.167506-0.0838367im     -0.0218651+0.113395im     -0.0565823-0.0236392im     0.241806-0.101482im      0.124838+0.0246963im    -0.257517-0.0132185im     0.0888149-0.0211184im    -0.0654585+0.0859096im   -0.0127085+0.0495656im     0.104429-0.148914im     -0.0157125+0.127048im     -0.285704+0.108267im      -0.153522+0.119795im       -0.240695-0.119922im     -0.0463217-0.0193179im    -0.0622828-0.247444im     0.0779726+0.0885399im       0.296153+0.167557im    0.000575496-0.140313im        0.109722+0.0829069im      0.0227836+0.000318033im  -0.0251007-0.186109im     0.0347237+0.0787398im   -0.0794912-0.0712984im
     0.114555+0.204039im   -0.0752811-0.0351721im   -0.0199302-0.0659858im     0.0704717+0.118645im     -0.0271169+0.327871im      -0.262018-0.254002im      -0.0941109+0.12356im        -0.0637919+0.231275im       -0.117467+0.00295669im    -0.0196871+0.180743im      -0.106295-0.19487im      0.0948361-0.121589im     -0.101567-0.0434919im    0.0242287-0.0310785im     0.0787155-0.194503im      0.0423307+0.205883im      0.210186+0.126566im    -0.0454252+0.079536im     -0.0648003-0.0910442im     -0.11712+0.130756im      0.0280534+0.115246im        0.081652-0.0288087im    -0.0609482+0.115315im      0.0568814-0.113819im    -0.0349101+0.0197251im      -0.174945+0.104573im     -0.0216253-0.060824im      -0.0141023-0.197198im      -0.0530362-0.0775144im     -0.112185-0.137417im     -0.201985+0.00127883im    0.178651-0.0592731im
   -0.0316417+0.0285548im    0.110725-0.00154657im  -0.0428005-0.171281im       0.194922-0.0678511im     0.0278823-0.0387559im      0.156263+0.0988888im      0.0166906+0.200932im        0.0128317+0.0740751im     -0.0475835-0.0116468im     -0.0640273+0.119962im      0.0668809-0.0551478im    0.0376755+0.0599923im    0.0336685-0.135011im      0.185076+0.0914716im     -0.171964+0.0134471im     -0.182875-0.10053im       0.198415+0.226422im    -0.0428474+0.00125467im    0.0807821+0.171839im      0.059335+0.0508665im     -0.069122+0.134939im       -0.126917+0.292223im       0.128149-0.0631363im      0.140614+0.234429im      0.312946-0.0180891im      0.0118538+0.148945im     -0.0263657+0.0324101im     -0.0918778+0.13525im        -0.224679+0.141323im       0.118849-0.142935im     -0.171954+0.0971181im    0.0206425-0.113591im
    0.0224316-0.0703361im   -0.159999+0.27048im      0.0211226+0.0544992im     0.0438618-0.16833im       0.0239861-0.0125777im     0.0543949+0.137109im        0.176791+0.151265im         -0.13177+0.128227im       -0.214896+0.12729im         0.318914-0.0983947im     -0.125076-0.0443661im     0.155603-0.193603im    -0.0222745+0.0748664im    0.0621038+0.00236098im     0.163453+0.165033im      -0.131584-0.0728398im     0.109606+0.123482im     0.0660658-0.0915701im     -0.218025+0.0406595im     0.106366-0.0283583im     0.0200535-0.096337im       0.0406854-0.109327im     -0.0252402-0.0358812im    -0.0122959+0.095383im    -0.0460394+0.0688297im     -0.0387408-0.119196im     -0.0475378-0.293322im        0.198494+0.0957335im      -0.116761-0.0170571im     0.0770154-0.156594im     0.0731186-0.168844im      0.141346+0.136562im
     0.129024+0.0546857im   0.0246138-0.0416648im   -0.0961794+0.146493im      0.0179944-0.268456im     -0.0650781+0.187269im      0.0153623+0.124697im        -0.17134+0.00289821im     -0.0567233+0.180429im        0.107986+0.00193123im     0.0995406-0.0117199im   -0.00120159+0.0665942im     0.102938-0.088028im     0.0691121-0.0733501im   -0.0283451-0.21184im       -0.159586-0.15893im       -0.171838-0.153862im     -0.119753+0.0586151im    -0.179059-0.0468679im     0.0619111+0.145798im    -0.0367486-8.20855e-5im    0.0873261-0.0544853im      -0.170179-0.262512im      -0.187027+0.038919im      -0.072056+0.0440717im   -0.0973789-0.0795121im      0.0352863-0.162252im       0.216887+0.339281im      -0.0494112+0.00638407im     0.0127392+0.175177im     -0.0170474-0.179576im    -0.0966357+0.097003im     0.0342678+0.168943im
    -0.220704-0.154231im     0.180843-0.293264im    -0.0181709-0.0929223im      0.119768+0.144302im      -0.142581+0.053563im      0.0499935+0.0631129im     -0.0903363+0.0690929im      -0.0188013+0.203674im      -0.0413092+0.174941im       0.0640555-0.130668im      -0.167694-0.199363im    -0.0468123-0.0412148im     0.104604+0.0436415im    0.0303401+0.0252738im   -0.00914838+0.194299im      0.0699942+0.189618im     -0.123933+0.0456005im    0.0901193-0.0299385im       0.10813-0.0308983im   0.00424131+0.0547248im      0.136022+0.0348112im      -0.148014-0.311723im       0.108063+0.173214im       0.113975+0.0732592im    0.0625718-0.135262im      -0.0705037+0.0132362im     -0.143596-0.00832924im     -0.198392+0.15203im        0.0819146-0.0974519im    -0.0331325-0.166339im      0.236995+0.0093368im   -0.0955222+0.00716888im
     0.162649+0.0560146im  -0.0568017-0.0694853im    0.0359781-0.163232im      -0.137418+0.0781386im     -0.107947-0.0837705im     0.0316471-0.164843im        0.196733-0.158199im         0.238043+0.255668im       0.0470912-0.0048297im       0.205367+0.0908322im      0.159475-0.0389981im   -0.0816794-0.048343im      0.219441+0.106208im      0.105924-0.0445757im     -0.197626+0.217187im      -0.134121-0.118456im     -0.184026+0.00732744im    0.059147+0.0879327im    -0.0841326-0.175508im    0.00402991-0.102609im      0.0130137-0.100826im       0.0593923+0.0569764im      0.109504-0.0131915im     -0.225699-0.126961im     0.0771302-0.0114956im      -0.187602-0.00474281im   -0.0329626+0.14623im        0.0482312+0.0217336im      -0.216322-0.20316im      -0.0904239-0.13858im      -0.146457+0.0436449im   -0.0347725+0.0285158im
   0.00480615-0.0861227im  -0.0437465-0.0278366im    0.0568893-0.00250944im     0.105793-0.203135im     -0.0757457+0.0103295im     0.0279553-0.0516653im      0.0277144-0.149553im     -0.000516434+0.151185im       -0.168986-0.158449im       -0.127174+0.223042im      -0.241587+0.199412im     -0.103436-0.0545182im     0.073025-0.278669im     0.0428493-0.00962708im   0.00596561-0.0100697im     -0.194207+0.128884im     -0.152655+0.0776373im    0.0637995+0.00607935im    -0.126001+0.00347625im   0.0570657-0.128946im     0.00538138-0.125828im     -0.00160959-0.0289821im    -0.0384954-0.208479im      0.0026862-0.183158im      0.141366-0.000689195im    0.0145014-0.0508411im     -0.126257-0.0330475im      -0.225263-0.018069im        0.132743-0.0498861im      0.100713+0.189153im      0.195436+0.127792im       0.34037-0.128117im
    -0.156475-0.0325985im  -0.0111943-0.0698122im     0.167639-0.207282im     -0.0529961-0.289638im      -0.153706-0.0535014im    -0.0923796-0.117866im      -0.0553702+0.0577162im       0.0900544-0.135376im       0.0601751+0.269378im      0.00812341-0.224943im      -0.117375-0.0734392im   -0.0368346+0.0899286im    -0.141862-0.136672im     -0.183376+0.162801im      -0.172797-0.156113im     -0.0742398-0.0456646im   -0.0484603-0.0753696im   -0.0785419-0.140484im       -0.13722-0.147418im     -0.158997-0.00420556im     0.209085+0.11125im         0.228565+0.000981272im    0.130328+0.0513548im    -0.0615672-0.0361569im    0.0176342+0.137625im     -0.00569675-0.0668501im     0.0647596-0.0513155im   -0.000969792+0.264095im      -0.0348674+0.0275141im     0.0445762+0.0189982im    -0.179024+0.105962im      0.177599+0.0373599im
    -0.198185+0.048024im   -0.0212569+0.132313im      0.108007+0.115109im      -0.108263+0.0155899im     -0.159724+0.0285017im    -0.0106993+0.0742634im       0.157569+0.100846im         0.117002-0.0283987im       0.008949-0.278771im      -0.0368403+0.11808im       -0.220658-0.0563457im   0.00929083+0.284991im     0.0199701+0.164922im    -0.0519694-0.0338986im    -0.0353619-0.0770689im    -0.0249536-0.166119im      0.020122+0.0751358im     0.113694-0.00588389im     0.109604+0.0549317im    0.0663992-0.0310311im    -0.0795957+0.120143im        0.194397-0.0408684im     -0.202586-0.011152im      -0.128094+0.125402im    -0.0995268+0.157405im       -0.128268+0.157411im      -0.153152+0.106364im       -0.115817+0.210423im        0.116191+0.0559431im     -0.322734-0.209023im     0.0937514-0.0338306im      0.11192-0.0275025im
   -0.0281522+0.0340231im     0.19509+0.0891415im   0.00932061+0.155739im     -0.0428239+0.0816891im    0.00312619+0.0353129im    -0.0573096-0.37697im        0.0700678+0.0690943im         0.19946+0.0682875im       0.185877+0.0980006im      0.0734261-0.0860554im     -0.240756-0.0784804im     0.202437+0.0542502im     0.117619-0.0714537im    0.0666803+0.214992im      -0.124351-0.0569959im   -0.00223285-0.0134275im    0.0767363-0.00821644im    0.105536+0.208587im      0.0210109+0.211061im      0.169917+0.0618817im     0.0213755+0.00445395im   -0.00529375+0.035282im      -0.199092+0.0311088im    -0.0288712-0.125986im     0.0740161+0.0568979im     -0.0342762-0.0299846im      0.134189+0.0759033im      0.0113249+0.0144083im      -0.126838+0.0534002im      0.290249+0.189362im      0.234182-0.128408im    -0.0602183+0.136637im
    0.0512506-0.0878999im   -0.267828+0.0455167im    0.0931059-0.0674223im     0.0076227+0.284309im     -0.0367378-0.0932282im      0.228682-0.0931841im      -0.045187+0.0238404im       -0.298105-0.00323491im      0.103113+0.0971955im     -0.0466142+0.00696932im  -0.00482599+0.12069im      -0.184756-0.143174im     0.0712802-0.0350403im   -0.0294817+0.181004im     -0.0712703+0.0282394im    -0.0546548-0.0519598im     0.240424-0.0805243im    0.0114272-0.16397im       0.0807527+0.0742587im    0.0314717-0.0823938im      0.224101+0.0178659im      0.0424977-0.00945758im    -0.123852+0.0563774im     -0.131569-0.0242399im    -0.257196-0.162216im       0.0176889+0.311983im       0.105425+0.151856im        -0.04009+0.00530504im       -0.1248-0.0102831im     0.0677024-0.062804im      0.132869+0.0692247im     0.203373-0.0479298im
    0.0473405-0.194331im   -0.0930449-0.1986im        0.104881+0.168871im      0.0924238-0.0112517im    -0.0478594+0.275726im       0.170946+0.0284355im     -0.0704973-0.310165im        -0.132504+0.03159im        0.0643392-0.152172im      0.00186548-0.0895954im     0.0609826-0.104751im      0.150563-0.0152038im   -0.0837176+0.154382im    -0.0639434+0.0651932im    -0.0910239-0.260515im     -0.0184904+0.181757im      0.180619-0.157072im      0.143907+0.0492283im     0.0701917+0.0127098im    0.0306913-0.0855859im    -0.0118337-0.0652403im     -0.0368908-0.0206845im      0.167745-0.27194im       -0.141904-0.0540234im     0.145554+0.169695im      -0.0100773-0.0463352im     0.0483414-0.0896095im      0.0481692+0.173548im       -0.230025+0.0334154im    -0.0565027-0.104244im     0.0441406-0.0785593im   -0.0744566-0.110015im
     0.119517-0.16442im     -0.169407-0.0382004im    0.0953236-0.171518im      -0.157129-0.0950971im      0.061597-0.16678im       -0.134349+0.163299im      -0.0196786+0.0027818im         0.12098+0.0995686im      0.0141829+0.0931899im     -0.0294676+0.0816882im    -0.0195263-0.102743im     0.0415226+0.128081im    -0.0334334-0.104043im     0.0683154+0.113242im      -0.021685-0.197714im      -0.198961+0.175039im   -0.00850561+0.0246132im    0.0935398-0.0595926im      0.235077-0.256392im      0.225667+0.139923im      -0.126546-0.000123413im    0.0208614-0.163842im      0.0872157-0.133051im       0.160902+0.161554im     -0.180465+0.0933062im      -0.012474+0.0695043im    -0.0552004+0.254988im          0.1878-0.220718im      -0.0192807+0.00679432im     0.127964-0.00696432im    0.105186-0.131089im    -0.0221884+0.0365587im
    0.0761859+0.161014im    -0.136224+0.194432im     0.0558789-0.178671im       0.196996-0.138204im      0.0550198-0.0302846im     0.0181463+0.047737im       -0.085719-0.109844im       -0.0235986-0.242175im      -0.0096639+0.124935im       0.0523622-0.0513214im     0.0516656-0.0839641im   -0.0451994+0.0280283im    0.0550467-0.0437541im   0.00913023+0.216768im     -0.0509649-0.142258im       -0.12393+0.20619im      -0.172705+0.0668936im   -0.0300769+0.405618im    -2.60501e-5+0.187947im      0.139806-0.1366im        0.0780953-0.0843018im     -0.0184514+0.0186209im    -0.0387553+0.0349214im    -0.0351996-0.0963464im    0.0341143-0.114697im       0.0771631+0.180075im     -0.0285039-0.0635748im     -0.0612482+0.00145404im      0.211708-0.105444im      -0.201332-0.227908im    -0.0141512-0.142532im     -0.122075+0.147973im
  0.000415461-0.199269im    -0.294314+0.0899414im    -0.124301-0.0273058im     0.0807013+0.00341273im    -0.254095-0.0429926im     -0.119436-0.00937198im      0.231381+0.0492411im       0.0513625+0.0711784im   -0.000949686+0.0605159im   -0.000868269-0.0780895im     0.0859276+0.0928454im    0.0219331+0.0326363im   -0.0419961-0.0104241im    0.0181157-0.00822755im    0.0141191-0.245408im       0.107686-0.253264im    -0.0511678-0.0788355im      0.11229+0.182406im       0.215201+0.00951174im   -0.260746-0.128927im     -0.0262065+0.0507188im     -0.0844559-0.15193im      -0.0742503-0.0322416im      0.213114+0.11093im       0.259136-0.227154im       -0.187523+0.0563328im      0.199581-0.13991im        0.0408944-0.0369701im      0.0229749-0.110094im     -0.0218054+0.110321im     0.0345079+0.0184035im    0.0410939-0.034071im
 -0.000461368-0.0561076im   0.0553042+0.0102749im   -0.0518591+0.0345102im      0.073721+0.173142im       0.223914-0.180221im       0.015245-0.0929098im     -0.0670905-0.22158im          0.114256+0.112298im        -0.09461-0.0346867im      0.0469983-0.144788im      0.0347812+0.310503im     0.0043879+0.0555277im    -0.146499+0.175435im     0.0198675+0.138502im    -0.00438419-0.052376im      0.0552274-0.0286506im   -0.0106467+0.352052im     0.0174835+0.00386794im      0.11526-0.0723854im    -0.180425+0.272813im       0.267685-0.142404im        0.184351+0.0110435im    -0.0688783-0.153323im       0.179621-0.0147467im    0.0891449+0.0685163im       0.100559-0.0773754im     0.0245598+0.0336074im      -0.109869-0.0101693im     -0.0305991+0.061899im      -0.104555-0.168704im     0.0129395-0.0256948im     0.124544+0.177049im
   -0.0287664-0.120815im    -0.243449-0.144778im     0.0388379-0.159008im     -0.0523207-0.1104im       -0.0300021-0.000576167im   0.0911039-0.112314im      -0.0587635-0.38053im         0.0137355+0.0074969im     -0.0373954+0.0994584im      0.0103296+0.0435856im     -0.172157+0.0642154im    0.0887986+0.182231im    -0.0260252+0.189331im      0.205131-0.188712im    -0.00425741+0.150556im      0.0477287-0.0515711im   0.00576152-0.128029im    -0.0967918+0.142146im      0.0286541+0.25097im       0.111745+0.296592im       -0.12465+0.236238im       -0.103725+0.0438747im    -0.0310564+0.16788im      0.00700234+0.0989464im    -0.124082+0.0459622im       0.125755-0.0161337im     0.0437813-0.136702im       -0.049679-0.0178415im     0.00575556-0.106899im      0.0496393+0.0279673im    -0.126256+0.0162348im     0.196703+0.0497155im
     0.220362+0.270344im    0.0674577-0.0152105im   0.00502506-0.222318im      0.0320517-0.0142932im     -0.276022-0.0219568im    -0.0319772+0.137287im       -0.141811-0.000756845im     -0.129993+0.0462414im      0.0315038+0.066123im        0.171611-0.0532672im     -0.155366+0.0149664im    -0.177979+0.114781im    -0.0100386+0.24407im      -0.168043-0.24169im      -0.0280962+0.00562796im   -0.0338641+0.0610909im    0.0448577-0.114226im      0.172722-0.0354847im     0.0289464-0.067651im     -0.084606+0.125651im      0.0600408-0.21981im        -0.110152+0.314444im      -0.117101-0.0629095im     0.0377755+0.056248im       0.14111+0.102178im       -0.123678+0.123849im      0.0558451-0.0146476im    -0.00419803-0.0236313im       0.102516+0.153351im       0.127767+0.0977171im     0.141825-0.133221im     0.0435623+0.063673im
  -0.00937465+0.127622im   -0.0532969+0.031029im     -0.225564+0.176873im      -0.108325+0.0673355im     0.0803834-0.00546323im    0.0654948+0.191346im      -0.0158202-0.230883im        0.0727707+0.119993im       0.0235057+0.162671im      -0.0395838+0.301532im       0.105028-0.187262im     -0.185214-0.0100819im    0.0572432-0.00571257im   0.0767577+0.251491im       0.173364-0.0858926im      0.109201+0.055539im      -0.11775-0.0596321im     0.233022-0.0326633im    -0.0692254-0.0242722im    0.0031974-0.00735805im    0.0409473+0.107231im      -0.0121229+0.016497im     0.00701601+0.245919im    -0.00800769-0.00172094im    0.158866+0.0439359im      0.0138614-0.0528885im      0.133034+0.0318842im       0.168497+0.227601im          0.1121+0.263661im       0.047635-0.0162205im   -0.0349816-0.00478524im    0.257601+0.0462707im
    -0.221475+0.202432im   -0.0327321-0.162774im     -0.324256+0.170004im     -0.0200986-0.200009im      0.0679143-0.199352im        -0.1324-0.0741056im      0.0613707-0.0270513im      -0.0961203-0.00306384im     -0.196479-0.0207377im     -0.0163002-0.15395im      -0.0883412-0.0415654im   -0.0553266-0.0723172im     0.164255+0.286023im     0.0055354+0.0574604im     -0.146475-0.164079im      -0.119463+0.11686im     -0.0831581+0.0626817im   -0.0255026-0.12074im      -0.0356376+0.0485589im   0.00368237-0.0956589im    -0.0732455+0.0535083im       0.099181+0.138052im       0.138278+0.0682803im    -0.0765793+0.151581im    -0.0576554-0.0730259im       0.016762+0.0208823im      0.252203+0.0206314im      -0.068976-0.219975im        -0.11521-0.10817im      -0.0305906-0.0162195im     0.160302-0.0870545im    0.0438332-0.202603im
   -0.0351262-0.0270457im  -0.0955792-0.0450618im    0.0132306-0.0803208im    -0.0337373+0.0898084im      0.166223+0.0733547im     -0.132768-0.0192787im       0.212099-0.0820228im       -0.147827-0.053075im        0.075233-0.00529371im     0.0465033-0.194865im      0.0459405-0.0112408im   -0.0967926+0.0797348im     0.385866-0.11312im       0.170894-0.170922im      -0.062165-0.258075im      0.0608337+0.0810744im     0.156787+0.133235im     0.0627916+0.0225696im     -0.143357-0.183078im    -0.0343386+0.00373378im    0.0311484+0.00306498im    -0.0897568+0.134653im      -0.251502+0.0182711im     0.0190066+0.130765im    -0.0439252+0.114008im        0.103626-0.171286im     -0.0747799-0.0331562im      0.0643243+0.161062im        0.187418-0.101888im       0.152559-0.149807im     0.0567559+0.267105im    -0.0940245-0.0484011im
    -0.211395+0.0676371im    0.207087-0.134367im    -0.0439828-0.0268485im     0.0155749-0.177884im      0.0209138+0.0485447im      0.179967+0.0781383im     -2.2219e-5+0.00374042im     -0.0161835-0.140912im       0.0425734+0.0574739im       0.193158+0.140408im      0.0574637+0.0509942im   -0.0343116-0.0743411im     0.237538-0.251013im     -0.134142-0.00655658im   -0.0280991+0.0732845im      0.266082-0.137858im     0.0643675-0.0666903im    0.0249154+0.310298im      0.0827548-0.144718im     -0.100788+0.191525im    -0.00306065-0.00683509im      0.101008-0.125359im     -0.0300544-0.183178im      -0.111995+0.0743858im    -0.014923+0.113522im       0.0445407+0.1326im         0.061588-0.0833773im       0.127788-0.256427im      -0.0673381-0.0211895im     0.0187511-0.167675im     0.0825647-0.0767407im     0.211085-0.103935im
   -0.0884934-0.0264571im    -0.12334-0.0084176im     0.218071+0.168512im      -0.209166-0.00487656im   -0.0344556+0.0822021im    -0.0552708+0.0646005im      -0.125984+0.104523im        0.0365282+0.0886074im         0.1108-0.0175044im     -0.0193088-0.10954im        0.102558-0.0954391im   -0.0479776-0.152728im    -0.0745713+0.0805454im      0.14122-0.204293im       0.047563-0.0251293im    -0.0582516-0.0656276im    0.0554494+0.0441183im    -0.131414+0.185624im      -0.126451-0.0956485im    -0.105949-0.0441876im    -0.0323077+0.00510075im      0.137277+0.0547774im      0.108583+0.128615im     -0.0128855+0.0476612im     0.330877-0.0251605im       0.439023+0.226286im      -0.106616+0.169165im       -0.025327-0.0287754im   -0.000502894-0.0849872im     0.0429108+0.0529884im     0.218738-0.0983202im      0.13587+0.136629im
   0.00886562-0.147605im     0.087721-0.202946im     -0.143696-0.0845161im     -0.105544+0.217489im      0.0813238-0.0746719im     0.0365139+0.185234im       -0.152214+0.107668im        0.0602002+0.0574622im     -0.0118586+0.189998im      -0.0628859+0.103054im      -0.123073+0.132479im      0.265895+0.0962447im     0.057586-0.0565523im     0.155395+0.0164646im     0.0656776-0.174149im      -0.288762-0.113506im     0.0308057-0.152078im    -0.0601183+0.188584im      -0.148921-0.109191im     -0.223224-0.118721im      0.0659862-0.0157484im     -0.0187536+0.189121im     -0.0663356+0.0119711im     -0.203409+0.0199215im    -0.145238-0.107385im      -0.0190714-0.108736im     -0.0992189-0.173248im      -0.0545923-0.0130713im     -0.0280928+0.126151im      -0.191321+0.0321408im    0.0817957-0.174518im     -0.010853-0.0209177im
     0.100932+0.111122im   0.00372413+0.227226im     0.0488233+0.0120683im    0.00387195-0.00798816im   -0.0480143-0.0817607im      0.127495-0.101819im       0.0212228+0.0304168im       -0.159581+0.0436877im      -0.176045-0.0694387im    -0.00580889-0.277621im     0.00310114+0.215981im      0.167165+0.050116im   -0.00944025-0.0731649im     0.138566-0.00455957im    0.0201652-0.049431im       0.133797+0.0742286im   -0.0695426-0.0728304im    0.0468663+0.169826im      -0.117165-0.236493im    -0.0355259+0.19646im       -0.220147+0.20372im       -0.0778246-0.0412137im      0.332141+0.0537071im     -0.177111-0.0777042im   -0.0328201-0.128224im        -0.16408+0.0529268im     0.0134863+0.172557im      -0.0634518+0.0862786im      0.0810837+0.296754im      0.0328421-0.0940114im     0.134046+0.0822352im    0.0278582-0.0115704im
      -0.1982-0.0206256im   0.0523196-0.162044im      0.163041-0.0391966im    -0.0472796+0.0804755im    -0.0202222-0.102643im      -0.116607+0.218437im       0.0982104+0.066187im        -0.175793+0.258418im      -0.0284251-0.149181im        0.182653-0.164496im       0.163236-0.00138054im   0.0485486+0.204333im   -0.00757848-0.11407im     0.00681233-0.100997im    -0.00531031-0.083236im       0.119125+0.155816im      -0.24037+0.107798im    -0.0536986+0.0578321im    -0.0108311+0.148375im       0.21745+0.00361155im     0.136071+0.0409485im      0.0303434+0.0748033im      -0.12497-0.00185256im   0.00319049-0.239938im    -0.0668938-0.127699im       0.0370912+0.161511im      0.0651175-0.101355im        0.196269+0.0130882im      -0.180573+0.166605im     -0.0882796+0.202613im     -0.128472-0.00618645im    0.111886-0.0532016im
    0.0597597+0.0241886im   0.0560993+0.0823864im   -0.0405539+0.205527im       0.100191-0.0566157im     0.0698549-0.205528im      0.0161534-0.103214im        0.104233-0.0887239im      -0.0120075+0.0587791im       0.156526-0.0239738im     -0.0894553+0.0776124im    -0.0319658-0.0326161im     0.108375+0.191564im      -0.10125+0.0346493im     -0.25509-0.0859361im     0.0168312+0.0370374im     0.0319022+0.209924im     0.0588015-0.00218234im   -0.173694+0.0748992im    -0.0325263-0.293027im      0.141216-0.0441475im       0.23652+0.0199463im      -0.164651-0.0777551im     -0.107398+0.018916im      -0.247878+0.374408im      0.138952-0.266377im      -0.0207475+0.0498957im      -0.14328-0.0685345im     -0.0179776+0.0180866im     -0.0582764-0.0762233im      0.107261+0.038124im     -0.143425-0.0412512im     0.111548+0.0334987im
     -0.15245+0.0133678im  0.00856112-0.0377184im       0.2052-0.0164325im   -0.00673587-0.112479im     -0.0820513+0.133892im      0.0994856-0.0761533im      0.0493331+0.12304im         0.0320146+0.0343405im      0.0350554+0.141011im      -0.0807199+0.227831im      0.0998771+0.335706im    -0.0549789+0.226436im     0.0267375+0.0931156im   -0.0289971-0.028617im      0.0730647-0.103741im     -0.0298306+0.127248im     0.0778142+0.0653845im     0.277572-0.114377im      -0.145887+0.0375073im    0.0896435-0.0371004im     0.0265636-0.0341058im      0.0312015-0.0617774im     0.0975041+0.183476im     -0.0846077+0.0599707im    0.0924141-0.0448536im      0.0472023-0.0319725im      0.115206-0.157902im       0.0155417-0.307504im       -0.118454+0.0769696im    -0.0874348-0.0721993im    0.0798555+0.241868im     -0.209437+0.278633im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.03947513639041468 + 0.10584825306579998im
  -0.08068586298430418 + 0.014881873559692858im
  0.046372530849852635 + 0.14817219047817232im
    0.2581061921056901 - 0.05045793461502314im
  0.055321215797442286 - 0.004549906012926007im
   0.09245682044682152 + 0.15165402363002237im
   0.11689370006805723 + 0.11149117330792763im
 -0.054920753273453624 - 0.07912733329863862im
  -0.13589911082011688 + 0.025742780886427im
   0.10997489244591425 + 0.18557304610905195im
   0.12193450623514229 - 0.09558922082679966im
   0.23105119762290519 + 0.1568221167791799im
  -0.22884400950054187 - 0.13326259548032118im
  -0.06932471802280574 - 0.12294849809992259im
  -0.02366920920327304 + 0.03028692601864766im
  0.016383822556104002 + 0.15253588789432793im
  -0.20672962915064896 - 0.04630306733294638im
   0.06778968950893882 + 0.05171190091022211im
  -0.02306254529154808 + 0.2235690929394164im
   0.10192918973813633 + 0.20133308345053375im
  -0.05653152332825742 + 0.006198630492531942im
  -0.08527103444851737 - 0.09500901808495381im
   0.14241963867106394 - 0.06437673306620012im
   0.30113817312711444 + 0.0im
   0.04450671567444123 - 0.09602272289696899im
  -0.07232703607098143 - 0.21865295470212998im
   0.19673611244503802 - 0.07312735368898735im
  -0.04397925850071002 - 0.2146114806660329im
  -0.09213039270892855 + 0.12833630539745267im
 -0.003097422778270551 + 0.05746360580637383im
  -0.22439431628539933 - 0.048222407493090994im
  0.025900529655896842 - 0.09157466921966453im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Sunday 12 June 2022 17:35">Sunday 12 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

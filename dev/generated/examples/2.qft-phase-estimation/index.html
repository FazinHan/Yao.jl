<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 0.00584092+0.113578im       0.250482+0.129362im        0.128663+0.197266im    0.0117907+0.16986im     -0.0681619+0.0816693im      0.183975-0.00683082im  -0.0273609-0.190438im    -0.0885836+0.097709im      -0.178503+0.020053im      0.0307878-0.0760237im     0.0642018-0.115447im      0.0116516-0.168727im       -0.206488+0.127191im     0.233745+0.0936561im      0.0705622+0.141561im      0.236743-0.0831378im    -0.0572321-0.115281im       0.0687906+0.0478789im   -0.00570104+0.00799351im    -0.091448-0.0973778im     -0.177065-0.0218784im    -0.112687-0.178336im      0.0922349-0.0487682im     0.017837+0.0872443im     0.0917013+0.0478835im     0.309854+0.0512598im     0.0938716-0.245495im      -0.061152-0.0499355im     -0.129361+0.140912im     -0.069423-0.211916im      0.0650702+0.0310364im      0.0365994-0.11865im
    0.17895+0.0029297im      0.184327-0.0595803im      0.0296332+0.108913im     0.133696-0.0403671im     -0.09906-0.180034im     -0.0173808+0.115486im     -0.247982-0.175611im     0.0581198+0.027339im       0.162121-0.112303im     -0.0623875-0.10371im        0.167511+0.0879121im     0.0168309-0.0627646im       0.226188+0.0409937im   -0.245959+0.125615im      -0.0930276+0.0848698im    -0.159167-0.158008im    -0.00767654+0.0870663im       0.034649+0.147722im      0.0212881+0.0129462im      0.146076+0.010332im      0.0692726+0.0515402im    0.0660929+0.104919im       0.197332-0.109426im     -0.174795+0.0176767im    -0.0568974+0.251441im      0.274495+0.178568im     -0.0291816-0.0602368im      0.117845+0.182863im     0.00587352+0.0754638im     0.152726+0.0842287im   0.000605289-0.137894im       -0.136589+0.0196412im
  0.0256163-0.1657im      -0.00796447-0.000120923im    -0.100502-0.214655im   -0.0558918+0.0731162im    0.0744977-0.0751715im    -0.0400199+0.0245071im     0.101459-0.312033im     0.0125805-0.169117im      -0.111754-0.118925im       0.172228-0.119101im     -0.0637491-0.0226215im     0.0394995+0.168425im       -0.258872-0.10097im     0.0557672-0.000317707im    0.0122816-0.210174im     0.0488473+0.0892116im     -0.223084-0.0120651im     -0.0837806+0.0145648im       0.19271+0.023587im      -0.062669-0.0780307im   -0.00412577+0.222965im     -0.139036-0.00777014im     0.165705-0.298533im     0.0642838+0.00895935im   -0.0827024+0.149565im      0.111897-0.112378im     -0.0605132+0.240917im      0.0876133-0.0735934im     0.0319152+0.0789233im     0.105029+0.00731747im    -0.109998+0.0124163im      -0.250083-0.0183567im
   0.249333-0.246217im      0.0610183-0.0465297im       0.123838+0.122653im    0.0551492-0.00622282im   -0.313943+0.0325408im     0.0284547+0.130715im      0.123251+0.0879324im    0.0532893-0.113556im     0.00909866-0.0133149im    -0.0681823-0.0592576im    -0.0744746+0.151057im      -0.013429+0.000248306im      -0.1682+0.147848im     0.100302-0.0856761im        -0.2317-0.0399766im    -0.148486+0.0230621im     -0.102383-0.104289im       0.0247847-0.0835637im     0.0946797-0.0669191im      0.228665+0.0651856im      0.112147-0.0551674im    0.0662189+0.0410357im       0.17315+0.131961im     0.0469846+0.139911im     -0.0588337+0.0211404im    -0.192753-0.23513im        0.230266+0.014885im       0.101417+0.0100013im     -0.263932+0.113044im     -0.200805-0.00524485im    0.0807103+0.0195554im     -0.0394946-0.135225im
 -0.0900944+0.214395im       0.003293-0.184557im        0.158874-0.074361im   -0.0711348+0.0044147im   -0.0436802+0.0648243im     0.0402756+0.0777393im     -0.04126+0.150018im     0.0418245+0.118268im       0.101752-0.0207634im      0.111069-0.056109im       0.256554-0.0582428im     0.0703798+0.207239im       0.0142521-0.104541im     0.136612-0.015545im       -0.149534-0.0968403im     0.152745-0.0797823im     0.0862051+0.0810032im     0.00391932-0.104024im     -0.0013173-0.0431717im      0.191395+0.0941607im    -0.0505458+0.10191im     -0.0955516+0.257554im      -0.137221-0.142391im    -0.0463244-0.0816545im     -0.206135-0.0353054im   0.00598398+0.0843699im     0.0531586-0.210525im       0.174289-0.340304im      -0.194545-0.0753161im      0.06453+0.00734503im    0.0119771+0.183053im       -0.174288-0.151382im
  -0.263219-0.0674281im      0.264453-0.0722586im     -0.0124779-0.09274im    -0.0708319-0.0500318im    0.0919558-0.215809im     -0.0796037+0.0373557im   -0.0562992+0.0767802im    0.0438382+0.132312im       0.073723+0.273251im      0.0216102+0.059971im    -0.00883704+0.0890952im     -0.064892+0.184869im       -0.316814-0.0361808im   -0.162773+0.0983466im      0.0617499+0.00120123im    0.143854-0.00132889im    0.0418748-0.203312im       0.0608387+0.0626625im     0.0563143-0.0459825im     0.0292061-0.0460484im      0.188534-0.161509im      0.172079+0.0363966im    -0.0585307+0.146383im     0.0607664+0.252148im     -0.0370792-0.00945722im    0.112946-0.0689602im    -0.0965299-0.100639im      0.0406223+0.00756728im    0.0518714+0.285168im     0.0685041+0.219479im      0.0551493+0.153294im      -0.0274169+0.0508974im
  0.0284591+0.0510421im    -0.0463194-0.0690719im       0.027199+0.159625im   0.00710318+0.056199im     0.0445434+0.0842145im    -0.0356954-0.0820505im    0.0580965-0.189462im      0.208238-0.081927im       0.183384-0.130429im       0.202845+0.119402im     0.00975229-0.10985im      -0.0138404-0.230419im      -0.0103566-0.0258566im   0.0199482-0.24528im        -0.164153-0.0911326im     0.167714-0.01486im        0.187192+0.0729572im      0.0151604+0.00170791im    0.0112534-0.0682264im    -0.0261434-0.0599273im      0.164476+0.105873im      0.254934-0.226002im      -0.137251-0.155587im    -0.0443955+0.118343im      -0.178776-0.0774584im     0.106185-0.130092im       0.181898-0.0465069im       0.19531+0.0287517im      0.251726+0.0653787im   -0.0668892+0.176686im     -0.0228155+0.00612647im      0.215096-0.0619838im
  -0.181507-0.058051im      -0.204481-0.126087im      -0.0273361-0.152585im     0.216501+0.0779314im     0.141712-0.0308777im    -0.0290156-0.182169im    -0.0158846-0.0424485im     0.187877-0.0785832im     0.0679531+0.0173948im     -0.133651+0.123693im      0.0458144+0.0396757im      0.248183+0.191302im      -0.0852554-0.227125im    0.0203722+0.12974im        0.0319264+0.0426075im    0.0216859-0.139866im     -0.0785923-0.0171319im       0.176324+0.0216588im     0.0759738-0.0100166im     0.0405848+0.0893534im    -0.0560833+0.120886im    -0.0301553-0.127418im      0.0160256+0.0217275im  -0.00960698+0.0606983im     0.0606057+0.25191im     -0.0647182-0.0682935im      0.300503-0.317824im      -0.111346+0.237658im     -0.0787905-0.140299im     -0.133094-0.0384075im    -0.0102755-0.118011im       0.0391669-0.0415418im
 -0.0736593+0.179281im     -0.0252502-0.0175143im      0.0321761+0.24805im     -0.107077+0.0163623im     0.134834+0.121614im      -0.280902-0.0516588im    0.0231546-0.205311im      0.135211+0.0108281im    0.00507375-0.000171791im   -0.181588+0.0319849im      0.233534+0.141364im     -0.0669401-0.0586944im     -0.0889245-0.150973im    -0.117987+0.0493611im     -0.0420239+0.178473im     0.0740538-0.127798im        0.12704+0.0332979im      -0.183267-0.0595235im     -0.117198+0.11105im       -0.111137-0.0152017im    -0.0517869-0.0841031im   -0.0100416+0.192326im        0.19204-0.169736im      0.100288+0.210259im      0.0594804+0.0761575im    -0.192452-0.251502im      -0.137351+0.165175im      0.0534977-0.0434075im     -0.131444-0.0584343im    -0.138201-0.108636im       0.115606+0.0151806im     -0.0268549+0.0795776im
  0.0418844+0.139696im     0.00511787-0.195829im      -0.0818869+0.0284316im   0.0271335+0.243757im      0.150848-0.238416im        0.25215-0.18162im      -0.153084-0.0135202im    -0.091712-0.0636928im       0.14054+0.0805836im       0.12841-0.0190178im    -0.0124085-0.198678im      -0.147544+0.0607494im      0.0935503-0.129435im    -0.161098+0.0373737im      -0.183343-0.113124im    -0.0746552+0.217664im     -0.0470427-0.0638489im      -0.145312-0.0407614im     -0.210122-0.166852im     -0.0445928-0.131631im       0.108293+0.109719im    -0.0320361-0.0355893im      0.264154+0.0574797im  -0.00932013+0.0041519im      0.297168-0.104864im     -0.109222-0.0101234im     0.0755948-0.0322582im      0.051897-0.095132im      -0.157672+0.0782918im   -0.0536478-0.0491514im      0.101911-0.000733251im    0.0552142-0.0294742im
  0.0941726-0.150047im      0.0916382-0.0916995im      0.0997779-0.0625115im    0.156939-0.0552468im    -0.137159-0.252778im    -0.00567294+0.152804im      0.488891+0.0119496im   -0.0976238+0.0347352im   -0.00408394+0.120553im      0.0234348+0.0011274im      0.168929-0.137077im      0.0915439-0.14621im        0.0895922-0.0489428im   -0.231479-0.110085im       0.0391678+0.0751253im     0.116811-0.0557766im   -0.00615871+0.0216578im       0.149718-0.049483im     -0.0742961+0.0302272im     -0.273515+0.0737304im     -0.056798+0.151064im     -0.109115+0.0765539im     -0.102125-0.121081im    -0.0471895+0.0709012im      0.170757+0.0501716im    -0.137163-0.098675im      0.0400211-0.0351351im   -0.00751807-0.0141994im    -0.0825599+0.0388955im      0.26667+0.0326004im     0.0362708+0.0622429im       0.157509-0.00274745im
   0.149029+0.0073184im      0.175792+0.12946im        -0.110798+0.0502279im   -0.116292-0.14611im      0.0776146+0.0848476im      0.126087-0.148485im     0.0503017+0.135853im     0.0511474+0.0094743im      0.129623-0.0548287im    -0.0277074-0.173019im       0.133027+0.0888795im     -0.057757-0.00951712im    -0.0337317+0.215522im    -0.105944+0.353107im     0.000478966-0.0560965im    0.0722238+0.0388451im    -0.0350493-0.106109im       -0.163354-0.247153im       0.176657+0.0709822im   -0.00555561-0.063044im      0.0306992+0.211355im      0.158919-0.0283944im    -0.0711869-0.211521im     -0.118131+0.00827792im     0.133832-0.0149761im    -0.116768-0.0978063im     0.0181597-0.128679im      -0.288841+0.0201622im     0.0599413-0.182917im    -0.0130913+0.193363im      -0.106309+0.0729814im     0.00334705-0.152686im
   0.089022+0.0419346im     0.0248295-0.0770096im      -0.242553+0.119847im    0.0525782-0.165415im     0.0785889+0.195505im      -0.118099+0.181842im      -0.11542+0.0578943im    0.0749226-0.136774im     -0.0609198+0.38227im        0.196472-0.100554im     0.00932317-0.0919739im      0.167306+0.131587im        0.189991-0.0346585im   0.0595115+0.0243894im      -0.167354+0.0974193im   -0.0474673+0.156548im       0.247526+0.0658945im     -0.0604026+0.0651476im      0.204397+0.156452im       -0.10807+0.0394021im    -0.0645766+0.0343704im   -0.0481884-0.138685im      0.0544567+0.0300298im    0.0907419+0.0598685im    -0.0403126-0.0344671im   -0.0630291-0.0892066im   -0.00597134-0.0801904im    -0.0937859+0.0738003im   -0.00401297+0.241492im      0.172234-0.157501im     -0.0209574-0.0624263im     -0.0558881-0.196573im
  0.0833861+0.0609024im     -0.311746+0.109167im       0.0256559+0.0475541im   0.0293918-0.111035im     0.0798761-0.23496im       0.0943915+0.140629im      0.119188+0.0398519im       0.2792+0.0606284im     -0.171718+0.0218877im     0.0927741-0.00397646im    0.0917352+0.0541189im     -0.304626+0.0973073im       0.165679+0.0907757im   0.0551935+0.0308703im     0.00197854-0.0952512im     0.160785-0.0192037im     -0.153302+0.0808075im     -0.0570551-0.00513148im     0.103407+0.182899im     -0.0500576-0.121779im       0.122042-0.137754im     -0.013084+0.0559144im    -0.0280669+0.0433362im    -0.096199-0.0143706im       0.12124+0.163265im    -0.0579987+0.0681933im     0.0744667-0.143291im       0.138656+0.0799214im      0.209876+0.143908im     -0.176869-0.219741im      0.0497369+0.221178im      -0.0849265+0.0340883im
 -0.0465598+0.101361im      0.0731712+0.207859im        -0.23969+0.136066im     0.106958-0.00399448im   -0.107845+0.0709938im      0.203932-0.361018im      0.100576+0.150829im     0.0608236-0.154217im       0.135226-0.130977im     -0.0598096-0.0620918im      0.193464-0.0252168im     -0.230778+0.0620749im     -0.0396679-0.0661296im   -0.101067-0.135762im        0.186183-0.125827im     -0.165092-0.106981im      0.0799614-0.0174779im    -0.00574489+0.126333im      0.0417765-0.019565im     -0.0390731+0.146802im     -0.0666528-0.120791im     -0.122122-0.0195685im     -0.123479-0.0580403im     0.180674-0.0409727im     -0.121696+0.0745589im   -0.0390466-0.0260968im      0.128276+0.00750538im    0.0326505+0.0374632im     -0.123499+0.309663im      0.142516-0.0429963im     -0.105531+0.0572878im     -0.0774478+0.101772im
  -0.178139+0.0527164im     0.0923407-0.0885418im     0.00279785-0.114015im    0.0474312-0.0848856im   0.00330207+0.096452im    -0.00536262+0.0503854im     0.056428+0.297003im    -0.0839236-0.307208im      0.0827575+0.00679069im    -0.096294+0.147013im      -0.257014-0.0238351im     -0.187755-0.0364093im      -0.166068+0.0715722im   -0.151334-0.0710257im      -0.178988+0.0926991im    0.0864817-0.240642im      -0.111077+0.151724im       -0.235802+0.234672im      0.0532782+0.0359331im     0.0432108-0.0264236im     -0.189011+0.150606im      0.138324+0.00342353im    0.0499485-0.0887942im     -0.10503+0.0657822im      0.109835+0.0130684im    0.0763029+0.124257im      -0.026661+0.0435225im      0.098123+0.0588463im     0.0127038-0.0628748im    0.0363028-0.241143im     -0.0125613+0.131346im        0.059417-0.156791im
 -0.0715043+0.00141831im   -0.0587083-0.0467782im       0.115256+0.2714im      0.0399801+0.109229im     -0.185012-0.0304615im      0.229795-0.109425im    -0.0711457-0.112363im    -0.0238121-0.0787109im    -0.0305396+0.00991683im    0.0613475+0.320847im      0.0500416+0.108841im       0.164872+0.20198im       -0.0645139+0.0892684im   -0.012748-0.260766im        0.128144+0.122723im    -0.0972049+0.150435im     0.00290214-0.190981im       -0.109847+0.0722503im      0.025163+0.199431im      -0.181206-0.0657948im      0.129632+0.0569041im     0.157624+0.245569im     -0.0369852+0.0658902im   -0.0657775-0.0945818im      0.024215+0.0331466im    0.0257997-0.0789966im     -0.104793-0.0550611im    -0.0295159+0.065427im      0.0612792-0.184308im      0.154658-0.0492733im     -0.114621+0.0810773im      -0.121817-0.220412im
   0.185716-0.126348im      0.0648117-0.189163im      -0.0959358+0.128852im     0.197724+0.0651641im     0.200293+0.198248im        0.15647-0.042334im     0.0330295-0.0208458im   -0.0140273-0.0190993im     0.0696966+0.123638im      0.0479831+0.0808049im   -0.00506546-0.0512919im    -0.0184821-0.0914989im      -0.154142-0.0791104im   0.0433154+0.0516384im     -0.0062011-0.00718994im  -0.0987209-0.0835546im    -0.0951213+0.180942im        0.205372+0.0280678im      0.185977+0.247682im      0.0716925-0.0708516im      0.240546-0.191368im     -0.125109+0.041238im       0.137669-0.0637244im     0.123504-0.0312265im    -0.0628621+0.0205789im   -0.0259193+0.205298im      -0.128113+0.00308712im   -0.0514773-0.104995im     -0.0257013-0.217139im     0.0539128+0.087267im       0.063344+0.317107im        0.209629+0.121848im
 -0.0655864+0.170578im      -0.175663+0.0900475im       0.145373-0.0222521im   0.0987811+0.164414im     -0.170375-0.0261397im     0.0601197+0.0489594im   -0.0385926+0.0807191im     -0.30655+0.0828907im     -0.172955-0.0548568im    -0.0920276+0.0273303im     0.0884269+0.0527794im    -0.0101833-0.137223im        0.107331-0.232928im   -0.0833269+0.067099im       -0.111573-0.193554im     0.0235923+0.0263046im     0.0262713+0.0624958im      -0.101199+0.0294843im      0.274912-0.0714139im       0.12252-0.103037im    -0.00511552+0.120168im    -0.0249788+0.100625im       0.025776+0.0100938im     0.354372+0.127186im      -0.102017+0.0334875im    0.0372315-0.0885708im    -0.0880286-2.85225e-6im    -0.207851+0.211298im       0.166152+0.0679341im    0.0134862+0.110074im       0.154727+0.114594im        0.109652-0.15769im
  -0.138291+0.0595543im     0.0831698-0.0816224im     -0.0113907+0.153616im   -0.0555684-0.209632im     0.0808192-0.110114im         0.1504+0.0903333im    0.0882137-0.0189919im      0.20688+0.29364im        -0.20449-0.152451im     -0.0231208-0.162663im       -0.24709-0.153701im       0.166132-0.0724642im     -0.0331695-0.0508859im  -0.0987552-0.130123im        0.119541-0.170321im     -0.144132+0.0302523im     0.0361535+0.0767575im       -0.10279+0.377859im    0.000655207+0.0223422im      0.160289+0.00916775im    -0.113346-0.142323im      0.052808-0.0353881im      0.120914-0.153648im       0.05615-0.00324382im     0.104944-0.0793184im    -0.141873-0.132785im      0.0434726-0.163998im     -0.0349786-0.020639im     -0.0271698-0.147203im     0.0203891+0.125718im      0.0258875+0.00658453im    -0.0738291-0.0761419im
 -0.0842036+0.088181im      -0.111742-0.144656im       -0.119267-0.0773758im    0.158851-0.132589im     0.0706675+0.0613852im     0.0809109-0.0293903im    -0.039385-0.089732im     -0.192332-0.0671904im     -0.195161-0.0704059im     -0.120903-0.337801im      0.0189999-0.00742811im   0.00377163+0.0232307im      0.0623894+0.0122099im    0.123766-0.0110114im     -0.0300586+0.0366694im   -0.0246503-0.176268im      0.0510236-0.387762im       0.0869872-0.0430654im     0.0865185+0.120868im      -0.157721-0.117448im      -0.136179+0.067873im      0.224517+0.113222im       0.116627+0.0371017im    -0.103444-0.0589911im     -0.095076-0.205092im    -0.0700575+0.00385654im    0.0625238-0.00418626im     0.313463+0.151744im     -0.0393091+0.00994698im   0.0346954+0.13683im       0.0553794+0.143947im        0.109486+0.134157im
  -0.168895-0.190872im     -0.0759166+0.0372125im     -0.0835831+0.188923im    0.0547761+0.406392im    0.00275755-0.0864058im     0.0208852+0.0181978im   0.00512326+0.0758458im    0.0526996+0.177442im       -0.15121-0.00958518im    0.0498812-0.0167443im     0.0677154-0.089482im    -0.00921045+0.0137147im     -0.0767889-0.0392675im   -0.102289+0.0757944im       -0.12781+0.178976im     -0.157774-0.156785im      0.0344162+0.117058im         0.11977-0.167149im      0.0622197-0.0159311im     0.0959315+0.169279im      -0.205618+0.0413478im      0.10933-0.234875im     0.00312235-0.0180835im    -0.229403-0.175946im      0.0157913-0.0783792im    -0.119002-0.0513046im     -0.233168+0.123349im      0.0492269+0.0229685im      0.085722+0.144995im    -0.0750242+0.0645577im    -0.0989384+0.194551im       -0.131599-0.125196im
   0.104063-0.0113596im     -0.116059+0.0267393im      0.0264806-0.226894im    -0.120027+0.0599419im    -0.210482-0.0115737im     -0.277135-0.15406im     -0.0514428-0.108408im     0.0766089+0.188221im       0.137592+0.118163im     -0.0328291-0.0933055im     0.0450616+0.0208805im     0.0381059+0.0571048im      0.0587738+0.0667686im   0.0135052-0.149593im        0.111709+0.0834393im    -0.112754-0.125732im       0.172166-0.167907im      -0.0391022+0.172839im       0.138692-0.173916im       0.129759-0.233812im       0.049914-0.035129im     -0.111353-0.0674333im      0.137785-0.111639im    -0.0509611-0.029096im       0.170138-0.00899412im  -0.0668479+0.0835592im     0.0510587+0.0441715im    -0.0594276-0.0575922im     0.0192845+0.0269386im     0.022771-0.122235im      -0.256866+0.320145im        0.234273-0.134631im
  0.0118918-0.0341066im     0.0736092-0.0315732im      -0.198687-0.148429im   -0.0104492+0.0901706im   -0.0112306-0.0823708im    -0.0334946-0.105865im     -0.111902+0.04426im      0.0692476+0.0845635im     0.0353831-0.246988im      -0.129643-0.065061im       0.160054-0.145681im      -0.117565-0.104703im        -0.11402+0.168984im    0.0509569-0.0802275im      0.0811897+0.16096im        0.14892+0.299407im       0.102691+0.191459im        0.193853+0.183638im         0.2536+0.0674518im    -0.0669432-0.00230702im    -0.077437+0.169792im    -0.0425478+0.155587im      0.0849786+0.301675im    -0.0387725+0.201722im     -0.0381003+0.0479773im    -0.215906+0.0513718im    -0.0486888+0.00669239im     0.111573-0.112306im      0.0952208-0.0693024im   -0.0276046-0.00212559im    0.0751075-0.114408im      0.00340722-0.141603im
   0.125245-0.123385im     -0.0729351+0.0111754im       0.181741+0.0534817im   0.0738806+0.0277528im     0.232517+0.125414im      0.0509532+0.0190748im   -0.0286367+0.0929608im     0.100089+0.019603im     -0.0979494-0.101074im     -0.0436369-0.177997im       0.194425+0.355992im       0.128615+0.0521382im      -0.217702-0.0600709im  -0.0049012-0.0997195im      0.0646419-0.204905im     -0.040501-0.165079im      0.0812511+0.12812im        -0.012496-0.018617im     -0.0946797-0.0844289im    -0.0499251+0.0326288im     0.0667855+0.130641im     0.0480051-0.023639im      0.0633103+0.172017im     0.0322235+0.121196im       0.274522-0.271371im     0.0368001+0.184908im      0.0462289+0.0361048im    0.00650668-0.0794952im      0.168683+0.101509im      0.264332-0.122174im      0.0141646-0.115866im      0.00578087-0.0851119im
  0.0940415+0.205482im      0.0482326+0.0942246im      0.0929539-0.153038im   -0.0106512+0.139353im      0.180495+0.101594im       0.226799-0.0108012im    0.0620479+0.00102521im     0.01961+0.0135385im    -0.0496005-0.0839164im     -0.247077+0.0812137im     -0.200957-0.123191im        0.32352+0.128701im       0.0730618+0.160294im     -0.17593+0.115902im      -0.0543512-0.0169833im    0.0638873-0.0233737im     0.0807315+0.04582im        0.0203788-0.145264im      0.0892813-8.53067e-5im   -0.0680391+0.0117451im      0.131682-0.303334im      -0.17663+0.102543im     -0.0605605-0.0630355im   -0.0967726+0.147656im     0.00211925+0.0153915im   -0.0304784-0.00457877im   0.00527208+0.174514im       0.247462+0.0906273im    -0.0081522+0.159419im    -0.0128037+0.0231055im      -0.16612-0.0665363im      0.0852799-0.225158im
   0.172742+0.0817772im     0.0588327-0.269657im       -0.112105-0.0417226im   -0.340188-0.0246343im     -0.13296-0.0355408im   -0.00717048-0.101254im    -0.0850963+0.12267im     -0.0505777-0.00678805im    -0.258874-0.00469842im     0.184929+0.0559877im     0.0820951-0.0560322im     0.0256341-0.0307215im       -0.20179-0.100602im    -0.183825-0.17628im         0.113522+0.190475im    -0.0551102-0.0920079im    -0.0448701+0.0511596im     -0.0701463-0.257077im      0.0850751-0.00964101im     0.045671-0.0543778im    -0.0145619-0.114645im     -0.171688+0.0173963im   -0.00802522-0.0914236im   -0.0953595+0.0716939im    -0.0571436-0.123909im    -0.0214197+0.14025im        0.257013-0.0152698im    -0.0302937+0.28421im        0.145677-0.0397165im   -0.0213933-0.00702625im     0.157297-0.0746146im      -0.104269+0.0725574im
  -0.070374-0.00665137im     0.114849-0.170904im      -0.0423543-0.124989im    0.0248355+0.102007im     -0.120625+0.0248439im    -0.0392081+0.0435497im    0.0524373+0.0878879im     0.144044-0.0480261im    -0.0953984-0.129087im       -0.11368+0.0687811im    -0.0093779+0.222371im      0.0870499-0.144298im      0.00764891-0.0371538im  -0.0787654+0.0602077im      0.0559981-0.0154526im    0.0390386+0.0824582im      0.213176-0.122736im       -0.289596+0.0160765im      0.248885+0.0771547im     -0.142239+0.176529im       0.205502+0.0273389im    -0.149312-0.155549im      0.0469494+0.0069118im   -0.0483874-0.430527im      0.0992469+0.0392214im     0.120423-0.00261686im   -0.0505233-0.0981757im      0.111396-0.166393im     -0.0317536+0.0972903im    -0.118654+0.0280612im      0.251435-0.0302467im       0.103024+0.078133im
  0.0825735+0.1025im       -0.0661069-0.236834im       -0.102447-0.0311531im    0.133731-0.0876756im   -0.0479071+0.0463353im     0.0543065+0.0131363im     0.063322-0.0646386im    0.0541378+0.113049im     -0.0383003+0.0167195im    -0.0745584-0.136143im       0.149845+0.0628892im    -0.0272706+0.0695796im     -0.0832131+0.032164im   -0.0456618-0.204871im       -0.213452+0.0343524im    0.0139986+0.263842im     -0.0420136-0.156044im      -0.0751684-0.0211181im    -0.0666336+0.006877im       0.024874+0.264947im      -0.139933-0.0633985im   0.00630813-0.15471im       -0.226207-0.0308388im     0.200635+0.171525im       0.228451+0.142185im      0.212099+0.274024im      -0.144719+0.150164im      0.0119251+0.0949952im    -0.0305419-0.109317im     -0.220891+0.123735im      -0.145669+0.0719512im    -0.00425073-0.0434498im
   0.116772+0.0175002im    -0.0991067-0.169372im     -0.00762317+0.0518297im   0.0676088-0.0935385im    -0.119039-0.00297943im    -0.051339+0.082298im    -0.0313947-0.0979963im    -0.273897+0.0134723im      0.164637+0.117847im      -0.322411+0.0925942im     0.0602433-0.0923923im    -0.0429022-0.0377782im      -0.155288-0.0579687im  -0.0191124-0.00679693im     0.0940349-0.344704im     0.0813125-0.0642133im      0.190753+0.149079im      -0.0478097-0.0336007im    0.00227951+0.11901im         -0.1443-0.229709im      -0.103578-0.145918im   -0.00171542-0.254813im     -0.0057892+0.146492im     -0.205738-0.0653345im     0.0222955+0.0496162im   -0.0242226-0.00626521im    0.0884771+0.0243033im    -0.0376857-0.0658452im   -0.00583048-0.00913206im  -0.0758737+0.12724im      -0.0689688+0.019616im       -0.347929-0.0776298im
  -0.250628-0.00183574im    0.0892572-0.0489622im      0.0361608+0.187592im    0.0373787-0.0428492im   -0.0433842+0.00397467im    -0.108253-0.0393769im    0.0675373+0.080808im       0.11178+0.121811im      0.0400863-0.0152653im      0.106035-0.0542517im       0.02674-0.0539462im     0.0529513-0.109228im        0.073102-0.106907im   -0.0997365+0.016426im       -0.207802-0.00337203im    -0.13488-0.182939im      -0.251573-0.111157im       0.0197582-0.00449256im     0.284284+0.0796581im     -0.164621-0.361885im      0.0522658+0.0286839im    -0.116813+0.0804666im      -0.17923+0.176034im     0.0964985-0.01887im       0.0635066-0.0732565im    0.0362746+0.130774im      0.0962141+0.145618im     0.00287465-0.183879im     -0.0504405+0.00378091im   -0.163861+0.0142968im     -0.217948-0.295488im      -0.0467595-0.0286284im
  -0.142991-0.122267im       -0.11377-0.0447432im      0.0717856+0.0375605im   -0.286085-0.132439im    -0.0609365+0.0485458im     0.0485171-0.19996im      -0.037085+0.15923im      0.0159647-0.0823488im     -0.113498+0.113337im       0.104424-0.0935713im     0.0462902-0.103214im       0.119867-0.155636im     -0.00317514+0.059982im      0.11963+0.157358im      -0.0128808-0.103778im    -0.0732517-0.12478im        0.079263-0.000472626im    0.0532906+0.159555im      -0.309208+0.100729im      -0.167145+0.114044im       0.123598+0.116093im    -0.0762745+0.07904im        0.112985+0.056403im    -0.0132603+0.00191043im  0.000633165+0.339136im     0.0126297+0.133365im      0.0600941+0.219563im     0.00308595+0.019952im      0.0552509+0.10123im      -0.118706+0.235488im      0.0991026+0.107397im       0.0354413-0.247673im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.18820985841435764 + 0.17827956710509757im
   0.028148942380666068 - 0.1629913218331301im
    0.28145444346882953 + 0.13196978537664908im
   -0.16402801696496913 - 0.2538133133923236im
    0.16760118294650864 + 0.00013936474422963333im
    0.12116152046365582 + 0.08182766970556046im
  -0.023154244987791506 - 0.0849099737174729im
    0.17729588666231907 - 0.17883955805530033im
   -0.16208882197989335 - 0.12749015261413102im
    0.13088569242376727 + 0.050261651708904856im
    0.13373993713089524 + 0.013009573899906753im
   -0.17245686109116587 + 0.04646478166178164im
    0.12420371828512516 - 0.10748338054889194im
    0.03882999436593587 - 0.020784991550338253im
     0.3166119000095482 + 0.0im
    0.01956279211442536 - 0.12705656573138885im
   -0.11552665625861097 + 0.02638491681793753im
   -0.09346082350554105 - 0.13659934245826819im
   -0.03721831155498334 + 0.03200001660197606im
     -0.111424319234077 + 0.06104429084974747im
   -0.07769124203445472 - 0.15161423406414246im
   -0.08943773898748827 + 0.1724436729196843im
   -0.05240112724555802 + 0.0495129892866899im
    0.07251161403047242 + 0.06583285721546629im
  -0.016291700672705016 + 0.11714332044653132im
    0.10026706100972406 - 0.04086082862034921im
   -0.15995945797283745 - 0.14374932125201353im
   0.007401090151150431 + 0.06806710156351753im
   -0.14053858132989874 - 0.05113177565473954im
    0.09191691013054762 - 0.2008317619333067im
    0.04811599609418182 + 0.05513027674644556im
 -0.0008608300149224205 + 0.21054673038500252im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Wednesday 17 August 2022 09:14">Wednesday 17 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.394412+0.21789im       0.0792141+0.119959im        0.08308+0.0583918im    -0.0246054-0.0587456im       0.023943+0.0122319im      -0.212957+0.0724246im       0.15608+0.0143882im   -0.167429+0.0177704im    -0.13836-0.137073im    -0.000459521-0.0200566im     0.0615785-0.231092im     -0.0857831+0.0629633im     -0.108719-0.116701im     -0.0232823-0.131373im     -0.101356-0.0736271im   -0.0275769+0.0355449im     -0.143863+0.144195im     -0.0204825+0.0445016im   -0.0367031-0.0776567im      -0.13949+0.015045im       0.100248+0.0262112im    -0.272525-0.0505053im      -0.12228-0.097532im       0.05776-0.0615136im    0.120824-0.129498im    -0.0554159+0.0365232im     -0.13181+0.0279186im    -0.0951061-0.144058im    -0.0675744-0.00802413im    0.0897723-0.247099im     -0.106036-0.284718im    -0.212482+0.0697364im
 -0.0595778+0.181254im       0.194472+0.198336im    -0.00911328+0.0211805im    -0.0403375+0.129923im        0.039212+0.0617349im       0.053959-0.0185413im     0.0523988+0.0650246im  0.00919039+0.112729im    0.0364249-0.148441im      -0.0866665+0.11487im       -0.116753+0.152459im       0.183258+0.156625im     -0.0820628-0.0505593im     0.0911076+0.0193686im    0.0506481+0.323415im    -0.0147571+0.0400635im     -0.152187-0.264902im     0.00809746-0.130237im     -0.371176-0.0237945im    -0.0411395+0.157843im       0.159321-0.159672im     -0.158106+0.0589292im     0.0424817-0.0128159im    0.0521627+0.148661im    -0.228619+0.15405im     -0.0904886+0.0236162im   -0.0582223+0.016854im      -0.158593-0.142091im     0.0270987+0.0211413im   -0.00137658-0.00719575im  -0.0206047-0.0299692im    0.196873-0.128461im
 -0.0257746-0.0668334im     0.0696782+0.0786154im     0.0583259-0.0257899im     -0.136288+0.186263im       0.0814695+0.0214674im       0.132047-0.186688im     -0.0590982-0.0432784im  -0.0940949-0.127897im     0.136247+0.0827997im     -0.0744046-0.133901im      0.0619702-0.217735im      -0.108211-0.0653461im      0.105346+0.0165569im      0.268745-0.119892im      0.231847+0.030893im     0.0419157+0.159565im       0.110537-0.121626im      -0.217008+0.043884im     -0.145703-0.104355im       0.136771-0.0397344im      0.177667-0.0142614im   -0.0957705+0.108195im     -0.0616635+0.188344im    -0.0015287+0.097286im     0.221137+0.0352903im    -0.210643+0.0749329im   -0.0230939+0.126106im       0.210198+0.240784im      0.198242+0.0433223im   -0.00945934-0.164157im    -0.0747904-0.0257933im  -0.0878004+0.098953im
 -0.0103314+0.00634914im    0.0968322+0.0698981im    -0.0658675-0.0235195im      0.481189+0.349278im        -0.20178-0.239673im       0.0982906+0.191659im      -0.153124+0.0690401im  -0.0674441-0.206123im   -0.0564355+0.0700822im     0.00474426-0.221286im      0.0402508+0.0605939im     -0.036253-0.0479368im   -0.00679225+0.101297im      0.0330992-0.0849667im    -0.190868+0.0358355im  -0.00416084-0.013434im     0.00329269+0.146028im     -0.0542277-0.0873071im   0.00826106-0.0019004im      0.180291-0.0376674im     0.0442738-0.0127679im  -0.00683151-0.0882059im     0.0571753+0.21902im     -0.0464146+0.0975448im   -0.021823+0.060884im     0.0284407-0.0397521im    0.0375635+0.0695535im    -0.0789862-0.209258im    -0.0329489+0.0449583im      0.208557-0.0178645im    -0.157849-0.100472im    0.0360618-0.000488727im
 0.00201339+0.0148943im     -0.231363+0.233745im      0.0716594+0.0176061im      0.159451-0.192951im        0.280877-0.091704im      -0.0920961+0.110592im      -0.106688-0.0791332im   0.0278592+0.103997im   -0.0359882-0.0893901im      -0.214509-0.070559im      0.0961496-0.125639im        0.26262-0.00154494im       0.1034-0.100212im     -0.0512518+0.0344757im    -0.124739-0.0707417im   -0.0745593-0.0742125im       0.11698-0.0432029im      0.148759+0.0448709im    -0.152802-0.00359763im      0.16203+0.0282883im     -0.176461-0.0945521im     0.100384+0.124925im       0.117824+0.268342im     0.0186695-0.103228im   -0.0129067+0.0843697im   -0.0631934+0.10985im      -0.138713+0.00945661im    -0.142453+0.0789812im     0.282985+0.0126321im      0.108553+0.0746739im     0.138157-0.121248im    -0.140223+0.052682im
 -0.0296364-0.0322496im    -0.0527878-0.0574032im     0.0945572+0.130245im     -0.0457195-0.00425423im  -0.000176033-0.0897549im       0.198611+0.268523im      -0.188874+0.0671415im  0.00336148+0.217169im   -0.0481616-0.116906im       -0.041266-0.00839096im     0.183788-0.110544im       0.269796-0.0939833im     -0.122617-0.202515im     -0.0606226-0.191223im       0.03055+0.0503988im    0.0257279-0.0180256im     -0.004794-0.0350472im    -0.0827824-0.0938513im    0.0195602-0.172506im       0.143169+0.136302im       0.131023-0.138094im     0.0113828-0.0689591im    -0.0319168-0.0451118im    0.0100084-0.14037im      0.220915+0.0301393im  -0.00546686-0.193305im    0.00421785-0.109361im       0.231065-0.164268im     -0.185553-0.0911937im     -0.065544-0.123801im     0.0379538+0.338253im   -0.0502834-0.023937im
  0.0408792-0.0721973im      0.114663+0.0515741im     0.0221407-0.166811im      0.0943174-0.197723im       0.0926289-0.210766im       -0.116556-0.0289256im      0.356573+0.151253im    -0.126693+0.034631im    -0.124809+0.260634im         0.14117+0.00731855im   -0.0587837-0.0298772im      0.119903-0.0309284im      0.119915-0.00205262im     -0.11155-0.0683329im     0.110204+0.0362017im   -0.0022228-0.0677204im     0.0295942-0.212927im     -0.0650767-0.0838175im    0.0682805-0.164603im       0.215546+0.126258im       0.260649-0.0286461im     0.138512-0.109669im      -0.082404-0.0530736im   -0.0670551+0.130728im   -0.0428333-0.156588im       0.14175+0.203761im    -0.0253899-0.0252623im     0.0926937-0.028501im     0.0416037+0.128545im       0.102493+0.181989im    -0.0331963+0.0483677im     -0.1533-0.152709im
   0.112771+0.152336im     -0.0666685+0.0512502im     0.0203496+0.199916im     -0.0147146-0.00925287im    -0.0284807-0.0756293im      -0.120065-0.20774im      -0.0831163-0.041538im     0.283838+0.271837im   0.00235327+0.289872im       -0.112862-0.100151im       0.219989-0.124039im       0.132565+0.0464472im    0.00762186-0.0925921im     -0.073307+0.0325728im   -0.0340168+0.188134im     -0.121817+0.0647276im    -0.0400844+0.0412975im   -0.00518036-0.0114553im     0.143755+0.0581521im    -0.0761423-0.240973im      0.0680995-0.0525031im    0.0289825+0.178487im     -0.0961177+0.0751388im    0.0214683+0.261348im   0.00674431+0.0139164im   -0.0163098+0.0400258im      0.27243+0.0382546im      0.134519-0.0640554im    -0.192463+0.0820797im    -0.0265581+0.163863im      -0.11486-0.141973im    0.0846945+0.0346535im
   0.117307+0.128383im     -0.0354994+0.0516801im     0.0680043-0.36976im       0.0256265-0.0440461im      0.0640813+0.13057im         0.193139+0.00290309im    0.0407466+0.0703334im   0.0247029+0.279687im     0.185417+0.04874im       -0.0209763+0.227373im      -0.114015-0.00576966im     0.012992-0.175931im       0.176321-0.0377428im       0.14408-0.236778im     -0.232586-0.0482199im      0.27026-0.0330412im    -0.0586152+0.243221im     -0.0617215+0.0574788im   -0.0418801-0.0373255im     0.0481391+0.113188im     -0.0149197+0.0397213im    0.0412557-0.0307675im     -0.114743+0.0711363im    0.0296604+0.0755991im  -0.0661723+0.0660216im    0.0747205-0.244614im      0.216648-0.0665144im     0.0511217+0.108107im     0.0179412+0.0387411im     0.0546885+0.0350094im    0.0277909-0.188205im     0.064242-0.0400967im
   0.133003+0.0885438im     0.0595395+0.0267918im     0.0107479-0.0127722im     0.0894498+0.106029im        -0.16404-0.280909im      -0.0510425+0.00585225im    0.0275292+0.115153im     0.042872-0.0915663im    0.090748-0.089027im        0.268992+0.131017im       0.225243-0.152518im      0.0253868+0.095753im        0.18412-0.164753im       -0.10193+0.0175986im  -0.00708179-0.0804426im   0.00594388-0.104915im    0.000799176-0.16148im       -0.154285+0.165374im    -0.0209371-0.174435im      -0.155657+0.0153999im     -0.106271-0.0518659im     0.173289+0.126789im     0.00454934-0.00148872im  -0.0988841+0.0157861im   -0.324304+0.045782im     -0.112726-0.165801im   -0.00807138+0.166291im     -0.0970019+0.279446im     -0.116454+0.0142154im     -0.103503-0.145149im      0.093272+0.113413im    0.0120001+0.0809516im
  0.0937424+0.000316768im   0.0937094+0.0753645im     0.0118311-0.00101512im   0.00260117+0.0908549im      -0.193416+0.114808im     -0.00116021-0.185332im       0.179432-0.166132im     -0.10232+0.0763804im   -0.243603+0.102271im       -0.193988+0.0243754im      0.164286+0.17805im      -0.0168463-0.172694im      -0.262665-0.0252098im     -0.096952-0.142518im      0.084253-0.191649im      0.025605+0.115828im       0.158369-0.0331048im      0.133293-0.00127588im   0.0118979-0.0411293im     -0.191822+0.0772379im      0.233762-0.0133171im     0.165464+0.0469323im      0.136745+0.255124im    -0.0213811-0.117537im    -0.113537+0.0149912im   -0.0514823-0.142854im    -0.0977506-0.0801947im     0.0327271+0.146972im    -0.0707109-0.107975im       0.234454+0.0544958im     0.135872+0.0090515im    0.114479+0.0341357im
   0.106835-0.033088im      0.0581196-0.0568584im      0.011838+0.0230015im     0.0149702+0.102842im        0.108257+0.24422im        -0.111545+0.168179im    -0.00329092-0.0416322im  -0.0783572-0.0839797im  0.00136442+0.116969im       -0.029868-0.0646624im     -0.115188-0.0270487im      0.300563+0.0985833im     -0.136905-0.111781im       0.015739-0.0154945im     0.158798+0.0161072im    0.0864979-0.0429106im      0.100826-0.0895322im     -0.203725+0.0682799im    0.0186771+0.00808039im     0.296619-0.27931im       -0.220354+0.196095im     -0.110625+0.00992349im      0.13706-0.0505693im   -0.0290948-0.0276592im   -0.249312-0.224202im    -0.0913211-0.158367im    -0.0150964-0.122441im       0.113492+0.108013im     -0.169796-0.0487518im     0.0955605-0.0215048im     0.024211-0.169652im    0.0844875-0.164528im
 -0.0463632-0.0678322im    -0.0228705-0.132801im       0.143593-0.113234im      0.0165072-0.00821364im     -0.134281+0.190885im      -0.0557266+0.0059657im     -0.207981+0.0615032im    0.116097-0.1729im      -0.272993+0.00891866im      -0.16976-0.0250547im     0.0814627+0.0264328im    -0.0521052-0.149245im       0.326797-0.0850466im    -0.0382104+0.0741781im    0.0766178+0.154157im    0.00522348-0.360071im      -0.266139-0.041035im      0.0338627+0.0203858im   -0.0788141+0.00690534im  -0.00390752+0.0765237im      0.195318-0.022793im    -0.0685916+0.109039im      0.0585276-0.061471im      0.132933-0.0480205im   -0.111827-0.109056im      0.065364-0.135285im     -0.196463-0.0417642im      0.155415+0.0513544im  -0.00942443+0.0193146im    -0.0113234+0.114406im      -0.11322-0.140129im   -0.0606273+0.209862im
  0.0342713+0.0362498im     0.0920736-0.097666im      -0.114873+0.0641108im       0.18464-0.0949534im      0.0632325-0.00803239im    -0.0623825-0.0947392im      0.142045-0.029735im     0.180848+0.0658674im   -0.215385-0.0475572im      -0.022281+0.157357im      0.0625104-0.207976im     -0.0100494+0.0271543im     0.0571015+0.213481im       0.442181+0.0385847im     0.128169-0.102711im    -0.0795092+0.03091im       0.0878041-0.150231im       0.182949+0.0534409im   -0.0856646-0.100341im       0.119337-0.084001im     -0.0873817+0.082231im     0.0255023-0.171812im      -0.121824+0.170973im    -0.0209662-0.0686726im  -0.0955342+0.0880613im     0.150618-0.239042im    -0.0675542-0.077455im      0.0384433-0.19622im     -0.0479084-0.0766384im      -0.21715-0.0385633im    -0.165329+0.0162463im   0.0479224+0.0947331im
    0.12015+0.00379188im    -0.328173+0.144486im       0.313564-0.0653461im      0.069426-0.0179789im     -0.0750808-0.0612657im       0.117609-0.0382999im      0.120311-0.158901im   -0.0330156-0.0790486im   0.0520866+0.0488317im      0.0911052-0.0108881im   -0.00800301+0.0736242im    -0.0491356+0.115269im     -0.0652698+0.207747im       0.117003-0.125594im     0.0986332+0.154774im    -0.0944746-0.221626im        0.11265+0.106603im      0.0447003-0.145058im     -0.285441-0.0214688im     -0.165824-0.0738046im     -0.203074-0.173517im    -0.0020255-0.0740527im      0.029577-0.0504182im    0.0483278+0.0291398im  -0.0805794-0.0210503im    0.0479645+0.0904621im    0.0104698+0.0430729im      0.250103+0.0532189im    -0.195139-0.243161im      0.0506048+0.0381427im   -0.0681692+0.067326im    -0.167623-0.0741268im
 -0.0823192+0.00284187im     0.036825+0.243846im      -0.188511-0.0973692im     0.0654501-0.0537093im     -0.0340692+0.242049im        0.152472+0.0708053im    -0.0393859-0.0456716im     0.12338+0.0307965im  -0.0807337+0.00711208im      0.199468-0.0847868im     0.0482543-0.171316im      0.0174323+0.0631092im    -0.0592264-0.122734im      0.0310196+0.135846im       0.14501-0.046951im      0.431075+0.0763006im     0.0460006+0.0252761im     0.0200201+0.0889512im    0.0920299-0.0647385im     -0.152226-0.02042im       0.0140987-0.0581398im   -0.0691138+0.102047im       0.138398-0.0408035im   -0.0840468+0.0410439im  0.00379346+0.0463474im    0.0391515-0.0347426im   -0.0732215+0.280919im     -0.0255745-0.160083im     0.0119852-0.180534im      0.0342288+0.295762im     -0.139442+0.0478637im   -0.264283-0.0770709im
  0.0366808+0.0614062im      0.110779+0.00307579im     0.178925-0.0148483im       0.16722-0.0266162im     -0.0655962+0.0748184im     -0.0545234-0.0596452im     -0.140179-0.0818163im   0.0690008-0.0103364im    0.143748-0.100385im        0.117478+0.105812im       -0.32272+0.142509im      0.0619688+0.159024im     -0.0319573-0.127563im      0.0275869+0.0551975im    0.0734483-0.0895809im    -0.103131+0.0104684im        0.2368+0.0951999im     0.0920646-0.11512im      0.0504931-0.0654234im      0.146516-0.208023im       0.299061-0.127462im       0.18895+0.0970778im   -0.00874812-0.108202im    0.00738355+0.052377im     0.194964+0.148094im      0.145546-0.128638im     -0.214081+0.117606im     -0.0134349+0.0479627im    -0.156518+0.122413im     -0.0989455-0.0319848im     0.167406-0.17921im     -0.118035+0.106999im
  0.0412982-0.0367354im     -0.300742+0.101937im      -0.142717+0.01106im       0.0575798+0.0246772im       -0.14138+0.00244637im     -0.175174-0.23243im       -0.185824+0.134249im   -0.0463979+0.179519im    0.0628269-0.00120602im     0.0945949-0.103237im      -0.230413+0.0453351im     0.0667386-0.2305im        0.0858694-0.0563658im     0.0157492+0.184164im     0.0921843-0.0834521im    0.0388989+0.0411063im     -0.105934-0.10559im        0.160689+0.0281043im    -0.137541-0.0498465im     0.0645671+0.0514243im    0.00704906-0.0182772im   -0.0640299-0.0130688im      -0.12162+0.0773845im   -0.0978805-0.188611im     0.124898-0.10484im      0.0488995+0.0162229im   -0.0243359+0.0688107im     -0.123355+0.17733im      -0.264633-0.0113629im      0.148139-0.170737im     -0.258397+0.0607317im   0.0836964-0.229459im
  -0.197727-0.203678im      0.0211018-0.121499im      -0.137447+0.0507941im      0.114465+0.104137im       -0.138654-0.0336022im      0.0866781+0.0238075im     0.0598393+0.0431941im    0.122329+0.02802im     0.0657794+0.033873im       -0.205549+0.233388im     -0.0976175-0.152039im       0.113039+0.241045im     -0.0348399-0.0961103im     0.0613412-0.0460268im  -0.00578483+0.0287915im   -0.0887765-0.100168im     -0.0154325-0.0992426im    -0.0479536-0.088015im     0.0288542+0.26386im       -0.234157+0.0239457im     0.0930765-0.0530869im   -0.0285311-0.166506im      -0.221689+0.103735im     -0.103312-0.246142im    0.0249914-0.107595im     -0.109448-0.0489388im     0.127189+0.04999im      -0.0173746+0.1263im       0.0085686+0.0182333im      0.118944+0.0321532im    0.0590661-0.189431im    -0.343957-0.128004im
    0.12723-0.195021im      0.0171141-0.0526073im      0.269444+0.198471im    -0.00372608-0.052602im      -0.0244262-0.0470472im     -0.0465467-0.114788im      -0.137979+0.106535im   -0.0642124+0.378299im    0.0346588-0.171438im        0.188497-0.0412291im    -0.0698408-0.0168257im     -0.169733+0.0899355im    -0.0588948+0.0968777im       0.07343+0.0989926im     0.112672-0.0648362im    -0.164941-0.0916529im    -0.0646323+0.0413757im     -0.281075+0.0152004im   -0.0329299+0.0725815im     0.0141623+0.0738311im     0.0718674+0.135194im     0.0675006+0.0100806im      0.179091+0.0153601im    -0.157515+0.0162406im  -0.0600926-0.0308269im   -0.0672127-0.234109im     0.0406804+0.0203294im   -0.00981824-0.127995im      0.271489-0.0576078im      0.240956+0.192016im    -0.0677341-0.0122024im  0.00167118+0.00113789im
  0.0505729+0.034785im     -0.0521198+0.0301543im     -0.107354-0.0791466im       0.12864+0.138983im       0.0319916+0.176428im      -0.0940529-0.0544212im    -0.0197433+0.13162im     0.0869075+0.0830916im    0.152607+0.062362im        0.145267-0.0897349im      0.121297-0.14647im        0.279338-0.00682837im   -0.0554092+0.125697im      -0.157268-0.0421964im     0.121671-0.018542im     0.0667597-0.0885673im    -0.0663878+0.184928im      0.0860287-0.332245im     -0.124608+0.0881879im    -0.0963356-0.164021im       0.190112+0.178285im     0.0220699-0.246191im     -0.0698923-0.0744457im   -0.0498739+0.0256674im  -0.0601737-0.0640618im    0.0170006+0.0558014im   -0.0827514-0.0369311im    -0.0627011+0.107985im      0.287794-0.128553im     -0.0744665-0.100487im     0.0642921+0.15372im     0.0980305+0.271363im
  0.0153106-0.180999im      -0.144059-0.17016im      -0.0504326+0.170085im     -0.0823852-0.0644085im      0.0095924+0.120161im        0.181869-0.0161962im     0.0758367-0.101712im    0.0386663-0.123421im    -0.068373-0.196398im       0.0398011-0.0207589im     0.0760132-0.0713563im     0.0510759-0.0772355im      0.185005-0.163149im      0.0143035-0.121785im     0.0856275+0.0113327im    0.0692945+0.0543426im      0.046561+0.0519714im     0.0562798-0.142723im     -0.118529+0.0903632im    -0.0685189+0.03579im     -0.00614066+0.0442641im       0.3191+0.125923im     -0.0443097+0.0157897im    -0.200261+0.286843im   -0.0801212-0.177874im      0.170103+0.0654963im   -0.0100741+0.104255im     -0.0347442-0.248674im     0.0165278+0.0306152im      0.136837-0.319274im     0.0523262-0.183427im     0.102265-0.153333im
  -0.031188+0.0348849im    -0.0172235-0.19353im      -0.0779397-0.339642im      0.0353489+0.0369544im       0.168848-0.0352243im     -0.0405651-0.152609im      0.0488247-0.204509im    0.0752396+0.057913im   -0.0168085-0.244817im        -0.13499-0.130297im     -0.0497726-0.10185im       0.0294429-0.00500296im   -0.0838352-0.00540999im    0.0847435-0.0281448im    0.0197703+0.182991im      -0.19894+0.00154268im    -0.216958+0.133024im     -0.0823214-0.151984im      0.180908-0.301763im     -0.0681533-0.0178845im     0.0288497+0.111024im     0.0205271-0.046643im       0.338467+0.117102im    -0.0157527-0.103453im   -0.0373991-0.0981162im    0.0428948+0.0333475im    0.0699243+0.275921im     -0.0601424+0.0485258im    -0.103753+0.111653im     -0.0414264-0.0249675im     0.062048+0.0934385im    -0.03725-0.107577im
  -0.110048+0.17866im       -0.108637+0.0415804im    0.00394998+0.0789044im       0.20226-0.230805im       0.0513425-0.174704im       0.0674916+0.068539im      0.0414316-0.184434im     0.144243+0.0208021im   0.0852786-0.112966im      -0.0943913-0.108601im     -0.0673502-0.0377783im     -0.188587+0.110261im      -0.135681+0.0562274im    -0.0687677-0.0647074im     0.119767+0.1146im        0.233061+0.18268im       -0.117444-0.0157813im    -0.0367381+0.0236181im    0.0128255+0.187781im       0.123847+0.140135im      0.0415458+0.134422im      0.181946-0.0695681im     -0.199857-0.118746im      0.156531-0.0657496im   -0.116569-0.165234im     -0.155564-0.0869632im    -0.211923+0.145815im       0.120757+0.127352im    -0.0857576+0.14313im        0.140077+0.0365881im   -0.0748695+0.0347738im    0.165532+0.151514im
   0.295177+0.188944im      -0.221481-0.235257im     -0.0924771-0.212036im      0.0142662+0.0753748im     -0.0801522-0.0283591im      0.0593987+0.168674im     -0.0739854+0.0514669im    0.107485+0.139035im   -0.0648949+0.0109329im      -0.225419-0.0190916im     -0.111502+0.0519837im     -0.189084+0.0978366im    -0.0912543-0.165898im      0.0304484+0.0353259im     0.174258-0.146989im     0.0433211-0.127216im        0.10482-0.270162im     -0.0981441-0.161832im      0.120572+0.0562164im    -0.0528936+0.0859051im     -0.132299+0.0553737im   -0.0882406-0.0405602im     -0.013073+0.0554951im    -0.159245+0.31354im     0.0693144+0.157407im      0.018415+0.157627im     -0.144215-0.100054im     -0.0396748+0.0388122im    0.0268535+0.028431im       0.033562+0.00415813im   -0.019146+0.0792834im  -0.0174416+0.0908842im
 -0.0332897-0.070853im     -0.0432076-0.0355734im     0.0767125+0.085459im     -0.0297195-0.0251615im       0.122503+0.0199177im    -0.00650956-0.110687im    -0.00745572+0.234101im       0.1559-0.0157918im  -0.0134037+0.146401im       0.0554174-0.252548im     -0.0228956+0.00979463im    -0.072967+0.10993im       -0.141784-0.0577137im    -0.0223183-0.300963im    -0.0100095+0.166873im      0.110315+0.0115533im    -0.0103198-0.0733103im      -0.12178+0.175385im    0.00936075-0.00795831im    -0.111318-0.0129322im    -0.0622334-0.0723225im   -0.0735234-0.0672554im     0.0340769+0.0147931im    -0.164716-0.305207im   -0.0744114+0.300309im      0.472618+0.0527277im    -0.126332+0.0302449im     0.0219909+0.042176im     0.0401203+0.1244im        0.0439119-0.0972783im    0.0713378-0.122763im      0.10536+0.0494999im
 -0.0886611-0.000802012im   -0.175548-0.15629im        0.187128-0.0879579im     0.0743758+0.00795824im     0.0826915-0.0396831im      -0.107006+0.131155im       0.129443+0.031943im    0.0347503-0.0328257im   -0.013474-0.0421967im       0.189358+0.193145im       0.169207+0.000160226im  -0.0798864-0.0575151im     -0.117041-0.104433im     -0.0282041+0.172768im     0.0709408+0.0501522im     0.121737-0.0242976im      0.196845-0.129706im       0.110131+0.0414528im    -0.165358+0.159231im       0.071128-0.0184132im        0.2026+0.215331im     -0.296934+0.0510815im      0.106559+0.132209im      0.168984-0.0383125im   0.0722076+0.0228617im     0.118755+0.0173724im     0.356528+0.203818im     -0.0217086-0.0566623im   -0.0762851+0.102082im       0.154863-0.0713229im     0.132118+0.0306265im   0.0508446+0.128213im
   0.103319+0.140084im     -0.0053629-0.00151906im    -0.132541+0.108662im       -0.14637+0.139391im       0.0766516+0.0970422im       0.126707+0.225915im     -0.0763783+0.200004im   -0.0571346+0.121716im   -0.0653567-0.0473471im       0.115339-0.0299649im      -0.14087-0.141813im     -0.0417715-0.0296039im      0.138669+0.266647im      -0.118894-0.141868im      0.152696+0.0979634im    -0.218539+0.0794791im     0.0621614-0.0530755im      0.322205+0.171294im       0.15828+0.127746im     -0.0382327+0.00011447im   0.00716716-0.170283im    -0.0174529-0.144432im       0.148498+0.096987im       0.20849+0.165206im   -0.0746414-0.0962064im    0.0766597-0.137625im    -0.0211485+0.159616im      0.0763401+0.150188im    0.00419699+0.120961im       0.115277-0.00909945im    0.104025+0.0147916im  -0.0872208-0.0504475im
  -0.145099+0.16234im       0.0421042+0.00293247im    0.0619066+0.0566779im     0.0129125+0.0588804im       -0.27427+0.154986im      -0.0198345+0.0598922im     0.0177532-0.0872744im    0.213022+0.0696341im   0.0998733-0.0577771im     0.00282913-0.0253133im     0.0493074-0.0795148im    -0.0460871-0.175292im     -0.0850291+0.000292878im  -0.0473896-0.317764im    -0.0419786-0.198428im     -0.245282-0.147494im       0.229287-0.128546im      0.0456217-0.082025im     0.0293926-0.131083im       0.140657+0.102516im     -0.0597903+0.108152im     -0.108943+0.159082im     -0.0939046-0.239585im      0.085109-0.118728im   -0.0920657-0.0608069im    0.0657979+0.115612im     0.0535184+0.219096im     -0.0357724+0.0211808im     0.231233+0.0267017im    -0.0485245+0.0878364im    -0.184605-0.0535991im    0.076097-0.1843im
  -0.270221-0.164392im     -0.0401556+0.0545531im    -0.0239808-0.00712017im   -0.0680181+0.0732608im     -0.0540245+0.000949052im    -0.125026-0.0457481im      0.132238+0.0551383im     -0.1405+0.0819705im   -0.259269-0.296357im      -0.0152017+0.151064im     -0.0599587-0.247425im     -0.0135639+0.0497703im    -0.0133138+0.119248im      -0.131395-0.0461566im   -0.0708945-0.0442871im        0.131-0.0394359im    -0.0241298+0.0505037im    -0.0656509-0.256232im     0.0583142-0.0985098im     0.0202062-0.27963im       -0.165844-0.106774im    -0.0792856+0.155814im      -0.119838-0.0407059im    0.0750729+0.133539im    0.0287427+0.248738im     0.0431886-0.0318442im   -0.0503211-0.0776939im     0.0810573+0.147011im    -0.0505195+0.180312im       0.265562+0.049112im     -0.100463+0.0574304im    0.102104+0.0643762im
  -0.152368-0.191664im       0.144786+0.0720673im     0.0129045-0.0638281im      0.155182-0.205609im       0.0600558-0.0185398im      -0.103213+0.14961im       -0.272204+0.0153732im  -0.0147751+0.0698543im  -0.0226196+0.0772284im       0.114554+0.0297004im      0.014838+0.0804723im     -0.231254+0.00160548im    -0.118556-0.017601im     -0.0672014-0.164644im      0.327038+0.080548im    -0.0389237-0.0316979im     -0.165814-0.00699248im     0.154033-0.0758536im    0.0838099-0.287534im     -0.0749054+0.00402879im    -0.124095+0.0567819im   -0.0802965+0.0744756im     -0.262106+0.174218im     0.0416349+0.133242im   -0.0109433-0.011422im    -0.0846932+0.0315487im     0.109097-0.0361392im    -0.0687016+0.0374278im  -0.00290462-0.226395im     -0.0328958-0.0865524im     0.230996-0.188443im    0.0599494-0.05213im
 -0.0115185-0.0466845im    -0.0122129+0.231169im      0.0487286+0.152065im       0.020504+0.154078im        0.091643+0.183533im        0.114958+0.258154im       0.188206-0.177439im    0.0514186+0.0987767im  0.00837333-0.101473im      -0.0426807+0.0728971im     0.0605949+0.0855475im      -0.12047+0.00958025im      0.22416-0.0238182im    -0.0951491-0.0386647im     0.225974-0.0359076im   -0.0484023-0.133072im     -0.0982782-0.0310871im     -0.106819+0.139707im    -0.0160538-0.124349im      0.0212824-0.12557im       0.0575922-0.0171644im     0.151831-0.278224im      0.0684626-0.00941559im   -0.159599-0.109999im     0.199285+0.0330303im  -0.00783053+0.187171im      0.174638-0.047642im      -0.222573+0.0802699im    -0.167105+0.0788331im    -0.0341497+0.12007im      -0.142109-0.0901535im    0.168931+0.158684im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.055257124800523735 - 0.0029638017785957303im
   -0.01797856520961637 - 0.03810104207772678im
   -0.03569510075131258 + 0.08966574481416717im
    0.10819003372921553 - 0.042540116718883664im
     0.0524468762541298 + 0.2975456096996731im
   -0.09405675551140086 - 0.05708296189997543im
    0.14587351743435586 + 0.10229924179378544im
   0.014200638721799183 - 0.03366661024725301im
    -0.1039625153386334 - 0.12964801537759676im
    -0.0551000229425541 + 0.07392733454596673im
    0.04400617640635572 + 0.15324476242049886im
   0.011638115264056198 - 0.07142732334400172im
    -0.0597332815588674 + 0.01205734323312292im
  -0.014089622108500632 + 0.04984287414080989im
    0.22272365052581364 - 0.1713634166010783im
    0.14220370238167612 + 0.08616368906414942im
    0.07468658605257986 + 0.02200969952482518im
     0.2494513513775027 - 0.18760096348869568im
    0.18729489660259444 + 0.054447383634332526im
  -0.018037727297147404 - 0.06466061964365408im
    0.06422255758244291 + 0.035910802074828094im
    0.11316760186620156 - 0.13543252960624114im
 -0.0024923168447256736 + 0.019606189648201964im
  -0.025401549588293708 + 0.21631981196278438im
    0.13297381757020416 - 0.035532058180768954im
    -0.2832080883389611 + 0.07059545139349016im
    -0.2372182139519823 - 0.04776819183686443im
   -0.06167654093239848 + 0.004201186247043823im
    0.34773936536213923 + 0.0im
   -0.12818380019153622 - 0.09747656374925553im
     0.2259291886625947 + 0.18951041583809053im
    0.15744580946323516 - 0.023158210244362765im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 10 June 2022 03:13">Friday 10 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.291148-0.0028503im   -0.0810689+0.063254im     -0.0531469+0.00230939im  -0.0899477-0.0621302im      0.14813-0.149044im        0.168915+0.0385677im     -0.22277-0.228315im      0.0422807+0.020964im       -0.257437-0.215167im     0.163594-0.080581im       0.130691+0.0972017im    -0.0495389+0.0978058im     -0.116702-0.108681im      0.236029+0.0013568im    -0.00556257+0.0955268im     0.109602+0.207684im      -0.174096-0.0182845im    0.0885125-0.0061084im     -0.14189-0.101914im     0.042825-0.0703805im   0.0242131+0.0446277im    0.0398328-0.156175im      0.204272+0.094632im    -0.0319059+0.192832im       0.055867-0.18147im        0.0437852+0.037694im        0.127662+0.0146493im     0.0239355+0.0818819im  -0.0089428+0.143545im      0.116713-0.0103468im      0.141369+0.158083im     -0.0909202+0.194412im
  -0.079309-0.00159861im  0.00955065+0.262294im     -0.0129408-0.146043im     0.0838178+0.0728476im      0.10367+0.0470528im       0.221151-0.212096im     0.0431427+0.0676065im      0.117781+0.288862im       0.0355946+0.0662843im    0.115387-0.167688im     0.00561088-0.165272im      0.0596676-0.0770814im      0.216823+0.0685802im    0.0285948+0.0275203im      0.0523031+0.102818im    0.00620794+0.0435239im     -0.126678-0.0784726im     0.240389-0.108211im    -0.0309657+0.0273268im  0.00590191-0.0748176im   -0.093302-0.229352im     0.0134959+0.298631im    -0.0996725+0.180945im       0.15227-0.227608im     -0.0288618+0.0118391im      -0.114525-0.0386323im    -0.00134071+0.013581im     -0.0268223-0.0821649im   0.0552687+0.23115im      -0.015853-0.0542479im     0.0462417+0.220394im      -0.159603+0.0379212im
 -0.0578361+0.121848im    -0.0689587-0.0999345im     -0.279014-0.0130758im      0.17473-0.0388207im   -0.0623345+0.0903089im        0.03934-0.148797im     -0.200123+0.0284503im     0.0814963-0.0149029im     -0.0941067+0.111885im    0.0542929-0.149248im    -0.00142975-0.0673905im    -0.0560752+0.00840325im    0.0683458-0.0888579im   -0.0714059+0.00222012im     0.0450625+0.240255im     -0.172025-0.0836066im     0.0656052+0.11239im       0.111075-0.0280944im    -0.110279+0.0937154im    -0.21349+0.128259im    0.0617659+0.120868im    -0.0134232-0.116639im    -0.0210599+0.0247532im   -0.0623059+0.274281im       0.114259+0.238868im       -0.321029-0.0647837im       0.195034+0.127313im      0.0737953+0.0351741im   -0.160951+0.175258im     0.0312741+0.118981im     -0.0391775-0.183201im     -0.0729423-0.171201im
  -0.173937-0.0174983im   -0.0359189+0.0987019im      0.107494+0.0353465im    -0.101075+0.0533115im     0.115623-0.135945im      -0.0603925+0.0039954im    -0.108294-0.15573im      -0.0314579-0.127739im      -0.0131263+0.0399052im   -0.151955+0.0333432im     -0.225814+0.079436im     0.00863132-0.0311449im    -0.0565891-0.0389555im     0.169051-0.0513361im      -0.168368-0.0198575im   -0.0682391-0.029785im        0.20024+0.00716216im   -0.110176-0.023322im      0.105529+0.0543056im     0.12109-0.336682im   -0.0389641-0.107095im     -0.144717+0.0917625im     0.277069+0.0693224im    0.0563829+0.178817im        0.10377+0.352979im       -0.146929-0.0902493im     -0.0451588-0.00192405im  -0.00393473-0.194881im     0.021817+0.127428im     0.0752936-0.0987583im      0.130507+0.196624im      0.0128527-0.205124im
 0.00268802+0.101778im    -0.0292618-0.0626358im     0.0835702+0.135286im     0.0755967+0.0712699im    -0.110209+0.278823im       0.0325247-0.154976im        0.1151-0.231797im      -0.028119+0.0335316im     -0.0647929+0.172331im    0.0943121-0.0417946im     -0.055807-0.15962im       -0.168479-0.0651498im      0.043323-0.0160426im    -0.186144-0.00229365im   -0.00676434+0.0818148im     0.132691+0.158686im      -0.126251-0.151094im     -0.360746+0.0677433im    -0.118775+0.116742im     0.209427+0.0507905im  0.00624643-0.0817086im    0.0973099+0.122854im      0.112257-0.208402im    -0.0627432+0.0886252im     0.0919878-0.000555543im     0.244606-0.0585523im      0.0923295+0.0800988im      0.197984+0.0111041im   0.0112753+0.10065im      0.0139855-0.189037im       0.183982-0.0542589im    -0.0849707-0.0994152im
 -0.0638804+0.129296im      0.033494+0.135263im      0.0951153+0.111818im     -0.106715+0.241465im     0.0601252-0.024978im       -0.194726+0.00640859im   0.0529618-0.00116101im    0.0391881-0.31014im       -0.0297234-0.0971446im    0.170115-0.280986im      -0.100772-0.0148851im     0.0303017+0.0215247im    -0.0383424+0.0224315im   0.00260409-0.0135653im     -0.0527009+0.106555im    -0.0563346-0.119548im     -0.0995662-0.0252742im     0.140712+0.0568565im     0.189032+0.0670777im   -0.177739+0.15917im      0.118502-0.0519771im   -0.0489227+0.0214998im     0.199539+0.0323158im     0.154274-0.115247im     -0.0263428+0.00827461im      0.084236-0.124643im        0.089465+0.320688im       0.195787+0.0946677im  -0.0548686-0.270117im     0.0209236-0.125757im      -0.115648+0.0566845im     -0.159347+0.134376im
   0.088924+0.130125im     0.0340299+0.201304im     0.00753956-0.177315im     0.0439511-0.132116im     -0.113531+0.0936133im        0.12099-0.0228215im    0.0354068-0.114351im      0.0547048-0.124536im    -0.000918802+0.130627im    0.0802658+0.11942im      0.00506174+0.0856447im     -0.228568+0.0641434im     -0.174815+0.246485im    -0.0945216+0.241104im       0.0365867-0.0533074im   -0.0322932+0.197181im       0.197951+0.161187im      0.241053+0.085407im    -0.0142898+0.198652im   -0.0612313+0.0856388im   -0.122054+0.177839im     0.0843298+0.0637081im     0.148088-0.119254im     0.0862074+0.00285394im    -0.120853+0.27697im        0.0302086+0.075633im       -0.161104-0.109135im      0.0501856+0.104559im   -0.0184328-0.00375244im  -0.0419497-0.114898im     -0.0210479+0.138991im      0.0932524+0.182587im
  -0.234336+0.140365im    0.00279772-0.091153im        0.18606-0.240189im     -0.151704+0.128442im     -0.145951-0.274871im       -0.127948-0.232607im      0.116573-0.0519388im     -0.100598-0.0512984im      -0.142916-0.100664im    0.0591443+0.0256465im     0.0162115+0.13374im       -0.271127+0.0528845im      0.110056-0.100369im    0.00484016+0.0228749im      -0.077884-0.0760903im     0.238002+0.105176im      -0.144259+0.0892829im     0.169809-0.118664im    -0.0803029+0.0531195im   0.0841563+0.178991im    0.0795111+0.121715im    -0.0229303-0.0258918im    -0.213067+0.0419944im    0.0906633+0.0740281im     0.0238692+0.0286852im     0.00877163+0.0508im           0.16277-0.114177im     -0.0748619-0.190154im     0.109686+0.00140494im   0.0393959-0.0815366im     -0.114555-0.00935317im  -0.00839792-0.187806im
  -0.182577-0.0239492im    -0.206531+0.140897im      -0.116368+0.00228169im    0.205639-0.00762079im    0.165089+0.0586278im     -0.0433298+0.0373598im    0.0755032+0.169251im       0.060873-0.255067im        -0.10426+0.218673im     0.173717+0.174669im     -0.0204184+0.047775im     -0.0417128+0.00239139im   -0.0299993+0.071146im      0.255907-0.178439im       -0.073074+0.126435im    -0.0123918-0.0387647im   -0.00215941-0.0499298im   -0.0232311-0.038223im     -0.024273-0.143114im     0.104793-0.048637im     0.220022+0.0675249im      0.19374+0.0714543im    -0.198656-0.154466im     -0.246634+0.117324im      -0.192792+0.0071237im     -0.0241288+0.172123im       0.0770266+0.0324924im    0.00525678-0.155682im      0.12542-0.060435im     -0.116957-0.0751259im    -0.0225307+0.141213im     -0.0895231+0.149102im
   0.064336+0.0990634im    -0.123381+0.0456891im     -0.169827-0.100648im      0.111088+0.0605061im    0.0492883-0.118858im       -0.076414-0.234332im    -0.0234127+0.224996im     -0.0035983+0.0754642im       0.112676+0.139071im    -0.143015+0.302581im      0.0405595-0.0371237im   -0.00962345+0.0670704im      0.134856-0.117187im    -0.0768129-0.0857414im     -0.0958369-0.0724491im    -0.133615+0.235382im     -0.0107127+0.00888888im   0.0702948+0.131771im      0.145576-0.111882im    0.0688309+0.103956im    0.0878201-0.0546431im     0.023065-0.19344im       0.186721+0.181993im      0.053429+0.0769708im    0.00139969-0.130975im        0.109474-0.254438im      -0.0669478+0.168282im     -0.0421286-0.0530221im   -0.103345+0.0497154im   -0.0374596-0.331601im      0.0308794-0.0393976im      0.178333+0.0883137im
  0.0536421-0.227125im    -0.0172678-0.253886im     -0.0901167+0.139837im      0.247539-0.1158im       -0.149452-0.0413993im       0.123598-0.147638im    0.00592852-0.000860681im   -0.104779-0.0866379im      0.0503108+0.157537im    0.0317454+0.00594007im   -0.0190695+0.279099im       0.174219+0.0489306im     0.0948096-0.219688im     -0.020217+0.0917626im     -0.0444094+0.0611233im    -0.033284+0.108606im      -0.216644-0.0804283im    0.0872798+0.0989662im     0.149066+0.123061im   -0.0438738+0.0604087im  0.00352638+0.0836207im   -0.0550004+0.0565084im    0.0820896-0.066596im     0.0930745-0.0426076im     -0.179097+0.0997706im       0.112314-0.122994im     -0.00491523-0.0592168im     -0.108286-0.0949238im   0.0914917-0.184201im       0.14982+0.21835im        0.108092+0.283611im      -0.145362-0.0796498im
   0.120264-0.0591623im   -0.0397735-0.180422im       0.236247+0.00403847im  -0.0824686-0.165951im       0.14256-0.0910114im      -0.016284-0.0382494im     0.153072+0.243476im      0.0982633+0.167439im       -0.272299+0.0205092im    0.073657+0.0671312im      0.182541-0.0335629im     -0.200351+0.139432im      0.0501493+0.0366605im    -0.079515+0.101574im        0.141801+0.264719im   -0.00456991-0.178592im       0.132346-0.220176im     -0.136784+0.10701im      0.0386534+0.0280446im   0.0758961-0.0210474im   0.0466482+0.106319im     0.0433725+0.0925228im     0.171986+0.201332im     0.0215166-0.0946038im     0.0623226+0.169017im       -0.139454-0.0765705im       0.162551-0.0261766im    -0.0297914-0.0725212im   0.0154531-0.224207im    -0.0847416+0.00666643im    0.0624536+0.0355002im      0.136303+0.0727547im
   0.154582-0.147093im     -0.267732+0.00544837im     -0.12253-0.312197im     0.0467197+0.0163265im   -0.0473871-0.150309im       -0.011695-0.0761462im    0.0963968+0.123314im     -0.0155517+0.0266594im       0.233487-0.215097im    0.0531668-0.322888im      -0.165591+0.157947im      0.0115583-0.117203im      0.0638657+0.154431im    -0.0875692+0.119935im       -0.122294-0.0171706im    -0.011329-0.149995im      0.0318158-0.0213247im    -0.252483+0.0746477im   -0.0506929-0.0989104im    0.148477+0.1721im     9.39725e-6+0.0662793im   -0.0339316+0.0225292im    0.0146905-0.0335727im     0.136169+0.209238im     -0.0857353-0.0181462im      -0.145152+0.169014im      -0.0882769+0.0252902im     0.0746793+0.0440645im   0.0130031-0.0463788im   -0.0353108-0.0799306im      0.244572+0.0166435im    -0.0155745+0.0395432im
   -0.12594-0.0976233im    0.0987442+0.0875355im     -0.223177-0.0107337im   -0.0063846+0.11115im      0.0114265-0.0790085im     -0.0466722+0.0659816im     0.102086+0.0448721im    -0.0856982-0.0118019im      0.0172023-0.155281im    -0.167616+0.0463028im    -0.0188802-0.319062im     -0.0673862-0.110816im      -0.132188+0.0842905im     -0.10228+0.0621686im      0.0850597+0.159307im     0.0994802+0.0133909im      0.100518-0.291674im     0.0742452-0.0994145im     0.135158+0.154682im    0.0555047-0.094083im    -0.125517+0.187239im      0.207797-0.225166im    -0.0799581-0.0987im       0.0811269+0.168153im     -0.0894242-0.136354im      -0.0530026-0.19604im        0.0829532-0.171999im     -0.0787584+0.0334769im   -0.145439-0.0955292im     0.161317-0.062659im      0.0651837+0.186001im      -0.183673-0.0449877im
  -0.158701-0.120311im    -0.0241371+0.231051im       0.217706+0.120181im       0.23394+0.15159im     -0.0273607+0.0538611im      0.0118686+0.0132013im    0.0379161+0.10226im      -0.0181758+0.0616578im      -0.060959-0.108746im    0.0900889-0.0331257im    -0.0869177-0.100097im       0.148851+0.270967im      0.0377406+0.119071im    -0.0158292+0.068379im       -0.224662-0.0456408im   -0.0960415+0.054752im     -0.0643554+0.16042im       -0.19885-0.00770559im   -0.157617-0.0377274im   0.0914803+0.0979764im  -0.0256798+0.21752im       0.207171-0.182087im     0.0810114-0.0542385im      0.11824-0.0715692im      0.237311+0.0813341im     -0.0427218-0.13374im        0.0112472+0.0176149im     -0.251949+0.0186316im   0.0979332+0.0926648im     0.173402+0.175834im     -0.0942662+0.0134581im     0.0726949+0.12972im
  0.0886724+0.00268341im   -0.179575+0.0553028im      0.184719+0.0833172im    0.0729414-0.114153im     -0.151963-0.0891865im      0.0522904+0.173163im    -0.0546186-0.312545im       0.223724+0.116433im     -0.00351704-0.0503662im   0.0339433-0.0278985im     0.0295381-0.0715351im     0.0418647-0.100411im       0.238851-0.012919im    -0.0108534+0.0678233im     -0.0348022+0.131657im      -0.14571-0.115074im       0.150731-0.0109141im    0.0580246-0.235364im      0.325639-0.0286246im   -0.122239+0.083621im    0.0919491-0.0477321im     0.146028+0.0136204im  -0.00829411-0.140424im      0.100544+0.167525im      -0.170261-0.0603359im       0.141368-0.000289436im     0.101596+0.00365381im    -0.210755-0.076607im     0.194585+0.0369038im     0.055676-0.166471im      -0.044945-0.118952im       0.172589-0.0477406im
  0.0352714+0.0404911im   0.00727542-0.0824625im    -0.0417828-0.050321im      -0.18356+0.0393649im   -0.0628406-0.0160298im   -0.000973118+0.21399im      0.0479173+0.168809im      0.0563889+0.168762im       0.0338508-0.0430024im    0.156025-0.130396im       -0.16954-0.0950563im    -0.0963595+0.142258im       -0.07178-0.267622im    -0.0851232-0.329617im       -0.048849+0.164136im     -0.101034+0.0794441im      0.065962+0.140258im     0.0803015+0.197746im      0.266949-0.0928692im    0.103712-0.0271745im  -0.0373117+0.169746im     0.0842833-0.0730944im    -0.126615-0.0943714im    0.0225319-0.188403im       -0.06941+0.156899im        0.134595+0.0789979im     -0.0349418-0.077355im       0.230289-0.0176433im   0.0845832+0.247877im      0.130301+0.040273im       0.113657+0.0717123im     0.0504615-0.0379326im
 -0.0543125+0.283651im    0.00667286+0.086789im      -0.050632-0.0483617im     0.117886-0.112936im      0.110076-0.203705im        0.101564-0.0407958im   -0.0135877+0.0820376im    -0.0625099+0.0607601im      0.0852726+0.0827296im    0.121881-0.131003im      0.0200102+0.0393497im    -0.0560903-0.0320191im    -0.0760974-0.186242im      0.116923+0.0898593im       0.231258-0.0947075im  -0.00685176-0.252981im       0.106585-0.147628im    -0.0607995-0.107911im     -0.153564-0.0890963im    0.150709-0.0790212im   -0.102957+0.267592im     -0.188241+0.0293642im     0.116314-0.238606im     0.0290663-0.115893im      -0.100751-0.00944989im      0.251166-0.11722im       -0.0812836+0.17046im       -0.103475-0.126244im   -0.0946947+0.0830966im     0.191752-0.00817779im    -0.160482-0.123802im     -0.0295923+0.0115175im
  0.0165679+0.281564im     -0.256989+0.0633681im     0.0237192+0.0364052im   -0.0642029+0.0676605im    -0.256415-0.0769907im      0.0632072-0.0287242im     -0.10317-0.00951259im    -0.117328-0.0776823im       0.195167-0.148483im   -0.0662374+0.0706319im     0.0529834-0.0604875im     0.0536101-0.100313im       0.137289+0.197838im      0.133417-0.076212im        0.294894+0.226475im     0.0348809+0.160324im     -0.0990765+0.0575144im     -0.10567+0.00803538im   0.0118928+0.0650877im   0.0920881-0.102162im    0.0818023+0.120614im     0.0681949+0.0101224im     0.137003+0.0721423im   -0.0829752-0.0897424im    -0.0786236-0.0547167im      -0.162527-0.167382im       -0.140743-0.0290669im      0.229935-0.0840533im      0.2268-0.0664838im   -0.0108939+0.252417im      -0.107672-0.0103779im     0.0898229-0.0295056im
  -0.104398+0.116838im     -0.112592+0.0340757im     0.0694874-0.0118631im    0.0913357-0.0356354im   0.00486627+0.0107958im     -0.0630397+0.0221227im     -0.25193-0.020469im      -0.079109+0.139529im        0.115563+0.018096im    -0.173264+0.0466761im     -0.109943-0.247797im      -0.121096-0.0297507im     0.0197487+0.0064013im   -0.0898328+0.0304043im      -0.135755-0.222277im    -0.0183312-0.140936im      0.0355255-0.178429im      0.324255+0.0623745im    -0.163868-0.128161im    0.0603855+0.0152624im     0.23986+0.0600727im    -0.084484-0.0113558im     0.143299-0.00763799im  -0.0449315-0.0629859im    -0.0149766+0.0583658im       0.124869+0.0882336im       0.257066-0.0434859im     0.0647892+0.213491im      0.24007-0.132514im    -0.0486632+0.216302im       0.247386+0.0756117im    -0.0093839+0.00660748im
  -0.153286-0.148447im       0.05688+0.114644im       -0.27905+0.0539879im    -0.174788+0.0384594im     0.136567-0.163639im       0.0635767+0.219785im    -0.0989073-0.222131im       0.116763+0.266277im        0.146755+0.132137im    0.0557451+0.153865im     -0.0730317+0.0741886im    -0.0257654-0.0393861im      0.105299-0.0620512im    -0.104494+0.000888514im     0.114765-0.0215231im    0.0518405+0.0400154im     0.0498605+0.257903im     -0.210104+0.00154624im   -0.144934-0.0105292im   -0.100453+0.17482im       0.19239+0.184587im    -0.0167191+0.168123im    0.00271401-0.0348722im     0.078042-0.0752305im      0.142067-0.0493367im     -0.0326881-0.109899im         0.13665-0.0317933im       0.11064-0.0995523im  -0.0503182-0.234078im    -0.0182194-0.0759588im    -0.0361805+0.170404im     -0.0297722+0.0380227im
   0.143865-0.14515im      0.0151344-0.0214039im     0.0673742-0.106514im      0.052735+0.153247im     -0.110281+0.0967575im      0.0972315+0.0828578im    0.0377126-0.0141466im     -0.158022-0.301256im        0.213639-0.0371389im  0.00206751+0.134667im      -0.103288-0.286784im     -0.0270277-0.0666921im   -0.00132813-0.361849im      0.119219+0.157584im      -0.0214317+0.207382im     0.0835198-0.0503653im     0.0206633-0.0155351im   0.00449325+0.0374645im    -0.154673+0.0688809im     -0.1552-0.0704363im   0.0912006+0.140058im     -0.122271+0.211699im      -0.11928+0.172061im     0.0620318-0.00136551im     0.107576-0.00195675im     0.0172554+0.0713419im      0.0438823+0.0189318im    -0.0738555-0.0836891im  -0.0250282+0.065219im     0.0880698-0.0893661im     0.0746565-0.0623675im      0.236822+0.246826im
  0.0783151+0.0959065im   -0.0259137-0.0088053im   -0.00387052+0.141412im      0.141491+0.187929im     0.0287588+0.0403949im      -0.266736+0.236938im    -0.0894804+0.129459im       0.104727-0.02139im        -0.147122+0.0853802im    0.127594-0.0383767im     0.0487684+0.177851im       0.140256-0.232853im      0.0659898-0.0450634im    0.0322552+0.0447553im       0.179028-0.188537im   -0.00909323-0.00309597im    -0.119004-0.0951058im     0.157419+0.0210976im    -0.115738-0.0145436im    0.113254-0.0334074im    -0.14586+0.158587im      0.174259+0.188931im     -0.154601+0.118082im      0.163093+0.160642im       0.118105+0.0454843im    -0.00407756-0.111056im      -0.0667481-0.0771595im      0.113681+0.1749im      0.0314008-0.0255846im    0.0816816-0.108332im      0.0979575+0.0686466im      0.297608-0.164282im
   0.217241-0.0418787im     0.140042+0.146383im    -0.00266289+0.0381566im     0.130693+0.203598im      0.303375-0.185603im       -0.141861-0.069476im     -0.103221-0.123023im     -0.0544462-0.020151im        0.107258+0.0361961im  -0.0209471+0.0134155im      0.171037-0.00596462im    0.0390482-0.0433996im   -0.00945871+0.0656935im   -0.0986818+0.0112974im      -0.104256+0.150898im      0.108595+0.0624611im    -0.0726643-0.102551im    -0.0832445+0.112534im     0.0293844-0.0878498im  -0.0266685+0.0974831im    0.219557+0.0518556im    0.0502206+0.0820516im      0.05911+0.0511979im    -0.116206-0.171705im      -0.218674+0.250049im      -0.0441613+0.136739im      -0.0710686-0.271647im     -0.0435423+0.108389im   -0.0345917+0.100351im      0.219093-0.05625im        -0.12189-0.240048im     -0.0546166-0.186749im
 0.00708837+0.0591766im   -0.0500537-0.15286im      -0.0355816+0.0512525im     0.085333+0.105853im      0.128747+0.0494233im      -0.244734+0.00665174im  -0.0739059-0.0743991im     0.0593514+0.104368im       0.0499789-0.0573403im   0.0754949-0.0942691im      0.140112-0.196842im      -0.149327-0.0243234im     -0.145377+0.093256im      0.183785+0.0996685im    -0.00352954+0.106787im     -0.293066+0.148936im     -0.0445635+0.0115108im   -0.0478723+0.0354441im    -0.228387+0.0427326im   -0.174804+0.102487im    -0.113741-0.108574im     -0.201193-0.236414im    -0.0913164-0.102701im     0.0259533-0.151384im     -0.0479307-0.00833591im     0.0151588+0.0922475im      -0.154683-0.00982889im   -0.0745007-0.321922im     0.102147-0.158564im     0.0181555-0.0898241im      0.157845+0.179284im       0.140362-0.140807im
 -0.0857311+0.161666im    -0.0959005-0.255943im     -0.0964656-0.208144im     0.0704034-0.0279499im     0.169167-0.0552837im      0.0544504+0.137252im     0.0409098+0.0933247im     0.0677354-0.13121im       -0.0284959-0.204343im   -0.0745416+0.1514im           0.1016-0.0913855im      0.262732+0.153821im     -0.0118809+0.0252276im  -0.00897938+0.131808im        0.160086-0.150745im      0.145093+0.0988573im     0.0326585+0.102526im     -0.172476-0.0212878im   -0.0718637+0.0518665im   -0.147324-0.0892377im   0.0975128-0.229716im      0.185976+0.0034589im   -0.0267065-0.0907643im     0.268562-0.0937005im     -0.159057+0.226757im       0.0956549+0.0279113im        0.22496+0.148793im      0.0722556+0.0482441im   0.0457865+0.100388im     0.0958152-0.0175935im     0.0979575+0.00146719im   -0.0347739-0.0501424im
     0.1448+0.0218278im   -0.0617852-0.144022im       0.115864-0.0751523im    0.0388068+0.0799407im     0.103702-0.098328im      -0.0655859-0.129494im     0.0381963-0.160717im       0.105759+0.160988im       -0.158947+0.0288416im  -0.0735935+0.0373586im      -0.16604-0.0702423im       0.14906-0.301164im      -0.167806-0.145643im    0.00352651-0.201553im      -0.0502641+0.0186727im     0.038489+0.141981im       0.104574-0.107349im     0.0643533-0.0825853im   -0.0900981+0.118259im    0.0783859+0.049743im     0.203474+0.0274645im     0.138797-0.0327958im   -0.0612557-0.127102im      0.258271+0.00563329im    0.0424874+0.131948im      -0.0243977+0.011791im       -0.267019+0.105905im     -0.0248034-0.0672142im   -0.140619-0.0716497im    -0.220382+0.272142im     -0.0978839-0.0512588im    -0.0418546+0.214279im
 -0.0423659-0.0305124im    0.0343284+0.281977im       0.186996-0.0608112im   -0.0937264+0.141918im     -0.155784-0.0355853im     -0.0510922+0.124986im    -0.0269634+0.105063im     -0.0547408+0.311026im        0.068914+0.155129im   -0.0573375+0.0543289im     0.0410617+0.172743im        0.21799+0.0120771im     -0.162088-0.171161im      0.129942+0.232434im       0.0616848+0.0148527im        0.034+0.0466896im    -0.0268645-0.187384im     -0.111067-0.0357661im    0.0321853+0.256058im    -0.100817+0.136963im   -0.0419575+0.0313029im    0.0266762-0.227634im    -0.0633641+0.126493im     -0.213497+0.0766465im     -0.150923+0.142715im       0.0353512+0.1239im          0.111086+0.213688im       0.132132-0.0394619im   0.0429225+0.0717457im      -0.1277+0.00164203im    0.0976432-0.0235337im    -0.0611763+0.00564933im
  0.0153022-0.206698im     -0.134884-0.107844im        0.11905-0.0480695im      0.04619+0.191504im      0.013958+0.146788im        -0.14979+0.0188im        0.107874+0.0470379im     0.0681599+0.00375117im       0.16561-0.0781239im   0.0774456-0.0221134im     0.0028866+0.275098im      -0.159516-0.0983851im      0.279315+0.0260615im     0.137788-0.174389im        0.171836-0.0237434im   -0.0328744+0.0401156im      0.252798-0.0312215im    0.0324356-0.0825452im    -0.182603+0.129187im    -0.158049-0.10678im     0.0794486-0.00790918im  -0.0738087-0.20691im       0.115737-0.024204im    -0.0614075-0.102818im     -0.0106314+0.0644434im       0.172142-0.197832im        0.105588-0.234898im     -0.0402877+0.156125im   -0.0581613+0.187266im    -0.0610263-0.0424562im   -0.00558867+0.00211068im     -0.17705+0.119761im
 -0.0923965+0.0195882im   -0.0984838+0.108964im      0.0719369+0.00282651im    0.240398-0.170072im     -0.111715-0.0640378im      -0.165465-0.175042im    -0.0870909+0.0874415im     0.0897799+0.0559151im     -0.0661112-0.118375im     0.024886-0.163345im      -0.015092-0.0829043im     0.0747534-0.00977536im   -0.0662363+0.0176599im   -0.0369496+0.0911922im      -0.071501-0.039075im      0.128908+0.180016im      0.0587087-0.00521578im   -0.167504-0.00911243im    0.155767-0.153033im    -0.339742-0.22495im     0.0552275+0.165756im     -0.060436+0.105371im    -0.0370061+0.102277im     -0.044914+0.0208679im     0.0883383-0.0611956im       0.273863+0.0731453im      0.0574798-0.199802im       0.204569-0.0953843im   -0.296847+0.00248884im   -0.160779+0.0625088im     -0.100084+0.142818im      0.0750111-0.0565622im
   0.122043+0.111286im     -0.141865+0.154091im      0.0612576+0.093351im    -0.0560041+0.130809im      0.217063+0.00663958im      0.158072-0.123311im     0.0812439+0.105888im      0.0828957-0.0782268im    -0.00276857-0.139698im    -0.193068+0.163688im      0.0799984+0.0573664im     0.0108282-0.0695245im   -0.00783878-0.0803372im    -0.134427+0.0395038im      0.0596882+0.1805im      0.00257432-0.301187im       -0.22321+0.228457im    0.00110401-0.0634102im    0.0620285+0.123453im   -0.0141184+0.0494314im   0.0550883+0.0766961im    -0.107483-0.0784164im   -0.0478881-0.206465im    -0.0507805+0.00267846im     0.158534+0.0270377im       0.182812+0.0678944im     -0.0694956-0.0238551im     -0.102017+0.155639im   -0.0622444+0.119682im     -0.245834+0.0327956im     0.0892561+0.287848im      0.0772032-0.210777im
  0.0380097-0.0838917im    0.0249012+0.0676178im      0.153611-0.0818963im    0.0940199-0.211966im     -0.099171+0.055184im         -0.1029-0.105565im     -0.107019-0.23324im        0.136179-0.135234im        0.103134-0.163809im    0.0268819+0.25967im       0.0485429+0.0251008im      0.269811+0.170814im     -0.0310981+0.0698566im    -0.134251-0.345405im       0.0751846+0.0109334im    -0.100537-0.245149im     -0.0199391-0.143249im     0.0722141-0.0259519im    -0.178399+0.0594062im    0.106987+0.133881im    -0.134713+0.168883im    0.00588341-0.0487116im   -0.0353694+0.125359im     0.0754435-0.121863im    -0.00547649-0.0262133im     -0.0116276+0.0742504im      0.0522426+0.00719617im     0.200134-0.200197im    -0.134839+0.0479153im    0.0395906-0.157249im      0.0739495+0.0520437im    -0.0899253-0.0691796im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.04612780454088315 - 0.02634421112325718im
   0.08447860778292916 - 0.018964956707315923im
  -0.14545946665097284 + 0.12200799651597258im
   0.08445667642324763 + 0.23283876594213504im
   0.02278916520879196 - 0.08342405457445413im
  -0.14144673114768547 - 0.01813533562796653im
 0.0017933720608594057 - 0.20368906737236786im
  -0.20413105622686734 - 0.029584368186399163im
  -0.06843414266832894 + 0.10338240820905464im
  -0.09456758206516618 + 0.13188269052158508im
  0.019918119594091947 + 0.06649652027203463im
    0.2877934141721689 + 0.004794540646366719im
 -0.025697460460513022 + 0.13718090459565452im
    0.2290209921939668 + 0.152273023698189im
  -0.23523456891710529 + 0.05850046046358414im
   -0.0834547787180503 - 0.06259981805184457im
   0.26567772437300674 - 0.04473493588257825im
  -0.24625538989370696 - 0.020038622197477873im
 -0.013527349932072986 - 0.15753483833721382im
   0.07083236839769257 - 0.059072619651988234im
    0.0385900593051258 + 0.014687156431360399im
  -0.09021017411105915 - 0.011491943603887918im
 -0.016320669047244163 - 0.07852392576386144im
   0.14279652571056112 - 0.18854266554806676im
  -0.10183348003070547 + 0.01331684123217544im
  -0.09334655243374557 + 0.18250510872724443im
    0.3131588569632119 + 0.0im
  -0.09795937949627441 + 0.09792590077173718im
 -0.030391063440136475 + 0.006891187025650419im
  -0.11497453233851289 + 0.1250591215768415im
 0.0008067747321539315 - 0.17777272465514873im
  -0.11418617215276616 + 0.05029020926227669im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 15 December 2022 05:49">Thursday 15 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0773846+0.0322451im  -0.0271723+0.0287687im    -0.0666162+0.115053im      0.102778+0.0626304im    -0.0186031-0.0444486im   0.0424974-0.0903055im    0.0774969+0.109899im    -0.0758153-0.0182543im    0.0532324-0.160517im       0.0853519-0.0813147im     0.0319244-0.0901925im     -0.131203+0.157088im       0.0290841-0.0174507im      0.0547825+0.034742im        0.164195+0.170984im      -0.288672-0.0758461im     -0.140972-0.149488im      0.0525104+0.123133im      0.115034+0.0672446im     -0.258416+0.0906709im     -0.190744+0.228091im          0.1606-0.0389581im   -0.0958918-0.359073im       -0.15247+0.019942im     -0.0705739-0.223077im       -0.05489-0.206467im       0.0351157-0.0372463im   0.0340772+0.2338im      0.00835951+0.0969556im    -0.155014+0.0185022im     0.0616441+0.0341157im     0.0395715-0.221429im
    0.143408+0.0627994im    0.109357-0.076509im     -0.0633912+0.235702im      0.156632-0.00467143im    -0.233074-0.0979843im   0.0120589-0.0141836im    0.0510791-0.0227343im     0.103455+0.104696im    -0.0254975-0.228901im      -0.0301036-0.0188444im    -0.0227922-0.0574663im      0.148835-0.063229im    -0.000278235-0.125549im     -2.00947e-5-0.036499im        0.160449+0.0769182im     -0.087852-0.169701im      -0.158112+0.0830301im    -0.0556822-0.0485764im   0.00526441-0.0438815im     0.0913887-0.259178im      0.0423405+0.169662im      -0.0191758+0.170599im      0.103691+0.0463699im      0.200312-0.110441im       0.313343-0.0413424im     -0.302943+0.15186im        -0.069039-0.177798im    -0.187653+0.103104im    -0.0538594+0.0111772im     0.128652+0.0550828im    -0.0899627+0.0580977im     -0.179953+0.106846im
   0.0721131-0.253275im      0.16596+0.0893629im      0.150192-0.0103026im  -0.00350824-0.0799431im      0.077572-0.104922im   -0.0163299-0.107867im     -0.129224+0.213409im      0.038083-0.0694236im    0.0597489+0.0928948im      -0.143372-0.1031im          0.17531-0.0998813im    -0.0828589+0.0592039im      -0.173614-0.13305im      -0.00378496-0.0389432im      -0.145996+0.163496im       0.122312-0.0530053im      0.144859+0.159297im     -0.0173843+0.117405im     0.0464371-0.0551703im     0.0807364-0.254725im     0.00177677+0.117188im       -0.115246-0.0739401im    -0.274685+0.0584579im    -0.0442259+0.0758762im    -0.0991798-0.120029im      0.0986778-0.146091im       0.0201628-0.0757288im  -0.0954623+0.180793im     -0.113164+0.111617im      0.243946+0.295091im     -0.0506572+0.0492318im      0.107735+0.105504im
   -0.107994+0.0609724im  -0.0769408+0.011967im     -0.0570312-0.108945im     0.0701029+0.0345274im   -0.00739818-0.075604im    0.0468742+0.232588im    -0.0225031-0.257416im    -0.0498025-0.0622729im    0.0516314-0.156007im       -0.066431-0.0616638im      0.233663+0.0574031im    -0.0145549-0.165235im        -0.14841-0.119974im        0.178558-0.128942im    -0.000500318-0.157596im      -0.161631+0.0482774im      0.274931+0.135438im       -0.20728-0.0427713im    0.0317509-0.0880324im     -0.195613-0.0588061im     -0.266991+0.161063im        0.243118+0.0546813im   -0.0592836+0.178535im     -0.0162571+0.0951489im    -0.0240948-0.132624im     -0.0483024-0.132925im       0.0614447-0.0645001im   0.0206215-0.218017im    0.00837127-0.121371im      0.145512+0.0100258im     0.0744764-0.157441im     -0.0960262-0.0189226im
   0.0186251+0.151691im     0.231216-0.0891122im      0.028171-0.0593598im     0.163517+0.0920414im      0.126292+0.256946im    0.0474161+0.0123328im     0.045364+0.0642642im   0.00246165-0.0580016im    -0.148976+0.204166im      -0.0778491-0.09236im        0.214826-0.199965im       0.387747-0.0169403im       0.130895-0.0114521im       0.135715+0.155566im       0.0685711-0.00424239im    -0.171761+0.189493im     -0.0793453-0.149832im      0.0301223-0.0875625im    -0.288628+0.0897417im     0.0232426-0.216688im      0.0892988+0.0723394im       0.136299-0.0375769im    0.0983135+0.0220845im     0.0917223-0.0208904im    -0.0484402+0.0186107im      0.114058-0.236472im     -0.00349522+0.0129665im  -0.0384863-0.0290135im   -0.0600984+0.00563291im  -0.0313677+0.0668245im      0.080872-0.071352im       0.100684+0.0563406im
    0.176443-0.0304924im  -0.0308953+0.247388im      0.0147237-0.0240972im    0.0868463+0.079912im       0.186435-0.10374im     0.0392009+0.00224401im    0.186345-0.0319151im     0.120181+0.0106632im    -0.164334+0.0355501im      -0.097021+0.0344004im      0.130076+0.0916363im     0.0122755-0.162902im       0.0318095+0.0612845im      -0.393077-0.105345im      0.00968438+0.103808im     -0.0367277-0.0187829im    -0.0859164+0.110472im       0.113276-0.0793566im    -0.112933+0.211307im      -0.128386+0.0743411im     -0.149706-0.0753408im     -0.0711325-0.103423im    -0.0646457+0.0748568im      0.328363+0.109332im      -0.036206-0.1508im        0.0574171+0.0603868im     -0.0578398-0.230967im    0.0326654-0.112682im     -0.139974+0.0182177im    0.0469563-0.138183im        0.13991+0.186215im      0.0413225-0.172376im
   0.0461038-0.122022im   -0.0067376+0.183199im      -0.134543-0.0418649im   -0.0312265+0.064462im     -0.0782861-0.228764im    -0.175467+0.13587im      0.0769092-0.016589im     -0.197138+0.14906im      -0.160042+0.211837im      0.00542985-0.0281482im     -0.178566+0.0647297im    -0.0159324-0.176691im       0.0500556+0.000840257im     0.209389+0.0293984im     -0.0414793+0.107447im     -0.0491844-0.0355142im     0.0828369-0.00899161im    -0.124824+0.0476255im    -0.120143-0.262698im      0.0726971+0.0058719im      0.252034+0.00866236im      0.160851-0.00730147im  -0.0679483+0.0263665im   -0.00317206+0.103152im       0.110373-0.128614im      -0.127351-0.0257049im      -0.218892+0.0474121im   -0.162206-0.0975857im   -0.0546878+0.176239im     -0.210069+0.0367588im       0.13607+0.10233im        0.262748-0.134895im
   -0.111569-0.0273475im  -0.0936982+0.177554im       -0.04923+0.0132022im     0.139971-0.0643717im     0.0129439+0.0344569im    0.132541+0.0233846im     0.113002-0.0217727im      0.34782-0.19459im       0.282704+0.106128im     -0.00566469-0.198916im    -0.00415114-0.00347676im   0.00948322-0.0720571im     -0.0548537+0.237091im      0.00987731-0.111031im        0.190784+0.0392269im      0.103372+0.153423im      0.0883827+0.0440641im     0.0616813-0.201241im      0.129846-0.352646im      0.0792184+0.0405684im      0.226294-0.000382687im    0.0838564+0.0672629im      0.18491-0.186992im      0.0140781-0.0120712im     0.0024116-0.0115153im      0.111022-0.11348im      -0.00245184-0.197105im   -0.0445886+0.0683782im   -0.0759053-0.023654im    0.00763284-0.0080868im     -0.113033+0.0268918im   -0.00449742-0.149721im
   0.0406119+0.0820054im  -0.0967207-0.00501413im    -0.120325-0.167198im     0.0010156-0.0784717im    -0.0195117+0.0684619im  -0.0749901+0.0253676im     -0.30883-0.0301894im   -0.0406295-0.281472im      0.130205-0.0118575im       0.214211+0.0438692im     -0.171679-0.107829im      0.0157914-0.138245im       -0.320341-0.0242806im      -0.204921-0.0262315im    -0.00185129+0.204129im      -0.267915+0.136336im      -0.218906-0.10272im       0.0203316-0.0423329im    -0.083799-0.0433456im     0.0959363-0.0741343im     0.0372844-0.0832857im    -0.00447771+0.143934im      -0.17221+0.203668im     -0.0361772-0.09514im      -0.0784091-0.0443569im    -0.0253437-0.0110886im       0.073216+0.0863595im  -0.0572849-0.0577088im   -0.0841986-0.079569im    -0.0895128+0.123096im      0.0855746+0.223949im      -0.130562-0.0871926im
   0.0249295+0.1401im      0.0448265-0.196817im      -0.189774+0.0134164im     0.193804-0.047109im      0.0204585+0.161142im    -0.175467+0.0297166im   -0.0349755+0.196389im     0.0176553+0.0944206im   -0.0939107+0.147456im      -0.0140898-0.0346509im     0.0629421+0.00980954im   -0.0582058-0.11362im        0.0928628+0.122951im       -0.113028+0.0383875im        0.21187+0.294236im      0.0796545+0.0502663im      0.301808+0.152205im      -0.185023+0.147784im     0.0526953-0.108102im      0.0258877-0.0265488im     -0.140608+0.0178963im      -0.075737-0.168615im    -0.0997386-0.111343im      0.0484981-0.0800568im     0.0290647-0.0181874im    -0.0901721-0.0184369im     -0.0449544+0.13218im      0.180098-0.141226im      0.183257-0.225428im    -0.0512535-0.00245455im    -0.153941+0.225381im      -0.101538+0.0206349im
   -0.122891-0.133385im    0.0433525+0.147913im      -0.195708-0.290797im    -0.0107781-0.0974763im     -0.187544+0.2292im     -0.0748912+0.140334im       -0.0148+0.0606932im    0.0116825+0.00921636im   0.0249136-0.200988im       -0.272516+0.100355im        0.14584+0.0185563im     0.0761218-0.0642im        -0.0237772-0.111365im        0.105416+0.0630828im     -0.0126182-0.0311978im      0.255076+0.176217im      -0.075595-0.0427874im      0.129645+0.230356im     0.0409851+0.230219im     0.00397852+0.00887922im    0.0588204+0.121822im      -0.0962014+0.142639im      0.096344-0.0847611im      -0.13188+0.0496865im      0.154126-0.134013im      0.0565727+0.0370581im      -0.058233-0.0948759im   0.0848389-0.112664im    -0.0399934+0.140346im     -0.126974+0.0423188im    -0.0283329+0.205278im      -0.140634-0.120923im
    0.190672-0.0886538im    0.264096-0.098308im       0.048466-0.0434799im   -0.0258364-0.0685937im     -0.105276+0.253567im     0.037627+0.140827im     0.0830122-0.0227883im    0.0621846-0.245164im     0.0948794-0.140083im        0.127552-0.0601968im     0.0183479+0.0989947im     0.0353767+0.0315207im       0.131281-0.0951955im     -0.0254524+0.0729704im      0.0379447+0.136261im      0.0399136-0.104452im      -0.138747+0.216828im      -0.123878+0.0463733im    0.0374778-0.0752143im     -0.225626+0.20325im        0.119936+0.0208632im     -0.0152968-0.0711471im   -0.0435514+0.0655441im     0.0102786+0.178992im     -0.0713181+0.0674964im    -0.0197146+0.00519103im      0.201531+0.171738im    -0.333415-0.219639im    -0.0165381+0.120155im     0.0390228-0.161109im      -0.155366+0.0152259im      0.155908-0.0337406im
    0.133808-0.111265im     0.106867-0.0157535im    -0.0387181+0.0974412im   0.00131853-0.18359im        0.050461-0.114992im   -0.0292382+0.17162im     -0.0945293-0.0267439im   -0.0513093+0.257948im      0.131963-0.17061im         0.176473+0.267625im      0.0900094-0.0985472im   -0.00681738+0.020465im       0.0390378-0.0126095im      -0.039327+0.0796468im       0.040311-0.064577im      -0.135539+0.0371029im     0.0661223+0.00398387im   -0.0845886+0.0120937im   0.00410097-0.124671im      -0.120586-0.133176im       0.148503-0.197502im      0.00446266+0.0183629im    0.0957648-0.0254731im      0.210653+0.0757792im      -0.15036+0.0103371im      0.163924-0.0461864im       0.209833-0.225837im     0.295638-0.062698im    -0.0583134+0.144572im     -0.265791+0.138262im      -0.207214+0.0120408im     0.0355398+0.0916092im
   0.0707277-0.0907526im  -0.0203355+0.0421388im    -0.0210826-0.0734677im   -0.0599611+0.0225771im     0.0112877-0.129776im    0.0960008-0.0415246im     0.133728+0.0736113im      0.04969-0.0689737im    0.0137504+0.000933205im   -0.0146434+0.0283155im     -0.178934-0.0921045im     0.0428566-0.148751im       0.0253523+0.190754im        0.128588-0.00405253im     0.0620303-0.0242417im     0.0685005+0.0147457im     -0.105315-0.177129im      -0.192485-0.0601432im    -0.176803-0.00419322im     0.144594+0.155396im      -0.168335+0.198565im      -0.0600328+0.068602im    -0.0689052+0.104741im       0.143613+0.00192413im     0.017495-0.37424im        0.232724+0.034936im        0.234192+0.0744753im   0.0113679+0.00382303im    0.397751+0.158607im     0.0264489+0.00375571im     -0.17603-0.00266381im   -0.0685256+0.199146im
 -0.00728227+0.215332im     0.012619+0.109657im       0.295091-0.0496976im  -0.00776495-0.0109921im     0.0369268+0.204443im   -0.0461881-0.206273im      -0.17007-0.0859906im   -0.0434249+0.0762989im     0.118276+0.110644im        0.199633+0.228402im      0.0823771+0.0822291im   -0.00126162+0.0434457im       0.101881+0.0500387im       0.102238+0.0123803im       0.204425-0.0289105im      0.186362+0.0534193im     0.0691264+0.00244537im   -0.0412607+0.0294414im    0.0832616+0.0572451im      0.062175+0.232705im      -0.110059+0.0102648im       0.166353+0.205654im     0.0628734+0.179854im       0.155373+0.040408im      0.0163847-0.190938im      -0.279367-0.0444946im     -0.0170394-0.0086306im   0.0433387+0.106472im     -0.125893+0.101187im      0.104343+0.171348im     -0.0361249+0.159674im       0.195695-0.0283918im
   0.0233442+0.0339293im  -0.0804181+0.211169im      -0.192579+0.0594167im    -0.236809+0.129521im     -0.0240524-0.0535039im  -0.0143604-0.286951im    -0.0863531-0.0452684im     -0.11297+0.0379013im     0.054515-0.0144419im     -0.0246454-0.0380512im     0.0912312+0.053389im       0.149346-0.00615751im     -0.111967-0.316414im      -0.0974977+0.1629im           0.33304-0.0794548im    -0.0192072+0.180597im      0.0447571-0.113835im      0.0858693-0.0770461im     0.135815-0.0491196im    -0.0575828-0.171631im     0.00962212-0.155811im       -0.106076-0.116874im     0.0486584-0.0679786im   -0.00454158+0.0839475im     -0.123846-0.142322im     -0.0101208+0.0596558im     -0.0925522+0.0500216im   -0.171716-0.13622im        0.22878-0.0466572im      0.10815-0.0877707im     -0.205582-0.0281113im      0.158895+0.0243849im
    0.375258-0.222922im   -0.0445255+0.0306939im    -0.0202101+0.147516im    -0.0917954+0.205335im       -0.10164+0.111444im     0.105611+0.094735im      0.044171+0.231384im     -0.127136-0.19746im      0.0683984+0.147673im        0.024522+0.19258im       0.0397332-0.0292338im     0.0608817+0.315479im       -0.136567-0.119717im        0.099624-0.122382im      -0.0666432+0.0243902im       0.10626-0.00385699im     0.135015+0.071377im     -0.0524446-0.233837im     -0.133558+0.0613106im     0.0197082+0.0744952im     0.0517869-0.0517439im      0.0378795+0.00998893im   0.0821025+0.0576189im    -0.0650015-0.176356im      0.0509553-0.151895im      -0.152024-0.0834036im     -0.0555501-0.114482im       0.1519-0.100213im     0.0508459-0.16913im     -0.0788754-0.0727925im    -0.0254485-0.0368956im     -0.107181-0.11997im
   -0.154443-0.0892311im  -0.0825667+0.013813im       0.120788-0.0789611im     0.104022-0.107011im     -0.0443453-0.0780143im  -0.0220161-0.0981242im    0.0791972+0.266103im    -0.0470901-0.14647im     -0.0205973+0.0203317im      0.0649716-0.0582775im      0.281783-0.0938469im     -0.199225-0.11614im         0.168893-0.0820469im     -0.0178539-0.135546im       -0.128642-0.00227623im   -0.0371882+0.105485im     -0.0625097+0.0906789im      0.227734-0.163211im     -0.131412-0.134606im     -0.0748289-0.0778492im     -0.119259+0.00743831im    -0.0957629+0.207159im      0.161828-0.0158357im     0.0222016+0.131357im      -0.130086-0.00275826im    -0.338366+0.154354im       0.0267244+0.0933432im  -0.0409985-0.0501615im     0.170585-0.013304im     -0.296057+0.0362621im   -0.00522676-0.040859im      0.0598554+0.160266im
  0.00674215+0.130596im    0.0803489+0.0615187im    -0.0511937+0.18571im       0.232007+0.235597im       0.106807-0.0388184im   0.0701634+0.222034im    -0.0338701-0.0260668im    -0.128733-0.264172im    -0.0246983+0.00749692im     -0.051363-0.255808im      0.0760184+0.105449im     -0.0344898-0.0465129im      -0.107982-0.165629im      -0.0441994-0.0775769im      0.0190692+0.0387152im      0.033147-0.0299455im    -0.0518538-0.204957im      -0.155326+0.107057im      0.143942+0.023405im     -0.0558069+0.195538im       0.144064-0.0401791im      -0.231967+0.174261im     0.0885405+0.0299554im     0.0369502-0.0631804im   -0.00221234+0.0870683im   -0.00398446+0.121379im      -0.0823684+0.0156147im    0.316613+0.00507938im   0.0881577+0.156003im     0.0481423+0.172855im      0.0379483+0.00389558im     0.219636+0.154295im
   0.0537028+0.052917im   -0.0561501-0.040436im     -0.0898723-0.115426im     0.0947532-0.00579588im    0.0416036-0.24924im     0.0672807-0.138949im    -0.0201706+0.24996im      0.0729448+0.0644994im      0.17125-0.133986im       -0.127354-0.0169758im     0.0943287+0.285272im      0.0878606-0.045946im      0.00257479-0.0165217im       0.198564+0.171649im       -0.112524+0.0721836im     -0.155848-0.0762114im      0.128558+0.0055545im     0.0983256-0.0750117im   -0.0731664+0.175271im      -0.112624+0.287577im       0.273112-0.0882124im       0.186728+0.109002im    -0.0649671-0.034873im       0.144214-0.0727688im     -0.148671+0.00427958im    0.0470303+0.0311157im      -0.112156+0.184732im   -0.0580645+0.0119799im     -0.08817-0.147988im     0.0791315+0.0873786im     -0.102897+0.120767im      -0.155114+0.160447im
   0.0118813+0.0125956im   0.0976966+0.0615871im      0.158616-0.186136im      0.199587+0.0978815im      0.066995-0.102359im    0.0786382-0.100828im     0.0582685-0.0745113im    0.0749956-0.164873im    -0.0717399-0.285682im        0.135753+0.198649im      -0.112217+0.154236im      -0.106735+0.0539976im      -0.300476+0.0874456im       0.100297+0.121089im        0.102756+0.0261007im      0.100553+0.0591658im      0.143597+0.0262729im      0.134196+0.0270324im   -0.0744993+0.0629482im     0.0283526-0.170052im       0.138582+0.0990473im     -0.0861499-0.266365im     0.0403753-0.147144im       0.145206-0.0232854im      0.223924+0.0130118im    -0.0971771-0.00871699im      0.155409+0.123279im    0.0361927-0.0984892im    0.0846446-0.110438im     -0.120317+0.110692im       0.183962-0.097116im       0.171722+0.0245217im
   0.0206612+0.0374335im   0.0500588-0.0193588im      0.307129-0.121125im     -0.204141+0.148453im      0.0821091-0.129822im     0.163452+0.256096im     0.0209446+0.111225im    0.00599117+0.0751561im    -0.157059-0.0509415im     -0.0183388+0.157982im       0.143139+0.0969717im   -0.00408685-0.100424im        0.163499+0.00426063im     -0.178161+0.0447866im     -0.0163756+0.101992im      0.0382271+0.250276im      0.0198907-0.219099im      -0.241066-0.091079im      0.219772-0.0224999im   -0.00221965-0.125249im       0.217472+0.0113678im      0.0326647+0.164297im     -0.129116-0.15011im      -0.0998903-0.039466im     -0.0194065+0.0277455im     -0.118185+0.0236059im       0.155413-0.0100033im   -0.133225+0.128694im      0.133029-0.0997447im    0.0794817-0.0282989im     0.0712204+0.0590887im     -0.135891-0.137148im
   -0.152991-0.126005im    -0.141643+0.209928im     -0.0854354-0.0292575im     0.254785-0.164868im      -0.152998+0.0945904im   0.0548499+0.0658959im   -0.0533692+0.292661im    -0.0463518-0.003047im     -0.122107+0.062566im        0.123235+0.127485im     -0.0892671+0.00814009im    0.0596734-0.136587im       0.0790799-0.218291im       -0.289508+0.127817im     -0.00919831-0.316183im     -0.0738296-0.201985im      0.0332205-0.0378941im    -0.0884158-0.118664im     0.0148047-0.012319im     -0.0207034+0.128554im      0.0628169+0.0294929im      0.0181501-0.142629im     0.0773609+0.0168276im   -0.00136132+0.0719565im      0.179767+0.0447174im   -0.00581857-0.23399im         0.133785+0.0948343im   0.0233594+0.139976im      0.064973-0.0581112im     0.202786+0.125044im      0.0225379-0.0111892im     0.0192668-0.0699956im
  -0.0876408-0.0112534im   -0.221719+0.214249im       0.193529+0.0331885im    -0.022574-0.0376989im     0.0981217+0.0984812im    -0.13595-0.0591027im    -0.132098+0.155702im      0.184999-0.074991im     -0.162539-0.142834im       -0.219823-0.110107im     -0.0913601-0.249425im     -0.0937829+0.0937451im      0.0612717+0.00181741im      0.209688+0.0483301im        0.10223+0.115556im      -0.045286-0.190746im     -0.0839708-0.0106405im     -0.292892+0.108665im       0.15574+0.0995471im     -0.025495-0.0603378im        0.1194-0.23255im       -0.0214605+0.01151im       0.109017+0.128967im       0.206155+0.0570331im    -0.0733463-0.0785585im   -0.00986874-0.0118033im    -0.00143447+0.0333934im  -0.0317375-0.139848im    0.00869836-0.128645im     -0.109244+0.0222534im     0.0567598-0.202028im      -0.106228-0.14776im
   -0.032401+0.0292966im    0.204995-0.0849635im      0.048623+0.0668426im    0.0347086-0.280792im      -0.038186-0.20897im    -0.0693486+0.0694611im    -0.136399-0.0183649im    0.0352128-0.126936im     0.0972232+0.0645022im      -0.114161-0.00116417im   -0.0784632+0.0388586im      0.295485+0.134997im       0.0308149-0.00934268im     0.0199197+0.035583im       -0.127213+0.0902505im     0.0626874+0.0469797im     -0.018998-0.126367im    -0.00796928-0.0373294im     0.186592-0.033211im      -0.117513+0.112587im      -0.133277-0.1013im         0.0864789-0.237114im      0.187794+0.100273im     -0.0645585+0.200225im      0.0758692-0.154405im     0.00408365+0.123244im     -0.00754097-0.198124im   -0.0698448+0.11143im       0.198095-0.249762im     -0.114442+0.0346311im      0.279795+0.164055im      0.0539004+0.10475im
   0.0207054-0.163034im     0.335123-0.0299987im      -0.02897+0.0409382im   -0.0388568-0.165699im       0.236403+0.0812841im   -0.041294-0.234833im      0.016415+0.143962im     0.0822506+0.0403574im   -0.0822739-0.100811im       0.0762205+0.014608im     -0.0787891+0.211895im      -0.184019-0.129939im       0.0133959-0.200073im      0.00806172-0.220155im        0.144257+0.0726054im    -0.0221528+0.0835707im     0.0219607-0.247584im     -0.0240164-0.0952642im  -0.00834105-0.0160558im    -0.0375417+0.0316098im    -0.0344048+0.110486im        0.118222+0.137448im    -0.0352808+0.239206im     -0.0774494+0.0591236im      0.213428+0.13162im        0.202619+0.000144928im    -0.195791-0.0419411im   0.0627101+0.00524667im  -0.0179075-0.156477im     -0.115183-0.0394762im    -0.0888867-0.181945im     0.00927119-0.123979im
   -0.124205+0.014975im    0.0123293-0.13071im       -0.002029+0.241009im     0.0510695+0.0981472im    -0.0828147-0.0857453im  -0.0561898-0.364139im    -0.0620908+0.00658314im   0.0201263-0.0714346im    -0.150064+0.0585507im     -0.0757351+0.0428774im     -0.167864+0.109281im       0.118831-0.0845856im      0.0591953-0.224192im      -0.0224155-0.00296569im     -0.106748+0.130108im        0.15589+0.0607256im      0.149595-0.0213393im   -0.00430648+0.0285548im   -0.0798077-0.14458im      -0.0904659+0.00477275im    0.0134051+0.0638925im      0.0616316+0.0924185im     0.149288-0.0769639im    -0.0243743-0.0469588im     -0.148612-0.0438329im     0.0559357+0.0624223im       0.423226-0.0110124im   0.0969819-0.196077im     -0.171046+0.203642im     0.0574937+0.00146357im     0.172879+0.0199416im     -0.178118-0.175993im
   -0.106462-0.0982084im    0.205916-0.119004im     -0.0214988-0.094142im    -0.0831182+0.204855im     0.00350199+0.0546234im   0.0632982+0.078407im     -0.168182+0.0301993im     0.157427+0.044495im    -0.0335423+0.0289694im      -0.336812-0.0045036im    -0.0993554-0.0136303im     -0.170614-0.158475im      -0.0254979+0.0640782im      -0.055861+0.182139im         0.13815-0.0346767im     -0.125683-0.212362im     -0.0443515-0.0653356im     0.0880201-0.253794im   -0.00700195+0.0222974im      0.112274+0.119427im      -0.074248-0.0466519im      0.0984017-0.143036im    -0.0227715+0.00722495im    -0.236261-0.0646446im    -0.0686551-0.0832414im     -0.260328+0.127527im        0.173899-0.19822im     0.0843403-0.114544im     -0.149759-0.0197952im   -0.0595238+0.119572im      -0.156839-0.0405619im      0.182354+0.0582975im
   0.0533251-0.129516im    -0.103483-0.096948im      -0.286026-0.114482im     0.0498065-0.0403615im       0.15389+0.159855im     -0.12312-0.112964im      0.020232-0.00341097im    0.250588+0.152969im     0.0652845-0.0578913im      -0.201157+0.125748im      0.0251987+0.176514im       0.106707+0.235115im      -0.0901346+0.0333145im       -0.22646-0.0349387im      -0.107542-0.0539301im   -0.00292213+0.095592im     -0.0825752-0.0267431im     -0.254782+0.0705568im   -0.0558053-0.177262im     -0.0302301+0.070362im     -0.0544284-0.0258475im     -0.0198443+0.19344im     -0.0718135-0.0952736im     0.0717343-0.144197im     -0.0495621-0.0249151im     -0.196212-0.090002im       0.0119993-0.0192051im    -0.11468+0.0430168im     0.078567+0.0695216im   -0.0436089+0.0366222im      0.241773-0.230282im       0.204271+0.132953im
    0.141134-0.230496im    0.0124603-0.0738936im   -0.00317947+0.0185529im     0.117002+0.26627im       0.0431187+0.137738im    -0.319244+0.00682425im   0.0372285-0.178403im    -0.0804133-0.0685536im    0.0853574-0.112376im      0.00923888+0.0499022im    -0.0788407-0.157801im      -0.213882-0.0569757im       0.251967+0.0327225im     -0.0398291+0.128985im       -0.201776+0.0737132im     -0.128433+0.20437im       0.0670475-0.129972im       0.205626+0.0690697im     0.028958-0.109644im      0.0286438+0.106602im      0.0219529-0.127434im      0.00117588+0.0281026im     0.113106-0.0771146im      0.070303+0.140499im       0.136769-0.141868im      0.0324159-0.0135067im     -0.0479371-0.0374236im  -0.0513461-0.003576im     0.0153767-0.158585im       0.33193+0.141109im      -0.008735-0.103108im     -0.0966905+0.0553739im
   -0.297652+0.127637im     0.161162+0.0706917im     0.0264416+0.0350626im   -0.0216225+0.160709im      0.0995057-0.143162im   -0.0874847-0.0268707im    -0.139096+0.160774im    -0.0149988+0.138906im      0.187794-0.0731747im       0.108885+0.0722947im     0.0938764-0.229404im      0.0148575+0.0316338im       0.107635-0.0525951im     -0.0229909-0.19im            0.127873-0.0182536im    -0.0993471+0.0937057im    -0.0614544+0.29065im       -0.062822+0.0415342im    -0.166508-0.00461387im   -0.0404597+0.239286im       0.197272-0.0184891im      -0.189039-0.0379946im   -0.0739978-0.0209251im     -0.187211-0.174059im       0.230711-0.176327im       0.127775+0.0197139im        0.05182-0.0839729im  -0.0684825-0.0993366im   -0.0314011-0.0635703im    0.0512332-0.142486im       0.178229-0.0506896im     0.0480845+0.0869392im
   0.0843722-0.190213im      0.13153+0.0233828im     -0.115374-0.0193669im    -0.115868-0.0419484im    -0.0465964-0.156517im   -0.0171233-0.00160683im   -0.239608-0.0611191im     0.167789-0.104688im    -0.0909373+0.205176im       0.0862495-0.0104035im    -0.0143586-0.0687474im    0.00929411+0.0310234im      -0.060311+0.0556277im      0.0536264-0.085781im        0.204782-0.0524547im     -0.114977+0.000187183im   0.0682913+0.0478613im     -0.120891+0.0748612im    -0.134624+0.255705im       0.113833+0.0472654im   -0.00745979+0.000321434im   0.00474093+0.262102im     0.0532905-0.364826im      0.0200162+0.43719im       0.0218448+0.163835im      -0.104551+0.00320144im     0.0570796+0.0549349im    0.101182-0.00771572im  -0.0331582-0.0736803im     0.141899-0.135046im       0.101857+0.0136123im    -0.0261022+0.104357im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
     0.3836009626567087 + 0.0im
  -0.054140632840815814 - 0.13185334980848987im
  -0.040325559894217884 + 0.27042787385046174im
   -0.08402116084183077 - 0.15315782291425953im
  -0.036966781182406816 - 0.015216508768297873im
     0.1568466043356347 + 0.2049843795458009im
   -0.03591405936406134 - 0.14704819288937518im
    0.21420559106311704 + 0.001482442687402293im
   0.050058199323266876 - 0.04020914860620788im
    0.10136776623093427 - 0.1121977513233644im
     0.0859986820469406 + 0.013078180750989467im
   0.020766508815829907 + 0.1027761378717874im
 -0.0023192217194435392 - 0.08772489800860829im
   0.029337830297444117 + 0.053089007084466185im
   -0.21702814236173645 - 0.04315798973541471im
   -0.03948127595171535 + 0.08154261604675736im
     0.1317587994361039 - 0.019102260219320114im
    0.07499532969399966 - 0.17278708327162645im
   0.034800092380025995 - 0.1532799822664484im
   -0.08711161944135047 + 0.13090998222942696im
  -0.029127639171584646 + 0.057909392887210503im
   -0.11454156462520564 + 0.0711064028712597im
    0.07182823641276574 + 0.04590734969703083im
   -0.03296973572294446 - 0.08181944192286468im
  -0.012051085790626286 - 0.11479751688106347im
     0.3074592728634471 - 0.06375785625956945im
    0.08748371029015861 - 0.03151599811099615im
   -0.14748491076411668 - 0.19923287344212im
   0.022743381195053577 - 0.06194319326714623im
     0.3195894957176993 + 0.08296012346487139im
  -0.009860413615746426 - 0.08583515325421189im
    0.12646193999149394 + 0.13129003309374376im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Thursday 25 August 2022 16:36">Thursday 25 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

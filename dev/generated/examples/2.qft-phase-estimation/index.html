<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.101763-0.192119im       0.145711-0.0792212im  -0.0339694-0.0627602im      -0.324594+0.0523715im     0.059473-0.0210387im    -0.0424422+0.00999535im      0.343136-0.276027im      0.0150978+0.0677452im    -0.0591413-0.023888im     -0.0147277-0.0169657im    0.125937+0.170429im    -0.0315314+0.10184im      -0.0580706-0.00689343im    -0.013423-0.0872345im     -0.129142+0.0721043im   0.00788601+0.0200367im      0.024123-0.0610985im     -0.208672-0.0460944im    -0.0322765-0.04873im       0.103694+0.062888im     -0.0216386-0.0716288im    0.272882+0.025682im      0.0447528-0.0773922im     -0.136522+0.0835787im     0.281936+0.170567im       0.198493+0.0291241im    -0.0565727-0.0422488im     0.0156279-0.130675im       0.142094+0.138484im     -0.076923-0.116165im     -0.0979018+0.0182655im     -0.127003+0.273121im
   0.152807+0.00965224im     0.106283-0.519342im     0.104351-0.193399im     -0.00334367-0.101962im    -0.0131072-0.0513083im     0.0341356+0.131042im          -0.119-0.0159294im     0.0862601-0.0375158im     0.0111271+0.0775841im    -0.0232841-0.103619im    -0.178446-0.109617im    -0.0321085-0.205818im      -0.217226-0.1063im       -0.0712789-0.129287im    -0.00666978-0.135806im     -0.108466-0.153024im       0.185442+0.0573022im     -0.233047-0.0543009im     0.0799418+0.0934615im    -0.088083+0.0675807im      0.103627-0.0878932im  0.00439404-0.0699335im      0.139724-0.0301596im     -0.137563-0.0719194im    0.0485321+0.0711635im     0.0649977-0.0584258im   -0.00547996+0.11802im       -0.154724-0.03958im      -0.0181871+0.0138651im     0.132975+0.109733im     -0.0451853-0.200737im       0.186821-0.0390114im
   0.108542+0.0401723im     0.0167656-0.0782423im  -0.0722912-0.317329im       -0.114368+0.121371im    -0.0760445+0.000641207im    0.113593+0.018155im       0.0417427-0.0666231im    -0.0349715-0.0797747im      0.162003+0.197818im      0.0676264-0.0187799im   0.0945741+0.0583314im    0.0511761-0.0797225im      0.213906-0.00743999im  -0.00576037+0.261612im     0.00957228+0.231181im     0.0105685-0.317117im       0.114817+0.0202026im    0.00813446+0.379946im     -0.0837434+0.0665538im     -0.20725+0.021462im       0.181448+0.110288im   -0.0987416+0.171559im     -0.0557604+0.0468334im    -0.0633839-0.137183im    -0.0955679+0.0912497im      0.021367+0.0249376im    -0.0380839-0.125478im     -0.0439611+0.0557993im    -0.0121955-0.0798254im   -0.0776848-0.112564im       0.142081+0.00290357im    -0.174346+0.108093im
 -0.0478211+0.0363614im    -0.0130773-0.0568335im   -0.163494-0.124228im      -0.0663853-0.57648im     -0.0357884+0.0363387im     -0.199404+0.0178817im      -0.026172-0.122791im     -0.0218812-0.146248im     -0.0178638-0.165227im      0.0505103-0.0565066im   0.0362626+0.0395538im    -0.165545+0.126077im     -0.0773231-0.123103im      0.0964989+0.129916im       0.118267+0.308431im     0.0275807-0.0314807im    -0.0814808+0.229122im      0.0220936+0.0697263im      0.116258+0.0617313im   -0.0811448-0.126616im      0.0810434+0.0649545im   0.0205313-0.0655809im     -0.101264-0.0371811im     0.0549085+0.0399772im     0.177852-0.0886973im      -0.13142+0.0141063im    -0.0424685+0.0316394im     0.0732109-0.18683im      -0.0169196-0.0766347im    -0.033341+0.101174im      -0.151003+0.0579029im   -0.00656231-0.126928im
   0.451781-0.124173im     -0.0274478-0.122297im    0.0229398+0.027748im        0.204047+0.150343im     0.0967491-0.40026im       0.0498018-0.0161529im       0.167198-0.101666im      -0.103908-0.0846046im     -0.204287+0.000401587im   0.0432813+0.159033im    -0.153913-0.120975im      -0.14039+0.102041im       0.043316+0.00696285im     0.165502-0.0862123im     0.0855736+0.0935373im     0.117254+0.133735im      0.0378335-0.0252952im    -0.0593449+0.164029im      0.0817593+0.081172im     -0.078446-0.0466008im    -0.0514359+0.0105665im    0.129005-0.0221398im    0.00668359+0.0258335im     0.0815689+0.139986im    -0.0918974-0.078506im      -0.131521+0.118384im      0.0741404+0.0749203im   -0.00983289-0.136328im      -0.194161+0.0333025im   -0.0950427-0.0274221im    -0.0407099+0.0737632im    -0.0860088+0.0955367im
  -0.043198-0.0107635im     0.0139104+0.0604332im  -0.0645581+0.00899581im     -0.161918-0.110549im      0.057072-0.0490475im      0.123851-0.542737im      -0.0335862-0.188089im       0.174104-0.0577307im    -0.0956235+0.136142im      -0.131621-0.11022im      -0.12892-0.06411im      0.0500814-0.271778im       0.173939+0.0125109im     0.0362751+0.00725782im    0.0379416-0.138282im      0.105831-0.0263794im     0.0358377+0.137292im      0.0774578+0.05101im       0.0265064-0.046871im      0.120142-0.003687im     -0.0208573+0.0200253im   -0.103508+0.191361im     -0.0354578-0.0626843im   -0.00474616+0.197405im    -0.0624937+0.0383767im     -0.105183-0.0364229im     -0.095372+0.342348im     -0.0977628-0.151765im      0.0981606+0.0998232im    0.0830489-0.0523856im   -0.00553645+0.0534303im   0.000279919+0.0081874im
   0.135846+0.0827568im      -0.11951+0.063527im    0.0061644+0.0177151im       0.101919+0.017658im     -0.136337+0.244512im      -0.159943-0.0325089im       0.206101-0.358885im      0.0327865+0.160587im      0.0394981-0.244102im       0.187211+0.17616im     0.0544736+0.0192241im   -0.0719965-0.0580539im       0.04063+0.0667896im     0.0331393+0.185788im      0.0172197-0.0935699im     0.108698+0.0109752im     0.0996707-0.128965im       -0.21677-0.150476im       0.150698-0.023312im    -0.0981811+0.0477213im      0.168888-0.1092im       -0.20354+0.0817668im     0.0756678-0.0312393im     0.0695806+0.0361901im   -0.0477476-0.0223965im     -0.047607+0.0292672im   -0.00396129+0.109462im       -0.15072+0.171125im      0.0132671-0.130479im      0.229197+0.172671im      0.0027426+0.11737im       0.0194529+0.154755im
  -0.177324-0.0709916im    -0.0505378-0.0563068im    0.107759+0.0191332im      0.0264068-0.00546041im   0.0110212+0.0903965im       0.22886+0.197251im        0.146406+0.012492im     -0.0755399-0.372375im      -0.146361+0.025609im       0.121981+0.155381im    0.0888894+0.0593442im     0.159227-0.0738092im      0.216253-0.115014im       0.135345+0.0520418im      0.126377-0.12607im     -0.0733099-0.330289im      0.0502983-0.00964767im  -0.00594683-0.138128im       0.093427+0.0792529im     0.248807+0.00190745im   0.00297229-0.0330745im   0.0499919+0.0101842im      0.177766-0.0857522im      0.107674+0.0624912im   -0.0337437-0.0583318im      -0.14285+0.0683978im      0.183496+0.0705539im     0.0466648+0.0709766im      0.109216-0.0834066im    -0.151126-0.0256909im     -0.266076+0.0248728im    0.00856732-0.0519429im
  0.0258841-0.116789im        -0.1401+0.0686426im   0.0583556+0.0162291im     -0.0644495+0.00682859im   -0.159548-0.151831im      0.0899694+0.107093im      -0.0887478+0.178im       -0.00766405-0.125567im       0.119676-0.366137im      -0.037992-0.0968886im    0.262582-0.130434im     -0.122285-0.00209643im     0.149326-0.225895im     -0.0702735-0.0270314im     -0.209489-0.0922659im   -0.0383193+0.00607259im     -0.14507+0.104755im      -0.168873+0.0557607im      0.137613-0.0420624im    -0.038365-0.0462956im    -0.0755688+0.0222065im   -0.136141+0.111913im     -0.0247661+0.219981im     -0.0237625-0.131112im     -0.139061-0.03201im         0.15978-0.109224im      0.0539128+0.208725im     -0.0901532-0.199333im       0.076803+0.103178im    -0.0532985-0.0107783im     -0.065286+0.096704im      0.0356884+0.241782im
  0.0228138-0.238863im     -0.0732801-0.15826im    0.00150319+0.0259986im      0.0246985+0.0199484im     0.317632+0.0563298im     -0.228039-0.163618im        0.149151+0.0825809im    -0.0453676-0.143336im     0.00400487-0.050541im     -0.0866768-0.207im      -0.0371489+0.0857454im     0.333783+0.0518154im     -0.215077+0.084799im      0.0664741+0.102884im      -0.018109-0.10833im     -0.0728343-0.0200633im      -0.24272-0.0190681im     -0.126648+0.0334248im     0.0675045-0.0102195im   -0.0519624-0.0877043im    -0.0315983+0.0127384im   -0.146706+0.039506im     -0.0534974+0.0911547im     0.0796187-0.200063im     0.0190138+0.024141im       -0.30569+0.0264207im     -0.101881-0.0641491im      -0.17142+0.126212im      0.0337041-0.0241068im     -0.21123+0.0300954im       0.06219+0.00912034im    0.0824265+0.166381im
  -0.128914-0.0887013im     -0.154285-0.179338im     0.102508+0.160029im      -0.0403371+0.00797311im   -0.232757+0.225924im     -0.0613508-0.0241322im        0.13488-0.0132526im     -0.227711-0.158856im      0.0469765+0.115785im     -0.0508574-0.0708248im   0.0549767-0.516177im    0.00177554-0.0828495im    -0.0343927+0.0845816im      0.109249-0.131755im     -0.0704135+0.127322im      0.223051-0.0195903im     -0.132196-0.103254im     -0.0707487-0.0462251im       0.04398+0.0989692im    0.0166896-0.0198956im     0.0747601-0.0312052im   0.0830089+0.0764469im     -0.215639+0.043317im       0.101129+0.0178538im    0.0555033+0.00339653im    0.0954095+0.0135504im     -0.133353+0.0557892im     0.0405228+0.0905737im     -0.113682+0.0204515im    0.0705967-0.160096im      0.0678627-0.123692im      -0.145653-0.118912im
   -0.13883-0.231682im       0.154534+0.0898925im   -0.225543+0.14104im        0.0817135+0.258729im     0.0736949-0.0474712im    -0.0315516+0.0507708im      0.0659343+0.0548048im    -0.0099182-0.0233244im     -0.104241-0.113403im     -0.0321773-0.214444im    -0.155866+0.160628im    -0.0147262-0.264724im     -0.0437054-0.138835im      -0.070351+0.0740475im      0.131087+0.262817im    -0.0238607-0.0505071im    -0.0982779-0.0917327im     -0.135772-0.0637006im       0.12254-0.053384im      -0.17176+0.0102098im     0.0927847+0.142858im   -0.0180265-0.0646764im     0.0829469-0.251537im       0.148225-0.0712534im    -0.123443-0.102077im       0.248727-0.0816947im     -0.036761+0.171127im     -0.0159113-0.0263228im    -0.0466261-0.0422471im    0.0836888+0.0026909im    -0.0170281-0.00136633im    -0.152957-0.200317im
 -0.0587223-0.0242817im    -0.0487158-0.0925754im  -0.0590785+0.0130944im       0.119924+0.100892im     0.0638324+0.0627467im    -0.0478068-0.0304495im   -0.000189346-0.148472im     -0.0372518+0.0610941im     -0.175238+0.00966702im   -0.0251278+0.0451885im    0.110573+0.0163118im   -0.0134997-0.0333561im      0.046976-0.36991im       -0.271044+0.105571im      0.0446944-0.136348im      0.163093+0.146319im       0.239493-0.126081im    -5.19862e-5+0.0581836im     0.0815894+0.0139334im   -0.0639834+0.0329648im     -0.024872-0.114918im    0.0278313+0.122165im     -0.0740914+0.214335im     -0.0659061-0.279313im     0.0760729-0.176664im        -0.1729+0.0926307im     -0.144938-0.108539im       0.108913-0.108104im       0.177636+0.210003im    -0.0522897-0.103599im     -0.0457838-0.0133995im    -0.0246963-0.32109im
 -0.0951806+0.234506im      -0.151122+0.0399582im  -0.0370229-0.235482im       0.0188994+0.0912805im   -0.0782043+0.0465253im    -0.0409514-0.077592im        0.140647+0.132302im       0.292268-0.0687171im     -0.149154-0.0301809im     0.0975176-0.158772im     0.114144+0.096368im    -0.0707748+0.0468925im    -0.0195127+0.0963382im       0.16791-0.389735im       0.182754-0.124315im      0.105905+0.0206295im     0.0189488-0.172654im     0.00534759+0.18082im        0.183416+0.0626127im    -0.163075-0.0636403im     -0.128789+0.134964im     0.162273+0.0176931im     0.0561281+0.0754067im     0.0938891-0.140429im     0.0297457+0.121303im     0.00395734-0.0690347im   -0.00117812+0.106392im       0.100329+0.0325725im      0.158387-0.112769im    -0.0015962+0.176078im      0.0404513-0.102821im      -0.102943-0.0243151im
 -0.0957856-0.271249im       0.108009+0.126346im     0.109429-0.0615625im     -0.0417723+0.113301im     -0.173749+0.0113242im     0.0364958+0.023291im      -0.0690693-0.0369723im     0.0174029-0.0649359im       0.20435-0.170666im     -0.0191971+0.0961069im    -0.13236-0.120965im     -0.159276+0.117447im     -0.0570215+0.105757im     -0.0675174+0.0192066im      0.224722-0.342639im    -0.0760011-0.0344374im   -0.00527397+0.00389186im    -0.188462+0.0817197im     -0.135767-0.0165435im   0.00490619-0.0742161im     0.0320035+0.181587im     0.022946+0.148638im      0.0679733-0.21218im       -0.130922-0.0202592im     0.186918-0.0966737im     -0.207174+0.0850595im      -0.11513+0.0216062im      0.128553-0.198844im     -0.0644072-0.198403im    -0.0808988+0.0063891im      0.224283-0.0132614im    -0.0635805-0.10611im
 -0.0161006-0.108669im      0.0142299-0.176047im   -0.0067247+0.241216im      -0.0350173+0.113834im     0.0750921+0.0159801im    -0.0743282-0.116986im      -0.0386624+0.0777499im    -0.0040493+0.0932117im     -0.150722-0.0475641im      0.155537+0.237961im    0.0820216+0.0344742im     -0.11423+0.0594914im    -0.0725806+0.0856632im     -0.128592-0.148781im      -0.262613+0.103673im    -0.0737235-0.426728im      0.0817597+0.15598im         0.14622+0.0485624im      0.233571+0.0509375im    0.0563695+0.0385603im     -0.139904-0.0101388im   -0.135242+0.0769711im    -0.0411119-0.0907475im    -0.0255735-0.00920802im  -0.0067468+0.00787979im    -0.100951-0.145622im      -0.154411-0.0322519im      0.234744-0.063135im     -0.0309209+0.0191787im    0.0716707+0.247012im       0.155499+0.0468104im     -0.115609+0.0183467im
 -0.0704623-0.0560741im   -0.00291032+0.138985im     0.177992-0.213259im      -0.0785561-0.0570138im    0.0490425-0.116954im      -0.148646+0.0837026im      -0.132705+0.124576im      -0.133964+0.128782im      -0.177021+0.0292164im    -0.0689268-0.117591im    0.0142157+0.0223931im    0.0381031-0.139584im        0.10932+0.049947im     -0.0687083-0.0519532im    0.00505944+0.0420122im     0.120786-0.0270974im    0.00581737-0.398397im     0.00390255-0.138189im       0.189281+0.198899im     0.0284327+0.142066im        0.24174-0.0257488im  -0.0234936+0.0960517im     -0.158938-0.0117901im     -0.205263+0.179206im     0.0430817+0.0203649im     -0.141706-0.234959im      0.0809563-0.0476795im   -0.00209405-0.133398im      -0.142963-0.0851726im     -0.16684+0.0939694im     0.0324238+0.210213im      0.0675628+0.0250993im
 -0.0508941-0.231342im     -0.0346945-0.120704im     -0.12414-0.240011im        0.139086+0.0855611im    0.0353383+0.20895im        0.124381-0.0317914im      -0.169462-0.00476483im    0.0400247-0.154852im     -0.0358039+0.132419im      0.0732719-0.0418118im   0.0527776+0.0756551im   -0.0711082-0.0312491im     0.0288944+0.0636975im    -0.0634242-0.1164im        0.0070276+0.139529im      0.100536+0.230524im      0.0227496+0.29884im      -0.0324605-0.394553im     -0.0860603-0.0850173im    -0.153472+0.00289312im   -0.0753584-0.159898im    0.0220563+0.0895766im    -0.0223136+0.120543im      -0.170937+0.0619037im   -0.0358385-0.142283im     -0.0500142-0.00286784im     0.149036+0.0537942im     0.0778441+0.088778im    -0.00829273-0.131427im    -0.0994587+0.104755im       0.139786+0.085782im      -0.219173+0.134938im
  0.0256832-0.0216096im      0.041432-0.224122im    -0.158869-0.151508im       0.0208916+0.0326126im   -0.0988721+0.0076499im      0.013706-0.0696544im      -0.121102+0.0314887im      -0.11816+0.151869im     -0.0991167-0.162236im     -0.0153911+0.115881im    0.0138864+0.00428677im   0.0835619-0.176438im    -0.00229073+0.15624im        0.223159+0.155253im     -0.0538685-0.127364im     0.0840965-0.0693068im     0.0668026-0.0464648im   -0.00678857-0.135551im      0.0993764-0.498977im     0.0254972+0.00618308im    0.0194867+0.33981im     0.0717029-0.131579im     -0.0746507+0.209204im        0.09229+0.0131582im    0.0327613+0.0549682im   -0.00650941-0.0991717im     0.0377228-0.0804205im      0.221568-0.115722im     -0.0452094-0.0548829im   -0.0302096-0.168244im     -0.0727228-0.0635607im     0.0528944+0.0235979im
  0.0543126-0.0169852im    -0.0222297+0.115483im    -0.146913+0.0493864im       0.110153+0.00440835im   -0.136923-0.0490864im    0.00234811+0.0964276im      -0.120609-0.063303im     -0.0680499+0.114175im     -0.0804082+0.102486im       -0.15771-0.14306im      0.127923+0.0722742im      0.13974+0.147468im      -0.156167+0.0471593im    -0.0734465+0.0132511im    -0.0586646-0.0927605im   -0.0430194-0.0832469im      0.136917+0.0399177im    -0.0752438-0.00369733im    0.0317023+0.0819934im   -0.0223268-0.565234im        0.25728-0.0840957im   0.0426608+0.13286im        0.199292+0.0637657im     0.0270888+0.179383im    -0.0513746+0.0851683im    -0.0791132-0.147622im     -0.0541773+0.148915im       0.210508+0.130293im     -0.0690207+0.120036im   -0.00226961-0.0881361im    -0.0870339-0.0873404im    -0.0983871+0.0505815im
 -0.0277292-0.109685im      0.0997081+0.0459653im  -0.0495924-0.206651im      -0.0590151-0.055553im      0.039277-0.0769307im    -0.0628828-0.155525im     -0.00945386+0.0726798im     -0.152713+0.0510171im      0.101727+0.0348372im     0.0908428+0.304209im     0.158496+0.0173042im     0.151766+0.0220843im    -0.0544427+0.0896025im    -0.0645004-0.0779503im     0.0806188+0.123702im     0.0902642+0.0961027im     -0.021203-0.0701589im      0.012925+0.0918378im    -0.0654697-0.0879426im     0.243406-0.064619im     0.00574776-0.335747im    0.0990166+0.0583346im      0.103369-0.0354026im     0.0735223-0.364512im     -0.161658-0.0360744im     0.0209875-0.185027im      -0.031453+0.20208im      -0.0797821-0.153872im      -0.157682-0.237188im      0.102163-0.00209574im    -0.123225-0.158995im      0.0390326-0.0409562im
   0.032502-0.232228im     -0.0215798+0.194377im     0.136035-0.143119im        -0.10105+0.0782235im   -0.0448277-0.0461302im     -0.069735-0.129763im       -0.071867-0.0503251im     0.0150722-0.0105698im     -0.171649-0.0916984im     -0.120001-0.0621877im    0.106072-0.120318im    -0.0375091-0.0365677im     0.0803655-0.0428115im     0.0500149+0.164447im     -0.0371792-0.00696783im   -0.161372-0.0485044im     0.0651633+0.0377855im    -0.0893508+0.0106945im     -0.162812+0.139229im     0.0178551+0.0763701im   -0.00610266-0.119386im    0.0474457-0.576356im     -0.0933158+0.129807im     0.00748012-0.0235242im   -0.0921643+0.174802im      -0.180149+0.0196207im    -0.0115827+0.0215853im     0.0989574+0.0943336im     0.0694989-0.0192324im      0.18049+0.153856im     -0.0204984-0.141371im       -0.22149-0.0499773im
  0.0091864+0.109585im      -0.108747-0.053249im     0.111564-0.251353im      -0.0711482+0.190228im    -0.0674154-0.0239718im     -0.202131-0.0851321im     -0.0324966+0.13577im      -0.0949146+0.032091im     -0.0749242-0.0141357im    0.00581371-0.0700469im   0.0752432-0.0417237im    -0.118962+0.0923246im    -0.0388229-0.0720131im       0.03233-0.018671im      0.0781928-0.0198013im     0.137864-0.048532im      -0.158192+0.147904im      0.0681699-0.104597im     -0.0200233-0.0844756im    -0.102875+0.0657541im      0.102447-0.0950954im  -0.0321757-0.0307333im     0.0876606-0.45038im      -0.0440442+0.0597568im    -0.289422-0.143606im     -0.0886618+0.116604im         -0.205-0.106857im       0.165612+0.0119321im      0.167822+0.142283im     0.0248924-0.19004im       -0.161684-0.055843im       0.166955+0.158773im
 -0.0532149-0.00270195im    -0.125205+0.0875223im   -0.128559-0.000530238im   -0.0388719+0.0407439im    0.0305067-0.114953im       0.140191+0.210079im     -0.00763374-0.0852182im     0.0718905+0.0854369im     0.0492586+0.109011im     -0.0774313-0.179795im    -0.134407-0.100095im     -0.152915+0.0590273im     0.0909751+0.0266772im      0.221509+0.182532im      -0.276491-0.0348066im     0.190042+0.084424im       0.179102+0.0915848im      0.114154-0.195312im       0.148063+0.0781687im     0.136744-0.0229055im    -0.0154266+0.0258139im   0.0536632+0.000174045im    0.016472-0.279111im       0.160455-0.377286im     0.0884725-0.00213044im    -0.188325-0.158307im    -0.00130073-0.0773518im     -0.127163-0.0669891im  -0.000353184-0.0145816im   -0.0378137+0.075109im      0.0649693-0.156412im     -0.0443757+0.121076im
  0.0440919-0.119716im       0.133598+0.180031im      0.12089-0.00494481im    -0.0210194+0.0290574im   -0.0580478+0.175994im      0.0453269+0.0212762im       0.273171-0.025127im      0.0651045+0.00873312im    0.0978427+0.0842265im     0.0603372-0.237508im     0.139411+0.141102im     -0.250495-0.245175im      -0.323074+0.113978im       0.041497-0.00266065im    -0.078321+0.00146228im   0.0518399-0.101413im       0.189942+0.0103776im      0.140776+0.0966438im   -0.00421987+0.0543554im    0.0664169-0.024813im     -0.0667836-0.0305024im  -0.0451259-0.122839im     -0.0710718+0.170664im      0.0225327+0.0314634im    -0.113958-0.345619im     -0.0682637+0.0617222im     0.0966749+0.0513061im     0.0777531-0.115203im       -0.15777+0.0083829im   -0.0803708-0.111977im     -0.0150425-0.0685537im      0.259787+0.0622943im
 -0.0438443-0.0625507im     0.0521636+0.116835im   -0.0471319-0.124524im      -0.0196201+0.00692161im   0.0212647+0.0674477im     -0.197644+0.132328im        0.084926-0.0785359im     0.0321894-0.223917im       0.166906+0.237824im       0.048059+0.201368im   -0.0945945-0.0433769im     0.110982+0.0415633im    -0.0408487-0.122258im       0.258231-0.00632818im   -0.0974642-0.104273im      -0.12121+0.0905087im     0.0414372-0.0481398im    -0.0729377+0.045351im     -0.0888065-0.0661094im    -0.101359+0.0660172im    -0.0749984+0.163891im    0.0607734+0.040338im     -0.0594713+0.00801164im   -0.0778789+0.0545285im    -0.177234-0.169617im     -0.0207128-0.419129im      -0.100271+0.00412563im    0.0812379+0.0148609im     -0.046292+0.356875im      0.130374+0.204665im     -0.0807858+0.129294im     0.00235995-0.0346804im
  -0.043179-0.0400325im      -0.13314+0.0698343im  0.00190993+0.0805436im      0.0250838+0.0199949im   -0.0764405-0.0297552im     -0.127855+0.051214im     -0.00820628-0.16918im        0.275829-0.0872083im     0.0329644-0.140582im     -0.0654073+0.0381032im  -0.0969413-0.032133im      0.188217-0.209695im     -0.0634644-0.0350493im     0.0213106-0.15835im       0.0105684+0.00805567im  -0.0502768+0.0242014im     0.0319017+0.124086im    -0.00159123+0.0582411im      0.119051-0.0200343im    0.0347122-0.0926745im     0.0180874-0.164282im   0.00641329+0.0837724im     -0.038681+0.0138184im    -0.0422867+0.15431im      -0.249179+0.0159918im     0.0140238-0.0696602im     0.0735285-0.566504im     -0.0926499-0.258787im      0.0143425-0.196077im     0.0298726-0.0922521im    -0.0645768-0.163554im      -0.154078-0.00392393im
   0.180946-0.0152279im    -0.0521145-0.0430753im    0.154856+0.0856381im      0.0693266+0.177697im    -0.0432324+0.227492im     -0.0143887+0.0513931im     -0.0425517+0.0143898im     -0.344321-0.033875im    -0.00609007+0.0801105im    -0.0904389-0.16628im    0.00987498+0.289585im    -0.0198649+0.00575513im     0.144751+0.0202981im      0.215659+0.118181im      0.0564786-0.0104685im     0.157347-0.0308905im     -0.130533+0.0299621im     0.0335007+0.0550735im    -0.0901219-0.00837819im   -0.029144-0.161283im      -0.220066-0.102104im   -0.0359203+0.0656837im     0.0498985+0.00690746im    -0.132391+0.0805665im     0.137655+0.139604im      0.0576973-0.0729511im     0.0159465-0.0535303im    -0.0725443-0.359152im       0.102013-0.0241317im     0.244089+0.216839im     -0.0237508-0.0886625im     0.0790143-0.119031im
 -0.0732474-0.072634im       0.123556-0.201279im    0.0474655+0.199736im       -0.203846-0.0179521im    -0.131107-0.0149077im    0.00213086+0.022179im       0.0819633-0.0624324im   -0.00210098+0.23117im        0.058289+0.166875im      0.0228956-0.183045im    -0.116645+0.0648224im   -0.0638349+0.182101im       0.226907-0.163591im     -0.0282569-0.0103811im     -0.112033-0.0600323im   -0.0532643+0.14597im      -0.0732696-0.00448155im   -0.0212705+0.0627467im    0.00800622-0.0134609im    -0.129777+0.10879im       -0.101256+0.0486093im   0.0297167+0.0634579im     0.0338187+0.136948im      0.0215468+0.0968613im    -0.239151-0.0232995im     -0.152808-0.0955742im     -0.123242+0.0392734im      0.130511+0.128072im     -0.0430786-0.46438im     -0.0595982+0.0323766im     -0.270303-0.0483032im     0.0567236-0.0271868im
  0.0301354+0.211765im      -0.121117+0.0355896im   -0.112283-0.0423854im     -0.0592456-0.0683745im    -0.280735-0.0564478im     0.0239149-0.0481842im     -0.0128482-0.22885im       -0.124002-0.0202238im     -0.193412-0.0422418im     -0.109171+0.0925817im  -0.0113853+0.194823im     0.0997413-0.0130234im     -0.084526-0.015413im      0.0134083-0.0284364im    -0.0763377+0.062469im     -0.215802-0.0865176im     -0.164352-0.0949175im    -0.0991586-0.25094im       -0.139609+0.264055im     -0.131475+0.175226im      -0.322409+0.0516341im  -0.0352332+0.0652832im      0.091286+0.0135029im      0.035425-0.0861659im   -0.0778592-0.078776im      -0.104284-0.0678681im   -0.00246197+0.0738901im     0.0043314-0.115079im      -0.136832+0.0175895im   -0.0769786-0.231979im       0.231114-0.164701im      0.0335825-0.0143768im
  0.0764152-0.0509981im    -0.0544932-0.0528012im   0.0246993-0.061107im       -0.130398-0.0940962im     0.108314+0.0677176im     0.0528594+0.186946im        0.038395-0.0814682im    -0.0130453+0.0762438im    -0.0358145-0.09342im      -0.0971649+0.0848875im   0.0588298-0.0588536im     0.019069-0.0939683im    -0.0720234-0.255628im      -0.118156-0.100785im      0.0454825+0.057538im      0.100219+0.0473396im     0.0236182-0.234995im       0.146669+0.0520593im     -0.250765-0.211706im    0.00388786-0.126533im      -0.137353+0.100807im    -0.285421+0.0779589im     -0.164786-0.206807im      0.0958742+0.156745im    -0.0451361+0.0463436im    -0.0622133+0.027184im       0.128483+0.108173im      0.0432876+0.0703563im    0.00456876+0.0377056im    -0.167324+0.24994im       0.0258576-0.385628im       -0.10531+0.110293im
   -0.14856+0.00235234im    -0.123934+0.159302im    0.0511717+0.0506364im      -0.120736+0.116703im      0.214265-0.144147im       0.104259-0.0553689im      0.0391427-0.0812134im      0.002848-0.108284im      0.0864647+0.118541im       0.288226+0.162609im    0.0792156+0.042014im    -0.0675367+0.129029im     -0.0902198-0.10211im       0.0610024+0.0447714im    -0.0545948-0.0798953im     0.111285+0.0149634im    -0.0820373+0.0972906im    -0.0177813-0.0992247im      0.175967-0.0825244im    -0.319445-0.00679733im     0.156682-0.0765919im   -0.173564-0.156225im     -0.0210894+0.0633504im    -0.0940133+0.149586im      0.080589+0.24921im       0.0267058-0.10314im       0.0318921+0.0779505im    -0.0473144-0.0582702im     -0.108073-0.0332656im    -0.129861-0.147132im      0.0955639-0.282256im       0.162782-0.225052im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.18400124387639483 + 0.11683578306774539im
   0.12936795411108334 + 0.210127596916301im
  0.005074544035290958 - 0.08841458338817909im
    0.1717751973458114 + 0.13983463697414167im
  -0.17815428438351982 - 0.19511731526547932im
  -0.20933118855350513 + 0.12787104005920127im
 -0.010003402698304506 + 0.15173332557954775im
 -0.009592603674754752 + 0.053522685186069494im
  -0.20866685229903034 - 0.030468791819177395im
  -0.04648273422299846 - 0.048717351629389324im
  0.013282964619787688 + 0.16208094248973165im
  -0.25857867893530534 + 0.06496036905644241im
  -0.08001493175164823 - 0.04803677777110395im
  -0.05572579564989344 - 0.045282180969215935im
  -0.06590479272816584 + 0.07222625038270535im
  -0.06121018705302793 + 0.2647600011116411im
   0.12976238140543736 - 0.1587051237667822im
  -0.05259593875877386 + 0.07969800446979304im
  -0.02611039862958274 + 0.22732395978051745im
  -0.00879453970524342 + 0.012541202739235063im
   0.07901178578570477 - 0.17247866996974784im
    0.1266328237439154 + 0.04478903036260579im
  -0.14184225025158698 + 0.19506401933626996im
 -0.016957052927430438 - 0.03196478852306008im
  -0.07042048294364132 + 0.04980025831432354im
   0.14172864082536632 + 0.08940961272737286im
  -0.07721671588585473 - 0.089082389536904im
   0.04886993960646382 - 0.11654137161474414im
    0.2907103491803709 + 0.0im
 -0.028536027046663057 - 0.11760389329895152im
  0.014908049207399042 + 0.04717999680755147im
   0.13044841328046336 - 0.18323888006735584im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 8 July 2024 12:37">Monday 8 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

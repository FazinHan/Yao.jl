<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0893973-0.0840996im     0.175951+0.0305415im       0.101388-0.24155im      -0.0457438+0.0152606im     0.0798626+0.0850844im     0.209642+0.0887976im    -0.0288206-0.071927im       -0.238744+0.120776im     0.0785915-0.165354im    0.00555401+0.0551754im      -0.187646-0.00635148im   -0.0105482+0.0287396im       0.2463-0.0855368im    -0.0823037+0.194091im        0.047394+0.0250185im    -0.128777-0.0220838im    -0.0479561-0.078632im       -0.18601-0.0213335im    -0.0374901+0.0388286im        0.167816-0.117588im         -0.10791-0.0652999im    -0.102921-0.0127116im        0.40851-0.164033im      -0.258157-0.121981im     0.0495848+0.0830447im      0.106702+0.0622286im   -0.0199478+0.0287169im     0.0602788+0.0645202im      -0.1172+0.00581722im     0.0566484-0.238177im     -0.177227-0.0175343im   -0.0657069-0.0106016im
  -0.0428044+0.194519im      0.242272+0.0425182im       0.114465+0.0756395im    -0.0641401-0.0432954im      0.155567+0.204109im    -0.0783547-0.025242im      -0.186114+0.211464im       0.0415946-0.0941557im    -0.104128+0.00352743im   0.0817271-0.117878im      -0.0286612-0.100396im      -0.117681-0.00346473im    0.156138+0.0776804im     0.0792455-0.0609674im     -0.0220072-0.118882im      -0.11935-0.017049im     -0.0271265+0.0827606im    -0.0271959+0.0242162im     -0.132231-0.0142417im        0.219032-0.0369506im        0.309946+0.149238im     -0.128959-0.0379198im      -0.154053+0.0879548im     -0.150366+0.0542902im   -0.0471832-0.0656753im      -0.15796+0.271628im     -0.153652-0.0307037im     0.0607936-0.184739im    -0.0465007+0.0389492im       -0.26673-0.0864483im   -0.0188399+0.121811im     -0.224983+0.0392794im
   0.0227075-0.0691359im     0.172573+0.0689237im       0.116417-0.118108im      0.0309017-0.0605841im     -0.133094-0.139831im    -0.0882247+0.201179im       0.121077+0.136269im       0.0472633+0.0289627im    -0.215144+0.0474924im    -0.257385+0.161362im       0.0597906-0.134294im      0.0671684+0.143896im     -0.203088-0.109589im     -0.0106822+0.127172im       0.0144887-0.0753153im   -0.0367581-0.0916492im     0.0739152-0.311908im       0.152691+0.194128im       0.105075-0.0245216im        0.148045+0.0287586im       -0.078808+0.191933im    -0.0981639+0.0766556im      -0.105853+0.0372737im      -0.22275-0.0861719im    -0.165084-0.161776im     -0.0322599-0.0344622im   -0.0660065+0.130221im      -0.297993+0.0732272im    0.0419945-0.0328837im    -0.00689022-0.0597038im   0.00813483+0.121913im    0.00177297-0.120572im
 -0.00622085+0.0378293im     0.111905-0.0153283im       0.169813+0.0936009im      0.205972+0.0336178im    -0.0819563+0.0176827im     0.137996-0.0302675im    -0.0828635-0.148714im       0.0911217-0.125332im   -0.00545948-0.217602im     -0.284822-0.0220482im      0.0786452+0.11841im         0.12173+0.0560411im    0.0119123+0.0552128im      0.114254+0.00125248im    -0.0169629-0.111395im     0.0610321-0.083239im      0.0293364+0.135812im       0.342672-0.111342im       0.112212-0.0954358im    -0.000224381-0.0824577im       -0.279883+0.0378948im    -0.146331-0.0825547im      0.0835918-0.0458151im     0.0158362+0.14201im      -0.233244+0.107844im      0.0777988+0.174515im     -0.203597-0.142562im       0.140768+0.0200694im    -0.100378+0.0902175im    -0.00328151+0.223659im     -0.157926+0.0148561im   -0.0126771+0.15701im
  -0.0026519-0.188223im      0.173216-0.00995663im    -0.0833458+0.0864806im    -0.0921986+0.0179718im     0.0651336-0.163379im    -0.0435929-0.0178706im    -0.0355723-0.0402248im        0.12481-0.122151im     0.0931829+0.11396im       0.160017-0.01203im         0.242561-0.0878355im    -0.0339692+0.122076im    -0.0535382+0.0699807im       0.17312+0.0916772im      0.0408206-0.123409im     -0.118156-0.0494421im   -0.00232265+0.0168951im    -0.0833267+0.228004im      -0.412476-0.118385im       -0.0739631+0.114092im       -0.0872256+0.0141712im    -0.139594+0.0563606im       0.158766+0.112356im     -0.0268894+0.00123417im    0.133887+0.155063im     -0.0350316-0.0101684im   -0.0426273+0.116563im      -0.032525+0.159059im      0.184569-0.0122546im     -0.0285476+0.130497im     -0.326896-0.050332im      0.116376+0.210386im
  -0.0581686-0.0672861im   -0.0311099-0.163019im         0.10384-0.0863742im     -0.114501+0.0921685im     0.0522923-0.0744945im     0.116102-0.145419im     -0.0227025-0.074201im      -0.0923857+0.0630881im     0.208375+0.226941im     0.0699725+0.0992126im     -0.0585016-0.0283085im     -0.239755-0.0224795im    0.0686387-0.0873116im    -0.0613994-0.23927im         0.119985+0.178839im     -0.012439+0.0261234im      0.124548-0.0523808im     0.0969823-0.0241046im       0.27449+0.000918738im    -0.0565034+0.0950653im       -0.051409+0.300897im    -0.0654982-0.187788im        0.104219-0.0461262im    -0.0828789+0.0874375im     0.057307-0.176425im      -0.264471+0.0536335im    -0.141696+0.230878im      -0.038497-0.0117309im    0.0317439-0.0121461im     -0.0420551+0.264956im     -0.116768-0.127855im    -0.0959353+0.0142682im
    0.115151+0.00737763im   -0.153092+0.0733304im      0.0999389-0.0496581im      0.102791+0.118882im     -0.0480456-0.312144im     0.0990777+0.0540104im    -0.0533209+0.0570202im      0.0379123-0.283934im    -0.0956863+0.0844804im      0.15614-0.0768045im     -0.0191775+0.0296022im   -0.00709372+0.158288im    0.00484228-0.01442im       -0.316723-0.0208937im     -0.0404203-0.134348im      0.226406-0.0092904im     -0.145225+0.134194im      0.0738606+0.0369169im     -0.109541+0.0276705im      -0.0566281+0.00149176im     -0.0463258+0.188565im    0.00366112-0.196813im      -0.0260993-0.029146im      -0.192526+0.094641im     0.0631174+0.219801im       0.129464-0.166376im    -0.0701983+0.172062im      0.0821593-0.0987389im   -0.0897009-0.224644im      -0.0297675-0.16951im       0.122361-0.016819im      -0.19314+0.0283934im
   0.0329022-0.377432im     0.0185824-0.129869im        0.075031+0.113627im       0.117785-0.0315257im     -0.135922-0.0418339im   -0.0636995-0.262366im     -0.0780221+0.0571516im      0.0721808-0.22091im      -0.118069+0.00694905im   -0.112422-0.0999372im       0.153221-0.0124641im     -0.204267+0.00838433im    0.230495-0.124672im      -0.113845+0.026573im      -0.0593663+0.254883im     -0.053309-0.0169386im     -0.182676-0.0617727im    -0.0177095-0.0272414im    0.00472313-0.0978225im        0.199644-0.0634131im       0.0536133+0.00545516im    0.348173+0.191476im      0.00462127+0.0455348im     -0.132829+0.182216im    -0.0367111-0.0735741im      0.014319+0.0356748im    0.0587223-0.159895im     -0.0514937+0.0341846im    0.0110133+0.0397688im       0.117403-0.0471329im    -0.070781-0.153977im     -0.010486-0.0175019im
    0.299282+0.0823499im    -0.260686-0.0311011im      0.0420123+0.186377im      0.0493558-0.0955379im      0.201269+0.0494274im     0.148275-0.259065im       0.190998+0.00359776im     0.0424634-0.0785412im     0.151858-0.0826255im   -0.0842191+0.0632011im     -0.0903295-0.242722im       0.133516+0.0121832im   -0.0147106-0.204919im     -0.0846955+0.00127383im      0.169204-0.0627265im   -0.0675153-0.120419im       0.120648-0.0980628im     0.0699713-0.121076im      -0.204949+0.12592im         0.0377716+0.00108638im      -0.112222+0.00963826im   0.0480184-0.00291658im       -0.1467+0.00786668im   -0.0833138+0.0420527im    -0.131375+0.0623819im     -0.198605+0.0210029im     0.130806+0.0933909im     0.0933083+0.0957133im    0.0849719+0.135038im       -0.222539-0.182421im    -0.0395723-0.0480188im     0.133587-0.00967268im
    -0.24934-0.106572im    -0.0455269+0.0415967im    -0.00435773-0.0591613im    -0.0901116+0.0866327im     0.0120339+0.164638im     0.0500172-0.155726im      0.0265879-0.00133712im    -0.0243327+0.0630788im   -0.0281358+0.177209im      0.146674-0.0462824im      -0.189676-0.0432467im    -0.0432087+0.0220396im   -0.0210647-0.181291im      -0.105231-0.0920158im     -0.0225822-0.258155im     0.0131857-0.106473im      0.0974253+0.0853208im      0.334071+0.119197im       0.116142-0.148091im         0.139615-0.0641099im       -0.144487-0.0693537im   0.00648764+0.214936im       -0.190629+0.136757im      -0.017031-0.196463im      0.283273+0.231071im       0.127268+0.175956im    -0.0325848-0.0644558im    -0.0700173-0.0164849im    -0.100815+0.049125im        0.035186-0.0853442im   -0.0486963-0.132818im      0.124616-0.0372927im
    0.180023+0.0723743im   0.00579209+0.0538872im      -0.033376-0.0211566im      0.026402+0.0251265im   -0.00930749-0.137091im      0.129477-0.15968im       -0.135206+0.0707853im       -0.18262+0.0752002im   -0.0690321+0.254871im    -0.0308441-0.0834108im       0.334524+0.0838702im    -0.0740401+0.0212149im    -0.107275+0.0679286im    0.00896311+0.114689im        0.226617+0.0920666im    -0.068889+0.0375774im    -0.0668763+0.093479im      0.0637203-0.0798594im      0.187215+0.0505664im        0.115637-0.112141im         0.117495-0.118416im     -0.169219-0.0495638im     -0.0574719+0.110387im     -0.0750167-0.0879216im    0.0605297-0.0488191im      0.120328+0.112406im     -0.107722+0.00184936im     0.300529+0.24405im       0.103403-0.125321im      -0.0588077-0.0541268im     0.054695+0.0972119im     0.286458-0.195796im
   -0.110264+0.127752im      0.031207-0.123105im       -0.133262-0.0195234im     0.0427974-0.0496618im     -0.236233-0.103306im      0.173259-0.0238734im    -0.0548928-0.0573388im     -0.0525917+0.144931im     -0.153523-0.333889im      0.133926+0.0501561im      0.0165053-0.0315879im     0.0875113+0.09678im      0.0890187-0.124947im       0.101291-0.0299032im      0.0631862-0.0223953im     0.207869-0.0115761im    -0.0769639-0.187872im       -0.12524-0.0898322im     -0.168557+0.0110049im      0.00253912-0.209149im     -0.000871593-0.0418027im     0.102189-0.123172im       -0.079227+0.33174im      -0.0940409-0.015078im      0.104391-0.0624918im     -0.154222+0.100197im     -0.159713+0.0948105im    -0.0541962-0.146929im    -0.0981153-0.165673im      -0.0334589+0.163866im    0.00750424-0.173472im      0.233386-0.046479im
   0.0735373-0.0735978im    -0.127913+0.00911469im     0.0720755-0.0869745im     -0.124504-0.0309268im     -0.011219+0.173246im   -0.00565317+0.271843im    0.000941286-0.191943im       0.0662873+0.184501im    -0.0972616+0.113844im     -0.180789-0.0438587im      0.0791558+0.00338904im    -0.199168+0.152802im       0.28183+0.0369067im    -0.0970459+0.00194654im    -0.0911437-0.18411im       0.352342-0.0750594im    -0.0904415-0.00245934im   -0.0836229-0.0782303im     0.0589141+0.0590574im       -0.069424+0.00139672im      0.0527481+0.10678im       0.121495+0.122341im       -0.114348+0.0905212im     0.0530901-0.0314612im    0.0029267-0.037125im      0.0124648-0.0612516im     0.134153+0.0993142im      0.176047+0.114156im     0.0151336+0.0764895im      -0.231246+0.0719289im    -0.294502+0.182938im     0.0967927+0.0458905im
   0.0826143+0.105178im    -0.0710149+0.129143im      -0.0403541-0.16431im        0.195644+0.175871im     -0.0896354+0.10958im     -0.0714942-0.187688im      -0.129117+0.0874563im     -0.0849307-0.0102559im      -0.1029+0.138813im    -0.0410211+0.0879069im   -0.000587738+0.0814871im    -0.0946189+0.222277im     0.0558882-0.175562im       0.331075-0.0184564im      -0.236594-0.0692924im    -0.130627+0.254615im      0.0931125-0.163376im     -0.0187929-0.0289508im    -0.0563929+0.069642im       -0.0455735+0.286214im        -0.069558-0.0318566im     0.159054-0.0504038im   -0.000949152+0.0125941im     0.0576802-0.176273im     -0.161819+0.0685981im     0.0139837+0.0662178im    0.0814776+0.0754635im      0.109997+0.132212im     -0.186426-0.152043im      -0.0845181+0.00436474im  -0.0041567-0.149556im    -0.0975095+0.0925464im
  -0.0162933+0.15626im      0.0302703+0.162794im       0.0899708-0.0704762im   -0.00557106+0.256788im       0.150025+0.082801im     -0.049066+0.0817145im    0.00303929-0.160835im        0.020876-0.28454im      -0.134409+0.161136im     0.0726161-0.0333768im      0.0964819+0.0329328im     0.0890345+0.0944728im    -0.032059+0.0117417im      0.185935-0.103402im         0.43613-0.102341im     0.0107612-0.119953im      0.0602928-0.276119im     -0.0710713-0.109135im       0.128093+0.0935959im       0.0367062-0.101875im        0.0675436-0.0421408im    0.0875816+0.220078im        0.104818-0.0890481im    -0.0446691+0.190404im     0.0922513-0.024822im     -0.0332771-0.172133im      0.066984-0.0932747im   -0.00108086-0.173206im     -0.134838+0.00178603im     0.0632177+0.0233632im   -0.0189035-0.0931328im    0.0855835+0.0915797im
   -0.016528+0.0547749im    0.0147588+0.254092im       0.0541835-0.126843im      -0.124981+0.153517im      -0.152538-0.148786im     -0.196797+0.0210498im     -0.209474-0.0691449im       0.208776-0.0512891im     0.162268+0.155919im    -0.0593029+0.0120855im     -0.0940768-0.0922074im      0.203171-0.22466im       0.160821-0.0670684im     0.0827387+0.0499287im     -0.0598991+0.206873im        0.2607+0.0387235im    -0.0449894-0.0145559im     0.0363321+0.00370637im    -0.102228-0.0584189im      -0.0631264-0.0210481im       0.0563325-0.0458465im    0.0120948+0.0396903im       0.047644-0.215794im    -0.00345721+0.0254095im   -0.0695677+0.0248374im      0.025788+0.251856im     -0.147553+0.150953im     -0.0644205+0.0154001im    0.0369121+0.176026im       -0.172101-0.123299im     0.0832348-0.139131im      0.252354-0.106457im
    0.101215-0.0176925im   -0.0605106-0.0561149im      -0.271648+0.195623im      -0.153792-0.059642im     -0.0974085-0.0114118im    -0.108166+0.0891945im     -0.150241-0.145511im        -0.03951-0.189902im      0.118204-0.0936852im     0.155785-0.124441im        0.149162-0.0590833im    -0.0865274-0.0824464im     -0.12539-0.144106im      0.0565697+0.0632861im      -0.185311-0.00944685im    0.012382-0.106111im       0.266269-0.175648im     -0.0393904+0.0651342im      0.307429+0.042167im         0.104906-0.27734im         0.0142886-0.0337873im     0.122314+0.00320204im     0.0712994+0.0100909im     0.0956806-0.0483706im   -0.0932753+0.177014im     -0.0474284+0.023952im     -0.156253+0.231875im      0.0566205+0.0628477im    -0.109264+0.00358318im    -0.0170233-0.1324im      -0.0263826+0.163944im     -0.153791+0.0819004im
  -0.0467685-0.0491045im    -0.210206+0.113273im      -0.0584436+0.0586696im    -0.0414191+0.216561im       0.248665+0.0473372im    0.0231113-0.0693256im      0.105515+0.0861746im      -0.286769+0.035957im    -0.0769121+0.0427677im   0.00706723-0.0450499im       0.160625-0.0429618im     0.0474679-0.304183im      0.174124-0.0783144im      0.163572+0.100407im       -0.143573-0.0281094im     0.287692-0.0110957im    -0.0543836-0.189517im       0.120175-0.00447599im    -0.175198-0.171091im         0.249096-0.0897605im      -0.0774711+0.0026325im    -0.189411-0.11534im       0.00378225-0.0333422im      0.102649+0.13249im     -0.0475088-0.0324857im     0.0105714-0.0926747im    0.0592766-0.0459136im     -0.109557+0.0355873im     0.069116-0.156997im       0.0568695+0.136371im    -0.0511846+0.0835137im    -0.159337-0.128912im
   -0.115395+0.19288im      -0.176098-0.0367961im      -0.274489+0.00200279im    0.0238349+0.159114im        -0.1013-0.186343im    -0.0662554+0.123502im      -0.213233+0.0533231im      -0.130415-0.0646479im    -0.109857+0.0143362im    -0.145772+0.0413711im     -0.0851247-0.274817im     -0.0175026-0.00130633im   0.0333693-0.0209174im   0.000909412-0.0209801im     0.00475483-0.00824839im  0.00930509+0.134747im      0.0570618+0.182025im      -0.210563-0.125724im       0.153112+0.0269314im       0.0178132-0.000531693im     -0.180586+0.0516623im    -0.189843+0.117794im       0.0176634+0.182533im      -0.257481+0.0871204im     0.036403+0.115779im     -0.0889764+0.0336357im     0.184593-0.214878im     -0.0645362+0.112474im      0.193211+0.223576im       0.0252161+0.0135359im   -0.0242205-0.0372845im    -0.117996+0.0671499im
   -0.054395+0.059709im    -0.0624603+0.0957155im       0.134766-0.192655im      -0.067853-9.0893e-5im    -0.0950342+0.0856231im     0.071796-0.125883im     0.00478255+0.174014im        0.273861+0.044817im     0.0293382-0.0893158im    -0.200492-0.00207303im     0.0618918+0.00711959im    -0.201635-0.0179859im    -0.230558+0.135924im      0.0109268-0.16388im        -0.111069-0.17558im      0.0450557-0.0293587im  -0.000160874+0.0793857im     -0.193101-0.0768888im    0.00405086+0.00022448im       0.394308-0.0885891im      -0.0930608-0.195396im     0.0846151-0.1291im          0.144079-0.157295im      0.0173409+0.139396im      0.204842+0.109651im       -0.18814-0.0654914im    0.0198347+0.139482im      -0.103476+0.158204im     0.0723956-0.0420599im     -0.0359046+0.0636845im     0.138762+0.0163785im     0.062364+0.0593674im
   -0.174025-0.0209763im     0.310563-0.155471im    -0.000413605+0.209979im       0.107184+0.133819im       0.183798-0.0372342im  -0.00632371-0.0131282im       0.18055-0.0703589im       0.019801-0.0195379im    -0.215715+0.0745391im    -0.168805-0.0836935im      -0.154808-0.0736391im    0.00447231-0.0199508im    -0.142799-0.0767036im    -0.0787461+0.147523im       -0.160103-0.0446266im     0.181998+0.0511581im       0.13626-0.00463648im    -0.146142-0.129996im      0.0858229-0.0594332im      -0.0929188+0.132535im         0.247467-0.156367im     -0.027173-0.059003im      -0.0495417-0.164977im     -0.0957251+0.0303534im   0.00283144+0.193078im      -0.206198+0.00971873im   -0.047667+0.11841im        0.201895+0.0597372im    0.0150514-0.0829419im       0.154929-0.00685247im   -0.129352-0.143968im     0.0628051-0.172556im
   0.0675048+0.0734395im     0.112176-0.0515906im      0.0583127-0.0678094im       0.11246+0.0943619im     -0.104599-0.102569im      0.034382+0.0367736im      0.126666-0.0223014im     -0.0489126+0.158981im     -0.246344+0.148535im       0.29798-0.188285im       0.0309549-0.121937im      0.0492417-0.0257951im   -0.0837263+0.104623im     -0.0594608+0.180608im        0.107014+0.0764908im    0.0126466-0.0254529im      0.169895+0.166878im    -0.00666514-0.086083im     -0.0976163-0.0762946im        0.212868-0.0538795im       -0.194553+0.119786im      0.340485-0.0108129im      0.0860593-0.15228im        0.111813-0.183696im      -0.15507+0.0218602im    -0.0504188+0.177828im      0.185802+0.0604173im     0.0371412-0.151826im      0.115977+0.143831im      -0.0572761+0.194795im     0.0190725+0.0677744im   -0.0639965+0.0197729im
   -0.337027+0.2084im       0.0468683+0.0904193im      -0.060069+0.136077im       0.132011-0.234975im      0.0211624-0.0379292im     0.067431+0.0160448im    -0.0751065+0.0830619im       0.158419+0.0968476im    0.0093633+0.12527im      0.0104883-0.0108567im       0.138572-0.0583646im    -0.0228969-0.0353271im     0.236896-0.00263825im    -0.357746+0.162954im       0.0458672-0.0052177im    -0.183656+0.0793147im    -0.0521555-0.373619im      0.0196386+0.029877im      0.0494364+0.180996im       0.00308099+0.04786im         -0.120385-0.0401417im   -0.0510085+0.0208692im      0.0649744-0.0746024im      0.168457+0.113881im     0.0298305+0.227533im      0.0869518-0.00511226im    0.019346+0.0135526im     0.0302038+0.0186738im   -0.0201149-0.000591733im    -0.164781+0.189727im     0.0600092-0.0576718im   -0.0545768-0.0635549im
  -0.0797581-0.0210451im    -0.136147-0.00220522im     -0.197246-0.093687im       0.309197-0.0457002im     0.0735832-0.0158113im   -0.0758409-0.239743im      0.0363057+0.000963615im    0.0545298-0.16001im       -0.11272-0.0376206im   -0.0904585-0.105339im       -0.358149-0.0587044im     0.0898638-0.00515271im    0.127065+0.223067im      0.0700493+0.0132921im       0.146572+0.106807im     0.0305984-0.0980404im     -0.174967+0.00301795im  0.000896323+0.102835im       0.162934-0.0874391im        0.086234-0.00772027im      0.0832471-0.0599798im    -0.025134+0.0893383im       0.131112+0.0562791im     0.0696153-0.307121im     -0.012691-0.00563394im   -0.0257345-0.223321im     -0.197203+0.196448im     -0.0255497+0.0245027im     0.112147-0.0508522im      -0.182366+0.0932443im   -0.0962366+0.138463im    -0.0258912+0.0749058im
   0.0792994-0.111343im     -0.203247+0.121717im       -0.305148-0.0607334im    0.00987425-0.0655282im     0.0650625-0.0578961im  -0.00906768+0.223841im       0.261471+0.121405im       0.0712571+0.0477955im    -0.089889-0.057219im    0.00434069-0.0392819im      0.0783168-0.0659553im    -0.0691749+0.126635im      0.105022+0.0801346im      0.187036+0.0605421im    -0.00624222+0.00514735im   -0.128687-0.151949im      -0.129386-0.0182988im      0.197283-0.253824im      0.0973709+0.0797402im      -0.0675293+0.216599im        -0.012367-0.0879115im    0.0973534-0.062486im       0.0174707-0.153839im     -0.0415187+0.126059im      0.237491+0.0155548im    -0.0426258+0.344399im     -0.211778+0.0510304im    -0.0152648-0.139583im      0.115896-0.000382723im    0.0990517-0.087722im    -0.0435577-0.0205993im   -0.0860906-0.0147802im
   -0.107626-0.0249428im   -0.0957644-0.00053479im     0.0276743+0.105096im      -0.302284+0.0722306im    0.00815141-0.297214im     0.0958077+0.00125829im    0.0659145+0.44063im      -0.00394432+0.0352526im    0.0790247+0.0357039im   -0.0341533-0.0682755im       -0.12842+0.224754im       0.142077+0.11287im      0.0961717+0.197027im       0.135048-0.0324787im     0.00254264+0.0306811im     -0.10101-0.175631im      0.0343302-0.00788557im    -0.190724-0.0839009im      0.041948+0.0267087im       0.0375644-0.0793101im      -0.0173328+0.158188im     0.0903337+0.0298984im       -0.13953-0.0322263im     0.0689006-0.0585636im     -0.17998+0.158574im    -0.00178928-0.0647155im   -0.0424331-0.0529513im   0.000694631+0.09963im      -0.268111+0.0735521im      0.0337179+0.0462692im    -0.217137-0.0525735im    0.0531019-0.150945im
    0.134572+0.0167134im    -0.179252+0.123332im         0.11038-0.0718791im      0.114229-0.158867im     -0.0220046-0.204551im     0.0600076+0.209468im      -0.109471-0.040267im        0.159566+0.0434225im    -0.179314-0.0567047im     0.160083+0.0474053im      -0.129187-0.202576im     -0.0675068-0.0672658im    0.0519481-0.0615871im     0.0784752-0.0818723im     -0.0571365+0.0221142im    -0.211163+0.0928096im      0.214023+0.0266884im      0.186263+0.0778945im    -0.0325479-0.17144im         0.0858648-0.114165im         0.266415-0.177455im    -0.0340553-0.155623im      -0.0562234-0.070836im       0.010172+0.0756152im    0.0960726-0.0992572im     0.0611452-0.227045im     0.0429732-0.0560345im      0.122951+0.114961im     -0.139414+0.155634im       0.0467384+0.153315im     -0.238551-0.113276im   -0.00259385-0.121449im
   0.0343943+0.117112im      0.157819-0.210732im       -0.120301-0.184568im      -0.197535-0.1251im       -0.0794202-0.194992im     -0.113442-0.00481979im     0.132217-0.0141148im      0.0357998-0.0387747im    -0.113386-0.0349558im    -0.102555-0.223422im      -0.0417589+0.0233403im    -0.0215442-0.00426822im    0.073256-0.203378im      0.0346229-0.235782im       0.0144034-0.0210149im   -0.0212213-0.184509im      0.0218677-0.115892im      0.0766568-0.0257542im     0.0130291-0.266958im        0.0366406+0.150199im      -0.00530244+0.122565im     -0.108571-0.116051im        0.261504+0.0460902im      0.238083+0.0316852im     0.017249+0.0350086im     0.0126595-0.0363253im     0.174363-0.228173im       0.184851+0.00589076im    0.055063-0.108935im       -0.205499-0.19812im       0.099958-0.0514757im    0.0620826-0.0458912im
  -0.0379254+0.157837im    -0.0970806+0.066722im        0.110509-0.0631876im    -0.0459479-0.0529969im    -0.0680207+0.134144im    -0.0816125+0.0380938im     0.0499084-0.192877im       -0.174414+0.0865123im    0.0420874-0.0175356im      0.12101-0.275971im      -0.0232139+0.0386725im    0.00882991+0.238442im    0.00532917-0.0276885im      0.063128-0.0678912im      -0.244018+0.0884535im    -0.192793-0.153666im      -0.147499+0.018187im     -0.0716124+0.137019im      0.0255405+0.000317071im      0.117863+0.00985669im     -0.0932832-0.0156359im    -0.112978+0.112204im       -0.151566-0.0623499im     -0.110553+0.172352im     -0.241452+0.0787082im    0.00126103-0.193403im     -0.147236+0.119175im       0.124463-0.105193im      0.343741+0.0404645im       0.087945+0.0657094im    0.0508703-0.236266im     0.0882458-0.12177im
   0.0736933+0.0433288im       0.1428-0.0629986im     -0.0269336+0.265071im     -0.0165675+0.191804im       -0.11336-0.0641797im    -0.121377-0.116293im     -0.0960793+0.0259273im      0.0358025+0.158485im    -0.0269003+0.0470108im    0.0716886+0.33245im        -0.042976+0.0933934im    -0.0918355+0.185927im      0.160277+0.10573im        0.034079+0.0216168im     -0.0759933-0.0924682im   0.00184912-0.053892im     -0.0442819+0.00482958im     0.262325-0.103928im      0.0951246+0.163573im         0.104358-0.148277im         0.107602-0.0897291im    -0.060211-0.201462im        0.119358-0.0240592im      0.108131-0.0465585im   -0.0538964+0.0712055im     -0.011094-0.192584im      0.168035+0.0164503im     -0.157966-0.236769im      0.274114+0.061928im     -0.00363354-0.214532im     -0.129388-0.0644731im    0.0849502+0.0146426im
    0.157182-0.102897im     0.0954008-0.0509286im    -0.00927305+0.126826im      0.0341165+0.00370613im    0.0457112+0.0271601im    -0.077906-0.0119875im     -0.124516-0.169526im      -0.0746463+0.0443803im    -0.016528-0.0420784im   -0.0069203-0.0520093im      -0.107523+0.0839134im     0.0373289+0.400906im      0.101779+0.00506564im    0.0789724-0.000658306im     0.157106+0.0232034im     0.118425+0.0460308im     0.0650745-0.00504374im    0.0199953-0.00773909im    -0.133863+0.00722791im       0.103351+0.0589214im       0.0131755+0.0749306im    -0.034426+0.00386544im     0.0090397-0.00124573im      0.19355+0.0834457im     0.229499+0.124716im     -0.0614808-0.0102311im    -0.112022+0.0199615im     -0.144302+0.283684im    -0.0584122+0.284115im       0.0288808+0.0894827im      0.32003+0.0758997im    -0.191431-0.344727im
   -0.170455-0.082154im     -0.166434+0.0294454im      0.0254302+0.0252347im      0.260556-0.131486im       0.108229-0.023024im      0.253628+0.190802im      0.0952263+0.0302146im      0.0554277-0.196094im     0.0846076+0.0118766im   -0.0408074-0.0325674im      0.0884189+0.185683im       -0.19323+0.0371206im   -0.0899535-0.0863463im      0.193727+0.0232932im     -0.0516581-0.0659856im    0.0489603+0.217672im    -0.00646973+0.0856949im    -0.0386545+0.0561219im   -0.00180607+0.00681912im      0.0295026-0.174256im        0.0952555+0.231471im     -0.134236+0.127535im        0.236745+0.0644809im      0.138234-0.13243im     -0.0670819+0.00216639im   -0.0893797+0.113424im      0.147505+0.0932901im    -0.0341604-0.199493im     0.0602631+0.146925im      -0.0521061-0.133078im     0.0348906-0.159733im       0.10928-0.254993im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.07489620410653691 - 0.018937133420826226im
   -0.06545801523211782 + 0.08393127418590551im
   -0.05974178260730837 + 0.16992408643703427im
   -0.22432575637555416 - 0.26704886961129637im
   -0.15293723087421535 - 0.13857097101200108im
   -0.11472176996040845 - 0.050322308837692856im
   -0.06455268286891129 - 0.1228345613471524im
    -0.0354172824004777 - 0.10409051744371667im
   -0.03716230818564283 - 0.06420217329395535im
  -0.008646077088074468 + 0.13815029589061686im
 -0.0074131851945520005 + 0.12272578098026224im
    -0.0770772177761324 + 0.1790251165251922im
   -0.05805986930890603 + 0.15816866051762593im
    0.12501511389238096 - 0.026365398440628993im
   -0.07537385949796148 + 0.1373510326402042im
   -0.04476530822852725 + 0.17205771554623717im
   -0.16656452348936177 + 0.2410082357825032im
   -0.08250424684741398 + 0.1739532906014919im
    0.11770483043464885 - 0.033453068283292635im
     0.1377192097216109 + 0.18273061739691093im
    0.09059829819733328 - 0.07837632850507015im
   -0.08442363095191208 - 0.03429494227011743im
   -0.04413487180029285 - 0.07710316486825272im
     0.1416019951880851 + 0.046145904340647574im
  -0.019664696562253427 - 0.0077440399896288505im
  0.0008634489162778494 + 0.056754105109447124im
  -0.012119878906012179 - 0.21909578655093498im
    -0.0972182124061083 + 0.17043308312423022im
    0.02473717659667851 + 0.09679515830429011im
   -0.06620622699576884 + 0.14670517557413437im
    0.10476745215956328 - 0.22965675699298463im
     0.3570422826006067 + 0.0im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 03:59">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

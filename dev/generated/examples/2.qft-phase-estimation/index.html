<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0182695-0.148295im     0.0163586+0.146731im      0.0113088-0.0301539im    -0.0986414-0.014205im     -0.0283817+0.180526im     0.184365-0.0244233im    -0.0389073+0.109086im      -0.13775+0.0880432im   -0.0204402+0.0319108im     0.0978353+0.12549im        0.220079-0.103864im       0.205891+0.203065im       0.236867+0.027245im     -0.0722077+0.116032im     0.122564-0.0496888im      0.116177+0.319527im      -0.186832-0.212613im      -0.203398+0.00433651im    0.0994204-0.209887im      0.0941671+0.0226363im     -0.238136+0.0940669im     0.179811+0.0356758im      0.149175-0.175133im      0.0613268+0.0644417im     0.0606759+0.181505im      -0.054459+0.0686802im    -0.0210909-0.0604532im   -0.00276939-0.106104im     0.00985622+0.141037im      0.0697991+0.0094661im   -0.0748686-0.0971762im     0.0236149+0.11629im
   0.0885329-0.0749043im    0.0848347-0.081661im       0.157908-0.133883im     -0.0565433-0.102145im     -0.0650204-0.224876im    -0.118373-0.195173im       0.129281+0.0946909im    0.0802022+0.00434808im  -0.0689305+0.179027im     -0.0766585-0.0353105im     0.0488452-0.072801im      -0.127066-0.167398im       0.164131-0.100544im        0.29776-0.124993im    -0.132929-0.192998im      -0.204597+0.138648im     -0.0194622-0.121958im      0.0553678-0.0823199im      0.039605+0.00728953im   -0.0310364-0.0274625im      0.006127+0.0753428im    0.0426938+0.0880533im     -0.112761+0.0225065im    -0.0724363+0.227666im      0.0130404+0.148356im      -0.140721-0.253617im      -0.020084+0.0114646im    -0.0235194-0.277437im       0.185961-0.0548104im     0.0248981-0.00627161im   -0.078338+0.0933224im     -0.175543+0.204342im
   0.0501958+0.238358im      0.151818-0.0528343im     0.0818886-0.126649im       0.270943-0.0963359im    -0.0971645-0.0300378im  0.00800564+0.326841im     -0.0902633+0.0752934im   0.00169944+0.0540758im    -0.104534-0.0248551im      0.230905-0.139755im      -0.163683-0.0710009im   0.000103691+0.202123im      -0.127629-0.0342647im    -0.0337585-0.0323025im  -0.0495093+0.105108im     -0.0281417-0.231934im      0.0142656+0.0282184im   -0.00362572-0.163466im      0.0641457-0.0467709im     0.0545868+0.110683im      0.0526307+0.207915im     0.0140314+0.0734018im      0.115949-0.262475im      0.0360269+0.0987173im     0.0487517+0.136658im     -0.0993596+0.0188453im      0.156217-0.0688168im     0.0169654+0.0351234im      0.105378+0.104596im      -0.128857-0.120143im     -0.251707+0.163011im     -0.0601641+0.166732im
   -0.372673+0.0810766im    0.0189138-0.124796im     -0.0597374-0.00112829im  -0.00868121-0.142172im      0.0284931+0.0822377im  0.00530138+0.138545im     -0.0897585+0.0638991im    0.0346422-0.0266582im   -0.0666302-0.128681im     -0.0830369-0.038876im     -0.0453609+0.245127im       0.131361+0.0497139im     0.0739359+0.125557im      0.0350274+0.11413im    -0.0529488+0.0773133im    -0.0968522+0.139972im      -0.209277+0.00763949im      0.29497+0.0488888im     -0.173693-0.0735787im    -0.0403043-0.124739im     -0.0251508-0.0719793im    -0.166561-0.0481849im    0.00810477+0.0922252im    -0.0309799+0.105217im       0.157344+0.0320279im     0.0173465-0.120566im       0.255559+0.178239im      -0.198061-0.00087796im      0.18802+0.105234im      -0.117975+0.185848im     0.0413344-0.196772im     0.00119102+0.186141im
    0.154725+0.0139065im     0.111148-0.246776im      -0.215397+0.0142323im      0.280573-0.198294im     -0.0123481+0.0912063im   0.0741645-0.114845im       0.117015-0.00308387im   0.0478461+0.183576im     0.0688557-0.000789228im   -0.232396+0.150605im      -0.103098+0.0707876im    -0.0618562+0.150487im      0.0367782-0.135242im     0.00712391-0.110288im     0.152755-0.238087im       0.141396-0.0606086im     -0.100472-0.129032im      0.0234884-0.049024im      0.0144156-0.0612512im     0.0512024+0.123629im      -0.191524-0.149586im     -0.133466-0.0388163im    -0.0652971+0.23569im      0.00784726-0.0816737im     0.0131866-0.0502705im     0.0312672+0.177043im       0.238648+0.00644im     -0.00905797-0.128233im      0.0385277+0.011595im      0.0313754-0.109241im     -0.243418+0.00170222im   -0.0530554-0.142823im
   0.0150524-0.0266237im     0.123004+0.183332im    -0.00334219-0.354462im     -0.0375138-0.269399im       -0.14567+0.0750976im   -0.254393-0.048088im      0.0546862+0.0587274im    0.0416141-0.033393im    -0.0369586-0.0467294im     -0.141044-0.014014im       0.255168+0.105509im      -0.182804-0.0698213im    -0.0100718+0.269374im      -0.202714+0.0297298im   0.0295797-0.107155im       0.151468-0.210891im      0.0778187+0.124877im      0.0374682+0.0637822im     0.0221262+0.100191im      0.0256646+0.0130125im    -0.0669478-0.00147419im    0.149836-0.0958134im    0.00628647-0.158176im        0.12337-0.0611444im      0.152829+0.101972im       0.058708-0.107849im      0.0273474-0.105295im       -0.20893+0.00808108im     0.128109+0.047543im      0.0913282+0.0748345im   -0.0108376-0.0514591im    -0.0478467-0.232935im
   -0.102861+0.196887im     0.0576383-0.159173im      0.0959493+0.0468402im     0.0382674-0.131559im       0.136068+0.206232im    0.0554951-0.0384203im     -0.101022-0.0110929im     -0.20666-0.194827im     0.0400223+0.190982im       0.248516+0.0974469im    -0.0911493-0.0596497im     0.0346938-0.125173im     -0.0703978+0.138564im      0.0420403-0.0874868im   -0.138589-0.249336im      -0.124495-0.0501094im     0.0104793-0.162981im     -0.0241981+0.0719173im    -0.0656925+0.0244196im   -0.00367472+0.158068im       0.221627-0.0688538im     0.233752-0.241855im      0.0895179+0.0238827im     0.0844114+0.0536259im    -0.0848304-0.0589744im    -0.0505924+0.097767im       0.189151-0.108651im     -0.0603984-0.0902775im    -0.0851338+0.0196978im      0.300147+0.0958054im     0.112293-0.0798383im    -0.0849728-0.0315488im
  -0.0969796+0.153932im     0.0243081+0.0760607im    -0.0882083+0.0797256im     -0.255262+0.0939248im    -0.0805013-0.14651im     -0.048385-0.18592im        -0.16754-0.123213im      0.085527-0.177356im     0.0236303+0.171621im      -0.109381-0.195791im      -0.351102-0.0468582im       0.11803+0.114755im      0.0122341-0.00499886im   -0.0640681-0.077521im    0.0879621+0.0194002im    -0.0576993+0.088298im       0.196143-0.101624im       0.171237-0.0354588im      0.047179-0.00114242im     0.129021+0.0174438im     -0.297712+0.0685212im      0.08513+0.109432im     -0.0528967-0.230854im     -0.0272473-0.189531im       -0.11496-0.0537661im     0.0412784+0.0964058im      0.107329+0.0165937im     -0.277841-0.0866551im     0.0658759+0.0255133im      0.103363+0.0470042im   -0.0703403+0.0516972im    -0.0315898-0.0956829im
   0.0732325-0.159175im       0.13474-0.0991904im     0.0526913+0.11881im        0.160611-0.00189045im  -0.00452954-0.194655im     0.113845-0.0411328im      0.027745-0.0379598im    -0.151227-0.0834629im   -0.0377192-0.105629im      0.0977479+0.149289im       -0.14953+0.0696848im     -0.212469+0.0980369im     0.0716536-0.081789im      0.0673394+0.312749im    0.0817753+0.0473378im      0.147143-0.0128974im      0.142444+0.137608im       0.062561-0.0477495im      -0.19815+0.105286im      -0.028068-0.00211463im    -0.236555-0.245302im      0.217142-0.0739315im    -0.0681493-0.089141im      0.0995469+0.111603im      0.0893553-0.0475163im      0.103825-0.0379602im    -0.0693874-0.101643im      -0.182646+0.0405845im    -0.0739317+0.036978im       0.106711+0.0651981im     0.137836+0.188664im     -0.0499968+0.300424im
  -0.0606211+0.0260077im    -0.221835+0.0690812im      0.265368-0.176344im     -0.0621049-0.0633629im     0.0625608-0.10735im      0.144847-0.00762125im     0.121126+0.0722599im    0.0523638-0.0281299im    0.0818162-0.0390392im    -0.0601061-0.0286551im     0.0129301-0.0562375im      0.040717+0.209271im      0.0142581+0.0509725im     0.0375003-0.130229im   -0.0659882+0.0987501im      0.171018-0.0741964im     0.0219689-0.122682im      0.0610038-0.131466im      -0.168377-0.342788im      -0.148573+0.291167im     -0.0119431-0.00720847im     0.10194-0.218069im      -0.110117+0.104066im     -0.0621316-0.0960511im    -0.0954515-0.0648628im     0.0853652-0.0538152im     -0.148276+0.0764652im    -0.0116102+0.177389im     -0.0248899-0.0827553im    -0.0648107+0.280043im     -0.157145+0.0615035im     -0.236529-0.00596728im
   -0.121476-0.180055im      0.107701-0.0409233im      0.108683+0.178327im     -0.0954372+0.119654im      0.0455103+0.160877im    0.0472271+0.0250712im      0.147612-0.0296775im    0.0151488-0.187921im      0.224625+0.174777im      -0.127174-0.0101788im      0.193546-0.0116347im    -0.0459254+0.169624im      -0.174947+0.00560317im    0.0952504-0.0675275im    0.039284-0.0392038im     0.0190142+0.0403257im    -0.0102179+0.197607im       0.172657-0.146043im      -0.218462+0.124717im      0.0871545+0.223619im      0.0260081-0.109991im    -0.0246393-0.0870801im    -0.0572673-0.173492im       -0.13086-0.11869im      -0.0629898+0.294863im      -0.104688+0.0324896im     0.0762614-0.109929im       0.190472-0.00337195im     0.207576+0.158835im      -0.117174-0.156614im     0.0751295+0.0159061im     0.0444249-0.0100012im
   0.0101196+0.0990688im   -0.0404685+0.0649253im     -0.152189+0.020135im      0.0366405+0.105812im      -0.121476+0.0436098im    0.130921+0.200946im        0.28443-0.0791191im   -0.0880371-0.187299im     -0.164161-0.0616875im     0.0474593+0.0181156im    -0.0820203+0.0932809im     -0.111559-0.239657im      0.0424645+0.204361im       0.196009-0.236314im     -0.16702+0.0296463im      0.144603+0.0863691im     0.0313685+0.145151im      -0.131123+0.0425178im     0.0876688-0.181644im      0.0854556-0.0155947im     -0.241943+0.163215im    -0.0659129-0.0744642im     -0.100694+0.0626343im    -0.0473771-0.158991im      0.0216796-0.10733im       0.0569919-0.0259405im     0.0422399-0.140793im      0.0822829-0.167857im    -4.91237e-5+0.32597im      -0.0458267+0.0255155im     0.111537+0.032884im     -0.0827988+0.0505559im
   -0.267405+0.0498081im   -0.0213245+0.11391im       0.0702235+0.13167im       -0.050497-0.10217im      0.00290784-0.191959im    0.0740507+0.232399im       0.260768+0.0427287im     -0.16567+0.224356im    -0.0105613+0.267922im      -0.150788+0.0483272im    -0.0207035+0.00440719im     0.174209-0.135227im      0.0871037+0.00423216im   -0.0869739-0.105535im     0.127896+0.0199955im   -0.00427089-0.280916im     -0.0767394-0.00423014im     0.124754+0.069044im      0.0656235-0.0491125im      0.184821+0.0605275im    -0.0630201-0.119537im      0.143288+0.166504im     -0.0737803+0.0866132im    0.00386365+0.242292im     -0.0241003-0.00442587im    -0.116548-0.00374772im   -0.0753122-0.0676051im      -0.14824+0.104276im      -0.149932+0.0444747im    -0.0450451-0.212744im      0.147009-0.000433969im   -0.036561-0.0661799im
    0.204067+0.036061im     0.0554795-0.119661im       0.145401+0.0572918im     0.0693853+0.129198im      0.0705214+0.0721993im  -0.0457034-0.0476857im     -0.176604+0.0501581im     0.106962-0.0257159im    -0.196267-0.0621683im    -0.0573069+0.0893804im     0.0135243-0.227776im     -0.0169169-0.0537468im    -0.0614054+0.0918746im   -0.00617503-0.302273im    0.0216632+0.0118382im    -0.0639742-0.0123727im    -0.0923807-0.232822im       0.228875+0.0447228im     -0.121292-0.174138im      0.0576998-0.0218746im     -0.165297-0.124541im    -0.0750449+0.0936503im      0.114979-0.0279245im      0.071107-0.0122339im      0.367134+0.00242003im   -0.0407177-0.0856034im     -0.144769-0.0139717im     0.0493206+0.256399im      0.0678918+0.145848im       0.102401-0.0141576im     0.228549+0.170382im      0.0922883-0.118905im
   -0.245404+0.0428781im    0.0606837+0.0650772im     0.0631485-0.0482145im      0.143613-0.00206272im   -0.0689753+0.0533349im    0.224153-0.153573im      -0.114572+0.140125im     -0.121712-0.0339844im    -0.107409-0.0733178im    -0.0442919+0.0554795im      0.193125+0.108677im     -0.0153322+0.00133992im    0.0359278+0.0619201im     -0.165194-0.21638im      -0.19074-0.0994589im     -0.178704+0.0526563im     0.0426872+0.156944im        0.10877+0.25321im      -0.0546116+0.0393245im     -0.147789-0.106771im      -0.184602+0.0106782im    0.0277795+0.02166im       -0.136425-0.0824401im   -0.00507387-0.167402im     -0.0483795+0.0159872im    -0.0873628+0.144249im    -0.00300334+0.118973im      0.0937306+0.0389072im      -0.17573-0.248368im     0.00219595-0.220315im     -0.158826+0.265356im     -0.0211425+0.140174im
  -0.0884699+0.0742544im   -0.0596346+0.125952im      0.0316389+0.138745im       0.076167+0.126182im      -0.212067+0.13085im     0.0812988-0.125304im       0.119315+0.122026im      0.119108-0.0117588im    -0.187187+0.0159117im     -0.140805+0.00692714im    -0.156259+0.184656im      0.0106066+0.238691im      0.0339662-0.233641im     -0.0840383+0.0608347im   -0.238122-0.0376662im    -0.0119635+0.0332274im     0.0383985+0.0742447im      0.188174+0.0133874im      0.134428+0.0100674im      0.165455+0.057686im       0.118161+0.0188407im    -0.108934-0.216868im       0.119249-0.116326im      0.0698207+0.250136im       0.178744-0.0429481im     0.0328315-0.0598728im     -0.198082-0.195866im       0.166834-0.137455im      -0.084447-0.0897216im      0.117392+0.092664im    0.00895176-0.0825645im     -0.076962-0.166598im
    0.140496+0.0981313im    -0.227693-0.239863im     -0.0549981-0.0942683im    -0.0102019+0.0615512im     0.0210599-0.0413494im   0.0836263+0.108818im     -0.0166189+0.033256im     0.0727916-0.0790149im     0.133507-0.128486im      0.0901023+0.0273684im       0.20368+0.0200758im    -0.0558459+0.0701992im     0.0158869-0.140679im     -0.0851452-0.01004im     0.0115894-0.10909im       0.0108696-0.0378326im     0.0829588-0.00709712im     0.010373+0.110756im       -0.18972-0.0819039im      0.136945-0.145549im     -0.0978754+0.0234264im   -0.0364402-0.0810016im     -0.190999-0.27832im       -0.181299+0.258296im      -0.158187-0.0676795im     -0.277204-0.195872im      0.0788051+0.098249im      -0.118427-0.112197im      -0.243933+0.13472im      -0.0173925+0.0477018im   0.00397483-0.00977727im     0.131038-0.243164im
   0.0714466-0.074081im      0.160538+0.0632494im     -0.132303+0.0922025im      0.105919-0.147361im      -0.157264-0.198689im   -0.0443479-0.0831665im     0.0293482+0.0857957im   -0.0805335-0.104031im      0.107706+0.16865im        0.263328-0.0368034im     0.0352512-0.0419273im      0.161833+0.00506917im    -0.213273-0.0119175im    -0.0809516+0.0042948im  -0.0791653+0.14766im       0.0119243+0.078559im      0.0183816+0.00887131im     0.113072+0.0911833im     0.0290203-0.051677im       0.145638-0.231262im     -0.0723398-0.148599im      0.152327-0.105545im    -0.00518627+0.254042im      -0.244402-0.1283im          0.12599-0.0203083im     -0.213077-0.165327im     -0.0272039-0.160108im        0.13547+0.115323im      0.0188142-0.00403829im   -0.0110069+0.161664im       -0.2795-0.103392im       0.093796-0.0459876im
 -0.00847847-0.0486048im     -0.21709+0.107425im     -0.0602215+0.153396im       0.105928+0.0847243im    -0.0779806+0.0954142im    0.231887-0.159296im     -0.0983576-0.0376472im    0.0742445+0.00136309im    0.183834+0.119231im       0.112815-0.0626472im     0.0228257-0.0618303im    -0.0605118-0.0203891im      0.121043+0.129952im     -0.0590925+0.0183921im   -0.032487-0.00185483im   -0.0188851-0.255958im      -0.273734+0.105747im      0.0320447-0.329716im       0.329543+0.0435724im     -0.132442-0.00980574im    0.0532074-0.0690823im   0.00511816-0.0568696im    -0.0925819-0.00706922im   -0.0996002-0.0968368im      0.213429+0.036054im    -0.00648085-0.248172im      0.0955177+0.188745im      -0.158312-0.0782857im    -0.0818904+0.0883149im      0.124711-0.00320787im   0.0111075+0.158317im      0.0634622+0.0233398im
  -0.0387286+0.079742im    -0.0379925+0.0723275im    -0.0534257+0.0465429im    -0.0894863+0.0352504im      0.205468-0.0562491im   -0.164815-0.0387603im   0.000944065-0.0627712im    0.0623117+0.188724im     -0.154957+0.115412im       0.145188-0.0520597im     0.0242694+0.204026im      -0.108782+0.293877im       0.127199+0.119269im       0.190276-0.157696im    0.0496521+0.0582944im     0.0810125+0.0395098im     0.0672491+0.0948998im     -0.095965-0.153081im      -0.111199-0.0771918im      0.133227-0.388427im      0.0924685-0.0560863im      0.21925-0.0939073im    -0.0029858+0.0673054im    0.00761487+0.0557389im      0.108107+0.164696im       0.016124+0.129768im       0.190602+0.152603im       0.162047+0.0253548im    -0.0715726-0.0491497im     0.0692689-0.0477332im    0.0661647+0.158525im       -0.14409-0.173157im
   -0.132474-0.0309879im     0.254059-0.088373im     0.00188354-0.148419im     -0.0277131+0.200582im       0.029307-0.0343265im   0.0933489-0.0437555im     -0.131322-0.0200906im     0.190001+0.100041im    -0.0429003-0.07137im       0.0652899-0.0878662im   -0.00554563-0.0240143im      0.063138+0.108513im    -0.00565907+0.231985im      -0.144132+0.0867483im   -0.113337-0.104312im       0.228764+0.00680714im   -0.0576007-0.00507245im    0.0796476-0.123975im      0.0850021-0.131603im      0.0320753-0.0722127im     0.0199228-0.103075im    -0.0316039+0.0761306im    -0.0835762+0.209274im       0.221855+0.0398685im     -0.411043-0.0875071im     -0.120609-0.237773im      0.0323161-0.277575im      0.0852593-0.0883463im     0.0767079-0.0623726im    0.00949752-0.0648514im     0.152304+0.129882im      0.0751956-0.0152774im
   -0.129295-0.0479268im   0.00730697+0.0400231im    -0.0600446-0.0350899im    -0.0939738+0.0508717im       0.18816-0.0941087im    0.165655-0.0613921im      0.301382+0.168452im     0.0991185-0.200907im    -0.0177606+0.049872im      0.0728264+0.0734712im     -0.173718+0.0345934im     -0.142806+0.00492412im    -0.191485+0.148131im      -0.172376+0.0477165im   0.0908292-0.104249im     -0.0768481-0.0297174im      0.240355-0.178741im      -0.107094-0.112409im     -0.0859982-0.173147im      -0.188601-0.124208im    -0.00805062+0.102079im     -0.156745-0.0241737im     0.0779249+0.0648173im     0.0224778+0.131161im       0.134826+0.184273im       0.136995-0.0910915im     0.0113719-0.0110636im     -0.064832+0.0347348im    -0.0426067-0.0326804im      0.090442-0.273667im     -0.148457-0.111656im       0.254716+0.0195654im
  -0.0102511-0.0363574im    -0.199071+0.223019im      0.0398805+0.045992im    -0.00252968-0.0491237im    -0.0825146-0.0150187im   -0.142489+0.0551699im    -0.0609548-0.00868931im  -0.0548201+0.0464338im   -0.0178565+0.151455im      0.0350894+0.0809963im    -0.0470056+0.0510964im     -0.046224-0.176046im        0.13404-0.048464im     -0.0548155+0.163434im    -0.213561-0.285645im       0.213984-0.15516im        0.225316-0.227132im      0.0454211-0.0691211im    -0.0141606-0.18927im       0.0336851-0.0838024im     0.0118365-0.251878im     -0.216926+0.00379943im  -0.00360114-0.175498im     -0.0278225-0.0857351im   -0.00613902+0.00857154im     -0.14087+0.20099im        0.134301+0.0507018im      0.172293+0.0384222im      0.146247-0.0406413im     -0.138689+0.128618im     0.0499825+0.0848827im      0.188952+0.168344im
   -0.212174+0.0321605im   -0.0919434-0.0884363im     -0.100055-0.0252485im     0.0507691-0.0347891im    0.00712838+0.011303im     0.175207-0.191805im     -0.0189569-0.148299im      0.138447+0.0560667im    -0.167912-0.0165203im     -0.157297-0.0676319im      0.112026-0.0497099im     -0.148144-0.212653im      -0.266886-0.0919359im    -0.0171027+0.106131im   -0.0577996+0.284196im       0.150138+0.0212535im    -0.0426748-0.306148im      -0.192327-0.0185538im     0.0554163+0.046469im       0.050859-0.0305255im    -0.0578629-0.0818583im     0.133664-0.134365im      0.0656251-0.19684im       -0.187522+0.0482432im     0.0218886-0.0768604im    -0.0795396-0.0547689im      0.189122-0.0771346im     0.0465166+0.119759im      0.0870302-0.114356im     -0.0574869-0.187863im     0.0968542-0.0526564im     -0.239456+0.0421744im
     0.14823+0.144789im      -0.16249+0.0396993im    -0.0783743+0.012893im       0.162816+0.0419932im     -0.310182+0.281718im   -0.0327616+0.00288752im     0.138191+0.00833347im     0.02413+0.132183im     0.0738905+0.159596im      0.0546065-0.0792219im    -0.0539924-0.271949im       0.122731+0.100365im     -0.0449967+0.218643im       0.121333+0.0482922im   -0.123618-0.0931917im     0.0109379+0.115537im       0.110022+0.140417im     -0.0566374+0.104423im      -0.198912-0.017384im     -0.0135322-0.0382365im     -0.118239-0.163748im     0.0329509+0.115896im      0.0321713-0.0188348im    -0.0785406+0.172448im      -0.119762+0.00290243im     0.265779-0.170961im      0.0322045+0.110862im     -0.0834853+0.139622im       0.116013-0.219508im     0.00532086-0.153713im     0.0626441-0.0900115im    -0.0449921+0.026361im
   -0.101097+0.134304im    -0.0900086-0.00141237im     0.148517-0.1im           0.0256066+0.0599174im   -0.00769834+0.19253im     0.0286666-0.0220051im      0.227235+0.253615im      0.294035-0.210593im      0.205376-0.0257746im      0.260862-0.0542141im    0.00666707+0.097961im      -0.124344+0.0717632im      0.185435-0.0607275im     0.0280033+0.0324994im    0.201971+0.0463866im      0.113032-0.0238182im     0.0240186-0.193689im      0.0327913+0.271101im       0.133764+0.239414im       0.164161-0.0698527im     0.0543435-0.0589372im   -0.0123804+0.19152im       0.0481493+0.147144im     -0.0639014-0.0765383im   0.000808989-0.0976871im    -0.0504126+0.101489im      -0.036627-0.00524045im   -0.0321022+0.0832104im      0.138048+0.0540311im     0.0266034-0.0157739im    0.0449749+0.158184im      -0.116203+0.0989391im
  -0.0706293-0.114278im    -0.0407392+0.00322419im    0.0200374-0.0621701im   -0.00605923-0.0268951im     -0.222292+0.0575831im  -0.0475946-0.0523801im     0.0397076-0.0154307im    -0.119994-0.129812im     -0.093279-0.114028im       0.266434+0.270676im     -0.0666121-0.0550685im     0.0956132-0.140458im        0.23491-0.155126im      0.0327966-0.153905im     0.245884+0.274997im      -0.139626-0.0204885im     -0.030128-0.0476061im      0.102817-0.0721727im     0.0199519-0.0802645im    -0.0693175-0.0730699im      0.071408-0.155721im     -0.075793-0.20526im      -0.0364222-0.110427im       0.108304-0.00227788im    -0.180452+0.0872461im      0.176431-0.0795212im      0.126595-0.125908im      -0.030015-0.0559583im      0.147425-0.14947im       -0.185129-0.115934im    -0.0166414+0.0967523im     0.0304086-0.260465im
    0.168134+0.0914331im     0.085841+0.189468im        0.10568+0.192526im      -0.258655-0.100777im      -0.188027+0.0263095im    0.124019+0.0145103im    -0.0885307+0.183465im      -0.04822-0.0613937im    -0.115763-0.294706im      0.0273728-0.0784217im     0.0249553-0.0929259im     -0.055478+0.0266422im    -0.0505263+0.0263992im     0.0931576-0.0102283im   0.0471273-0.105794im       0.139655-0.0642832im   -0.00654713-0.0964184im     0.0765172-0.154049im      -0.205275+0.0349514im      0.180425-0.0131157im      0.149331-0.0168013im    0.0724608-0.0295868im     0.0407244+0.13572im      -0.0149829-0.170913im       0.107971-0.133255im      -0.100848-0.0249669im     0.0136285+0.077786im      -0.151849-0.25522im       -0.132063-0.157126im       -0.21352-0.279875im     0.0486457-0.160325im     -0.0298689+0.0584574im
   0.0909338-0.182806im      0.055797-0.0591374im     -0.186359-0.0551834im   -0.00558211+0.229262im      0.0135572-0.100806im    0.0970423-0.20849im       0.0400245+0.255231im     -0.193458+0.123407im      0.269077+0.0534398im     0.0902897+0.00859817im     0.106434+0.0828975im    0.00244315-0.0282386im     -0.119529+0.0971576im      0.155683-0.0514026im   0.0298541+0.0835165im   -0.00903697-0.161637im       0.126396+0.0258131im      0.168718+0.0684157im     0.0623304-0.139676im      0.0899421+0.0639863im    -0.0373802+0.199283im        -0.148+0.0748878im      0.229479-0.102653im       0.184206+0.0261511im     0.0755157-0.0531152im    -0.0416961+0.0329469im      0.246875+0.0209547im    -0.0328809+0.00770383im   -0.0529003-0.197378im      -0.124121+0.156769im      0.185766-0.0591539im       -0.2133+0.0247598im
    0.138919+0.00511412im   -0.165962-0.0737154im    -0.0265312-0.00692057im    -0.168333+0.335653im       0.031493+0.14735im     -0.185964-0.0617949im      0.067312-0.0442058im     0.055447+0.189306im     -0.154609-0.109608im       0.175486+0.0339939im   -0.00197783+0.249956im       0.134613-0.0447606im    -0.0972202+0.0469973im     -0.122945+0.0411887im   0.0354773+0.0861457im     -0.127618-0.191752im      0.0739106+0.00639398im    0.0801489+0.101036im    -0.00636251-0.0697725im     -0.154578+0.271603im        -0.1213-0.123674im      0.295245+0.0138646im     -0.155989+0.0848243im    -0.0535819+0.0446259im      0.124286-0.0276431im     -0.136405+0.0478656im      0.024107-0.00650316im    0.0636933-0.221016im       0.185074-0.000965989im   0.0227941-0.0970777im    -0.126839-0.0997111im     0.0261965+0.136915im
   0.0061463+0.173025im    0.00320008+0.291902im      -0.190396+0.0406887im       0.11377-0.00751861im     0.183668-0.052622im   0.00534816+0.0698635im      0.122265+0.157038im     0.0160309+0.287323im     0.0871433-0.10581im      -0.0485986+0.281742im      -0.125067+0.0288967im     0.0342294+0.101367im      -0.170047+0.0488677im     0.0873896-0.064736im    0.0232095-0.0495289im     -0.109734+0.109732im     -0.0260532-0.0862099im    -0.0113867-0.00267734im   -0.0107328+0.165884im       -0.20109-0.065217im      0.0039618-0.00923105im   0.0571671-0.173375im       0.166048-0.140858im      -0.105398-0.156338im      -0.142908-0.0477329im     -0.227628-0.106889im      -0.179216-0.023149im      -0.166039-0.120804im       0.218597+0.00884612im   -0.0426153+0.0799242im     0.156794+0.171791im       0.045488-0.0381548im
  -0.0979325-0.0757453im    0.0549751+0.115225im      -0.367718-0.243557im      0.0169421-0.0433576im    0.00224578+0.0582278im   0.0571949-0.115287im      -0.291038+0.0162101im      0.10308-0.0543048im    0.0809529+0.0192288im      0.133896+0.0231052im     0.0129298+0.149513im      0.0609878-0.072623im      0.0634264+0.00877247im     0.191949-0.19518im    -0.0125959-0.0975204im     0.0752961+0.0149427im     0.0845584+0.00844664im     0.107584-0.207112im     -0.0795569+0.0235901im    -0.0865361+0.0962289im     0.0919392-0.107721im     0.0556041+0.111616im      0.0196951-0.0472566im     -0.196926+0.26976im       0.0407878-0.153278im      0.0819907+0.171932im      -0.291587-0.124599im     -0.0287841+0.0981233im    -0.0745165+0.195986im      -0.144583-0.138588im    -0.0535084-0.0734622im    -0.0335883+0.0256814im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.32883323522303637 + 0.0im
 -0.043524735249843745 - 0.13291510740062257im
 -0.011598036672248577 + 0.08782164375140951im
   0.18722392793140163 - 0.14028699301273032im
    0.2710194032211806 - 0.04601163983347968im
   0.03975791580072912 - 0.12166115220397694im
   -0.2694687051304833 + 0.03500315726294675im
   -0.1464033518244897 + 0.04837474222639492im
   0.29686229455304197 - 0.053157290834286525im
   0.10485261418475533 + 0.08121403085658441im
  -0.13586506628137454 + 0.0281350941721234im
   -0.2774699831499352 - 0.151804450939017im
 -0.009774654894051554 - 0.12240895732101803im
   -0.2316531643429391 + 0.1153939727919483im
  0.044505511992943975 - 0.15520053399725856im
 -0.024606077686304077 - 0.1236611654415594im
 -0.022655622266769017 + 0.20731695782894904im
    0.1192900735536247 + 0.13169960319117738im
   0.02398938157123276 + 0.07218182925894472im
   0.15162196910044395 + 0.0863795157538016im
   0.10109688919093954 + 0.1287212052679926im
  0.048270125682756744 - 0.05530058741886683im
  -0.09334976792363152 + 0.04514226424817605im
  -0.10747134664576644 - 0.05256552261729701im
   -0.1734505052194807 - 0.010398910992865776im
  -0.11640651912689948 + 0.033855531404628054im
  -0.08781718669311835 - 0.012920863205747401im
   0.05198029102026457 - 0.006670024620997983im
    0.0358732030981047 + 0.054372379542113866im
  -0.10131907661355445 - 0.06502451135005165im
  0.039017683500211696 + 0.11541991472099028im
 -0.019474821099665876 + 0.1014340650706665im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 11 July 2023 15:15">Tuesday 11 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.137475+0.0736641im   -0.154866+0.0842791im     0.241214+0.132122im        0.196385+0.0197198im   -0.0900592+0.192192im      0.0451127-0.206005im     0.00267419+0.0506273im     0.0106817+0.132121im      0.121193-0.12839im      0.0631244-0.0505146im      0.116432-0.219658im       0.361483-0.0873204im    -0.113967+0.0125292im      0.083678+0.0292798im      0.0763147+0.125015im     -0.257511-0.0172933im     0.0352228+0.128489im    -0.168342+0.243872im        0.10317-0.105069im    -0.00751356-0.148615im      0.0749832-0.0258762im      0.0746373+0.0583404im      -0.0214418+0.14165im      -0.0170096+0.0550564im     0.157346+0.19573im      0.0546321-0.151897im     -0.116547+0.121405im      -0.132413-0.0791669im      -0.111914+0.0586333im   -0.0242233+0.0629831im    -0.0238059+0.0768025im     -0.127469-0.0217444im
 0.000268519+0.0425498im   -0.078726+0.126709im     0.0828647+0.299952im       -0.142524+0.0437252im     0.162873+0.0910869im    -0.0136023+0.136976im      -0.212298+0.138593im       0.112277-0.112599im    -0.0999365+0.00936im       0.167281+0.103085im       -0.02857-0.00425132im   -0.0611521-0.124243im     -0.116927-0.0467644im       0.12951+0.04365im       -0.0763602+0.0305398im    0.0274259+0.194601im       -0.16829-0.0305001im     0.13726+0.0842107im     0.0343182+0.0260396im     0.0137631+0.201559im      -0.128165-0.0202202im      0.0251761+0.163635im        -0.175575+0.167086im      0.0808193-0.15541im     -0.0494935-0.14713im      -0.044654-0.160043im      -0.26646-0.0626139im      0.157695+0.00649714im     -0.129991+0.00629096im  0.00982768-0.312319im      -0.140436+0.0896435im     -0.071989-0.185311im
    0.100774+0.128246im    -0.193346+0.050026im    -0.0560562+0.1917im        -0.0802783+0.0484118im   -0.0551581+0.0475212im      0.159607-0.04249im        0.113524+0.0143311im      0.162744-0.14329im        0.15585-0.0503518im    0.0330363-0.0818546im     -0.134932-0.263645im       -0.10264-0.121339im     0.0324161-0.133739im      0.0862095-0.388654im        -0.20687-0.00140994im   0.0939608+0.0935686im     -0.116589+0.141486im   -0.0118635-0.154785im      -0.108522-0.0815569im     0.0487762+0.082846im       0.167218-0.0485071im     -0.0407445-0.00770476im      0.0881038-0.118337im      0.0127362+0.226987im     -0.130065+0.0562056im     0.163736+0.118322im    -0.0248306+0.0249798im    -0.0165693+0.195539im       -0.252521+0.0223712im    0.0470838+0.149851im      0.0102142+0.0543702im      0.144716+0.047996im
   0.0152449-0.143014im    0.0435316+0.0546077im   -0.0282022-0.0365424im      -0.122513+0.0315996im    0.0979354+0.0401082im     0.0491259-0.180935im    -0.00199342-0.0454816im      0.197452+0.00855798im  -0.0871937-0.049142im      -0.22013+0.0251397im      0.149265+0.0871148im    -0.0757934+0.106367im     -0.150096+0.0144124im      0.174046-0.199274im         0.12687+0.112158im     -0.280056-0.045933im      -0.100708+0.166747im    0.0651557-0.122897im      -0.014486-0.00613642im     0.236283+0.230912im       0.157709-0.0348005im     -0.0558432+0.067674im         -0.14423-0.0493054im     -0.166002-0.00479916im    0.201882-0.0703995im     0.167981+0.00288122im    0.143594+0.0822825im     -0.187382+0.0381251im       0.167773-0.0568639im   -0.0129985-0.327903im       0.154227-0.0630908im    -0.0394122+0.0570451im
  -0.0136654-0.0320815im  -0.0921442-0.0597283im    0.0660665-0.0303527im      -0.122359-0.0800623im    -0.200737+0.138736im      -0.180436-0.0727936im     -0.024018+0.0767927im      0.166668-0.134535im     0.0627382+0.0193325im    -0.296224-0.00571813im    0.0952513+0.119481im      0.0625275-0.178276im      -0.23399+0.109251im     -0.0157862+0.0723296im       -0.16783-0.098679im     0.0973201-0.0583048im     0.0748396-0.153472im     0.141423-0.130625im     -0.0932403-0.261678im       0.198285-0.192707im     -0.0889994+0.106755im       0.0347549-0.013184im        -0.187583-0.128361im      -0.238066+0.0934495im    -0.024228+0.128004im     -0.133303-0.0119377im    -0.268524+0.00080766im    0.0998974+0.0244096im      0.0964239+0.116134im    -0.0293179+0.0609313im     0.0800669-0.0393789im      0.108098-0.118541im
   0.0305663-0.281126im    0.0850132+0.137124im     -0.144884+0.084106im     -0.00110372-0.225872im     0.0677413-0.092197im      0.0862051-0.177372im       0.183693-0.181272im     -0.0233593-0.138264im     0.0158445+0.102728im    -0.0232011+0.113857im       0.023833-0.0979428im      0.151521-0.17492im      0.0531896-0.0507015im   -0.00178251+0.111331im      -0.0637013+0.0568485im    0.0324646+0.0961539im      0.137063+0.0853311im    0.169504-0.0278238im    -0.0036944+0.0105008im      0.157505+0.151022im    -0.00231177+0.0449065im       -0.21127-0.132639im        0.0824144+0.336175im      0.0168224+0.118405im    -0.0351215-0.00180322im  -0.0104781-0.0226048im    0.0256555-0.0549176im    -0.0591482-0.368597im      0.00799351-0.0151715im     0.064445+0.093814im      0.0263765+0.0800329im      0.151855-0.251574im
  -0.0309136+0.115437im    0.0198822+0.183287im     -0.312715-0.103887im     -0.00289947+0.0991566im   -0.0606261-0.0889135im   -0.00480221-0.115916im      -0.170586+0.233278im      0.0210872+0.215881im     -0.108233-0.0100438im     0.168704+0.0325228im    -0.0201133+0.0792538im        -0.192+0.131628im    -0.0453994+0.0802564im     -0.126312-0.154631im       -0.112942+0.134358im     -0.137649+0.0735497im   -0.00915786+0.044566im     0.294943+0.0241799im    -0.0791551+0.0582047im     0.0523934-0.199983im       0.169905+0.00221109im    -0.0464349-0.145898im       0.00234523-0.0156141im    -0.0512158-0.0334421im     0.195934+0.165781im     -0.117939-0.0219534im    -0.115333-0.218191im      -0.135202-0.167627im       -0.152153+0.140105im    -0.0216903+0.0837292im     -0.163935-0.0498671im     0.0359784-0.0717131im
  -0.0133932-0.0111903im    0.043029-0.0511648im     0.115604-0.0384846im       0.134089-0.230671im     -0.246302+0.0849367im     0.0801259-0.0743786im     -0.191952-0.00279161im   -0.0967472+0.135546im    -0.0336648-0.0690676im     0.163703-0.00909428im     0.042718-0.0808846im     -0.137194-0.120487im      0.262478+0.222547im      -0.163208+0.0105466im     -0.0242625+0.0491804im     0.157203+0.0154776im    -0.0528888-0.0278292im   -0.129229-0.0560768im     -0.181982-0.224456im     -0.0522038+0.19372im        0.124812-0.210003im        0.053208+0.0560856im       -0.207882+0.0510154im     -0.129893-0.082311im     -0.152949-0.00684268im   0.0613433+0.0563707im    0.0775082-0.00339314im    -0.221161-0.03223im         0.103009+0.0856124im    -0.167937-0.18768im       -0.100669+0.0243779im      0.200841-0.126812im
  -0.0691251-0.221429im   -0.0726306+0.0261912im     0.039483+0.0286932im      0.0467806+0.124819im      0.202816+0.0712517im     -0.145394-0.0361066im    -0.0737306-0.0337258im     -0.108068+0.0445839im    -0.399896+0.375353im    -0.0198604-0.150518im     0.00873024-0.207652im      0.0511745-0.12417im      -0.167391-0.023469im      -0.124573-0.0199575im      -0.180113-0.0707139im     0.030961-0.166225im      0.0534235+0.0742169im   0.0033275+0.0323681im    -0.0611494-0.0210041im     -0.136738+0.183086im        0.21738-0.055412im      -0.0724579+0.182933im        0.0971275-0.0910139im    -0.0345112+0.0155656im    0.0162139+0.0892016im    0.0163899+0.0990646im    -0.157982-0.0268602im     0.0177488+0.000156106im     0.172423-0.0583615im   -0.0833963+0.123236im        -0.1856-0.0853104im    -0.0389272+0.13694im
    0.264568-0.118772im    0.0448301+0.0581744im    0.0492612+0.14917im        -0.158148+0.0369963im  -0.00561349+0.0910778im    -0.0234552+0.107222im     -0.0464755+0.0467395im    -0.0137684+0.0556362im     0.191596-0.209015im     -0.075137+0.133498im      -0.448198-0.116419im        0.15466+0.0588953im    0.0961006+0.0779283im     0.0620529-0.0637601im       0.121575+0.0534935im   -0.0840752-0.127963im      0.0180144-0.0789351im  -0.0291647-0.0543164im    -0.0548035-0.0278585im    -0.0377693+0.00344912im   -0.0021114-0.0755701im      -0.115645+0.124692im         0.132497-0.137608im      -0.252787-0.0410423im      0.10224-0.0752322im    -0.102134-0.0294133im   -0.0598632-0.163753im      0.0879786-0.287565im       0.0994694-0.13352im      -0.259403+0.0450036im     -0.111724-0.00218052im    0.0195196+0.104938im
  0.00212276+0.0859703im   -0.112306+0.149807im      0.260835+0.0307191im      0.0185412-0.0125449im    -0.250904+0.0132369im      0.081515-0.13735im       -0.101243+0.0303536im      0.129564-0.026906im    0.00494323+0.317987im      0.253225+0.111602im      -0.191075+0.235915im       0.145526+0.00182246im   0.0238308+0.10957im     -0.00371599-0.0812323im    -0.00460642-0.0947352im    0.0510613+0.0154124im    -0.0854058-0.0866814im    0.053914+0.0873573im     0.0590553+0.272613im     -0.0994987-0.0163534im     0.0915142+0.00169544im      -0.11159-0.0681624im        0.150157+0.0982373im    -0.0904777+0.139193im      0.106139+0.0927717im    0.0227376+0.106006im     0.0281664+0.0186888im      0.121053+0.094734im        0.170559-0.15124im       0.016652-0.133731im       0.272202-0.174729im       0.117318-0.0720817im
   -0.333647-0.0757696im    0.122747-0.0878228im     0.098567-0.0116082im     -0.0544307-0.174535im    0.00947499-0.0655246im     0.0014938+0.0410157im    -0.0040114+0.259672im      0.0148873+0.188608im    -0.0443592-0.170401im      0.047697+0.235765im     -0.0204239-0.0969922im    -0.0584324+0.0646084im     0.147678-0.0644443im     -0.108278-0.0534173im      -0.237862-0.0797523im   -0.0815808-0.0121845im      0.160588+0.272153im   -0.0233268-0.0708018im      0.116711-0.182199im     -0.0672657+0.0570822im     -0.101703+0.180852im       -0.111936-0.0174979im        0.113155-0.0765304im     0.0886679+0.0319763im     0.208658-0.0681048im      0.16813+0.116929im     -0.145129+0.0471423im      0.277622+0.0261013im      0.0877517+0.0452469im   -0.0481264-0.0750756im      0.168918+0.0864221im     0.0463344-0.023751im
   0.0680176-0.0126668im    0.147007-0.00615776im  -0.0810868-0.0722312im      0.0797872+0.130209im     0.0819207+0.060551im        0.02268+0.120261im      -0.232226-0.0747398im     0.0576163-0.130694im     0.0270316+0.0905705im    0.0737336-0.10197im       0.0489926-0.0487225im     0.0343568-0.144379im     0.0615727-0.0398554im    -0.0960766+0.159246im       -0.184975+0.220154im     -0.100548+0.0496273im     -0.293019-0.119952im    -0.171706+0.0516023im     0.0089945-0.0646081im      0.120528-0.0747113im     0.0474617+0.0432902im     -0.0562063+0.0145093im       0.0453627+0.0211688im     0.0387281+0.0407713im     0.113019-0.136695im      0.059624-0.0319512im   -0.0231882-0.260356im    -0.00354097-0.0307534im      0.0608502+0.218253im     -0.135587+0.0793293im      0.465658+0.182226im      0.0604763+0.203554im
  -0.0742176+0.048775im   -0.0627811+0.0978022im   -0.0565256+0.0332337im        0.25155-0.248786im      0.120775+0.0864375im    -0.0530647-0.0456301im     -0.125336+0.136414im       0.109793-0.215947im     -0.132971-0.0274855im   0.00957376+0.0604024im    0.00412501-0.0326574im    -0.0910429+0.00698064im    0.149299+0.0499333im    -0.0695749+0.221313im        0.327563+0.00283086im   0.0562118-0.0720399im     0.0536561+0.0495448im  0.00495745-0.0201525im    0.00677393+0.0751745im       0.12363-0.0531501im      0.293659+0.192968im       -0.114245+0.138339im       0.00781707-0.262316im      -0.152581+0.105977im     -0.155986+0.0903094im   -0.0392045+0.04539im      0.0629814-0.0292401im      0.172626-0.0693238im      -0.253762-0.0948828im      0.10024-0.0856162im     0.0682899+0.159249im      -0.121235+0.0607616im
  -0.0903292+0.0626459im   -0.080563-0.188783im    -0.0895265+0.053118im      -0.0455298-0.15303im       0.264013+0.0134925im      0.102105-0.0705459im     -0.117064+0.128463im     -0.0484402+0.00905942im  -0.0233657+0.113769im     -0.164994+0.0693016im   -0.00197934+0.174055im       0.156518-0.00732781im  -0.0109656+0.157673im    -0.00568153-0.256856im       0.0403929+0.265073im    -0.0566705-0.092116im      0.0522275-0.239626im     0.077775+0.097164im       0.101827-0.0402851im     -0.201807+0.0197141im     -0.129648-0.112827im       -0.129826-0.100539im         0.105091-0.0499461im   -0.00507636+0.222906im     -0.300184-0.0501991im     0.184137-0.00436858im   0.0550733+0.0273617im   -0.00244454-0.0206735im     -0.0490008+0.284592im     -0.151336-0.0305131im   -0.00709581-0.0124344im     -0.159302-0.0671689im
    0.099512-0.138139im   -0.0469169-0.240825im     0.0377931-0.365869im       0.0532939+0.0288958im     0.185291-0.0750845im     0.0766138-0.136268im      0.0474585+0.0595687im    -0.0707632-0.141405im      0.105494+0.0796676im     0.212631+0.0479006im     -0.119932+0.0376776im      0.158298-0.0502031im     0.128047-0.0736595im      0.194755+0.0175828im    -0.00963018+0.0389942im    -0.104357+0.236425im      0.0136441-0.0531097im  -0.0953411-0.0978334im    -0.0915636-0.0408942im      0.124142-0.154113im      0.0701373-0.0160349im      -0.148372+0.0556354im    -0.000298285-0.0137229im     -0.138301-0.165034im     0.0486674+0.132991im      0.134267+0.0539141im    -0.106488-0.0445755im      0.132951+0.179339im        0.128694+0.163987im       0.19079-0.111187im      -0.299978+0.0652725im    -0.0285644-0.0256382im
   0.0291696+0.152541im     0.195214-0.0592302im    0.0492463+0.160191im      -0.0452611+0.217422im     0.0912935-0.158933im     -0.0472855-0.0585602im     0.0439686-0.166058im       0.162688+0.0458614im    -0.164489-0.0319393im      0.12824+0.00561291im     0.112897+0.0916356im   -0.00574103-0.168277im    0.00603554+0.18085im        0.223433+0.20177im        0.0369649+0.0572632im     0.072511-0.0573889im    -0.0290307+0.268822im    0.0283666+0.0280704im     -0.153679-0.165611im     -0.0684207-0.138214im      -0.166822-0.314575im    -0.000363462-0.20913im         0.0702953-0.194387im     -0.0591497+0.056001im    -0.0198681+0.191202im      0.183097+0.068229im     0.0596923-0.113054im       0.173598-0.107427im      -0.0120064-0.133806im    -0.0087958-0.0460907im   -0.00211707+0.0668092im   -0.00407837-0.0399314im
    0.169341+0.0313466im   -0.215973+0.179391im    0.00783914+0.0621362im      0.0211139-0.112635im    -0.0642202-0.257053im      -0.129645+0.0109901im     -0.168477-0.257977im     -0.0719166-0.156514im    -0.0427453-0.0176501im   -0.0394448-0.0690844im     -0.117556+0.10825im      -0.0398077+0.265201im      0.185534+0.0156636im     0.0276163+0.132163im       -0.181229+0.0548446im    -0.147201+0.206724im   -0.000585478+0.112968im   -0.0322462+0.149903im       0.102324-0.276774im      0.0235277+0.0790689im     0.0204446+0.0914065im       0.125926-0.0854169im       0.0017988-0.0821254im    -0.0574294+0.201205im     0.0144313-0.0638157im    0.0113299+0.137912im      -0.10778+0.0564136im    -0.0678953+0.0594047im       0.123176-0.016977im    -0.0565046+0.0564313im    -0.0760607-0.0621874im     -0.318058-0.109669im
  -0.0956157-0.0710439im  -0.0603686-0.00481553im    0.097667+0.199285im        0.189751-0.0897625im     0.100498+0.13703im      -0.0503274+0.203136im      0.0515533-0.114338im       0.123751+0.0541222im     0.236581-0.0234981im   -0.0593938-0.00369487im     0.137414+0.204528im     -0.0123193-0.0296182im    0.0450041-0.0971715im    -0.0593134-0.0795216im     -0.0929288-0.0945313im    -0.111886+0.207452im       0.140442+0.0635742im    0.144458-0.0816355im     -0.317657+0.177527im     -0.0950855-0.0282821im       0.13657+0.0192163im       0.268678+0.0772818im        0.118471+0.0384278im    -0.0641018-0.206054im    -0.0770843+0.0931907im     0.169884+0.0928349im    0.0849701-0.229046im      0.0529431-0.114409im       0.0992066+0.131971im     -0.073658+0.044711im      0.0661813-0.0987871im     -0.189615-0.0256516im
    0.204068-0.0530153im   -0.102112+0.223528im     0.0826171-0.0172532im     -0.0825157+0.0292407im     0.027622-0.128739im      -0.122719+0.107802im      0.0729784+0.0571526im      -0.17198+0.266333im     0.0287723+0.0636608im     0.122755+0.0837957im      0.260806+0.0580092im     -0.117111-0.113558im    -0.0467517-0.0452621im    0.00694118-0.0304598im       0.158319+0.0841561im   -0.0868815-0.0717473im      0.196857-0.0602814im   -0.234295-0.0503427im    -0.0456326-0.104883im    -0.00777292+0.140512im      0.0218185-0.0817099im     -0.0617665-0.0269855im        0.075008+0.0930875im     -0.357976+0.018617im    -0.0108965-0.191055im    -0.0250791-0.0053599im   -0.0771759-0.0999908im       0.14237+0.160093im       -0.229925+0.0952253im     0.186135+0.12614im        0.177044-0.113238im     -0.0112924-0.0955304im
  -0.0411323+0.15904im    0.00396465+0.0569047im   -0.0728329-0.0341999im      -0.332722+0.0511855im     0.119384+0.0776734im      0.124004-0.0659804im     -0.221849-0.0765523im     0.0958178-0.0787392im     0.113757+0.0518631im   -0.0159679-0.200669im      0.0337501+0.0473047im    0.00173775-0.0244524im    0.0460236+0.0237408im     -0.175661-0.0675296im       0.179374+0.0885402im   -0.0318847+0.0653913im      0.291392+0.135445im    -0.156126+0.0181673im     0.0315805-0.0850037im     -0.111195-0.0342592im     -0.169186+0.136627im       0.0757936+0.14561im        -0.0544329+0.234757im     -0.0134387+0.0106561im   -0.0427665+0.116799im    -0.0804744+0.388317im    -0.0887334-0.0900772im    -0.0149086-0.123783im       0.0339819-0.0640174im     0.158207-0.106948im     -0.0350254-0.00916617im     0.144171+0.213398im
  -0.0715348-0.010982im   -0.0861708+0.177688im    -0.0598425-0.0303326im     -0.0020129-0.0235274im     -0.16561+0.115928im       0.303516+0.0451066im     0.0463354-0.115345im     -0.0908522+0.0462275im     -0.16734+0.108643im     -0.116675-0.0061665im     -0.179047+0.037731im       -0.18442-0.100807im    -0.0626372-0.0179155im    -0.0495065+0.27518im         0.114865-0.0644299im   -0.0718966+0.119006im     -0.0956246+0.0302956im   0.0876856-0.256686im      0.0600629-0.0817967im     -0.106248-0.170225im      -0.230877+0.0701489im     -0.0684979+0.135713im        0.0642449+0.12545im       -0.160247+0.0121532im     0.078628-0.0024027im     0.383311-0.127408im     0.0306886+0.0598646im    0.00732412+0.032847im       -0.156825+0.0945425im    -0.129686+0.0271136im    -0.0994645-0.141095im     -0.0396971+0.144691im
   -0.128528+0.121273im     0.200061+0.144124im    -0.0140179+0.0735112im       0.267906-0.0924231im     0.167713+0.0198371im     -0.239214+0.0919529im    -0.0370626-0.00331321im    0.0417648+0.0613117im    0.0105409-0.0723461im     0.105998-0.143049im      -0.166857+0.0526178im    -0.0783184+0.0547988im    -0.238043-0.107289im       0.152131-0.161599im         0.15199-0.0436844im    0.0228485+0.0855937im    -0.0748602-0.2051im      -0.190941-0.134805im       0.113136-0.164315im      0.0463438+0.0684527im    -0.0281571+0.129765im       -0.222241-0.172463im        -0.222977+0.153564im        0.00752-0.0338608im   -0.0403568+0.192435im      0.158973+0.128325im     0.0242025-0.0240649im     0.0411236-0.0265503im       0.125114-0.103675im     -0.110414+0.185235im     -0.0333714-0.0879766im     0.0581466-0.0677357im
  -0.0430787+0.0939544im   -0.143831-0.213535im    -0.0376682+0.00824381im      0.179531+0.122221im     0.0309745+0.116057im      -0.147546+0.0903716im     0.0105069+0.0257048im    -0.0786421-0.067644im      0.125175-0.114243im      0.174606+0.230032im     -0.0276006+0.0694388im    -0.0276071+0.150453im     -0.174628-0.0640139im    0.00403801+0.144066im      -0.0614776+0.0458473im     0.287073-0.0149705im      0.049686+0.106251im     0.184545+0.130282im    0.000798441-0.0820821im      0.122244+0.239514im      -0.148915-0.101046im       -0.102058+0.178511im        0.0236985+0.137176im      -0.175745+0.253854im      0.167904+0.061583im    -0.0227477+0.099348im      0.178919-0.0248772im     -0.117468-0.0395133im    -9.92164e-5+0.179428im     0.0822897-0.00291433im   -0.0209047-0.107576im      0.0155283+0.242272im
    0.154275-0.116594im    0.0530386-0.146685im    -0.0207891+0.00210221im     -0.131699-0.0640027im    0.0543743-0.0221708im     -0.373082+0.162589im      0.0619621-0.131895im       0.130473+0.274125im    -0.0277313+0.0641139im    0.0234257+0.0244885im     -0.134747+0.011979im       0.119793-0.118315im      0.154299+0.0627171im    -0.0266282+0.00063535im  -0.000103005+0.22444im       0.163666+0.0278934im    -0.0693736+0.178409im   -0.0317881-0.00425629im      0.17669+0.175323im      0.0353396-0.0442678im     0.0981546+0.305727im        0.163943-0.072757im       -0.0782437+0.0401545im    -0.0437327+0.0743121im   -0.0587459+0.163348im      0.155571-0.134524im    -0.0882521+0.108359im     -0.0875268+0.032558im       -0.166384+0.109039im    -0.0365149-0.157547im      -0.036484-0.165618im       0.128598+0.0993202im
  -0.0679231-0.0235101im   0.0338998-0.0774362im     0.200523+0.233452im       -0.198022-0.0444102im     0.159166-0.0608725im      0.112446-0.0190215im   -0.00862113-0.0686901im       -0.2117+0.098036im     0.0981961-0.0196087im    0.0380161-0.24208im        0.112555-0.0483697im   -0.00952045-0.00566422im  -0.0708269+0.0311788im     -0.053377+0.140621im       -0.032183+0.0611011im   -0.0373417+0.216113im     -0.0293229-0.0276858im    0.086323+0.147824im      -0.116043+0.194164im      0.0284085-0.0623623im     0.0031567+0.211847im       -0.227753-0.000929257im     -0.177187-0.219834im      -0.133298+0.0828891im     0.190012-0.0492592im     -0.13016+0.136299im      0.282014+0.0927927im     0.0767468+0.136333im      -0.0824521+0.0643855im    -0.211701+0.0583565im     -0.102584-0.006115im        0.16672-0.108334im
    0.017767+0.247497im     0.116757+0.137678im     -0.118956-0.0173415im      0.0417718+0.112671im     0.0799062+0.138785im      0.0615615+0.106132im     -0.0198439-0.296414im      -0.114476+0.0878202im   -0.0451101-0.0991035im   -0.0548994+0.0679113im      0.137618+0.066515im      0.0191119+0.0489379im     0.299513+0.0798657im      0.109648-0.100771im      -0.0553013-0.0682704im   0.00680554+0.0144682im      0.163647-0.0230955im    0.197731+0.136572im       0.135197+0.105774im       0.166431-0.00313769im    0.0470498-0.105221im       -0.208654+0.278116im       -0.0170031-0.00993584im     -0.07991-0.116231im      -0.10544+0.127004im     0.0442499-0.0741567im    -0.250237+0.253689im      0.0674833+0.120696im        0.113634+0.0324718im    -0.077226+0.145801im       0.107507+0.0549474im      0.146796-0.0229126im
    0.198433-0.0215195im   0.0499012-0.282088im     -0.141965+0.152206im       0.0747152-0.0423459im   -0.0351869-0.0485865im      0.141212-0.213064im     -0.0713908-0.00102227im  -0.00207297+0.145475im     0.0553522-0.174375im      0.067133-0.0774136im    -0.0942774+0.14863im       -0.144839-0.227526im    -0.0843955+0.161954im    -0.00211095+0.155891im       -0.103663-0.0711903im    -0.150173-0.0343126im      0.202534-0.0627591im  -0.0240151-0.11994im       -0.012773+0.116892im       0.102104+0.141009im        0.17628-0.047475im      -0.0289319-0.0572167im      -0.0939065+0.226197im       0.182906+0.127958im    0.00888366+0.0288245im    -0.095584-8.01396e-5im   -0.134634+0.0842204im      0.204034+0.118987im      -0.0377278-0.0832755im    -0.126029+0.0245391im     0.0297998-0.0794997im     -0.230628+0.244339im
  -0.0122882-0.096974im     0.194187-0.0177895im     -0.13034-0.0344888im     -0.0552647-0.0204668im    -0.301868-0.0134409im  -0.000484221+0.160515im       0.101311+0.159843im     -0.0680357-0.233603im     -0.184381-0.0975561im    0.0120168-0.0372245im     0.0172194-0.0307011im    0.00475868-0.0485609im    -0.107454+0.181597im       0.182321-0.00993241im    -0.0184398+0.267145im     -0.155089+0.179272im       0.129822-0.0490693im  -0.0495827+0.0195158im      0.145639+0.0924845im     -0.125205+0.23997im      -0.0290468+0.042761im        0.200901+0.241272im         0.105207-0.0349334im    -0.0310293+0.0466046im   0.00562322+0.330248im    -0.0393277-0.00171053im    0.167248-0.134376im      0.0881692+0.149232im       0.0301971-0.0045475im   -0.0348536+0.106602im      0.0254835+0.0381598im     0.0542236-0.131113im
  -0.0804204-0.0576162im    0.118693+0.0316513im   -0.0979374-0.073805im      -0.0352526-0.183404im    -0.0776509-0.160911im    -0.00659106-0.199383im     -0.0497504-0.242227im           0.18-0.156876im     0.0513529-0.00900414im    0.131678+0.204298im      0.0621244-0.0343491im     0.0782604+0.040341im    -0.0894156-0.0243636im     0.0382697-0.0438013im       0.206113+0.0929928im     0.113445-0.224154im      -0.141364-0.0586057im   0.0375657+0.0981853im     -0.162264+0.0589634im    -0.0643896+0.0994794im    -0.0267365+0.0238551im       0.183492+0.104671im       -0.0265616-0.00212582im     0.048229-0.185416im      0.206972-0.10679im      0.0713713+0.242219im     -0.176499+0.112314im       0.144165+0.0993169im      -0.180544+0.174485im     -0.221163+0.237275im     -0.0786955-0.0744627im    -0.0125982+0.017649im
    0.345172+0.0522364im     0.07759-0.127021im      0.117008+0.000270302im   0.00162809-0.157966im     -0.123319+0.163483im    -0.00179605+0.00251777im    0.0997806-0.0516724im      -0.02497+0.0412119im     0.023097+0.15772im       0.075425+0.288217im       0.113489-0.00350307im    -0.340783-0.0556676im    -0.278202-0.168969im     -0.0618825-0.0622325im      0.0643838+0.0758481im     -0.10005+0.0314101im     0.0580397+0.0533861im   0.0363965+0.239472im       0.181656+0.0232973im     0.0163932-0.209335im      0.0434046+0.0576928im      0.0105341+0.0155207im       0.0106477-0.0605285im     0.0477613+0.0521085im    -0.111447-0.0780049im     0.135557+0.14269im       -0.04892-0.0556887im    -0.0555987-0.0304734im       0.176522-0.100987im     -0.111905+0.0224343im     -0.136871+0.285103im      0.0355294+0.0178967im
    -0.16405-0.126663im     0.192807+0.0792116im    0.0879249+0.215893im       0.0103973+0.0381406im    0.0120794-0.0777491im     0.0129561-0.152488im       0.232887+0.0224431im     0.0309411-0.163923im     0.0532808-0.0395099im    0.0827198-0.0835894im     -0.025043+0.0188015im     -0.167892-0.00157395im    0.236358-0.00546674im  -6.04595e-5-0.0725353im      -0.154344+0.130716im    0.00172064-0.277145im      0.0463956-0.184117im       0.1916+0.234117im      0.0697011-0.140315im     -0.0960744-0.147509im      0.0485271+0.131928im       0.0444463+0.0183045im       -0.167912+0.159148im      -0.217505-0.0185685im   -0.0354179-0.0762142im    0.0915073-0.156443im     0.0425856-0.19131im     -0.00577112+0.181902im       0.0662744-0.104178im      0.148123-0.00896229im   -0.0919437-0.0511586im    -0.0389538+0.227111im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.23260880322146657 - 0.001543707057294163im
   0.02823933614472132 + 0.18075190599461724im
  -0.10801260094969785 - 0.03972047910793187im
   0.13765967981090277 - 0.10186686988960009im
   0.24284833490785404 - 0.15034790011020066im
    0.4132744700128814 + 0.0im
 -0.029218034687690027 + 0.012746767358789777im
  0.026068145874269113 + 0.03818220675695136im
    0.0666962954973717 - 0.02532084902712669im
 -0.007599033660167612 + 0.06991533060019842im
 -0.009563657188497516 - 0.0773037106910741im
   0.19868424419022632 - 0.24483194280282294im
   0.04610533889074175 - 0.09852624664230618im
  -0.07588422074972476 + 0.049736752237188056im
   0.12111450745993095 + 0.15846562624146213im
   0.15935486401841006 + 0.148802444237821im
 -0.013048590981933549 + 0.019246912656463187im
   0.11417582966147286 - 0.20819502582593205im
   0.07559220366769251 - 0.010419468691049056im
  -0.04161334434396913 - 0.13285258586949028im
  -0.04529546709194465 + 0.18527849567148302im
  0.008724492296595715 - 0.10015301347629534im
   -0.1930830918871986 - 0.10385693242169736im
 0.0038243565986944366 + 0.1538278422062547im
  -0.04408593037445828 - 0.13487579633013164im
  -0.04932670528847451 - 0.0452338977673335im
  -0.06709197365217985 + 0.1713891012343777im
   0.12895905411384123 + 0.05583290427189013im
    -0.205423409587677 - 0.10398514494340702im
   0.11696092689099633 + 0.07781700913559542im
  -0.16911762022504534 - 0.07980862983998925im
   0.06549641880048966 + 0.028577311060788684im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 8 March 2023 18:04">Wednesday 8 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

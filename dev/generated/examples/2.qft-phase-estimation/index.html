<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0204635-0.0555438im     -0.211261+0.0716675im      0.0115009-0.146898im     -0.122121-0.0317347im     -0.0728604-0.0360174im      -0.153745+0.0308798im   -0.129761-0.296511im     0.204932-0.0906602im   -0.0765721+0.145042im      -0.158969+0.0511376im        0.1911-0.0229432im    -0.0313445+0.0697465im    -0.0121934-0.103366im       0.163697+0.0439089im   -0.0611655-0.0298953im   -0.0758725+0.096215im        0.30821+0.15176im        0.134255+0.153752im      -0.192252+0.276127im    0.00472245+0.00417773im    0.163523-0.0682308im     0.0955153+0.197349im       0.153268+0.0409863im    0.0690615+0.0615464im      -0.0567678-0.112238im   -0.0896585-0.00445862im   -0.0112776-0.13899im        0.137167+0.154907im      0.0340256-0.114544im    -0.0348641+0.188841im     0.0861487-0.100714im     0.146794-0.0592456im
    0.223243-0.0949793im     -0.134101-0.165101im     -0.00568871-0.0715029im   -0.0480728-0.0241871im       0.330411+0.000169125im     0.226747-0.129682im    0.0237754+0.03007im     0.0352067-0.209332im     0.0794847-0.060728im     -0.0291299-0.0680172im     -0.152296+0.136611im       0.325842+0.0788024im     0.0988128-0.062206im      0.0853424+0.035676im    -0.0832359-0.0913018im     0.147813-0.0893271im      -0.05347-0.132235im      -0.105134+0.0447761im      0.168869+0.103413im     -0.161208+0.0809841im   0.00843162-0.248354im     -0.0372993+0.0550229im   -0.00797622-0.0261265im    -0.190994+0.0946817im      -0.0733539-0.216392im    -0.262207-0.109451im      0.0209131+0.04172im      -0.0400439+0.0211202im    -0.0618836-0.041445im    -0.0162403-0.0476865im   0.00943308-0.0957728im    0.228693+0.0509241im
    0.071845+0.120348im      -0.288426+0.134468im       0.0966585-0.48184im     -0.0934463+0.225132im       0.0401072+0.256184im       -0.195215-0.075418im   -0.0342314+0.0393563im    0.144189+0.0504324im   -0.0879237-0.102793im     -0.0903867+0.0764172im    -0.0714285+0.104511im     -0.0315005+0.0801193im    -0.0166522+0.0607016im    -0.0428989-0.169883im    -0.0839165-0.0181499im    0.0151235+0.129736im     -0.0472943-0.0329318im    -0.0258674-0.0444018im      0.173793-0.237752im      0.037444+0.0886173im    0.0686607-0.00428525im   -0.0366682-0.264893im      0.0759633+0.0210849im    0.0125065-0.0134423im       0.0434385+0.175356im     -0.14659+0.0665189im    -0.0278547-0.187092im      -0.051418+0.0426079im      0.056222-0.0190573im   -0.0502189-0.0599649im    0.0189886+0.129723im   -0.0283985+0.122712im
  -0.0510477-0.0146074im      0.216532+0.12784im         0.240069-0.276493im     0.0744247-0.171787im      -0.0868187+0.0113041im     -0.0311488+0.12051im      0.111623+0.0988618im   -0.131231-0.250193im      0.134404-0.108153im      0.0892409-0.0847146im    -0.0961309+0.125043im      -0.126874-0.0885031im     -0.137828+0.023738im       0.143711-0.020643im     -0.144294+0.0623863im    0.0886416-0.124595im       0.181369+0.0811881im     -0.031382-0.0177556im    0.00871682+0.143735im      0.106388+0.0274049im    0.0934794+0.0395296im     -0.117114+0.0481264im     -0.270703+0.289295im     -0.109554+0.0775427im        0.291568+0.0522668im   -0.156394+0.0564043im    -0.0674425-0.0528992im   -0.00832313-0.0148091im   -0.00110892-0.0333511im    0.0383908-0.0619498im    0.0106894-0.0212573im   0.0479245-0.223494im
   -0.105072-0.0627329im     -0.122306+0.338959im       0.0945155-0.177926im     0.0464887-0.167092im        0.152889-0.133682im          0.1032-0.0297665im    0.225873-0.13866im    -0.0306837+0.210736im    -0.0121859-0.0183294im    -0.0401195+0.218616im     -0.0614504+0.00832501im     0.058266-0.0397748im    -0.0300238+0.0558847im     0.0857226+0.129986im    -0.0936225+0.0168919im     0.033797-0.0848734im    -0.0416891-0.221522im     -0.0444606+0.0675534im    -0.0752314+0.191402im     0.0410994-0.0824788im    0.0819991-0.0761026im      0.199105-0.00189407im    -0.172153-0.152273im      0.192625-0.0164476im    -0.000995618-0.0212238im   0.0597915-0.166325im      -0.205694+0.0832884im     -0.222162-0.00171982im   -0.0903747+0.111278im    -0.0854566+0.0186641im     0.128118+0.0582494im   -0.257213+0.129563im
    -0.19265-0.107345im      0.0576493-0.0248074im       0.105416+3.34686e-5im   0.0654937+0.170612im      -0.0357044-0.223822im       -0.200209-0.0278512im   0.0562845-0.0171413im   0.0332638+0.0720711im  -0.00791751-0.0418871im     -0.107283-0.110395im    -0.00710872+0.0208616im     0.0424914+0.0367207im      0.111194+0.0780093im      0.037061-0.337671im      -0.09105-0.146025im     0.0672282+0.111775im      0.0586177-0.0270861im    -0.0577783+0.05212im       -0.086706+0.139839im     -0.154916-0.136002im     0.0442012+0.0969931im     -0.314265+0.00381664im     0.128558-0.215151im    -0.0687813+0.0360211im       0.0817412+0.0234209im   -0.193034+0.0711629im     0.0173832+0.170508im      0.0346459-0.0922022im     -0.131527+0.0403035im    0.0403375-0.132088im     0.0183118-0.359218im    -0.260626+0.0926747im
 -0.00553806-0.0705765im    -0.0135281+0.00375377im  -0.000567143+0.0083366im     0.184648-0.136159im       -0.109483-0.0908806im     -0.0259623-0.15141im      0.079289-0.244958im   -0.0410571-0.142519im     0.0124959-0.00288396im   -0.0271179+0.0808705im        -0.155-0.00774556im    0.0733126+0.0756818im    -0.0317238-0.0224848im   -0.00407042-0.0562929im   -0.0179514-0.0653168im    -0.124862+0.00805631im    0.0561893+0.130924im      -0.141037-0.204868im       0.288447-0.312583im     0.0562265-0.121559im      0.152449-0.0483232im      0.084073+0.205607im       0.112204-0.0764946im    0.0590151-0.243567im        0.0526263+0.0439713im   0.0352744-0.0463385im     -0.171007+0.00974233im   -0.0906783-0.244628im       0.336355-0.0872128im   -0.0185695+0.0698828im    0.0363058-0.25343im     0.0691145-0.0584844im
   -0.250789-0.240643im       0.160629-0.106122im      -0.0951266+0.0592647im   -0.0825015+0.0782714im      0.0286198-0.0102544im      -0.012934+0.0043367im    0.167083-0.0303518im    -0.13168-0.19167im     -0.0798685+0.0610185im      0.213134-0.13339im        0.163636+0.235138im       0.133059+0.0115635im   -0.00999266+0.0403625im   -0.00942538-0.0648403im    0.0117948-0.10456im       0.202624+0.0998144im      0.118407+0.177096im       0.101731+0.00213935im     0.115877+0.0429628im   0.00811794-0.0252908im     0.223664+0.088592im       0.157823-0.0980169im     0.0697735-0.0661452im    0.0593111-0.156982im       -0.0414183+0.0588796im  -0.0439561-0.0944877im   -0.00195058-0.268866im      -0.177912-0.0298426im     -0.185077+0.0458959im    -0.115533+0.101631im     -0.118217+0.24353im     0.0175423+0.18777im
  -0.0987262-0.132111im     -0.0220854+0.14602im       -0.0424029-0.0537121im    -0.151327+0.128621im      -0.0276163+0.159812im         0.16718-0.0808034im  -0.0330593-0.0382914im  -0.0128089-0.027322im    -0.0266135-0.19353im       -0.205376-0.139655im       0.236774-0.0754946im     -0.150492+0.0809562im     0.0281994-0.188299im     -0.0795297+0.223072im      -0.10697+0.102655im    -0.0946377+0.00640562im   -0.0185958+0.195249im       0.150697-0.231079im     0.00775057+0.148281im    -0.0608704-0.171631im     -0.286038-0.0207954im    -0.0671828-0.016659im     -0.0200902-0.0519362im   -0.0327343-0.0573063im       0.0809132+0.0577026im  -0.0364432-0.0576893im    -0.0923776+0.100919im      -0.273901-0.192059im     -0.0878445-0.129783im      -0.10077-0.221095im    -0.0523302-0.0733368im    0.158699+0.0463444im
  -0.0525864-0.0528334im     0.0789659+0.0219281im      0.0927356-0.165265im     0.0678211-0.0495453im      0.0963078+0.027359im         -0.2446-0.133773im    -0.072976-0.0784445im  -0.0861866+0.131885im      0.180208-0.129141im      0.0101808-0.209087im       -0.23513-0.0784143im     0.0633368+0.224698im       0.146515+0.0443392im    -0.0608607-0.0139915im     0.163206+0.331187im      0.209733-0.0207788im      0.051195+0.151392im      0.0842201-0.0329591im     -0.152787-0.0133473im   -0.0885623+0.146517im    -0.0227904-0.0527455im    -0.0552958+0.170111im     -0.0192845+0.0800771im     0.188715-0.156959im        -0.342599+0.0233195im   0.0239363+0.0638375im     -0.031923+0.0959724im    -0.0161717-0.107572im      -0.123429-0.00325417im    0.152825+0.0693466im    0.0701839+0.118013im    0.0871966+0.0187328im
   0.0799479-0.112025im       0.180631+0.0932546im       0.148747-0.0512138im    0.0217983-0.078536im       -0.097752-0.0629149im     -0.0510622-0.217387im     0.106744-0.0580339im   0.0237551-0.090847im      0.059197-0.106807im     -0.0994065-0.00337658im     0.162275-0.251397im         0.1904+0.109219im       -0.17487-0.267946im      -0.143754-0.115024im      0.148704+0.00419196im  -0.0290266-0.101691im     -0.0609648-0.089034im      0.0126338+0.159031im     -0.0245926-0.0234675im    0.0205716-0.0604341im     0.223675-0.0831713im     0.0641354-0.132612im      0.0433569-0.0572885im    -0.144391-0.141454im        0.0588003-0.0188054im   0.0993889+0.0779081im     0.0420213+0.100257im       0.284635+0.0913016im    -0.0552838-0.13186im      -0.183318-0.300035im    0.00773379+0.238813im    0.0125694+0.0064054im
  -0.0672616-0.0997436im       -0.1146-0.0753009im       -0.33144+0.0714644im     0.114301-0.195839im        -0.19079-0.0560006im      0.0909265-0.0571959im  -0.0589963+0.0779163im    0.209721-0.0225838im     0.122689-0.111185im     -0.0278079+0.0258526im   -0.00721709-0.0543998im     0.0242093-0.0966174im    -0.0211018-0.00418685im     0.174737+0.0273257im     0.106451+0.154518im     -0.013123+0.157139im       0.212176-0.0425644im     0.0707509+0.0428969im     0.0413728-0.128823im     -0.168599-0.0246784im     0.214872+0.0992134im    -0.0392396-0.0883085im     -0.143064+0.0830124im   -0.0742563+0.35561im         -0.136265+0.0969973im  -0.0371898+0.0919052im    -0.0995837-0.0243761im     -0.130086-0.133469im      0.0321406-0.088087im     0.0507008-0.210845im      0.213892+0.100628im   -0.0457832+0.197684im
    -0.20149+0.0927853im    -0.0664378-0.0561097im     -0.0785977-0.117996im     -0.305707+0.160575im      -0.0141214-0.15381im      -0.00666109+0.0879678im    0.146885+0.0810074im  -0.0291815+0.142492im     -0.076948+0.0867342im      0.236728+0.00281322im    0.0336492-0.0595455im   -0.00672529+0.13672im       0.0166785-0.208177im       0.145993-0.153418im    -0.0115178-0.0590487im    0.0470349+0.102138im      -0.159631+0.110943im      -0.139727-0.039731im    -0.00414292+0.0697109im    -0.112242+0.348828im     0.0420242-0.00918302im     0.118024+0.110933im      -0.127137-0.10001im     -0.0840581+0.0917126im        0.134332-0.0786598im    0.174999+0.0324251im     -0.125521+0.150335im      0.0356871-0.218398im       0.145346-0.1751im       0.0448869-0.0430178im     0.157221+0.110613im     0.101239-0.107009im
  -0.0827466+0.125457im     -0.0958059-0.117732im      -0.0523811-0.0833301im    0.0959558-0.0325946im       0.125688-0.0708142im       0.268557-0.134181im    -0.301474+0.0853828im    0.122105-0.0930308im   -0.0347041-0.228216im      0.0697616+0.102499im     -0.0555614+0.0978294im     -0.148846-0.0788868im     -0.111376-0.0983671im     -0.168945-0.344022im     0.0274303-0.213745im    -0.0426624-0.0667733im     0.0912733+0.0864063im      0.102282+0.108657im      -0.155712+0.0368im       -0.107933-0.138386im    -0.0125228+0.105882im     -0.0666779+0.0230427im    -0.0799659-0.0527009im     0.202101-0.179596im       0.00543029-0.137705im   -0.0684252-0.0383391im     -0.068037+0.127499im     -0.0551366-0.0779244im     0.0434425+0.064241im    -0.0571492+0.0992472im    0.0484522+0.251077im    0.0152529-0.193327im
   0.0241696+0.130372im       0.188124+0.0746192im     -0.0102987-0.0643733im    0.0499195-0.0693429im    -0.00459312+0.00262005im    -0.0458851-0.112382im   -0.0289632-0.171224im     0.137321-0.0777327im    0.0864441+0.0423565im      0.120107-0.146642im       0.109209+0.00546622im     0.156916+0.141797im       0.137071+0.13696im        0.108977+0.225095im     -0.120031-0.422103im     -0.185402+0.0625474im      0.124418-0.0719674im     -0.023511-0.0142285im     0.0296648+0.028531im     0.0159437+0.132389im    -0.0726772-0.138748im      -0.193133-0.0393186im     0.0533235-0.0628256im     0.200998+0.158935im        -0.042889+0.120507im    0.0940561+0.168198im      0.0654887+0.142832im      -0.131974-0.0784174im     0.0736157+0.0557213im    0.0295276-0.0853294im    -0.159107+0.275522im   -0.0678653-0.16208im
   0.0304265-0.264225im     -0.0960045-0.0120136im       0.174055-0.0015743im    -0.129446+0.101783im      -0.0104797+0.00129014im      0.189154+0.115301im   -0.0362193-0.118826im    0.0728334-0.0601151im    -0.151093+0.150845im       0.146639+0.0585533im    -0.0522722-0.102034im       0.156016+0.056961im      -0.266723+0.0502071im     0.0847838-0.10414im      0.0333495+0.0910003im     0.145377-0.318706im       0.118468+0.03269im        0.158016-0.166824im       -0.12829-0.0852873im   -0.0277158-0.0310307im    -0.135673-0.0693412im     -0.123878+0.0604151im     0.0727087+0.0144928im   -0.0455909+0.0209048im       0.0557405+0.0222824im   0.0294652+0.210601im       0.203719+0.0810539im     -0.190099+0.0709209im      0.273114-0.00577314im    0.136264-0.00298296im   0.0238215+0.109812im    -0.195575+0.167869im
  -0.0490076+0.0282728im      0.127805-0.0290341im       0.130588-0.0871281im    0.0216408+0.0695399im        0.10979-0.110843im       0.0057307-0.191027im    -0.144754+0.0773427im    0.183711+0.261523im      0.120172+0.122691im      0.0181909-0.034039im       0.263026+0.231701im       0.201874-0.0624803im     -0.216986-0.176069im      -0.066187+0.125834im     0.0635966+0.0437046im     0.150935+0.157665im     -0.0373774-0.199205im        0.13434-0.159238im    -0.00423402-0.157334im     -0.169243-0.0961009im    0.0461058-0.087222im     -0.0308991+0.108521im     -0.0516919+0.207728im      0.156573+0.0495223im        0.216282-0.0178229im    0.112865-0.0771193im     0.0872371-0.171245im      0.0282968-0.124738im     -0.0335186-0.0134771im    0.0588507+0.0729401im   0.00618737-0.164835im    -0.038712-0.0952117im
    0.221229-0.0277209im     0.0363333-0.13077im        -0.124473-0.0692972im   -0.0750305+0.0533114im      -0.126303-0.0821543im     -0.0122989-0.10247im    -0.0999255-0.0711071im   -0.156432+0.187491im      0.193815-0.0201853im      0.257134+0.14561im      -0.0833587-0.089198im      0.0107909+0.104873im     -0.0418924-0.0224168im    -0.0750354+0.0282948im    -0.208238-0.129942im     0.0160927-0.0352724im     0.0376136-0.0709286im        0.1473-0.255092im       -0.24963-0.0825092im     0.182467+0.0368377im    0.0929048+0.207883im       0.205358+0.126905im      0.0866693-0.0426491im    0.0320181+0.1167im            0.10728+0.0711598im   -0.264257+0.00823678im   -0.0295943+0.0569116im    0.00366829+0.0573434im     -0.136254+0.214188im     -0.089998-0.18472im     0.00766632-0.0581585im    0.180359+0.0756477im
  -0.0920771-0.0351551im     0.0721927+0.0812668im     -0.0221028+0.0058893im    0.0194098-0.00576462im     0.0942264-0.0951527im     -0.0466283+0.262717im     0.040198+0.211833im    0.0165364+0.191076im     -0.187391-0.079581im      0.0612974-0.0855108im     0.0468463-0.19956im       0.0224926+0.0374875im     0.0518932-0.130724im      0.0460356-0.106747im    -0.0880059-0.132737im     -0.193148-0.116252im      0.0823271-0.0907767im   -0.00765085-0.239309im     -0.0402707-0.148945im     0.0856254-0.0863616im     0.122997-0.160571im      -0.120468+0.0928151im     -0.167044+0.144262im      0.104451+0.0226261im       -0.330172-0.0120391im   -0.251254-0.253439im      0.0730609-0.0888922im     0.0800362+0.0313828im     0.0610639-0.239373im      -0.12221+0.00534615im   -0.164198+0.0341029im  -0.0166425+0.0504848im
   0.0315815+0.00353182im    -0.104208+0.0381333im     -0.0414907-0.0258616im    -0.275035-0.0606148im       0.196924-0.00362957im     -0.203129-0.156179im   -0.0391881+0.117195im    0.0423311-0.0389805im    0.0992909+0.187491im       0.142234+0.0487523im    -0.0465497-0.278058im     -0.0342828-0.294633im       0.177996-0.192578im       -0.20466-0.0116107im    0.0668684+0.0352042im    -0.046209-0.0976227im      0.122288+0.147953im      -0.240071+0.0183885im      0.156238+0.0850024im     0.124545-0.244445im      0.149052-0.0627178im    -0.0714217+0.0630648im     0.0966946+0.109323im     0.0370246+0.122664im         0.156531+0.0425385im    0.018663-0.0117068im     0.0986178+0.095916im      -0.133029-0.101837im      -0.121019+0.0881794im     0.154088+0.0644587im   -0.0723161+0.0758487im  -0.0432968+0.0840178im
    0.088834+0.165868im       0.054074+0.101349im       0.0311195-0.0174746im     0.254743+0.0521148im      0.0457585+0.0121116im      0.0930605-0.101472im   -0.0425055-0.0347806im   -0.118726-0.0141597im   -0.0790802-0.138105im       0.127391-0.0564283im    -0.0646969+0.168315im      -0.115962-0.247522im     -0.0922301-0.249106im       0.139672-0.0643271im   -0.0389741+0.103066im    -0.0235448+0.194546im      0.0684795+0.184748im    -0.00874958-0.266386im     -0.0868681+0.113316im    -0.0136892+0.127079im     0.0673525-0.289988im     0.00753656+0.0459492im      0.285947-0.0502473im    -0.196181+0.131913im       -0.0903413+0.0612498im    0.159627-0.120033im     -0.0241274+0.0990833im       0.10418+0.093035im       0.017688+0.122705im    -0.0289774-0.00383138im  -0.0905505+0.0591862im   -0.166216+0.180179im
    0.105144+0.246021im       0.228527-0.0142554im      0.0897591-0.00328118im   -0.132163-0.0804261im       0.292379-0.127651im      0.00376316+0.0212052im    0.162134-0.0227277im  -0.0556904-0.143181im   -0.00723686-0.0623134im     -0.185785+0.0136622im     0.0057498-0.0883486im      0.067366-0.0608439im     0.0166724-0.0311936im      -0.03028-0.141236im     0.0151045+0.0476294im    -0.138857+0.144306im       0.090968+0.0582894im     0.0692487-0.165072im      -0.247096-0.00599339im   0.0404263-0.00355233im   0.0184249+0.0366264im      0.195178-0.314911im      -0.122179-0.106569im     0.0715569+0.0729736im      -0.0783983-0.190791im    0.0201798+0.25167im        0.140592-0.199991im      -0.139726-0.14315im        0.147334+0.0666528im     0.113865-0.00361404im   0.0314268-0.167374im    0.0858889+0.090521im
 -0.00739309-0.263745im    -0.00988122-0.0653496im      -0.220878+0.0183974im    0.0456154-0.0915897im       0.104646+0.0688048im      0.0332985+0.003064im     0.112561-0.0153764im   0.0191487+0.172696im      0.120245+0.0706447im     -0.336931+0.0951675im      -0.07297+0.0358394im     -0.183736-0.00548712im    -0.150413+0.111552im      0.0402008-0.121121im     -0.183272-0.153456im    -0.0649222+0.0105337im     -0.095106+0.196989im      0.0710268-0.169546im      0.0429299-0.0116748im   -0.0833951+0.117973im      0.229466-0.18351im     -0.00101824-0.0591512im     -0.111684-0.0103796im    0.0821953-0.0955608im        0.120885+0.0356705im    0.117528+0.0102274im      0.234225+0.116972im      0.0419489+0.161652im      -0.180434-0.0416503im      0.32627-0.0284728im     -0.07497+0.059388im    0.0861043-0.0642831im
  -0.0297573-0.164721im        0.17126-0.0659645im   -0.000344192+0.079158im     -0.144953+0.226464im    -0.000817506+0.0858166im      0.0570962-0.197969im   -0.0902245+0.0345133im   0.0511208-0.0278521im    -0.185652+0.0565747im     -0.197808-0.0679335im     -0.151231+0.0136289im    0.00780247-0.165263im     0.00873636+0.0447812im     -0.083367+0.161398im      0.169222+0.0247366im    -0.102377+0.160292im      0.0908341-0.0428528im     0.0521198+0.0695039im    -0.0604606-0.023761im      0.262734+0.281548im     0.0945169-0.0917181im    -0.0213769+0.145858im      -0.230261-0.0444617im     0.075059-0.0810143im        0.140604-0.136185im    -0.242708-0.00406835im     -0.27338+0.0586584im     0.0995923-0.00277088im     0.150782+0.0675825im     0.105227-0.0835076im     -0.11443+0.0440709im   -0.178603+0.103941im
     0.20364-0.147761im       0.128122+0.0830807im       0.111568+0.104865im     0.0757988+0.118169im         -0.2005+0.23538im        -0.134081-0.0018954im   0.0124044-0.0572233im   0.0387275+0.04547im      -0.146659+0.0527864im     0.0172778+0.146194im       0.112654+0.179im       -0.00785255-0.0654667im     0.0170834-0.15722im        0.117963-0.159429im    -0.0748539+0.0126218im    -0.248992-0.166748im      0.0557525-0.224318im      -0.160958-0.0118153im    -0.0495029-0.00231427im  -0.0602629+0.0965616im    0.0286401+0.0850205im     -0.109872+0.00864097im   0.00212396+0.0612951im   -0.0565662-0.0932877im       -0.117799-0.232712im    0.0613928-0.0392574im    -0.0409189-0.0371057im     -0.145353-0.287908im      -0.213522+0.16212im       0.205586+0.0265267im     0.141205+0.107104im     0.185202+0.0546097im
  -0.0901989+0.022698im     -0.0123776-0.0898244im      0.0475397-0.157658im    -0.0550988+0.0973692im      -0.151313-0.175489im       0.0681854+0.0222337im   -0.079532+0.327638im    -0.112542-0.22521im     -0.0545284+0.191366im      -0.205654+0.0429323im     0.0131891+0.0843661im      0.157542+0.191193im     -0.0241145+0.0832475im     0.0555575+0.0596235im    -0.149254+0.203475im     -0.135981-0.0673795im     0.0451103+0.0754422im     -0.063581+0.119328im      -0.163196-0.117118im    -0.0151998-0.0552646im     0.104972-0.0615937im    0.00483096-0.166233im      0.0838349+0.0760047im     0.167866+0.0780795im      -0.0327758+0.112843im     0.149132-0.28277im     -0.00487956+0.271141im      0.0540637-0.0715354im     0.0571539+0.248481im    -0.0119833-0.0062084im   -0.0853276-0.0268016im    0.139316+0.070438im
  -0.0829123+0.139708im     -0.0538359-0.0305338im      -0.179003+0.0237369im   -0.0769683-0.0524473im      0.0845797+0.0512368im      0.0714585-0.128673im    -0.182838+0.0394699im   -0.163207+0.0384108im     0.216475+0.10322im     -2.75573e-5-0.00700243im    0.0235693+0.0360306im     -0.139709+0.192715im      -0.262913-0.178601im       0.238649+0.0894831im   0.00574673-0.01323im     -0.0717981-0.200158im     -0.0739539+0.00652197im    -0.168324+0.176796im      -0.105885+0.0439359im     0.152735+0.125627im      0.127504-0.0702365im     -0.245124-0.0146118im    -0.0540748-0.0836769im   -0.0371073-0.218734im       -0.0834911+0.105575im   -0.0303612+0.178512im      0.0796831-0.242404im     -0.0470951-0.16223im      -0.0283881+0.017658im     -0.134264+0.0307777im   -0.0700272-0.173634im    -0.142367+0.168868im
  -0.0355077+0.0296247im     -0.176785+0.186241im       0.0284898+0.139746im     -0.120495-0.212565im        0.162492-0.17242im       -0.0582475+0.232601im   -0.0892283-0.125041im   -0.0125283+0.0519127im     0.145787+0.114602im      -0.105434-0.158457im     -0.0707069+0.099143im      0.0635302-0.115687im      -0.220066+0.0731548im    -0.0773659-0.00306658im  -0.0339936+0.0950622im   -0.0669045+0.154045im      -0.006671-0.138652im      0.0777572-0.119165im      0.0840524+0.0435717im      0.06382+0.200956im     0.0584474+0.290739im      -0.194751-0.0947411im      0.228403+0.125135im    -0.0627845-0.131975im        0.0466741-0.167232im   -0.0615857-0.0606925im    -0.0251788+0.208308im      0.0113643-0.145288im      0.0504942-0.0396379im     -0.14993-0.0373133im    -0.120983+0.166285im     0.120695+0.0778765im
  -0.0985106+0.144975im      0.0702267-0.303842im        0.114005+0.00374368im   0.0670709-0.0350861im       0.113234-0.0740856im       -0.07768-0.034126im    0.0980164+0.045688im     0.209822+0.0136231im    -0.158027-0.0895628im      0.195324+0.132779im     -0.0606918+0.0657555im    -0.0564148-0.0385721im    -0.0601237-0.0102431im     0.0537126+0.165237im     -0.122268+0.310389im     -0.146147-0.171325im       0.033672-0.0776644im      0.230669+0.0635713im      0.114589+0.0098431im     0.178188+0.0618735im    0.0912193+0.0100867im     -0.112225-0.0801174im      0.192991-0.316957im       0.11161+0.00182397im       0.069029+0.0321703im  -0.0150317+0.00889956im   -0.0396841+0.0519117im    -0.0499891+0.0348947im       -0.1751-0.329146im        0.1257-0.0253239im   -0.0232763-0.0400199im   0.0998798-0.0450861im
    0.188222+0.080752im      0.0734576+0.104018im       0.0547186+0.00849193im   0.0444136-0.0296293im      0.0796359-0.0352906im      0.0780773-0.0129995im   -0.161624+0.109938im   -0.0401336+0.248912im     -0.268958+0.261101im      0.0351891-0.0789149im    -0.0456983-0.0928189im    -0.0352947-0.227058im      0.0850204+0.252147im       0.171322-0.0277274im   -0.0688074+0.0153533im       0.1057-0.0653624im     0.0975022+0.179864im       0.100552+0.176458im      0.0713286-0.0198013im    -0.180199-0.0102093im     0.101265-0.116673im       0.105123+0.0360344im     0.0708276+0.00886584im   0.0240565-0.190504im       0.00668754+0.0127688im   0.0101824+0.103353im     0.00550427-0.0929771im    -0.0490904-0.1608im       -0.0275364+0.00785793im   -0.205556-0.41061im      0.0171243-0.0422703im    0.121019-0.108572im
   -0.229963-0.0310793im    -0.0501065+0.129846im       -0.147239-0.158567im    0.00226398-0.163769im       -0.131224-0.0142047im       0.128494-0.226627im     0.101954+0.0401088im   0.0832023+0.0548793im    -0.243816-0.00319666im    0.0129347-0.178607im      -0.214644-0.18276im      -0.0426261+0.010353im       0.034545-0.0948075im      0.102611-0.0120417im   -0.0819951-0.0760168im     0.217254+0.121819im    -0.00172731-0.227062im        0.12643+0.0884932im     -0.101247-0.0785209im     0.250049-0.0807375im   -0.0591031+0.0631384im    -0.0995364-0.0239467im       0.11229-0.00798555im   -0.208432-0.043631im        -0.015371-0.144044im     0.168029-0.0716753im      0.121968-0.138935im     -0.0272156-0.0186519im     0.0225095+0.164297im      0.196115+0.0276832im    -0.173348-0.0496822im    0.208739-0.0912524im
   0.0631172-0.0146842im    -0.0335084-0.034567im      -0.0912346+0.0354822im    0.0356087+0.289986im        0.256963-0.0771442im     -0.0175081-0.0737802im   0.0267709-0.309237im    0.0359169-0.16126im      -0.047209-0.141265im      0.0105664-0.065897im      0.0802606-0.0943943im     -0.247502-0.0434462im     0.0677451+0.179991im      0.0431978-0.024156im    -0.0278028+0.135443im    0.00887522-0.0901765im     0.0123089-0.303053im      0.0148846+0.0801602im     -0.128171-0.0123451im   -0.0893355+0.0394733im     0.166934+0.0524581im      0.138422+0.070141im      -0.112338+0.108641im     -0.154212+0.000533539im     0.0693372+0.318674im    0.0512391-0.163717im       0.212012+0.0618044im     0.0545871-0.264061im      0.0811616-0.0252305im   -0.0345725+0.0723581im     -0.14876+0.0318665im   0.0196735-0.0561752im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.13655860481061124 + 0.10333957969258278im
   -0.18826243441657534 + 0.1465362939097317im
    0.08371719682547453 - 0.10614739829213625im
     0.1760481000223904 + 0.028616144807102697im
       0.30880009130245 + 0.0im
    0.16810329495249204 - 0.13329761706821328im
  -0.010580568469623025 + 0.10533690119140696im
   -0.14689830463444895 + 0.19807181675499166im
     0.0953974159683831 - 0.09940817042957162im
   -0.04908092274459083 - 0.06382504851765822im
    0.06835393553468277 + 0.08485309553869377im
    0.21750704279603697 + 0.14329868564115777im
  -0.046203252688974086 - 0.042551675182239686im
    0.22766094545845317 + 0.008097130746457211im
   -0.01866678612751359 + 0.017648160955394766im
   -0.06499861555462107 + 0.18403692210730516im
     0.0841892156686285 - 0.21516458867789812im
     0.1887761036929921 - 0.13839657468235558im
    0.09386424333658636 + 0.06236844535037754im
    0.16303994034449126 - 0.01578766690761854im
      0.167038129309222 - 0.005348109751169991im
     0.1314200413064632 + 0.039469073595118274im
    0.03289115765158824 + 0.16061350831615265im
   -0.08435886558591517 - 0.048232086683664854im
    -0.1498739244870894 - 0.1905696945301155im
   -0.04158993217664344 + 0.007857722629704137im
 -0.0059598584100616905 + 0.06254464565996885im
   0.044308545174954854 + 0.018480701494595044im
   0.024917405392356512 + 0.2673451822638572im
     0.1753107051926295 + 0.11505581699615454im
   -0.02312354857580638 - 0.15033498703503384im
  -0.017370552177314962 + 0.11566274852604153im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 15 May 2023 16:25">Monday 15 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

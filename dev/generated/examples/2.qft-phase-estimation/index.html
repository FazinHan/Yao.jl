<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.165116-0.110641im     0.0152738-0.0432069im    0.0153334+0.0426354im     0.195643-0.158805im     -0.174802-0.303461im     -0.0722567+0.0138114im   0.00751167+0.00950918im    0.0904111-0.0629979im     0.0123303+0.0641685im     0.0158284-0.00351438im   0.00456052+0.133005im     -0.155723+0.191783im     0.00596387-0.176761im      -0.151497-0.0497362im    0.0142333+0.083116im      -0.122555-0.00887728im    -0.195969+0.0465719im       0.154413+0.164793im     0.0897399-0.067406im     -0.170652-0.126162im    -0.0337527+0.0937274im     0.107072-0.0233079im     0.127828-0.0396113im   -0.0562526-0.0444431im    -0.201952+0.176823im      -0.149439+0.311911im        0.0216684-0.163629im     -0.0800118-0.0824059im    -0.0721443-0.0340464im       0.26121+0.0440135im    -0.0435903-0.205734im       -0.157519+0.135814im
   -0.044811-0.113107im    -0.0962068+0.182262im       -0.1233-0.0022725im    0.0424333-0.0744513im   -0.0524139-0.0106142im   -0.00954615-0.108331im     -0.115829+0.0577738im      -0.02286-0.15137im       -0.026116+0.108603im       0.123082-0.0609411im     0.0903476-0.0842024im     0.126856-0.121641im      0.0496963-0.161822im     -0.0305371-0.0298486im     0.245964-0.0082185im   -0.00731164+0.107147im       0.081398+0.0152962im       -0.16552+0.0912361im    -0.157496+0.130447im     0.0280073+0.170077im      0.214701+0.0235492im     0.213739-0.00603725im  -0.0317127-0.18422im      -0.056262+0.0847208im      0.16277-0.210692im     -0.0170196-0.100913im       -0.0279549-0.105172im     -0.0144098-0.120313im      0.0833835-0.410597im       0.088759+0.0258196im      0.146622+0.0512094im      -0.216893+0.265199im
    0.160904-0.0564066im   -0.0726541-0.259443im      0.294872+0.307496im     -0.171127-0.0093977im   -0.0432624-0.178797im       0.163003+0.0104802im     0.200117+0.0966717im      0.049098-0.201427im      0.0735812+0.0797166im     0.0849764+0.0888346im    -0.0975499+0.0777733im   -0.0293152-0.197412im      0.0294558-0.143065im      0.0914171-0.0668391im    0.0699084-0.105142im       0.215074-0.0329445im     -0.119669-0.178568im      -0.0777828+0.0561367im   0.00955402-0.105417im      0.147201+0.0293726im    0.0864246-0.120345im     -0.053526-0.0804821im   -0.0232727+0.0640949im    0.0814716-0.0241551im     0.161712-0.0365301im     0.0560234+0.0490295im      -0.0442486-0.122952im       -0.02085+0.103824im       0.159674+0.109415im      0.0485485-0.241644im     -0.0614496-0.100119im       -0.221786+0.00390504im
  0.00893526-0.15769im     -0.0160413-0.227826im    -0.0725087-0.0973593im    0.0833962-0.0149537im    -0.194233+0.0587484im     -0.108671+0.0721109im    0.0740852+0.161726im      0.0439359+0.065831im       0.105519+0.309764im      -0.163877+0.0601344im     -0.045617+0.0553835im    -0.219512+0.235454im     -0.0879662+0.0825036im     -0.371558+0.112384im     0.0472251+0.0288751im      0.078837-0.0728399im     0.0709629-0.133163im       -0.145715-0.00786447im   0.0230678+0.106734im     0.0899684+0.0734932im   -0.0138758+0.103509im      0.120964+0.120179im     -0.237275-0.110689im    -0.0427744-0.059928im     0.0188486-0.126625im       0.142159-0.220018im        0.0176316+0.0105377im    -0.0925423+0.164392im      0.0762239+0.214661im     -0.0519617+0.101772im      0.0489683-0.0249975im     -0.0497077+0.0619565im
    0.285431-0.125627im      0.169692+0.00474816im   0.0546496-0.0141289im    0.0329323+0.024127im    -0.0578233-0.0265134im     -0.101744-0.0359369im   -0.0695918-0.0661329im     0.0199062+0.0749324im      0.142374-0.00743378im     0.212763+0.171386im       0.244374-0.145908im    -0.0455452-0.0739087im    -0.0234413-0.0450071im     -0.102896+0.0221851im   -0.0877964+0.0222507im      0.209426-0.123089im       0.203662+0.251747im       -0.137783+0.0538083im      0.19112+0.0864383im    -0.208472+0.0955907im    0.0590474+0.156884im      0.131871-0.0132983im    0.0157137+0.179214im     -0.095329-0.11671im      -0.106616+0.00531271im    -0.208119+0.0140286im       -0.214613+0.127001im      -0.075962+0.0728386im     0.0552955-0.0441443im     0.0692776-0.304526im     0.00543388+0.047452im       0.0282202-0.126175im
   0.0906332-0.228333im      0.108128-0.0979769im    -0.153017-0.0303159im   -0.0677946-0.0788704im     0.120321-0.0873062im      0.165194+0.14994im      0.0960282+0.0285024im     -0.179497+0.336919im      -0.190602-0.0218774im     -0.216053+0.0250266im      0.101714-0.101356im    -0.0322852-0.162236im      0.0287101-0.139629im      -0.122768+0.0396208im    0.0499123+0.0517617im     -0.136458+0.0973162im    -0.0482249-0.162404im        0.195387+0.0517376im    -0.155887+0.0642055im   -0.0147779-0.0315602im   -0.0414561-0.0903448im    0.0187033-0.0168183im   -0.0370577+0.091514im    0.00253537+0.0220714im   -0.0560852+0.182384im       0.070751-0.0680077im       -0.245872+0.211051im      0.0840424-0.0707782im      0.328448-0.0991811im     0.0719537-0.0931965im    -0.0898317-0.0793488im      0.0467581+0.148549im
   0.0274419+0.0792245im    -0.228009+0.304623im     0.0234732-0.0102113im      -0.1872-0.0362788im   -0.0771878-0.0642039im    -0.0486958+0.29657im       0.205236+0.0973213im     -0.103924+0.100607im      0.0298358+0.0231351im       0.11278-0.0788618im    -0.0325946-0.131416im    -0.0537163-0.0121745im    -0.0602987-0.232992im        0.19959+0.163814im    0.00732918+0.0817464im    -0.0921475-0.0520903im    -0.0038073-0.206995im      -0.0875664+0.0926059im      0.01299+0.255682im      -0.11888+0.187966im     -0.230062+0.145888im    -0.0470895+0.0835896im     0.184914-0.0528871im     0.112576-0.254385im     0.0637614+0.0296852im    -0.0914518-0.000736241im    -0.0148745-0.0191883im     -0.168701+0.0275191im    -0.0351584+0.141583im    0.000777626+0.0779361im    0.00374297+0.105283im      -0.0211966-0.00795079im
  -0.0701993-0.0103795im   -0.0466524-0.00427867im    0.148338+0.178138im     0.0514542+0.224009im     0.0278962+0.110975im       0.134196+0.0453538im    0.0388995+0.135065im       0.161009+0.211822im      -0.115905+0.0111667im     -0.101536-0.3308im         0.362138-0.0683516im     0.106895+0.133456im     -0.0299746+0.150673im      -0.232254-0.0314629im    0.0454025-0.0356362im     0.0223014-0.00929664im   -0.0433241+0.011427im       0.0134944+0.0425425im    0.0667886+0.140018im     -0.121361+0.017026im     -0.110854-0.152591im     -0.118675-0.126844im      0.197941+0.112791im    -0.0289432+0.136291im      0.114934+0.0133112im      -0.07986-0.0496246im      -0.0444927-0.317577im     -0.0479767+0.161604im    0.000431686-0.0498194im   -0.00315746-0.0339278im      0.179033+0.00321693im    -0.0908669-0.0641274im
   -0.272726+0.0702644im    0.0125756-0.0484077im     0.151898-0.112951im      0.013734+0.143332im     0.0394171-0.0237426im      0.176981-0.0216538im     0.149089-0.0150065im     -0.145841+0.199358im       0.012848+0.194006im     -0.0811272+0.0959846im    -0.0749855-0.0407065im   -0.0302916-0.0301345im      0.325751-0.152086im        0.11087-0.136796im     -0.209694-0.00560671im   -0.0871275-0.02036im        0.194546+0.143917im       -0.129207+0.0137628im    0.0796466+0.040631im    -0.0739995+0.162302im     -0.022171+0.0169451im     0.103374-0.349866im     -0.172516-0.0689332im    -0.193514+0.106806im    -0.0590131+0.0868022im    -0.0360881-0.0448483im        0.129382-0.138455im      0.0468163-0.0595713im    -0.0180745+0.12385im      -0.0316917-0.0403646im     -0.137377+0.156423im      -0.0842195+0.109873im
   0.0068958-0.0173864im    0.0921127+0.114065im     0.0368226+0.0335786im     -0.12152-0.0112093im     0.100174-0.043288im      -0.101544-0.0198131im    0.0273992-0.113702im       0.260846-0.158802im       -0.25718-0.109576im      0.0729922+0.0756636im     -0.056134-0.189339im    -0.0638945+0.104214im      0.0984335-0.0431399im     -0.207887+0.0118436im    -0.176592+0.00873626im    -0.113761-0.0245256im     -0.143524-0.145149im       -0.153471+0.0878577im    -0.216367-0.21919im     -0.0837772+0.0564131im    -0.106844-0.0944164im    0.0121645-0.166359im     -0.149355-0.0175089im   -0.0949539-0.259292im    -0.0315702-0.0078048im      0.148566-0.0807999im       0.0366364-0.0531837im     0.0672173+0.247763im     -0.0648916-0.0831726im      0.206772-0.0907939im      0.116362+0.218844im        0.189601+0.0641461im
   0.0247671-0.019329im    -0.0879482-0.0242155im    -0.168586-0.0559876im     0.060217-0.0633026im   -0.0413578-0.00973507im    0.0636387-0.0764327im   -0.0373438+0.0548206im     0.0984104+0.138828im     -0.0486783-0.28076im       0.0741094-0.18819im     -0.00576993+0.191183im     -0.185601-0.0527226im      0.135536-0.0446021im      0.067302+0.239144im      0.100838+0.0105158im     0.0664457+0.264786im       0.115862+0.255266im       -0.246831+0.0688307im     0.149862-0.0879825im     0.138175+0.0512044im    -0.341039-0.195179im    -0.0488417+0.0360766im   -0.0576073-0.0775068im     -0.14469-0.175665im      0.102488-0.0526919im   -0.00106138+0.0127957im       0.0624612-0.0278873im      0.098889-0.00776197im    0.0408998+0.0797289im     0.0252538-0.149386im     -0.0210288-0.238028im       0.0430149+0.10189im
   0.0585318-0.0458502im    0.0995867+0.0104418im    -0.102384+0.169733im     -0.157657+0.0744111im   -0.0181342-0.235719im      -0.185884-0.125599im      0.106782-0.119268im     -0.0329852+0.156481im    -0.00619167-0.0347586im     -0.224185-0.202404im      -0.159937+0.245763im      0.295611+0.228335im        0.07085-0.147405im      -0.135889+0.11219im     -0.0305142-0.173547im     -0.0856288-0.231546im       0.056465+0.111038im      -0.0271718+0.0357404im     0.108937-0.100994im    -0.0318357+0.0206171im      0.15208-0.0120532im   -0.0288779-0.0235509im    0.0207126-0.0204394im     0.114756-0.198138im      0.224415-0.0462474im    -0.0636409-0.0818868im      -0.0893898+0.106561im      0.0722817-0.218923im     -0.0721623+0.00376314im    -0.076785-0.0490362im     0.0281024+0.121747im      -0.0754358-0.00368954im
  -0.0264872+0.0870139im     -0.12036-0.0739475im   0.00435742+0.0764961im   -0.0675797-0.1011im      -0.0112086-0.0312849im     0.0253728-0.00882347im   -0.109284-0.392375im       0.107697-0.0124857im    0.00613236+0.108492im      0.0420559-0.215917im        0.10062+0.121188im     -0.301106-0.152242im       0.216814+0.196834im     -0.0250359+0.0636667im    0.0881677-0.151649im      -0.258569-0.0319341im     0.0323782+0.000374024im     0.136618+0.205889im      -0.05097+0.0804007im  -0.00878046+0.291593im      0.098109+0.0362657im   -0.0726819+0.00064765im   -0.120416-0.0258809im    0.0868307+0.0386058im   -0.0681391-0.0936293im     0.0285054-0.0625823im       -0.134899+0.0151264im     -0.120036-0.00494763im   0.00522376-0.00557996im     0.103751+0.0446025im     -0.185623-0.00633898im   -0.00745152-0.297735im
  0.00215308-0.141036im     0.0141306-0.037903im      0.111598-0.0227736im     0.148328+0.130553im    -0.0962024-0.0783667im     0.0406737-0.0502864im    -0.258686+0.339658im       0.167388+0.187669im      0.0925553-0.0909352im     0.0140739+0.010034im      0.0438338+0.15229im      0.0304896+0.102502im       0.117554+0.0441062im      0.301317-0.00187868im  -0.0544051-0.02601im      -0.0130698-0.24822im      -0.0544267-0.0940246im     -0.0581678+0.00724756im   -0.223431+0.19379im     0.00187011+0.0860617im     0.130376+0.114017im     -0.174218+0.0020877im    -0.141122-0.240756im      0.162641-0.0436533im   -0.0275689+0.0565082im     0.0191399+0.0981657im      -0.0938101-0.0351053im      0.158963+0.0155753im     0.0239299-0.0568587im      0.126052-0.0926206im   -0.00630249-0.0321709im       0.282378+0.019512im
 -0.00686302+0.177567im      -0.25255-0.0693505im   -0.0608165-0.0157743im   -0.0611697+0.16778im       0.173364+0.0348426im     -0.156748-0.134123im    -0.0574004+0.151852im       0.195269+0.0541133im    -0.0409084+0.0736327im     0.0138103-0.132028im      -0.148102-0.0853205im   -0.0459777-0.124183im      -0.260871-0.0310199im    0.00464126+0.0302068im    0.0749723-0.17231im      -0.0294298+0.134491im      0.0225269+0.0998198im       0.154987+0.0394487im   -0.0772866+0.0907058im    -0.326221-0.0813028im     0.116056+0.0278099im     0.130257-0.122171im     -0.183581+0.0399307im     0.028704-0.153219im     -0.126105-0.104449im     -0.0213657+0.237699im        0.0146378+0.058546im       0.220538+0.0188746im      0.222376+0.21617im      -0.0620937-0.0216664im     0.0704668+0.0338369im      -0.113419+0.0466345im
   0.0193972+0.0598404im    0.0457687-0.0617502im    0.0186132-0.00378063im  -0.0760361+0.104283im     -0.171993-0.105177im      -0.231326-0.0496399im     0.109618-0.0792066im    -0.0674939+0.0570091im      0.162146-0.309396im      -0.146308-0.0463836im     -0.036045-0.180145im      0.118487-0.0140047im     0.0899468-0.0176563im     -0.185243-0.11836im     -0.0816038-0.010298im       0.166565+0.124389im      -0.109925-0.0189456im    -0.00714014+0.108083im     -0.229765+0.162449im     0.0154916+0.271357im    -0.0378475+0.00518071im   0.0831438+0.174901im    -0.0579139+0.0637157im   -0.0312506+0.199184im      0.118936-0.0496584im     -0.164116+0.20194im           0.28169+0.0266841im      0.117009+0.135618im      0.0644742-0.0171786im     0.0447524+0.111768im       -0.23048-0.101824im       0.0639756-0.0536312im
   0.0738904-0.168454im     -0.141229-0.0427978im     0.229349+0.110044im     -0.134158-0.128451im     -0.101874-0.134504im     -0.0845081-0.0193847im    0.0880619-0.0336084im     0.0807635-0.0363229im     0.0210407+0.0835236im     -0.135788-0.258509im     -0.0725943-0.0278924im    0.0507933-0.114367im      -0.191277+0.123323im        0.11936-0.0533522im   -0.0820935+0.33375im      -0.0766318+0.129156im       0.254127+0.216825im       -0.108656+0.0758767im    0.0979363+0.0324024im     0.092427-0.167369im     0.0245615-0.00829567im   0.0203158+0.0408117im   -0.0587145-0.0282768im     0.152984+0.122541im    -0.0927109+0.188961im     -0.0287271-0.142921im         0.026748+0.0665759im      0.176702+0.148216im    -0.00252448-0.0607245im      0.239281+0.13571im       0.0141108+0.174386im       0.0945641+0.0625933im
   0.0845343-0.198058im      0.341018+0.0922515im   0.00971003-0.106157im     -0.122909-0.0617864im    0.0363153+0.06653im       -0.179611-0.0749082im   -0.0361908+0.075401im        0.12721-0.00633274im     0.155274+0.178465im       0.136093+0.130261im        0.11363+0.0294116im    0.0603123-0.0950325im      0.077942-0.0266158im      0.104841+0.0752978im    0.0879248-0.129119im      0.0104932-0.0324657im     -0.081919+0.15296im         0.301925+0.314932im      0.119857+0.0089303im   -0.0714613+0.0434203im    -0.218014-0.166653im    -0.0423622+0.0225394im   -0.0239373-0.0521019im     0.150682+0.0485522im     0.110305+0.152926im       0.167139-0.0760393im        0.227212-0.118681im      0.0611068+0.0351744im      0.111474+0.0587339im      -0.10923+0.168923im     0.00447667+0.122424im      -0.0411325+0.0629167im
   -0.271686+0.0839141im     0.291426+0.0481132im   -0.0696678+0.0921861im   0.00604536+0.168311im     0.0358901-0.0142747im     -0.162508-0.0187246im     0.128536+0.0389498im     0.0648832+0.00741074im   -0.0135126-0.130221im     -0.0710986+0.204176im     0.00730428+0.156502im     -0.221259-0.0234915im    -0.0985914+0.0753524im      0.157895+0.0484457im     0.163384+0.0410474im       -0.1327+0.0374947im      0.100172+0.0988927im       -0.19428+0.0166817im    -0.207585+0.0651969im    0.0258034+0.0401978im    0.0909213+0.034192im    -0.0207489+0.0928528im     0.119283+0.261307im     0.0789195-0.0161746im  0.000835436+0.10573im       0.0631853-0.0341088im       -0.240174-0.0420276im     0.0996953+0.260223im      -0.127223-0.0380925im    -0.0853787+0.0373827im     -0.124731+0.020152im       -0.294199+0.119969im
  -0.0600558-0.21977im      -0.132174-0.0225373im    -0.074143-0.125675im     -0.254696+0.0261714im     0.133127-0.110776im      -0.255299-0.171702im     0.0536586+0.00713763im   -0.0852976+0.0817414im    -0.0743896+0.00293484im    0.0718127+0.152702im        0.30219+0.00687352im   0.0660732+0.0628174im    -0.0670377+0.168527im      0.0488529-0.0610917im   0.00910723+0.128429im      0.0467198+0.113353im      -0.150191-0.0659653im     -0.0301563-0.0473073im     0.129834+0.0269352im     0.191614+0.121364im    -0.0284318+0.160119im     -0.177953-0.336524im     0.0569609-0.0289342im   -0.0357074+0.0332418im  -0.00157433-0.196226im       0.134724+0.106732im       -0.0624812+0.113679im       0.105444-0.0999129im     -0.131311+0.157272im       0.198988+0.0724241im      0.007018-0.0768534im       -0.14201-0.0398049im
   0.0795091-0.258037im     0.0669114+0.039682im     -0.168302-0.142956im     0.0913613-0.165029im    -0.0393667-0.107506im       0.124953+0.181228im    -0.0516682-0.290741im       0.240748-0.0535455im      0.056541+0.0315638im    -0.0588478-0.207011im       0.124546-0.0442655im    0.0390759-0.00882919im    0.0293898-0.0722543im      0.158096-0.0598344im   -0.0196462+0.100954im        0.15317+0.0510683im     -0.117635-0.0810516im     -0.0521613-0.209616im    -0.0702875+0.0921902im    -0.186141-0.0181312im     0.138324-0.0701252im    0.0237807-0.0925857im   -0.0850402+0.195586im      0.126893-0.0267216im    0.0178364-0.139257im     -0.0329045-0.0553669im       0.0231093-0.131095im       0.135708+0.00954758im    -0.218391+0.24957im         -0.2139-0.0124913im      -0.14926-0.00849517im    -0.0171711+0.191372im
   -0.180644+0.00898895im   0.0380341-0.103806im     0.0485405-0.234761im     -0.109899-0.10121im      0.0242004+0.00965799im    0.0325481-0.133411im    -0.0250544-0.212797im       0.066324+0.0680271im     0.0358788+0.00679188im   -0.0357897-0.140182im      0.0206507-0.0975651im    0.0571201-0.0619857im   -0.00913905-0.00383704im     0.102684+0.148516im     -0.245774-0.255241im       0.211785-0.0549412im     0.0567289-0.0762579im      -0.169206+0.0940369im     -0.10502+0.210416im      0.102325-0.175053im      0.108375+0.0414431im    0.0493393+0.130318im     0.0517874+0.150282im     -0.127406-0.0990015im    0.0710051+0.28127im        0.267452+0.114568im       -0.0137206-0.0477057im     -0.149115-0.100954im       0.016835+0.0293779im      0.159413+0.085426im       0.262015-0.118504im      -0.0888072-0.0107854im
   -0.143322-0.106189im     0.0271165+0.0630904im     0.119682+0.3351im        0.239105-0.154406im    -0.0671149+0.275065im     -0.0354167-0.148956im     -0.054583+0.00734718im    -0.204708+0.138612im     -0.0625148-0.0434325im     0.0652739-0.0174864im       -0.1042-0.0574926im   -0.0626294-0.0256101im      0.103029+0.110098im    -0.00394665+0.0204948im    -0.302736+0.197663im       0.128998+0.253064im     -0.0928029-0.0178493im       0.110168+0.187474im     0.0134869-0.0630496im    -0.122864+0.0453312im     0.152364+0.206628im     -0.114966-0.0141171im    -0.045829+0.105913im      0.158058-0.234296im      0.171009-0.0700549im      0.049704-0.0773196im    -0.000430745-0.000269047im  -0.0106082-0.0625273im     0.0538241+0.0453826im    -0.0860218+0.0381584im     0.0401653-0.0471291im     -0.0578682+0.0821019im
  -0.0745644+0.0379315im     0.131552+0.00464513im    0.161488-0.103317im       -0.1662+0.10837im       0.109393+0.0619941im    -0.0053877+0.186173im    -0.0561361+0.0588601im       0.13251-0.0243809im    -0.0893397-0.00655558im     0.100897-0.0672434im   -0.00187584+0.00905911im  -0.0996107+0.174328im      -0.130764+0.107216im      0.0372975+0.0716997im    -0.195136+0.100062im      0.0252993+0.0663014im     -0.207851+0.0322488im      -0.212466+0.0680147im     0.014957-0.170998im    -0.0251704+0.145722im    -0.0658543-0.109499im      0.227106+0.113814im     -0.207443-0.00766535im    0.244363+0.279047im     0.0840421+0.0168827im     -0.156355+0.0637268im       -0.194168+0.0863101im     -0.128249-0.387376im      0.0932441+0.0286342im    -0.0178632-0.0151611im   0.000457932+0.000478653im   -0.0742868+0.0542125im
    0.144764+0.0574586im   -0.0451569-0.119321im    -0.0517861-0.0200632im   -0.0633616+0.392528im    -0.0873681-0.0848812im     0.0657379-0.148091im     0.0869011+0.0533926im     -0.119005-0.0977984im    -0.0811242-0.0174197im    0.00102237-0.0218183im      0.206831-0.133978im     -0.124684-0.0454628im     0.0755487-0.102163im      0.0412666+0.293841im     0.0808333+0.185384im        0.11919+0.0754047im    -0.0819059-0.0678843im      0.0293933+0.0625646im     0.155125-0.143547im    -0.0739883-0.00244962im    0.313983-0.0831734im    0.0380192+0.0679059im    -0.107266-0.0650049im   -0.0800477-0.124371im    -0.0299345+0.187305im      0.0411851-0.00234748im     -0.0852216-0.161713im       0.015276-0.0678675im     -0.156204-0.0625229im     -0.100365+0.327232im     -0.0876167+0.0124103im        0.16214-0.0380982im
    0.165799+0.153238im    -0.0149559-0.172029im     0.0388058+0.142025im    -0.0305392-0.0139382im   -0.0672799+0.108404im       0.029297+0.0347132im   -0.0694409+0.047908im       0.115881+0.108743im       0.337712-0.153855im      -0.087609-0.099471im     -0.0523053-0.051011im     0.0577602-0.118764im      0.0879108+0.0776285im   -0.00167876-0.0681066im     0.158322+0.14601im       0.0382026-0.0811236im     -0.202012-0.0653701im     -0.0242158+0.0826101im   -0.0459969-0.0227849im   -0.0975151-0.0258328im    -0.280615+0.161304im      0.027457-0.035893im     -0.104449+0.0277865im    -0.222761-0.0216958im     -0.15843+0.0498335im      0.227028-0.069217im       -0.0954767+0.117247im      0.0459191-0.241455im      -0.265801-0.126554im     -0.0386003+0.018942im      0.0396708+0.183009im       -0.247128+0.0952768im
   -0.050473-0.0126781im   -0.0111938+0.0813888im     0.229795+0.196614im     0.0301419+0.121781im      0.168164+0.0327672im    -0.0343405+0.166504im     -0.135223-0.161984im     -0.0349311+0.0228776im      0.164565+0.0181576im    -0.0235342+0.0108878im      0.105976-0.0620125im   -0.0431492+0.131504im     0.00268595-0.37244im      -0.0424375-0.0924263im     0.153544+0.0300939im     -0.115914+0.00752041im    0.0475257+0.0889643im      -0.178792-0.0282666im    0.0810744-0.0193386im   -0.0475713-0.0235974im   -0.0286366+0.0667777im     0.137117-0.0676031im   -0.0226314+0.0562091im     0.163494+0.0264071im    0.0303763-0.0470854im      0.398701+0.0327652im       0.0702671+0.118383im       0.136304+0.0111822im     0.0244594-0.0483072im    -0.0644096+0.127632im      0.0871221-0.374438im        0.165296-0.133007im
   -0.100614-0.0300729im    -0.230449+0.0538455im   -0.0765179+0.0713705im    0.0653386+0.0411314im     0.315092+0.0222879im     0.0875371+0.197258im     -0.198109-0.0514389im    -0.0560443-0.0400337im    -0.0610434+0.130016im      0.0268603+0.0600405im     0.0928081+0.131836im      0.111589-0.13826im       -0.155253-0.00928185im     -0.17099-0.113299im    -0.0620917-0.026922im       0.154362-0.194042im     0.00228581+0.0452345im      0.0125329+0.0948297im    0.0834694-0.0328817im    0.0830752+0.137538im     -0.068048+0.0276906im    -0.131819+0.184173im     -0.287226+0.0174129im    -0.083177-0.137307im      0.213958+0.276995im      -0.127633+0.118877im       0.00313151+0.0919754im      0.117133+0.141198im      -0.206848-0.0534454im     0.0361925+0.0848961im      -0.14587-0.00978936im     -0.082564+0.143131im
  -0.0779577+0.061198im     0.0639247+0.0845472im     0.154132+0.107848im      0.177222-0.0275258im    0.0912698-0.153154im      -0.280171-0.116794im     -0.103241-0.137658im    -0.00556961-0.0706432im     0.0155069-0.115004im     0.00279459-0.0798254im     0.0782257-0.0730988im    0.0244546-0.100897im      -0.043515+0.114552im     -0.0269187+0.0550916im     0.157592+0.096385im     -0.0289822-0.0535369im    -0.0904875-0.122456im       0.0137127-0.169862im     -0.001118+0.165849im      0.260738-0.102049im     -0.109528+0.0537694im      0.22232-0.265413im     -0.126932-0.175691im     -0.047185-0.129898im      0.104005+0.306301im      -0.150449-0.0941945im      -0.0561798-0.082546im       -0.13087-0.0376685im      0.201161+0.113609im      -0.255154-0.0660546im     -0.078324-0.008628im       0.0379379-0.00525263im
   -0.196553-0.00607707im  -0.0355423+0.197922im    -0.0859245+0.0121861im    0.0553414-0.0227034im   -0.0248176-0.142668im       0.123859+0.191062im      0.104601+0.0936363im      0.127964-0.061534im       0.152267-0.160385im    -0.00145704+0.0176065im      0.060585+0.166507im    -0.0902724-0.118123im      0.0562979-0.111351im      -0.145758+0.0321616im      -0.1666+0.026965im       0.335547+0.0649111im   -0.00156417+0.128477im        0.136816+0.101271im     -0.167541-0.0163903im   0.00804042-0.121146im     0.0734254-0.0622529im    0.0790508-0.204175im     0.0812291-0.286655im    -0.0262959+0.101004im     0.0492994-0.0174523im     0.0358666-0.0624648im       -0.196999+0.245149im      0.0483972+0.0839354im   -0.00414348+0.0881434im    -0.0626346+0.152953im       0.132625+0.130374im      -0.0503729-0.278153im
    0.168504-0.175044im     -0.039471-0.0066505im   -0.0267188+0.142189im     -0.120137+0.00205738im     0.24539+0.0262233im     0.0902775+0.0824395im    0.0604419-0.0957071im      0.040758-0.0233243im      0.198113-0.0952346im    -0.0454679+0.219373im     -0.0898352-0.214805im     -0.107763+0.254741im     -0.0498495+0.113076im     -0.0324779-0.0200557im   -0.0309289+0.107226im      -0.129436+0.0569274im      0.193706+0.1826im         0.0407878+0.137827im     -0.195299+0.22309im      0.0341041-0.212926im     0.0747927-0.14633im      -0.181027+0.0145129im   -0.0744594-0.205943im     -0.131668-0.0782568im     0.133084-0.0770866im    -0.0265103+0.174103im       -0.0490565-0.219427im      -0.137643-0.185243im     -0.0517045+0.0111595im    -0.0792885-0.00793502im   -0.0836874-0.0280121im     -0.0430159-0.010494im
   0.0737732-0.113073im      0.162702+0.120151im     0.0299609+0.0059348im   -0.0301644+0.239314im    -0.0415854+0.37272im      0.00204951-0.0783222im    0.0390874+0.0726075im      0.188285-0.171279im      0.0590729+0.154572im        0.16316-0.191778im      -0.115833+0.117421im     0.0404031-0.101697im       0.134534-0.108544im      -0.193229+0.0530582im   -0.0409034+0.0358819im    -0.0741054+0.0208828im     0.0993739-0.122384im      -0.0450183-0.138247im    -0.0668849+0.111701im     0.0377907-0.169092im    -0.0426622+0.0429472im   -0.0792263-0.143414im      0.129776+0.0645096im   -0.0919884-0.0216393im     0.110849+0.0313119im    -0.0787352+0.0730272im       -0.066783+0.191002im     -0.0152851-0.107047im      0.0244513+0.0694551im      0.233128+0.157438im      -0.358409-0.0827135im      0.0217235+0.0576459im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.17776979608116403 - 0.07707764055830305im
  -0.12215546279784645 + 0.07503757142906342im
   0.12627126109286432 - 0.032679991912897506im
  -0.13380307882672918 + 0.051565241887753493im
   0.10452042821405863 - 0.27106263300555977im
  0.035011714371564216 + 0.01773696557043957im
  -0.19431330229705207 + 0.06554981085718434im
   0.06144930499113978 - 0.0020451298479504183im
  -0.16518653717069728 - 0.12373170110097693im
  -0.15872425792746842 + 0.0743865409813664im
  -0.16130632048090876 - 0.07347760974494703im
 -0.026872838811353914 - 0.0684776575618886im
   -0.1774030561898969 + 0.15429919684422322im
   0.08001386356473991 - 0.006119649466364127im
   0.18736719339617236 + 0.09162621775528841im
   -0.2253602374397359 - 0.12080170654576013im
 -0.020381851586635965 + 0.18689892584169718im
 -0.013834369709753026 - 0.10200364569129003im
   -0.0509361654574181 - 0.07199649691006528im
    0.3828732985199977 + 0.0im
   -0.0706467701120904 - 0.16343328196316095im
   0.16374845611589836 + 0.07381983778376033im
  -0.05506874284317196 - 0.11430925667177311im
  0.017782032342757395 + 0.017215253606753113im
  -0.07887598256968291 - 0.009473849176766197im
  -0.12007244201799332 + 0.042184690283763364im
   -0.0604049005078251 + 0.1445467368285769im
   0.08259313428044564 + 0.011918843500348003im
  -0.04796882809282987 + 0.057687573712917335im
   0.16493073162264407 - 0.263276501025049im
   0.15387317633821904 - 0.04308876041348931im
   0.13912642786180007 + 0.09880290738413752im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 26 February 2023 17:51">Sunday 26 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

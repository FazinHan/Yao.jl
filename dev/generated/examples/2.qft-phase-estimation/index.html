<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.051682-0.320464im    -0.162873+0.0730016im   0.00231008-0.0472395im     0.0138121+0.151384im      0.0241256-0.0148543im    -0.0493292+0.0858075im   -0.0357534-0.0640843im     0.256765+0.0811295im   -0.0709118+0.225331im     -0.153386-0.117752im      0.130005+0.0381427im      0.0669186-0.0334472im     -0.0746374-0.181741im     -0.307623+0.0266041im      0.168078+0.0240655im     -0.114511-0.151606im         0.169361+0.00566353im    0.234397-0.0586825im    -0.145212+0.021873im     -0.136688-0.177491im       0.120427+0.010803im     0.0251431+0.0516861im    0.00696034-0.23819im      0.0568386+0.0528895im      -0.10803-0.203814im       0.129888+0.135603im      0.0413559-0.0123076im     0.163253+0.103775im     0.0933744+0.16315im       -0.115647-0.0379415im     0.0112662+0.105581im     -0.0644208-0.0029525im
  0.0670423+0.244824im   -0.0110925-0.0752772im     0.314108+0.00460842im    -0.147019-0.0217105im    -0.0329233+0.118735im      -0.269773+0.024611im     -0.147401+0.00269969im    0.297691-0.244546im    -0.0200372+0.0640614im    -0.124609+0.143817im    -0.0891477+0.116059im         0.18199-0.284808im       0.0553118-0.0610505im     0.110858+0.149492im       0.141592-0.111763im      0.0318406+0.0504676im       0.0753377-0.0195701im    0.0984707+0.0176692im     0.210229-0.0425656im    0.0540449+0.0188457im    -0.0606538-0.023299im      0.158163+0.00698856im    0.0493162-0.0449891im    -0.119991+0.158037im      0.0769158+0.0270193im     0.0265114-0.172227im        0.12314+0.0455505im    -0.112246+0.0336947im   -0.0920014+0.0704286im     -0.133045-0.156591im     -0.0396826+0.141629im       0.105043+0.0403306im
   0.102919+0.124899im    -0.184705-0.138025im      0.102431-0.0973736im     0.0869094+0.0984155im    -0.0344706+0.00493538im    0.0117445-0.0499055im    0.0668561+0.0863255im    -0.139958-0.0908467im   -0.0227459-0.0866971im   -0.0274813-0.126688im      0.125356-0.0168792im       0.204349+0.0502211im    -0.00683688+0.0900591im    0.0142031+0.198383im     -0.0146573-0.18354im       -0.276163+0.0532515im       -0.135296+0.178373im      0.035584+0.0925152im    0.0490649+0.177311im      0.026488-0.124321im       0.354514+0.015124im     0.0280486+0.132247im      0.0518044+0.154818im     0.0407346-0.301719im       0.203735-0.163186im     -0.0898751-0.14656im       0.0482037-0.137802im      0.102802-0.00522643im   0.0797077+0.0113385im     -0.186267-0.0812161im     0.0628377-0.163445im      -0.106132+0.0346586im
 -0.0520949-0.10155im     0.0120868+0.0012295im    0.0968444+0.048709im       0.343992-0.167979im        0.16723+0.251656im       0.242444+0.132166im    0.00968711+0.0429867im    0.0255681-0.0952364im    0.0672239-0.033605im     0.0405659-0.126341im      0.115647+0.0248727im      0.0198413+0.000595688im    0.0313031+0.0969015im    -0.139481-0.126615im      -0.182189+0.0632538im      0.119003-0.0136715im      -0.0755969-0.0245755im    0.0762562+0.090556im    -0.0139669+0.0754627im   -0.0247358-0.139016im     -0.0361255-0.125925im    -0.0471423+0.144727im      0.0552946-0.131353im     -0.124232-0.0405088im     0.0378153+0.200154im      0.0802588-0.293713im      -0.061612+0.0427465im    -0.337665+0.0984197im      0.15018+0.263354im      -0.132525-0.0337334im    -0.0992638+0.0555323im     0.0560635+0.01345im
 0.00388801-0.0356887im   -0.097359-0.0362313im    -0.133501+0.0231297im     -0.165105-0.036949im      -0.155623-0.105801im      0.0632769+0.0618062im   -0.0297488-0.016477im     0.0971269+0.0188699im     0.260484-0.0195453im     -0.23048-0.0372079im     0.208846+0.116019im      0.00307019+0.0285194im       0.114816+0.223536im    -0.0428353-0.212614im     -0.0653433-0.0422803im      0.129411-0.19609im          0.203766+0.0344129im    -0.248991+0.0848758im     0.255143+0.179472im    -0.0335237-0.055383im     -0.0278347-0.0611287im   -0.0397211-0.0621082im     -0.113004-0.113182im    -0.0235309+0.00783013im     0.018445-0.0156823im    -0.0955699-0.0104656im    0.00281349-0.108306im      0.100419-0.017722im    -0.0281259+0.00793273im    -0.093135-0.186668im       0.186486-0.201031im       0.365485-0.00380981im
  -0.140867-0.130798im    0.0191138+0.211323im      0.126075+0.0537911im     -0.258882+0.113151im     -0.0845076-0.303478im     -0.0810932-0.209961im     0.0509699-0.00651684im  -0.0561021-0.0579105im    -0.042215-0.130576im      0.208053-0.0667402im    0.0390039-0.0513571im      -0.133051+0.138694im      0.00227125+0.0948573im    0.0871406-0.059044im      0.0715919-0.170211im      0.0883916+0.0416344im       0.0471463-0.128723im      0.228744+0.118444im     0.0237532+0.100257im    -0.0184568-0.151929im       -0.19974-0.116269im    -0.0471331-0.0374937im      0.227187-0.0635116im    0.0191707-0.0633631im     -0.108294-0.0884692im      0.150068-0.276094im    -0.00359452+0.0978997im   -0.0877183+0.124237im    -0.0751359-0.0358799im     -0.223232+0.0380038im      0.155187-0.0796361im     -0.109841+0.0314902im
  -0.153885+0.0190168im   -0.201282+0.0452907im   -0.0574276-0.028207im      -0.118484+0.00756575im   -0.0139317+0.135682im      0.0514328+0.0706465im     0.199052+0.10879im      0.0697241-0.0301948im   -0.0109793-0.0226576im    0.0503739+0.0879745im     0.105467+0.11062im         0.275027+0.176508im       0.0848564-0.0481583im   -0.0619859+0.0106198im     -0.113868-0.0906317im    -0.0132563+0.0931329im     0.000561943+0.144135im     -0.163248-0.0958592im   -0.0192537+0.12331im      0.0343864+0.142449im     -0.0985165+0.0674717im    -0.108033-0.0958138im      0.025131-0.192669im     -0.236598+0.258944im      0.0982882-0.191662im      0.0479059-0.0459033im     0.0217318-0.0769318im     -0.15751-0.102646im    -0.0636077+0.0100351im      0.093471+0.155108im       0.252347+0.0937166im     -0.329858-0.216476im
  0.0943175-0.0516441im    0.111716-0.0265265im     0.073746-0.135692im     -0.0506293-0.0269639im      0.029405-0.262226im     -0.0157166-0.023655im      0.161945-0.0402629im    0.0741753-0.136691im      0.159997+0.120423im     -0.287893-0.0967026im   -0.0382565+0.134364im        0.126655+0.27397im      -0.00447102-0.175626im     0.0446399-0.0314499im     -0.227659+0.225033im     -0.0204238+0.144728im       -0.0243902-0.2627im        0.163546-0.0310818im   -0.0561588-0.0712888im     0.160246-0.0127639im      0.117554-0.033285im     -0.103898-0.0525587im     -0.124904+0.0729511im    0.0111992+0.0112438im   -0.00447309-0.0141482im     -0.030664+0.0980782im      0.211374-0.0472164im    -0.331227-0.123909im     0.0411789-0.162904im      -0.150507-0.0101846im    -0.0364503-0.0901143im    0.00461581+0.0272808im
  0.0872469+0.138503im    0.0346539+0.140701im    -0.0761285-0.138684im      -0.128111+0.0995545im     0.0413372+0.147599im      0.0136923+0.136715im     0.0496364+0.0875602im    0.0151209+0.0401654im      0.16491+0.0537311im    0.0287766-0.2381im       0.0125076+0.0322427im      0.0795253-0.0931726im      0.0267822-0.167096im     -0.107377-0.0773151im      0.124599+0.220561im     -0.0159406-0.0457623im       -0.181687-0.243135im      0.154701-0.0438093im    0.0821704+0.263625im      0.132564+0.186115im     -0.0928908-0.124583im      0.231647+0.0534461im      0.162149+0.160902im      0.023936-0.123347im     -0.0645441+0.00241792im    -0.113546-0.0225891im     -0.333429+0.111198im     0.0585772-0.105667im     -0.030718+0.00332288im    0.0304637-0.0165392im      0.255102+0.0413273im     0.0187675-0.0998059im
  0.0171812-0.114846im     0.189881-0.137172im     -0.184256+0.0701534im     -0.164287-0.0099893im     0.0969493+0.102631im     -0.0345339-0.00635351im  -0.0531195-0.186799im     0.0155259-0.12923im       0.148985-0.0706667im     0.202989-0.00685447im    -0.27743+0.0745612im       0.090466-0.138313im      -0.0870119+0.0555608im    -0.173418+0.0971128im     -0.152819+0.125904im       0.106782+0.194513im        -0.180789-0.0730483im    0.0408785+0.199159im     0.0836999-0.072613im     -0.193235+0.0241714im   -0.00308987+0.0264893im    -0.162138+0.105764im       0.187359-0.226471im     0.0290877-0.0670417im      0.106413-0.227801im      0.0151948-0.00634435im      0.16694-0.0878796im     0.197095-0.190835im      0.135148-0.00879331im  -0.00670255+0.00871883im     0.105953-0.000258311im    0.097192+0.00371766im
  0.0962178-0.182846im   0.00447654-0.072416im      0.172178+0.189871im     -0.0358245+0.0847637im      -0.13551+0.0182614im     -0.105414+0.00323577im    0.157823+0.321866im     0.0404333+0.0275644im     0.322629-0.0118906im     0.233662-0.00544743im     0.13552-0.217937im      -0.0723737-0.0786957im      0.0829096-0.16344im     -0.0730402+0.0406968im     0.0197894+0.0582635im    -0.0279829+0.0440135im         0.10764+0.00103972im  -0.0347528-0.132561im     -0.025924-0.0414687im    -0.159149+0.0115271im    -0.0940228+0.00633891im    0.205017+0.0859995im    -0.0126559-0.0400279im   -0.0368757-0.147615im       0.223338-0.0723314im    -0.0172432+0.0817616im      0.154367-0.0443267im    -0.228858+0.0445534im    0.0162302-0.0455322im      0.279194+0.00222433im     0.017748-0.124373im       0.067848+0.222613im
  0.0746513+0.0636528im   -0.195977-0.289686im     0.0289682+0.0411376im    -0.0403598+0.0253142im      0.011358-0.172126im      0.0809351+0.0143605im   -0.0530708-0.070498im     -0.239608+0.084505im    -0.0684681+0.038905im    -0.0939258-0.137703im       0.13182+0.0590692im     -0.0026005-0.177005im     -0.00045911-0.17497im      -0.225005+0.0580663im     -0.257382-0.0894949im     -0.148154+0.0460948im      -0.0413541-0.263836im     -0.274426+0.075777im     -0.029913+0.00255039im  -0.0513557-0.126239im      -0.138602+0.101674im       0.19532-0.00751912im     0.102753+0.0313036im   -0.0796146+0.107072im      -0.160354+0.000692102im    0.237656-0.207789im      0.0301476+0.101464im     0.0376464-0.060994im     -0.088584-0.170309im      0.0600989+0.106244im     -0.0762846+0.0886279im     0.0751387+0.0594949im
  -0.253783-0.117168im    0.0986373+0.0374665im   -0.0104077-0.00373633im     0.273474-0.00152691im    0.0579868+0.111931im      -0.214195+0.0683904im    -0.222442-0.068097im     -0.150054-0.0087973im    0.0321587-0.180673im   -0.00492646+0.166461im     0.0403232+0.0347712im     0.00105359+0.0216839im      0.0712004-0.103994im    -0.0695769+0.0992952im     -0.263067+0.156014im      -0.055611-0.0967136im        0.214439+0.159811im      0.084752-0.021025im    -0.0585705+0.0722026im    0.0820571-0.0501378im     0.0349564+0.163184im     0.0665906-0.0646878im      0.135447+0.109765im     0.0263416-0.0234243im     0.0283079-0.0936848im    -0.0576903+0.0785602im     0.0342538+0.234691im    -0.0556587+0.0228741im    -0.202244-0.190768im      -0.161781-0.0802545im      0.326932+0.0881503im      0.112109+0.100683im
  0.0273684+0.149578im   -0.0937401+0.180469im    0.00855853+0.189924im      0.0433214+0.0567917im      0.030468-0.0826379im      0.213556+0.0285596im    0.0674455-0.054894im     0.0597526-0.0869549im  -0.00679116-0.132137im    -0.0267013+0.125765im      0.158505-0.0897433im       0.227602+0.196231im       -0.080455+0.0124782im     0.350947-0.183618im      -0.041298+0.10946im      -0.0381241-0.130981im        -0.129232+0.022558im     0.0914061-0.0420105im    -0.102332-0.182291im     0.0488952-0.00567304im   -0.0703525+0.147032im      0.244876+0.130398im      0.0939096-0.0433476im  -0.00649552+0.00445599im   -0.0445965-0.192607im       0.108799-0.0345229im      0.132708+0.0904663im     0.184486-0.152001im      0.137136+0.120397im      0.0703499+0.0347935im     0.0396031+0.143623im       0.259977+0.126604im
  -0.153874-0.0966213im    0.332837-0.0598719im   -0.0324901+0.0376133im   -0.00464046+0.232269im       0.272054+0.0838642im      0.136643-0.0445935im     0.309159-0.0213985im   -0.0305283+0.138396im    -0.0794548+0.0962491im    -0.130152+0.118571im      0.219042+0.158026im       0.0295963-0.0961087im      0.0857082-0.0111966im    0.0758231-0.0305469im      0.127428-0.150407im        0.13897-0.0159532im        0.065886-0.0814044im     0.171772+0.147096im    -0.0387085+0.0163198im      -0.2339+0.036934im       0.229009+0.0253852im    0.0916764-0.0536318im     0.0925047+0.19101im     -0.0826434+0.109184im       0.128451+0.107461im     -0.0133755-0.124317im      0.0977225-0.119776im     0.0550592-0.0432141im    -0.158616-0.0717272im      0.104793+0.061107im      0.0328503-0.0130244im     0.0938733-0.0215265im
  0.0483864+0.0637142im   0.0192293+0.109241im     0.0309803-0.144748im        0.11167-0.0215083im     -0.236577-0.116072im       0.302932+0.0808912im    0.0725356+0.249245im    0.00451291+0.0722892im    -0.118458-0.126342im    -0.0533718+0.0920607im    -0.136848-0.0813197im      0.0161076-0.219195im        0.112029-0.100954im    -0.0658519+0.0787748im     0.0108987+0.00520868im     0.286926-0.280207im       -0.0173669-0.101348im      0.027284-0.120734im    -0.0549022+0.00286209im   0.0542649+0.0331379im      0.113652-0.0621945im    -0.210469+0.0268899im     0.0935816-0.173071im     0.0377039+0.0252591im      0.195255-0.0708729im     0.0963823-0.102085im      0.0123533+0.0544243im    0.0921693-0.178156im    -0.0329038-0.290877im     -0.0919864-0.156838im     -0.0715094+0.0469106im    -0.0827222+0.148928im
 -0.0665351+0.0249645im   0.0746527-0.0283723im     0.141614+0.00764866im   -0.0503145+0.158273im     -0.0533229-0.0707669im      0.156954-0.14632im      -0.040074+0.0751868im    -0.144091-0.29798im      0.0563225-0.0341218im   -0.0476842-0.108069im     0.0187969-0.0350192im    -0.00939539-1.19249e-5im      -0.19855+0.124816im    -0.0228706+0.0433072im    -0.0218025+0.154531im     -0.0278216-0.191762im         0.222837-0.106865im     -0.137674+0.0685842im    0.0667894-0.0512658im   -0.0399228-0.0488488im      0.115972-0.095824im    -0.0476937+0.0170104im      0.202843-0.0344247im    -0.277558-0.0836035im     -0.146773+0.101945im      -0.280578+0.194967im      0.0807216-0.0440063im    0.0383101-0.0514594im    -0.128527+0.158684im       0.133036-0.0680211im   -0.00235907+0.326628im      -0.225836+0.0243733im
  0.0224577-0.201659im    -0.174199+0.0782095im     -0.09395+0.0939927im    -0.0101531-0.0352885im     0.0459519+0.138023im      0.0515147-0.260508im     -0.129899+0.00915877im   -0.247838-0.0101873im   -0.0413385-0.040634im    -0.0827595-0.14155im     -0.0846663+0.0873584im      0.0791447+0.0138815im     -0.0235711-0.0651298im     0.164141-0.06694im        0.010726-9.02578e-5im   -0.0142558+0.0777457im        0.143334-0.174073im      0.055654-0.452694im       0.26057+0.022414im     -0.197788+0.0140246im   -0.00646832+0.181488im    -0.0837382+0.0904552im     0.0903073+0.0993144im      0.20936+0.108904im        0.14633-0.0011396im      0.041826-0.0861965im   -0.00758125-0.0304054im   -0.0653411-0.101759im     -0.066588+0.127316im      0.0474754-0.252072im     -0.0768802-0.0091888im    -0.0101658-0.109071im
   0.277267+0.178668im     0.059844+0.00892349im  -0.0264092-0.077641im       0.255862+0.0579108im     0.0572644-0.0991353im     -0.183634-0.0705336im    0.0935216+0.0868423im     0.172928-0.0989091im    -0.061079+0.0788595im   -0.0893193-0.0927278im   0.00782774-0.0209867im    -0.00774556-0.00757102im     -0.135404+0.2469im        0.045001+0.0496231im    -0.0602831+0.128772im      0.0527068-0.169813im        0.0580283+0.00853313im  -0.0467781+0.0108323im     0.121299-0.110922im     -0.359182+0.0215631im    -0.0342408+0.103518im      -0.16583+0.00818205im    0.0185931+0.108157im    -0.0250976-0.101352im      0.0217606-0.180156im       0.278442-0.0352919im      -0.18246+0.104507im     -0.140381+0.131886im    -0.0206523-0.142649im       0.132949+0.110763im       0.176011+0.0256133im     0.0278497-0.201668im
  -0.257127-0.128567im    -0.191641-0.0338613im    -0.145089-0.0953343im      0.093357-0.0862517im      0.014095+0.0524556im     -0.176142-0.0579781im    0.0461239+0.0997134im    0.0342033-0.0800096im    -0.194069+0.253717im     0.0628366+0.0120578im     0.137848-0.156733im      -0.0421322-0.0823449im      -0.147496+0.0691096im   -0.0635338-0.0850757im     0.0917541-0.0131848im     0.0600387+0.000723709im    -0.0232601-0.16102im       0.121596+0.0390094im      0.18133-0.160004im      0.410197-0.150695im     -0.0607858+0.138366im     -0.123714+0.147715im      0.0100463+0.0777187im     -0.22057-0.0752904im     0.0290606-0.0131738im    -0.0547466-0.0744453im     0.0664649-0.116081im     0.0425795-0.0780561im        0.108-0.200986im       0.203233-0.0674519im     0.0760878-0.0311901im       0.11686-0.0401576im
  0.0832832-0.0235005im   0.0414915+0.33857im       0.109621+0.111981im      0.0194424-0.0442146im    -0.0703331-0.174798im      0.0659962+0.00763723im  -0.0939185-0.120359im     -0.247584-0.11471im      -0.124874+0.120854im    -0.0588685-0.0555269im   -0.0449685+0.0435208im      0.0602623+0.0106059im        -0.1019-0.156714im     -0.170582+0.156569im     -0.0600601-0.250165im       0.129358+0.0649123im     -0.00391191+0.0170406im   -0.0106013+0.0387211im    -0.051667-0.0515565im      0.13179+0.174487im       0.090684-0.121077im    -0.0057168+0.185066im     -0.0893266-0.0719628im    -0.118408-0.0792924im      0.259983+0.0277021im     0.0734962+0.134294im     -0.0365401+0.0477837im    -0.018279+0.109735im     -0.177409+0.175679im       0.152625+0.10859im        0.150956-0.0833591im      0.289762-0.163986im
  0.0150878-0.0676132im  -0.0381308-0.00322067im   -0.212431+0.211422im     0.00899688+0.0389076im     -0.112195-0.122991im    -0.00652348-0.0630729im     0.135401+0.0860088im   -0.0749278-0.0799527im   -0.0403961+0.195237im       0.22855+0.0467168im    -0.170757+0.0738607im      0.0399619+0.0364672im      0.0912493+0.0766592im    -0.128762+0.117933im      -0.130905+0.149872im      0.0669519-0.178868im        -0.056242+0.0374512im    0.0827646-0.0784509im      0.28483-0.0121112im     0.129558+0.122363im       0.236107+0.0998957im     0.252552-0.34697im      -0.0213803+0.0863197im    -0.107945+0.0417842im   -0.00806455+0.0730562im       0.20555-0.0286246im     -0.060872-0.125991im     0.0183127+0.132684im     0.0764253+0.157503im      -0.173814+0.0721002im    -0.0532271+0.0649725im     0.0141879+0.13878im
 -0.0400955-0.137883im   5.06743e-5+0.0992496im   -0.0496267-0.115051im     -0.0583334+0.100033im       0.118533-0.0463458im     -0.183502-0.0465755im   -0.0254304+0.132838im     0.0774666-0.0783721im    0.0786442-0.0957727im    0.0696227-0.0634342im   -0.0294254+0.0235187im      0.0475524-0.0252125im      -0.154246+0.0402167im     0.165553-0.0377359im     -0.136893+0.0112269im     -0.232093-0.179699im        0.0003075+0.0567347im   -0.0674773+0.0857447im    0.0234267+0.191934im       0.11808+0.0811761im      0.213115-0.0185815im    0.0831418+0.186404im       0.242959-0.27775im      0.0894518+0.279604im       0.106089+0.246833im      0.0809598+0.059379im     -0.0792269+0.0279498im  -0.00827823+0.0606916im    0.0341776-0.225756im      0.0728121+0.160116im      -0.273037-0.115683im       0.113451-0.101818im
  0.0224707+0.1314im     -0.0824056-0.0503746im     0.134922-0.0526433im     0.0877804-0.124228im      0.0999143+0.248876im      0.0143211-0.210223im     0.0365084+0.0367917im    -0.145484+0.0315373im      0.31628+0.0496468im    -0.215466+0.0749032im    -0.159934-0.0491569im      -0.030288+0.154897im       0.0786751-0.132814im     -0.039075-0.0736227im     0.0341596-0.118248im       0.188396-0.0874959im       0.0897312+0.0621239im    0.0968547+0.096762im      0.154178-0.0695287im     0.152529-0.0285514im      0.041647+0.0148854im     0.102147-0.00422669im     0.101087-0.217248im       0.23509-0.198331im      -0.210112+0.0202308im      0.221979-0.0045456im     0.0922254-0.191895im      0.102606+0.0754487im    -0.106712-0.0809904im      0.118296+0.19546im       0.0585973+0.0217686im    -0.0978775-0.065621im
 -0.0893744+0.11827im     -0.138287+0.238879im     0.0802329-0.0876528im     -0.156425+0.104769im       0.184548+0.0813287im    -0.0144445+0.141305im     -0.161098-0.0991869im    -0.156795+0.0669748im    0.0530469+0.0516668im   -0.0976783+0.0354595im    -0.102246-0.000603121im    -0.143205-0.0711496im    -0.00754595+0.189172im     -0.174064-0.160956im      0.0196914+0.0400927im     -0.203796-0.243649im        -0.101399+0.063234im     0.0993629-0.0152068im    0.0611297+0.1191im      -0.0321561+0.155799im     -0.0410067-0.119804im     -0.164192-0.123576im    0.000652465+0.190969im    -0.0782163-0.0221876im     0.0852725-0.200247im       0.136435-0.0358037im      0.337396-0.0125161im    -0.163223-0.0375097im    0.0060086+0.0243074im      0.157768+0.0812766im     -0.170552-0.051208im     0.00512236+0.192848im
 -0.0736076+0.0374847im     0.10689-0.0581374im    -0.368669-0.104032im     -0.0865131-0.0688941im    0.00600139-0.0445402im    -0.0894503-0.0515504im   -0.0392291+0.174401im    -0.0713417-0.024637im        0.1086-0.020557im     -0.155075-0.305756im      0.038155-0.290385im        0.185746-0.11453im         -0.10238-0.0298981im   -0.0136918+0.0577588im     0.0726552-0.0691583im   -0.00791796-0.061707im         0.186749+0.192647im     0.0383479+0.121688im     -0.263481-0.21094im      0.0672553+0.176583im      -0.163957+0.0412448im   -0.0291649-0.118145im      0.0524673+0.0534965im     0.088596+0.0075716im     0.0785044+0.0104106im     0.0512612-0.163354im     6.09386e-5-0.105063im     -0.114549-0.133325im     -0.113751+0.207714im      -0.166155+0.0671858im     -0.075617+0.0514659im      0.070091+0.0572989im
  -0.198851-0.201671im    -0.168087-0.0996199im    0.0455846-0.227157im     -0.0101977+0.256409im        0.14708-0.0679292im       0.22631-0.0640022im   -0.0900955+0.0176799im     0.166964-0.0307751im   -0.0738374+0.150634im    -0.0104335+0.0410965im    -0.349796-0.0310073im       0.198081-0.0415328im       0.316328+0.173306im     0.0954165+0.118518im     -0.0222959+0.066787im     -0.0189503-0.0368125im      -0.0136451-0.0468565im    -0.181455-0.0252462im    -0.117307-0.157921im      0.051002-0.137076im     -0.0818158-0.101862im      0.110623-0.0401488im     0.0524029+0.0245917im     0.147832-0.134305im      0.0435667-8.79563e-5im   -0.0532936-0.0163788im    -0.0590451+0.091567im    -0.0861945+0.0483763im   -0.0912303+0.118816im       0.132664+0.078282im       0.107935-0.157976im      0.0952106-0.0210457im
 -0.0371088-0.126231im    0.0603686+0.0454181im    0.0873652-0.17268im        0.101004-0.0474781im   -0.00542228-0.287927im      -0.168135+0.125585im     0.0776496-0.192964im     0.0158568+0.0607296im    0.0999249-0.139989im    0.00100932-0.0604746im    -0.107691-0.127568im       -0.157398-0.0854317im       0.217163-0.142457im     0.0873696+0.000221836im    0.145745+0.0708476im     0.0872057-0.072054im      -0.00887169+0.0908761im    -0.166142+0.0309419im     0.202093+0.140633im     0.0253171-0.164811im      0.0899674+0.177751im     0.0148741+0.234112im     -0.0563458+0.150446im    -0.0496449+0.0739823im     0.0517279+0.0362244im     0.0945078-0.0543345im     0.0588626-0.0873762im   -0.0245711-0.301465im     0.0523023+0.280365im     0.00139396+0.228239im      0.0601184+0.155484im     -0.0730651-0.0822333im
   0.177406+0.0113854im   0.0987367+0.109912im     -0.110238+0.0552201im     0.0188424-0.00835282im    0.0962629+0.151449im       -0.21467-0.0131333im    -0.128379-0.109218im     -0.042087-0.259453im     -0.243234+0.0138937im    -0.105149+0.0254309im     0.190014-0.082857im       -0.110523+0.277827im        0.208441-0.00285757im  -0.0133633+0.236982im       0.122727+0.12241im        0.173705-0.0739531im    -0.000889584-0.169908im     -0.221138-0.0104218im    -0.160925+0.196448im     0.0486424-0.124058im     -0.0507222-0.079053im      0.116869-0.188418im       0.137727-0.117734im      0.060297-0.0294936im      0.124209-0.10057im       -0.029216-0.0860556im    -0.0254898-0.177547im     -0.013107-0.124681im     0.0735221-0.00850317im     0.118129+0.00594127im    -0.140486-0.0705768im    -0.0103798+0.0681395im
  0.0573856-0.0934527im   -0.083583+0.0205482im    0.0351651+0.281546im       0.256168+0.0120954im     0.0990918-0.0947682im     -0.158665+0.0624933im    0.0866707+0.242788im     0.0438894-0.0511025im    -0.131274-0.0886279im    -0.084285-0.035336im     -0.249163+0.0634713im      0.0958341+0.0462769im      -0.156617-0.103941im     -0.101899-0.0738317im    -0.0489398-0.0119im        0.0587426-0.124885im       -0.0831277+0.0730928im   -0.0605021+0.0662045im   0.00454471+0.0308542im   -0.0481571-0.0427952im     -0.256051-0.341608im     0.0517368+0.0517215im     0.0188068+0.255999im      0.129182+0.231186im     -0.0659461+0.0622427im     -0.155319-0.0486041im      0.209741-0.192099im      0.179427-0.0240031im    -0.022695-0.0142122im    -0.0243414-0.0117508im      0.122871-0.109218im      -0.069404-0.0327464im
 -0.0896544+0.0468368im   0.0700267-0.0677215im    0.0352505+0.0627468im     -0.244463+0.154813im      0.0327884+0.0404999im     0.0267243+0.0710961im    0.0697405-0.0411847im   -0.0296209-0.129789im     -0.193009+0.149625im     -0.200057+0.0560001im   -0.0257926-0.185094im       -0.219194-0.0459399im      0.0264477-0.280014im      0.125549-0.117696im      -0.196593+0.259497im      -0.121635+0.0382485im      -0.0303975+0.297276im    -0.0589714-0.0961387im  -0.00613259-0.0220965im   -0.0558265+0.0140918im    -0.0687616-0.072053im    -0.0962841+0.0874804im     0.0616122-0.0623172im    -0.102017-0.151889im      0.0679295+0.228422im       0.256512-0.0782485im     -0.086403-0.16092im       0.107675+0.0654711im    0.0552872-0.00452129im   -0.0700754-0.203242im       0.158363-0.0980667im    -0.0570449-0.0263984im
  0.0040808+0.123803im    -0.138135-0.0284im       -0.127751-0.120798im     -0.0773315+0.134075im     -0.0238734+0.00639212im     -0.12075+0.113505im      0.321359-0.141228im     -0.211275+0.0885628im   -0.0490708+0.0659414im     0.155277+0.122317im     0.0371461-0.0128257im       0.106913+0.0855176im     -0.0254194+0.00155887im  -0.0654351+0.238895im       0.032916+0.00806269im     0.137756-0.0844983im        0.182182+0.105595im    -0.0361254-0.0477491im    0.0348031+0.0078278im   -0.0598415+0.051144im     -0.0442722-0.179971im    0.00347011+0.113248im      0.0629795-0.0193697im     0.178468-0.102998im      -0.170853+0.196507im     -0.0267189-0.0166013im      0.272473+0.241549im     -0.153576-0.056254im      0.244057-0.00557396im  -0.00850124-0.184115im     -0.0627175+0.0923209im      0.136114-0.220637im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.24415164996992086 - 0.04531808103834393im
  0.047357367456861726 - 0.12701863257916618im
    0.1824269027447341 - 0.14104131310822937im
   0.09816973106457069 + 0.0768123283311967im
  -0.18004347831058262 - 0.16552521498158507im
    0.0464391971864172 + 0.06588770763891977im
   0.10844791717066296 - 0.10735000436545214im
  0.058990670366682076 - 0.005287748650206614im
   0.11159868091764091 + 0.06774843670184309im
   0.36723281911777944 + 0.0im
  -0.05603243257225722 + 0.24608760574650365im
   0.04784306262680181 - 0.2595453883333441im
 -0.028462053300358482 - 0.022722299148298784im
  -0.12160398989338692 + 0.2113051516980223im
   0.04940753848950669 - 0.16312666561419642im
    0.1361401919940823 + 0.07593226179241046im
   0.08489864333207109 + 0.12386133193624382im
     0.165027747927224 + 0.04586446018123531im
    0.0356298330082313 + 0.17540452285936847im
   0.04403238711388614 + 0.07688366936327759im
  -0.02928015829343495 - 0.027068165628489765im
  -0.16492719465594155 + 0.13046770580117745im
   0.03006455793153891 - 0.2638973999702913im
  0.011229906667207537 + 0.10976190450049761im
   0.04910944179072304 + 0.014477492273420975im
   0.09216053164374499 - 0.1131187403721343im
   0.11944327929833432 - 0.1609648962924165im
    0.1044982811060287 - 0.05313611488258317im
  0.061820502741491666 - 0.07354834258328961im
   0.11702059055647877 + 0.04931376782085936im
 -0.003142035198169923 - 0.16957616135938655im
  0.019128033359101793 + 0.07842132631988374im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Wednesday 29 June 2022 03:02">Wednesday 29 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

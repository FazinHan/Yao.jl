<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0493743-0.0303095im    0.0502537-0.0631614im     0.138508+0.167723im    -0.0233858+0.170977im   0.00396841+0.17025im         0.222092-0.0167199im    0.0645117-0.0847441im   -0.176584-0.042451im        0.1291+0.038616im     -0.191843-0.026078im     -0.145126+0.0796658im   -0.0397776+0.0824294im     0.0507386-0.156721im        -0.21467+0.169719im    -0.0115862-0.24639im        0.0965175+0.0122352im     -0.103038+0.0962271im      -0.121293-0.0950802im     0.0514856+0.0423038im    0.0250045+0.000466541im  -0.00412411-0.192952im       0.206178+0.0893876im    0.0020087+0.0341211im  -0.0507043+0.104788im       0.0303508+0.29114im      -0.233539+0.25156im       -0.0758822-0.0649884im  -0.0505104-0.0397919im      0.0683822-0.0668411im      -0.320044-0.169386im      0.0180469-0.104348im     -0.0392777-0.0673639im
    0.131907-0.0833638im      0.15628-0.0438655im     0.270836+0.133254im     0.0923469-0.0904357im    0.182357+0.108015im       0.0547632-0.0326594im    -0.240569-0.0699262im    0.118471+0.0434468im   -0.0225301+0.251442im     0.0274163-0.0962763im    -0.126412+0.088912im    -0.0430949-0.110993im      0.0355086+0.0949537im      0.0274328-0.0804505im   -0.0349683-0.000722373im     0.116638+0.069097im        0.20619-0.255767im       0.0130855+0.0453436im      0.197046-0.0543552im     0.150286+0.077221im      0.00985451+0.000435731im   0.0939413+0.217135im     -0.175962+0.0939616im    0.326448+0.13054im        0.0651095+0.0939864im    0.0741699-0.0702999im      -0.141146+0.0834311im  -0.0509416+0.214208im       0.0684873+0.0850392im        0.18386-0.0963286im    -0.0732503-0.0559094im    0.00609027+0.0502474im
   -0.140418-0.187983im    -0.0124552-0.0980058im  0.000432423-0.128068im      0.173858+0.156823im   -0.0450746+0.175439im       -0.281105-0.134897im    -0.0393981+0.136943im    -0.257616+0.0171724im   -0.0175333+0.1354im      -0.0220183+0.0203027im     0.018352-0.00498283im    0.117958-0.0864954im      0.278155+0.0929265im      -0.242827-0.0174132im     -0.10651-0.185484im      -0.0498143+0.0882974im    -0.0817815-0.1866im          0.163907+0.0623926im    -0.0457282-0.0712219im   -0.0350511+0.282793im         0.01001+0.201974im      -0.191263-0.157969im    -0.0142707+0.0641606im  -0.0633525+0.252854im       0.0276705-0.0294119im   -0.0293849+0.131319im      -0.0132841+0.042047im    0.0128462-0.0532579im    -0.00748545-0.114953im       0.0880096+0.0214551im     0.0322203+0.0574427im      0.132497-0.0314835im
   0.0584995-0.225638im     -0.165991-0.115016im     -0.225919+0.0867049im    0.0049575-0.259658im    0.0146838+0.152373im        0.014396+0.0950057im    0.0259244+0.0026149im    0.016704-0.132135im     -0.232984-0.0968642im   -0.0464704+0.141053im    -0.0306893+0.154883im    -0.0878573+0.177641im       0.148333-0.113203im      -0.0122652+0.0514291im    0.0619381+0.217528im       0.0603501+0.056898im       0.143728+0.00495118im    0.00249937+0.179443im      0.0735409-0.239124im     0.0304344-0.0546751im       0.168726-0.0512692im     0.0819845-0.124393im     0.0466663-0.0112475im   0.0441149+0.133121im     -0.00129851-0.1685im       -0.327037+0.193709im       -0.139361-0.09271im     0.0980348+0.197637im       -0.123636+0.043467im       0.0225929+0.0957532im     0.0467553+0.0645761im     -0.068721-0.00869255im
  -0.0383097-0.072195im      0.029034+0.260826im     0.0140949-0.0345706im    -0.100571-0.131243im   -0.0887798+0.0577502im      -0.163801-0.19225im        0.16074+0.11195im     -0.116094+0.301975im     -0.135912-0.122859im     0.0627088-0.210367im     -0.108445-0.0207918im   0.00565391+0.0290961im      0.114426-0.117546im        0.225048+0.0441529im   -0.0691728+0.00908272im     -0.184061-0.0535951im    -0.0301133-0.297005im       -0.150684-0.0979752im     0.0446312+0.0381005im    -0.150197-0.296681im        0.119409+0.00407583im    0.0209522-0.0316848im    -0.232395+0.164856im   -0.0963935+0.00847581im    0.00822558+0.137824im    -0.0463244+0.0547028im      0.0391518+0.0520827im  -0.0219696+0.203895im        0.078067-0.0366914im     -0.0103901+0.00757167im    0.0991073-0.110607im     -0.0696719-0.122425im
   -0.070021-0.0141512im   -0.0090779+0.027816im    -0.0701941+0.0652608im    0.0968227+0.0900792im  -0.0408572+0.225575im        0.169224-0.0726767im    0.0294576-0.0870775im  -0.0268509+0.120936im      0.376289-0.0248658im    -0.102401-0.14858im      0.0935958+0.299581im     0.0102382-0.112048im      -0.133278+0.119676im       0.0154166+0.0766981im    0.0385096+0.0534553im      0.0751269+0.0629454im      0.223977-0.0510949im      0.0868972+0.10576im      -0.0886316-0.0950565im   0.00105618-0.149321im       0.0555328-0.0146972im      -0.22394-0.0172882im     0.213789-0.0070371im  -0.0297417-0.0062206im      -0.151722+0.0910344im   -0.0960871-0.134286im        0.249979-0.0748616im    0.186272+0.144401im        0.184997-0.136753im        0.127965+0.183638im    -0.00205626-0.0785789im     -0.038571-0.122349im
  -0.0409652+0.0939701im     0.016682+0.0446737im    -0.167249-0.260894im     -0.219718-0.203047im     0.148088-0.0264987im      0.0203599-0.080269im     -0.178807-0.207224im   -0.0394195-0.116517im     0.0643628-0.0759503im    0.0576207+0.108408im      -0.19612-0.0135814im    -0.139222+0.102068im     -0.0674127+0.0263592im      -0.127641-0.13311im      -0.169616-0.102896im     -0.00848348-0.0825163im     0.0513451-0.0972106im     -0.0105196+0.10452im       -0.141805-0.074598im   -0.00499108+0.171128im        0.289012-0.182257im      0.0648235+0.101293im    -0.0798258+0.0764538im  -0.0586507+0.109842im       -0.147237-0.0439038im     0.173908+0.00356604im  -0.000520832-0.0547064im    -0.11568-0.124971im        0.296356-0.214767im      -0.0192325+0.149291im      0.0908939-0.0105597im     -0.103179-0.068577im
    0.154532+0.183015im     0.0982605-0.0743367im     0.103452-0.0348199im  -0.00211084-0.0520523im   0.0323398+0.284881im       0.0717206+0.10182im       0.136201-0.156828im    -0.149126+0.0716562im    0.0574288+0.0198865im   -0.0041576-0.0529773im   -0.0914682+0.0250844im    0.0308633+0.0426417im     0.0860262+0.0638957im       0.114585-0.0167608im    -0.149346-0.0184634im     -0.0429174-0.197048im     -0.0165825+0.054103im        0.453926-0.093261im      0.0586913-0.0506735im   -0.0111178-0.0600177im     0.00924606-0.0806075im      0.132416+0.0446065im  -0.00560235+0.155514im     -0.26008-0.0238805im     -0.0275077-0.0532544im    0.0171465-0.120218im       -0.145894+0.229673im     0.199493-0.0647862im      -0.224045+0.0108565im      0.0268941+0.0567537im      0.142778+0.215303im     -0.0970369+0.15838im
 -0.00489243-0.0407748im     0.184566+0.239674im     -0.180754-0.0815004im    -0.201343-0.0615359im    0.129286-0.000799801im   -0.0960488-0.0790785im    0.0209068-0.0281056im   0.0338798+0.124im         0.285064+0.0234581im   -0.0593139+0.0722987im    0.0560322+0.00751914im    0.173618+0.0175486im      0.142201-0.115352im      -0.0410588-0.0565777im    0.0986057-0.269746im        0.159292+0.0745837im     0.0946517-0.0562783im      -0.053743+0.304333im       0.128674+0.0313945im      0.10932-0.0367637im      -0.115067+0.000588517im   0.0310957+0.0925529im   -0.0202612-0.0517703im  -0.0136567-0.0996553im      0.0511184-0.117484im     -0.232561-0.0359846im       0.103385+0.166545im    -0.218605-0.161725im       -0.284653+0.176384im       0.0349345+0.100219im      0.0526612-0.034774im      -0.103364+0.0220278im
   0.0350169-0.0201884im    -0.164429+0.032505im      0.107417-0.245077im   -0.00452011+0.173021im   0.00313732-0.279769im      0.00821202+0.106026im     -0.154683-0.102751im   0.00139938+0.192692im     -0.126805+0.124923im     -0.185769+0.0336582im    0.0792061+0.149692im      0.168878-0.136985im       0.149576+0.0778751im       0.181409+0.0781078im    0.0899868-0.0540156im      0.0432713+0.139917im     -0.0340049+0.155175im        0.114498-0.0547923im     -0.156458-0.0873032im    0.0449964+0.0143896im       0.257198-0.0962737im     -0.067666+0.154402im    -0.0999634-0.0676287im   -0.230159-0.133747im       0.0197515-0.0330764im    -0.178622+0.0739687im      -0.131382+0.031737im    -0.175266+0.215877im         0.10865-0.0620379im      0.0199446+0.0060141im    -0.0630921-0.0569723im    -0.0960427+0.17991im
  -0.0533971+0.017934im    -0.0983088-0.109893im     0.0451029-0.112054im    -0.0252173-0.0357465im   -0.130941+0.261723im        0.126767-0.026385im     -0.010231-0.0306539im   0.0545744+0.123423im     -0.232292-0.124876im      0.172513-0.0836576im     0.143554-0.093735im     0.0679801-0.0178747im     0.0189093+0.132018im      -0.0825551-0.178647im      0.207494+0.0953541im      0.0448625-0.121521im     -0.0943286+0.0670612im       0.121516+0.114553im      0.0851096-0.0319837im     0.127867+0.0723461im      -0.111131-0.138228im     -0.0135436+0.166419im     0.0712196-0.0120423im   0.0786514-0.0424907im       0.199649+0.00174171im   0.0300532+0.194968im        0.400051+0.157698im    -0.229344+0.126275im       0.0751907-0.12838im       -0.0857489-0.104252im       0.206815+0.0382878im    -0.0779225-0.0651647im
    0.193095-0.0582744im   -0.0121042-0.0892147im   -0.0845773-0.0212787im   -0.0523355+0.0611647im   -0.075334+0.109358im       0.0170236+0.101098im      0.134574+0.0784476im    0.102511-0.03857im       0.250543+0.18566im      -0.160699+0.0310704im     0.191999-0.02274im      0.0720701+0.128592im     -0.0932491-0.00749861im      0.161969+0.0678531im    0.0899246-0.059642im      8.01949e-5+0.0542478im     -0.121954-0.056708im        0.147298-0.137529im      0.0528142+0.0819155im    -0.091523-0.0570404im      0.0708651-0.0967237im     0.0983169-0.245963im     -0.328088-0.108921im       0.2172+0.130356im        0.183821-0.0996056im    0.0573382-0.023678im       0.0105948-0.206567im    -0.225973-0.047196im        0.177901-0.088402im        0.123959+0.0522173im      0.217014+0.177039im     -0.0755376-0.0450032im
    0.152739-0.137923im     -0.121148+0.0293002im   -0.0158475-0.147752im   -0.00457339+0.11832im     0.0854312+0.115709im       -0.102757+0.120232im     0.0674216-0.0858057im  -0.0964708-0.0820056im     0.112509+0.0940817im     0.171979-0.145828im    -0.0067361-0.0597501im    0.0541538+0.245773im      -0.145087+0.204815im         0.18371-0.128405im     -0.154385+0.0847864im       0.193789+0.0580042im     -0.148928-0.240815im        -0.11146-0.0769239im     0.0604622+0.281923im      0.223604-0.087794im       0.0189271+0.114279im      0.0430965+0.110263im      0.224062-0.0535587im   -0.104135+0.031236im       -0.100005-0.133485im    -0.0454212+0.289483im       0.0128259-0.114218im    0.0111319+0.017663im      0.00442909+0.00510084im    -0.0443401+0.0327246im     -0.136057-0.06752im      -0.0127663+0.150204im
   -0.139157-0.0163606im    0.0877826-0.135311im     0.0670936+0.0143096im   -0.0842197+0.0540319im  -0.0208244-0.0101097im      0.0586513+0.334252im    -0.0403364+0.133315im    0.0941898-0.0597192im   -0.0278021-0.0679336im     0.123721-0.152926im    -0.0261111-0.153032im     0.0801418-0.0599789im  -0.000258262+0.219051im        0.100947+0.230668im     0.0625188-0.272634im        0.032879+0.00521146im     0.173615-0.0693386im      -0.315713-0.128281im      -0.073437-0.316465im    -0.0317562-0.110548im        0.156297+0.0120569im     0.0973129-0.0279468im     0.124063+0.102151im   0.00246398+0.117395im       0.0301922+0.0143083im    0.0569858+0.0710485im       0.104056+0.0776941im  -0.0545088-0.138457im       -0.216065-0.183338im        0.137531+0.0877373im   0.000828142+0.113926im     -0.0791877+0.0655535im
   -0.252579-0.0805572im    0.0731477+0.174372im    -0.0407613+0.115939im      0.129152+0.103912im    0.0445509-0.0457294im       0.214801-0.00622723im    0.143621-0.161503im   0.00525293-0.253555im    -0.0676867-0.123593im     -0.112516+0.128012im    -0.0675471-0.0299014im     0.101634-0.0556954im   -0.00766081-0.0588701im      0.0803896+0.0344306im     0.101119+0.156482im       -0.181157+0.234517im     -0.0534387-0.307211im        0.167859-0.0841751im    -0.0568483+0.0699997im     0.102592+0.0703656im       0.105457+0.13028im         0.17814+0.109767im    -0.0851524+0.0365106im    0.080525-0.00521291im     0.0742369-0.0330729im   -0.0160038-0.103229im        0.180841+0.143334im   -0.0640992+0.0062299im      -0.065888-0.141801im       -0.214065+0.236889im     -0.0730443+0.0730126im      0.115617+0.142093im
    0.335499-0.0753992im    0.0839056+0.0821687im   -0.0722426+0.174288im    -0.0088087-0.0602902im  -0.0626514-0.0605731im     -0.0200484-0.0773363im    -0.153523-0.275552im   -0.0718127+0.015324im      0.129434+0.175633im     0.0347108-0.0792069im    0.0863347-0.286489im    -0.0206368-0.108547im      0.0333154+0.0181732im       0.140875+0.113284im    -0.0834486+0.0331322im      -0.137751-0.116488im      -0.198631+0.0345132im      -0.016503+0.0421857im     -0.183475-0.175614im     -0.131089+0.159283im       0.0109648+0.0665969im      0.080781-0.0236077im     0.075532-0.150781im     0.157371-0.0226027im      -0.136383-0.0444108im    -0.142793+0.0967101im      0.0855517+0.171005im   0.00551967+0.146106im       -0.115669-0.13591im        -0.113245-0.00634355im    -0.153535+0.0795418im    -0.0483603-0.279152im
   0.0455101-0.209827im    -0.0148591-0.0400832im     0.114076+0.181769im    -0.0623145-0.057228im    0.0443975-0.128875im       -0.034159+0.18975im       0.189982-0.120406im   -0.0609415-0.00111288im   -0.110134+0.201834im     0.0409815+0.289711im     0.0286759+0.160174im      -0.12566+0.0753929im       0.22399+0.0456619im     -0.0606099-0.0557333im    -0.204552-0.00347096im      0.209698-0.147169im      -0.018168+0.117682im       -0.109919+0.0348634im     -0.104749+0.105886im      -0.14503-0.10793im        -0.119596+0.242865im      0.0405963+0.120565im     -0.118082-0.0487172im  -0.0272501-0.0793555im      0.0258496+0.148817im     0.0366812-0.073431im        0.278596+0.0422534im   0.0252023-0.000548114im    0.0440768-0.228364im        0.137197+0.158646im        0.15965-0.0644808im   -0.00689181+0.0575714im
    0.224189+0.123076im     -0.177036+0.0682323im    -0.112724+0.0876439im     0.177644+0.0339191im   0.0448241+0.0365036im      -0.191323+0.022595im    -0.0367541-0.138961im   -0.0614746+0.100867im      0.023583-0.0486351im    0.0454534-0.099028im    -0.0215249-0.217397im    0.00373447-0.0748663im    -0.0606857-0.0644051im     -0.0964987-0.0165394im     0.179079+0.0508758im       0.219114-0.078544im      0.0243933+0.000447062im   -0.0457777+0.209047im       -0.24481-0.037301im     0.0692607-0.0599589im       0.151428+0.0555181im     0.0460619-0.214883im     -0.123255+0.246417im      0.10008-0.00579386im      0.137371+0.251503im    -0.0872447-0.0648199im      0.0678528-0.0276334im   0.0642269-0.126874im       0.0881523+0.0131904im      -0.105274-0.0188262im     0.0241445+0.00805675im    0.0696335+0.418629im
   -0.149325+0.0138016im    -0.221912+0.132631im     0.0234144+0.133718im    -0.0313546-0.106459im   -0.0748192+0.143302im      -0.0259255-0.127696im     0.0117369+0.0891478im    0.184739+0.0330804im    -0.023506+0.13662im     -0.0539299+0.0984339im    -0.168668+0.0915899im    -0.113244-0.106352im     -0.0329928+0.234981im        0.143004-0.00108909im    -0.12082+0.0755812im      0.0890292-0.0283757im    -0.0610102+0.0942887im       0.167531-0.0245478im      0.148302-0.105673im    0.00373189-0.0135098im      0.0338265-0.0409867im      0.076191-0.253581im     -0.132707+0.0306938im  -0.0410904-0.000461674im    -0.189569-0.0332351im   -0.0757186+0.0418753im       0.183636+0.0483947im   -0.211703-0.311528im      -0.0755185-0.0962669im    -0.00225376-0.169962im      -0.340506-0.197851im     -0.0394965+0.0643446im
    0.134158+0.00840328im   -0.212124+0.0405027im     0.183969+0.191137im     -0.189316+0.0209921im    0.110078-0.028425im       -0.160126-0.195016im     0.0419686+0.0676068im    0.113705-0.0944782im    0.0551719-0.121973im    -0.0762309-0.0978829im   -0.0915415+0.109978im      0.232225-0.196389im     -0.0752993-0.148585im    -0.000908128+0.0775759im     0.027585+0.143127im        0.308947+0.075876im      0.0905038+0.0228908im     -0.0505076+0.0406509im    -0.0275761+0.120165im    -0.0986056+0.129154im       0.0990502+0.0768214im      0.147744+0.0624895im    0.0663638+0.0547344im   -0.229772+0.101026im      -0.0339759-0.176834im      0.155697-0.00424375im     0.0389734+0.025023im   -0.0336862+0.0639281im     -0.0774013-0.16936im     -0.000513139-0.18111im         0.16517+0.245569im       0.112675-0.152222im
   0.0766228+0.166977im     0.0625729+0.141506im     0.0189014-0.0105379im     0.248357-0.0449227im  -0.0152869-0.147718im      -0.0796558+0.0992355im   -0.0581953-0.131568im    0.0258944-0.354822im     0.0238172-0.00918999im   -0.227077-0.147236im     -0.050701+0.0249686im     0.101138+0.254046im     -0.0471266-0.0306132im     -0.0294197-0.0170055im   -0.0650553+0.0753155im     -0.0196796+0.0172152im     0.0395186-0.00836783im   -0.00194358+0.00855793im   -0.0217047-0.15114im       0.217404-0.0509398im     -0.0626636-0.0366027im     -0.140763-0.104817im     -0.210891-0.0199232im   -0.218314-0.00723996im      0.176388+0.0717882im    0.0738321+0.193476im        0.163164+0.15357im     0.0618055-0.00508323im     -0.100453-0.0421253im        0.22922-0.161477im      0.0992396-0.212942im    -0.00634459-0.20837im
   -0.130731+0.136523im    -0.0833442+0.0511984im     0.122451+0.293124im    -0.0217337+0.0110107im   -0.183097+0.132942im       -0.208396-0.0849538im    -0.247636+0.0639558im   0.0197063-0.189624im     0.0912521+0.0264328im   7.96711e-5+0.00905812im    0.061595+0.0901586im    0.0750743+0.0296537im     0.0206285-0.145461im       0.0897469-0.269536im      -0.13102-0.118975im       -0.171732-0.139521im     -0.0969627+0.103982im      -0.0834951-0.0427199im   -0.00705773-0.0693319im    0.0752787-0.213313im        0.205037+0.0787834im     -0.064189+0.111294im      0.175235-0.208692im    0.0832852+0.14187im         0.164916-0.154584im    -0.0829059-0.141974im      -0.0738127+0.100838im   -0.0314873+0.00609036im     0.0841697-0.0621437im     -0.0916447+0.0376991im      0.136787-0.0891394im    -0.0666653+0.204276im
  -0.0954548+0.145878im     -0.186041-0.130559im      0.029463-0.0550522im     0.120236-0.239778im   -0.0537989-0.0869623im      -0.053736+0.0970104im   -0.0432045+0.0010134im   0.0907824-0.112665im     0.0274917+0.191343im     -0.171938-0.0344797im   -0.0141565+0.00260398im    0.254947-0.26764im       -0.110196-0.0510181im      -0.100103-0.103339im    -0.0268352+0.0792929im      -0.208192-0.1703im        0.0487911-0.135156im      -0.0428459+0.0116236im     0.0243228+0.172531im    -0.0376079-0.0614604im      -0.214533+0.0609827im      0.043737+0.0441936im    0.0530906+0.192115im    0.0460531-0.0807878im      -0.229324+0.185548im     -0.209764+0.195324im       -0.092898-0.101727im    -0.146913-0.0441858im     -0.0363151-0.0528001im      0.0417121+0.187807im       0.110368+0.130095im      -0.185103-0.0215747im
     0.10925-0.0572812im   -0.0715796+0.0389115im     0.259947+0.177856im      0.137088-0.0288979im   -0.190667-0.109157im      -0.0503972-0.00346122im    0.145475+0.0288658im   0.0713189+0.0451768im     0.127939-0.086521im    0.00456496-0.0682277im     0.163361-0.139768im    -0.0651124+0.0785477im      0.316213+0.0060892im     -0.0424524-0.0788179im    0.0738838+0.0833923im    -0.00129096+0.174059im     -0.0379604-0.0147176im       0.089709+0.0776717im     -0.106236-0.149173im     0.0723763+0.00963103im    -0.0772152-0.151038im       0.232971+0.0593032im     0.194643+0.211733im   -0.0863708+0.0473215im     -0.0935738-0.0815916im      0.19712+0.00344299im     -0.134519-0.0882562im    -0.15609-0.147237im        0.121691+0.10738im        0.0395322+0.275144im      0.0149232-0.252014im     -0.0609586-0.112239im
   0.0612331-0.187252im     -0.207239+0.217039im    -0.0106661+0.0889851im     0.121995-0.156302im   -0.0714065-0.0178166im      -0.061086+0.162407im    -0.0101816-0.124383im    -0.121417+0.060862im     -0.107384-0.0719472im    0.0698885-0.0375094im     0.181138+0.146331im      0.128566-0.0150376im     -0.106378-0.113887im      -0.0288699-0.100675im     -0.280118-0.300056im       -0.121748+0.182131im      0.0573808-0.0793425im     -0.0139228-0.0478952im      0.169216-0.150946im     0.0464367+0.169082im      -0.0446026-0.195695im       0.135067-0.048706im     0.0857195-0.0551674im  -0.0386744-0.197744im       0.0329872+0.110529im     0.0894399-0.13952im         0.157178-0.196548im    0.0453583-0.0260122im      0.0370371+0.0403063im    0.000584922-0.149231im     -0.0695962+0.248882im     -0.0278151+0.052145im
   -0.132122+0.0427988im     0.156406+0.0391813im   -0.0267859+0.206882im      0.244118-0.0582007im    0.263146-0.142012im     -0.00422569-0.0205911im     0.193892+0.112428im   -0.0906757+0.134505im     0.0627347+0.157433im     0.0325994+0.129621im    -0.0384371-0.113407im     0.0035974+0.0182345im    -0.0325099+0.185787im       -0.155021-0.0805652im    0.0609681+0.0684791im      -0.112757-0.0888406im      0.153521-0.0291752im     -0.0749748-0.0276214im    -0.0642383+0.162253im     -0.010087+0.0728792im       0.146094-0.120182im       0.158973-0.223729im      0.207087-0.0853383im   -0.180886+0.00680691im      0.153438-0.156584im    -0.0601532-0.00901629im     0.0266271+0.108098im   -0.0702505+0.165133im        0.160706+0.0180374im      0.0648327-0.188654im     -0.0145468+0.0611164im     -0.312612+0.0271617im
  -0.0308934+0.0310684im   -0.0265508+0.110772im    -0.0485278+0.0084019im     -0.17351-0.0176689im   -0.118931+0.141132im      -0.0886086+0.0580842im     0.124059-0.109309im   0.00919124-0.11911im      0.0545943-0.127019im     0.0737974-0.0692225im   -0.0989025+0.19286im       0.155765-0.268844im       0.174653+0.170731im       -0.048783+0.133074im    0.00414199+0.0731525im     -0.0231266-0.239324im     -0.0676031+0.0365088im       -0.19157-0.155667im       -0.15025+0.064433im      0.132628+0.241575im        -0.11557-0.117477im       0.116423+0.0222127im    -0.156936-0.0390777im   0.0591658-0.0404076im       0.263432-0.150461im      -0.10424+0.0353048im     -0.0261187-0.0265506im    0.196059-0.0424189im       0.198086+0.216734im        0.166769+0.137015im      -0.164432-0.0336929im    -0.0107176-0.026669im
 -0.00710773+0.0785784im   -0.0433494+0.0947348im    0.0839864-0.0410725im   -0.0744839+0.149237im   -0.0911178+0.165802im      -0.0960011-0.0308602im    -0.125445-0.177708im     0.278128+0.0149953im   -0.0876836+0.00726775im   -0.107649+0.348058im     0.0705187-0.144731im      0.201709+0.159344im       0.155451+0.263991im       -0.155287+0.221594im      -0.15528-0.0077939im      -0.108439+0.0959365im     0.0395103-0.0125755im     -0.0565919+0.0697177im   -0.00116136+0.191221im     0.0522486-0.211881im        0.186321-0.0471775im      0.047899-0.0760146im    0.0925185+0.117897im     0.124394-0.085452im        -0.13657+0.0687661im    0.0490452-0.0236179im      0.0493814+0.0493721im    0.142834+0.0521892im      0.0399341+0.191661im      -0.0122506-0.113732im      0.0995621+0.0988992im     0.0569874-0.133791im
   -0.134591-0.0424359im   -0.0694705-0.215992im      0.025106+0.064753im     -0.235082-0.203193im     0.219817+0.0155971im     -0.0925618-0.0177938im    0.0642884+0.07459im     -0.149582-0.156692im      0.020465+0.0636203im    -0.176066-0.0114917im     0.227263-0.313698im     0.0580067-0.0118041im    0.00262218+0.0275796im       0.264461+0.0924834im   -0.0304739-0.0241568im     -0.0946622-0.0338829im   -0.00900387+0.155579im      -0.0171076+0.151369im       0.150146+0.0794929im     0.178144+0.0899216im     0.00528306-0.176438im     -0.0292045+0.0171439im  -0.00314646+0.0732012im   -0.179628+0.165946im      0.00922853+0.213376im    -0.0377586-0.165078im        0.130351+0.0181026im   0.0406522+0.157003im        0.104099+0.0591466im      0.0465628+0.0977471im      -0.13027-0.0680403im      0.229872+0.0325358im
     0.11544-0.108931im     -0.256824+0.154621im      0.145154+0.0112963im    0.0796906+0.10491im      0.173929-0.0537708im       0.244183-0.0649996im   -0.0198756+0.104531im     0.163335-0.0816408im   -0.0203973-0.00809611im    0.174494-0.00642849im  0.00830252-0.0425182im   -0.0915625-0.0146192im     -0.118124-0.0515174im      -0.228217+0.0864338im   -0.0434975-0.0963237im     -0.0689095-0.0165581im     -0.358822+0.0157151im     -0.0432612+0.110314im      0.0294772+0.0192555im   0.00472333-0.12651im      -0.00243083-0.0673602im     -0.218271+0.0777505im    -0.144107+0.131054im    -0.137248+0.270098im       0.0400655-0.048517im     -0.109756-0.120451im       0.0708225+0.0836024im   0.0566478+0.0239569im     -0.0360509+0.117588im        0.125658+0.16213im       -0.125632+0.185459im      -0.259946-0.0374763im
    -0.24079-0.094957im     -0.187191-0.094376im     -0.041219+0.0354913im    0.0741414+0.117353im   -0.0813057+0.0841618im      -0.285671+0.0459461im    -0.181502-0.255984im    -0.146121+0.00153464im    0.110191+0.0910731im    -0.116396+0.0060859im   -0.0936759-0.0962564im    -0.285687+0.05179im      -0.0800026+0.00021831im    -0.0647822+0.206045im      0.100119+0.166897im       0.0239242-0.0153601im     0.0193951-0.17494im        -0.101098-0.0286735im     0.0354497-0.0677405im     -0.25606-0.111204im       -0.219519-0.251803im     -0.0160006+0.190774im    -0.0529578-0.0491395im   -0.131223-0.0591885im      0.0448276-0.162695im     0.0784259-0.104683im       0.0360512+0.0601212im   -0.161817+0.0379902im     -0.0512684+0.132651im       0.0480068-0.0237025im     0.0207677+0.109433im      0.0229451+0.0857254im
    0.178634-0.0901936im     0.143053+0.0113376im    0.0701339-0.0336793im    0.0914804+0.0994455im  -0.0632434+0.114094im       0.0014263-0.167245im      0.169597+0.130888im    0.0546023+0.123261im    0.00568694+0.10124im      -0.058891+0.341866im     -0.192876-0.0449615im     0.134662+0.0310148im     -0.136136-0.149205im       0.0531012+0.0808439im     0.111166+0.111425im       -0.156972-0.237918im      -0.126118-0.0944366im        -0.1885+0.0612373im    0.00846017-0.313304im      0.253091+0.0727131im      0.0146504-0.084118im     -0.0380112+0.180315im      0.070344-0.091268im     -0.11445-0.0953558im      -0.125082+0.0372571im    0.0397188+0.00425048im     0.0214224-0.17083im    -0.0140144-0.0727975im      0.0131696-0.0966246im       0.197991-0.0338145im     0.0479312+0.0548685im      0.146225+0.148907im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 -0.012351350167010377 + 0.09920785712579083im
   -0.0473086656764825 + 0.1928230394690647im
  -0.14926354204284673 + 0.1371186973495244im
    0.5081706216665086 + 0.0im
    0.0773563309289025 - 0.09492035578711316im
   0.07915314687287855 + 0.05165762465601636im
   0.23851950131050845 - 0.04051550623493111im
  0.032071795392203596 + 0.031207470861492698im
   0.12058988520435306 + 0.03087905510414442im
  -0.08109169923636024 - 0.0058840357100798405im
   -0.1731061304491935 + 0.05392933539009232im
   -0.2051334584334418 + 0.08051384716963839im
   0.12758196959262144 - 0.07319110546776164im
  -0.06065356949174582 - 0.021705698011140112im
   0.04374991040304341 + 0.23035427723584537im
  0.003406620881524242 - 0.24833197015176084im
   0.13616198079214495 - 0.03228489870546578im
  0.019186717969992176 + 0.06908840593792571im
    0.1813996380618813 - 0.06880943146371898im
   0.07216861007309054 - 0.1367777926265413im
   0.06796563847068487 - 0.03894636192159737im
   0.09383036410884994 - 0.12716145168997625im
  -0.03940067330525483 - 0.1311672874677148im
  0.049891876772746924 + 0.07308255309858895im
   0.26526657964002814 + 0.07288199985486898im
  0.030268872672186278 + 0.22205778887758962im
    0.0611256409947023 - 0.043161943594126444im
  -0.06163929714886419 - 0.10542271639846956im
   0.07288676899637873 - 0.016959130354521658im
  -0.07936342544003148 + 0.005344911632135484im
  0.056448241063709124 + 0.07149646070832548im
 -0.058962184229388565 - 0.0819980268040513im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 30 September 2022 15:27">Friday 30 September 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

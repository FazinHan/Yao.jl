<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.257691-0.189563im        0.142798-0.000413192im    0.0511275-0.251598im      0.0395357+0.0683111im      -0.23279-0.0312123im      0.0897413-0.195358im       0.260385+0.0736543im   -0.175811+0.00442365im   0.0131092+0.0161731im     0.0337053-0.0735964im    -0.00256617-0.223613im      0.0812234+0.0212358im    0.0250792+0.168151im     -0.136484+0.135104im      -0.075163-0.114669im       0.166842-0.0350822im    0.101464+0.101697im      -0.246416-0.00412783im      0.19388+0.00868031im  -0.0712354+0.0782787im   -0.00119524-0.0163574im   -0.0882799-0.0906471im     -0.156101+0.0173118im     0.131404-0.00707857im  -0.00307612+0.203632im    -0.0637806-0.23835im      -0.0662225-0.177598im        0.206781+0.0437251im     0.00896079+0.194833im      0.106938+0.00660716im    0.0278556+0.00389566im  0.00608565-0.00945796im
  -0.180708-0.0879382im      0.0348172-0.29321im        0.0905453-0.29165im       0.0545027+0.0473308im     0.0970568-0.0316452im      0.0769644-0.0483833im     0.0622702-0.133566im    0.0202341+0.0545696im     -0.16286-0.0161744im    -0.0243341+0.0421259im      -0.193836+0.129804im     -0.0894441+0.266538im     -0.236078-0.197373im    -0.0268044-0.061681im      -0.190439-0.0776696im    0.00286683-0.065881im   0.00128564-0.132859im       0.114885-0.149521im      0.0590756-0.138529im     0.0784025-0.0600252im      -0.15622-0.186929im    -0.0679894+0.0955489im    -0.0815628+0.00664521im   -0.211138+0.207553im      -0.172124+0.142333im       0.15082-0.0562238im    -0.0394164-0.0272608im       0.046875+0.211015im      -0.0447581-0.0491095im     0.039145-0.0710425im   0.000183201+0.16767im     -0.0019185-0.0683635im
  -0.169596-0.0314948im   -0.000261971-0.23694im        0.0191818-0.2233im        -0.107327+0.182024im     -0.0199074+0.0210828im     -0.0544183-0.211738im       0.167006+0.143931im     0.129891-0.0721457im     0.153467-0.195464im     -0.0754246+0.087186im        0.120879-0.103133im      0.0350067+0.00370754im  -0.0593661+0.25854im       0.146382+0.00321626im    -0.174079+0.148036im     -0.0644472-0.0244886im   -0.024056+0.0523871im    -0.0933109-0.191051im     -0.0225791+0.039481im    0.00265102+0.0651957im    -0.0109075+0.0110601im     0.136097+0.0533113im     0.0866401+0.00303633im  -0.0527474-0.164022im     -0.0711151-0.411858im     0.0150618-0.145849im       0.154147-0.000274894im    -0.266464-0.00757598im      0.114796+0.0517025im    -0.126162-0.00795472im    0.0882174+0.039288im     0.0392601-0.047152im
  0.0117932-0.12102im         0.183977+0.0753838im     -0.0661027-0.102345im       0.385105-0.121003im       0.246516+0.102833im       0.0208524+0.191762im      -0.219801+0.0583745im    0.176451+0.167857im    -0.0867692+0.0672518im     -0.198756+0.123572im       0.0844593-0.103664im     -0.0405035+0.094286im     0.0369835+0.0877439im     0.135203+0.0667323im    -0.0178161-0.00135504im     0.022665+0.0691997im   -0.127995-0.0109379im    -0.0585032-0.0448162im    -0.0663417+0.208502im     0.0177756-0.0737021im     -0.140895-0.108457im    -0.0307154+0.057817im        0.11862-0.0198346im    0.0490202-0.0932543im     -0.226561-0.129673im    -0.0287739-0.12251im       0.0306402-0.0488215im       0.219208-0.034069im       0.0403816+0.241232im      0.132082-0.0698393im     -0.125237-0.203588im    -0.0237959-0.0476559im
  0.0555757+0.0565196im      -0.096837+0.124888im      -0.0750606+0.102949im     -0.0773892-0.131921im     -0.0885111-0.222291im       0.0750532-0.0603898im     0.0684023+0.0538612im   0.0523178+0.187492im      0.130515+0.0510229im     0.0589068+0.0237736im    -0.00548424-0.216274im      -0.205716+0.117883im     0.0135004+0.104385im    -0.0679108+0.183826im       -0.10691+0.2426im        -0.102097-0.199282im     0.175944+0.0269375im      0.136066+0.0897343im   -0.00688806+0.161184im      0.180667-0.0216907im   -0.00174668-0.0629118im      0.13533+0.213281im      -0.163554+0.168217im     -0.305688+0.119589im      0.0386835-0.0878971im     0.152901+0.0525416im     0.0300281-0.088334im        0.136019+0.00501796im     -0.028219-0.047033im     0.0999023+0.0836673im     0.0449556-0.197908im     -0.182516-0.124484im
   0.114235+0.0201659im      0.0189572-0.0384589im      -0.013678-0.0600961im     0.0519516-0.103293im      0.0880058-0.179665im       0.0826874-0.234983im      0.0156205-0.0670189im    0.221702-0.0471434im   -0.0266612+0.0222543im     0.0465952-0.193884im       0.0119089-0.0879895im    -0.0851811-0.0892501im   -0.0460382-0.0808174im   0.00400442-0.0790307im      0.109847-0.0408266im     -0.163611+0.205488im    0.0562774+0.0124413im     -0.139772+0.0140666im     0.0300858-0.0802096im   -0.0194199-0.239934im       0.134558-0.324717im    -0.0422146+0.0574447im      0.238326-0.0431894im   -0.0606571-0.0596803im      0.247414-0.0100962im     -0.26571+0.111057im       0.131255-0.0325961im     0.00293902+0.198827im     -0.00606884+0.117933im    -0.0460162-0.170736im       0.177281+0.00871611im   -0.292619+0.0183002im
  -0.188505+0.158685im       0.0187894+0.0847238im      -0.177826+0.026569im       0.043525-0.0606801im    -0.0905144+0.00457228im  -0.000875868-0.103663im       0.151285-0.0296318im    0.201726+0.017428im      0.165332-0.175792im     -0.0420265+0.309466im       -0.104752+0.0142034im     -0.273723-0.0476191im    -0.138588-0.229771im    -0.0725039+0.209587im      0.0905989-0.05585im      -0.0269722+0.0793472im    0.111614-0.0276497im     0.0752503-0.147523im      -0.115389-0.0276984im    -0.151319-0.0869189im    -0.0949716+0.190379im     -0.224972-0.144002im      -0.119868-0.0080079im     0.223947-0.128795im     -0.0129646+0.0199138im    -0.065479+0.0495732im      0.126059-0.257304im     -0.00650017-0.0225062im      -0.100859+0.070414im      0.141661+0.076198im      0.0893491+0.0306132im   0.00150315-0.0600052im
   0.252192+0.0833999im      0.0324243-0.0608718im      -0.228699-0.00170685im     0.209533+0.12393im      -0.0717575+0.121471im        0.192316-0.235531im     -0.0305433+0.0328863im  -0.0357513-0.0705983im     0.295289-0.0811935im     0.0618436+0.061515im      -0.0995982-0.0495613im    -0.0711023+0.136778im     -0.186294+0.137283im    0.00711465-0.1227im         0.152605-0.104754im      0.0125646-0.0277985im   -0.216337-0.0591454im      0.113668+0.254344im     -0.0462966-0.160918im      0.124159-0.0281603im   -0.00762167-0.0570556im     -0.05623-0.0643955im      0.131206-0.063614im     -0.168662-0.0869578im     -0.163023+0.0725707im    0.0506268-0.0159755im     0.0442882+0.193335im       0.0483559-0.284638im       -0.184898-0.0430794im   -0.0743406+0.0697562im      0.054496-0.00594937im   0.0289918-0.0583225im
  -0.146383+0.0518207im      0.0941885+0.0422839im      0.0605143+0.0808781im     0.0366904+0.0368161im     -0.145288-0.0865266im      0.0623194-0.00574325im    -0.260475+0.0181867im  -0.0671703-0.198475im    0.00643656-0.247697im      -0.139418-0.0169903im      -0.133217-0.130899im     -0.0638214+0.132333im      0.244344-0.0595113im   -0.0685166-0.00340518im     0.180388-0.0415437im    -0.0664051-0.134755im   -0.0633877+0.202017im      -0.139049+0.134358im     -0.0890903+0.0211663im    -0.138565+0.0103411im     -0.235934+0.0431768im    -0.141363+0.174993im      0.0807764+0.121918im     0.0369015+0.00674257im     0.148253-0.0502683im     0.143275-0.180818im      -0.127787+0.164888im       0.0218544+0.198097im       0.0505627+0.0281125im   -0.0767279-0.0288353im     0.0621602+0.182287im    -0.0655892-0.303461im
  -0.153112-0.0628591im     -0.0373502+0.0999194im      0.0528567+0.156272im      0.0433159+0.258312im      0.0984298+0.0833025im     -0.0060311-0.382394im       -0.18574+0.0987416im    0.118733+0.0161102im   -0.0208057+0.191209im       0.235374-0.1938im       -0.00075692+0.182875im      0.0638591-0.0103562im   -0.0638179-0.081995im      -0.06094+0.0801214im      0.130571-0.165169im     -0.0566485-0.286153im    0.0639816+0.0398374im    -0.0393271-0.0501879im    -0.0420212+0.0552152im   -0.0620455-0.0709915im     -0.074913-0.0439532im     0.149797-0.182155im     -0.0917939+0.059316im    -0.0785784-0.183638im      -0.128973-0.00589195im   -0.022419+0.019924im      0.0499697-0.140359im        0.141405+0.0545169im       0.253669-0.00143354im  -0.0966028+0.0426767im     -0.135835-0.0665444im    0.0523843-0.153838im
  -0.197874-0.0482739im    -0.00690087+0.227638im       -0.110441-0.168394im      0.0182275+0.113677im      0.0865584-0.0103691im      -0.104637-0.120827im       0.053872-0.0373162im   -0.180317-0.0279308im    -0.190424+0.0431585im     0.0614425+0.0298667im       0.112392-0.11704im      -0.0904527-0.0148646im    -0.103443-0.077013im     0.0873923+0.0157293im   -0.00238335-0.0434836im      0.102142-0.0418032im  -0.0427205+0.10929im        0.106408+0.113117im       0.270409+0.169088im    -0.0012206+0.0315982im     -0.123737+0.0441564im     0.143004+0.032287im       0.133744+0.00700341im    0.113999+0.0165447im     0.0456684+0.0551081im     0.052544+0.167087im     -0.0909637-0.118831im       -0.207307-0.123065im       -0.396166+0.101878im     -0.266354-0.180471im     -0.0915846-0.0591458im    -0.159723-0.175702im
 -0.0980256+0.112762im     -0.00790661+0.266054im     -0.00298622-0.000142666im  -0.0290802+0.0352701im     -0.107972+0.136186im        0.103276+0.151689im      0.0850529-0.237582im     0.055808-0.036602im     0.0842099-0.262123im     -0.0589483-0.000686063im  -0.00372428-0.114241im      0.0725649-0.129295im     -0.109673+0.0985813im     0.093061-0.0804338im     -0.122176-0.298301im      0.0421433-0.018691im   -0.0182159+0.262197im      0.0815927-0.30167im       0.0968504+0.109766im      0.219496-0.0317881im     -0.159444-0.0946952im     0.125705+0.00524357im   -0.0600812+0.0679709im   -0.0614194-0.0609034im      0.023814+0.138388im     -0.110927+0.150315im      0.0579525+0.202327im        0.231383+0.000616278im     0.177935-0.0760815im   -0.0782523-0.0231996im     0.0500832+0.0230501im   -0.0628941+0.0929258im
   0.112212+0.0845177im      -0.065434+0.0749366im       -0.11118-0.0244663im    -0.0382928+0.0669427im    -0.0201103+0.165939im       0.0328218+0.0695278im    -0.0806107+0.107579im    0.0951963-0.0426392im     0.191067-0.207006im       0.123079-0.156151im        0.122914+0.210968im     -0.0390202+0.0456745im     0.148844-0.266629im      -0.15621+0.0999478im     -0.259151+0.187643im     -0.0991651+0.228174im     0.107977+0.0692033im      0.002238-0.045551im       0.163884-0.0731657im      0.15377+0.125814im     -0.0854023-0.0581291im     0.059452+0.0568606im      0.108092-0.315509im    -0.0804644+0.025604im      0.0262609+0.0210456im   -0.0102787-0.0166656im     -0.190888-0.0838143im       0.103362-0.0608789im      0.0377816+0.235146im    -0.0550506-0.0408367im    -0.0505302+0.0320353im     0.163544-0.193679im
 -0.0890964-0.0766311im     -0.0554306+0.135128im      -0.0269209-0.181963im       -0.15823-0.061143im     -0.0321643+0.155382im       -0.014336+0.10842im      -0.0490367+0.051778im   -0.0921347-0.15561im      0.0209758+0.137535im      0.0548109+0.0634146im     -0.0546414-0.157023im       0.044182+0.0619666im    0.0854502-0.0839524im      0.30981-0.328748im     -0.0110048-0.0291945im    -0.0543444-0.0353985im   0.0777689-0.0868815im     0.0506233-0.12262im       -0.269687-0.047582im     -0.120997+0.0455143im     0.0994825-0.0837175im    0.0449621-0.26824im       -0.086938-0.17301im      -0.177504+0.0100728im      0.223888+0.0532771im     0.112877-0.116671im      0.0242686-0.123551im        0.103536-0.155125im     0.000852259+0.105355im     0.0969467+0.00503217im     0.171749-0.0775472im    -0.110487-0.250675im
  -0.263805+0.00230489im    -0.0705063-0.257473im       0.0262265+0.107446im      0.0584614+0.0967019im      0.101643+0.08802im         0.245284-0.0561165im     -0.133267+0.032126im    0.0916852+0.100937im     0.0866247-0.0780925im    -0.0254981-0.0740359im       0.161074-0.203603im    -0.00177219+0.00339978im   0.0715449+0.101622im    -0.0299463-0.0969125im    0.00424815-0.249574im      0.0539166+0.219924im     0.228175+0.0114791im     0.0886575+0.0170196im     0.0336933-0.0885226im    -0.126434-0.0026157im      0.115212+0.0234355im     0.144571+0.10423im        0.017322+0.0501585im     0.155905+0.125443im     -0.0740653+0.111862im     0.0599521+0.0303163im     -0.359827-0.0885642im     -0.0664548-0.0332888im    -0.00236959-0.0768331im    0.0808197+0.141913im        0.21221-0.267978im    -0.0188462+0.00244355im
 0.00971012-0.0688189im     -0.0435991-0.143716im        0.147623-0.0791221im     0.0934005+0.0457729im     0.0525411-0.136716im       -0.105458+0.194466im     -0.0888809-0.0604135im     0.16103-0.0797009im    0.0300132-0.231125im       0.181223+0.0846187im     -0.0451086+0.0348579im    0.00287784-0.245876im     -0.117973+0.0793201im    -0.124051+0.0921733im     0.0833745+0.076065im       0.108259-0.340698im     0.198004-0.0210393im      0.140651+0.0770785im     0.0127758+0.157643im     0.0506155-0.0344782im       0.15218-0.0657883im    -0.145162-0.157237im       0.150797-0.229852im       0.12642+0.0929525im   -0.00114932+0.00522318im    0.185474-0.136882im     -0.0672935-0.0103147im       0.140104-0.124062im       0.0785562-0.00936514im   -0.187304-0.156207im       0.163844-0.055583im     -0.127167+0.0676536im
  0.0134056-0.0781874im      -0.167218+0.144208im       0.0190791+0.00403323im     0.221228-0.0969929im     -0.267415-0.0113698im        0.20824-0.0216088im    -0.0347443-0.0865172im   0.0146946+0.0159687im    0.0558035-0.0462808im    -0.0150176+0.0855268im       0.243814+0.195698im       0.128679+0.0472714im    0.0852287+0.0588457im  -0.00163346-0.193589im       -0.10149-0.143881im       0.198688-0.123455im     0.114826-0.370847im      0.0114474+0.114287im       0.116727+0.0826484im     0.116686-0.12465im       -0.127575+0.101896im     0.0111304-0.027094im       0.110739-0.0692402im   -0.0176395-0.0640024im     0.0993476-0.182159im    -0.0169493+0.00607583im   -0.0267378-0.176144im       -0.163435+0.109946im       0.0737463-0.0524164im     0.159441+0.0582643im    -0.0604071+0.212196im     -0.187365-0.0336281im
 -0.0843661+0.205047im       -0.210964+0.106184im        0.159549-0.084316im     0.00233546+0.0614613im      0.242511+0.0770046im      0.0267779-0.0132125im     0.0310228+0.136377im    -0.147035+0.125616im    -0.0366625-0.00215081im   -0.0227881-0.058687im       -0.120657-0.138475im       0.192332+0.0306648im   -0.0277153+0.159426im    -0.0417272+0.0365831im      0.331464+0.0846973im   -0.00644385+0.0238084im    0.165708+0.0316076im      0.097885-0.0230891im      0.063992-0.0901235im    0.0686191-0.0662998im     -0.253793+0.0308936im    -0.131138+0.125179im      0.0518474-0.101208im     -0.188479-0.195083im       0.130679-0.0433955im    0.0587313+0.00493im      -0.0654086-0.173392im       0.0147097-0.096381im      -0.0251262+0.0451155im     0.212149-0.196606im      0.0783877+0.160493im      0.164654+0.23656im
  0.0516942+0.111125im       -0.148417+0.0289187im       0.161655+0.304883im        0.15873+0.0105301im    -0.0156404+0.0126773im      0.0217613+0.0710297im    0.00360457-0.0826598im   0.0605464-0.136929im      0.030755+0.0643936im    -0.0391702+0.133214im      -0.0397208-0.149793im       0.278331-0.0426169im    -0.154177-0.0668899im     0.128525-0.0633387im     -0.203006-0.0706894im     -0.152132-0.0651356im   0.0839972+0.0924922im   -0.00365669+0.178641im       0.199502-0.283173im    -0.0539633+0.00406784im   0.00936692-0.149696im     -0.125521+0.064242im      -0.264591+0.0237525im     0.113187+0.144595im     -0.0720279-0.254206im    -0.0739608-0.0894697im      0.131329-0.120493im     -0.00598731-0.0271726im      -0.104533+0.0741154im   -0.0747956-0.189203im     -0.0592167-0.0800179im     0.109982-0.140462im
 -0.0435534+0.0774093im     -0.0636813+0.00915522im    0.00283245-0.0802077im     -0.131472-0.0800498im     0.0373989-0.0296891im      -0.172251-0.134305im     -0.0798113+0.140358im    -0.171175+0.161558im      0.130054-0.067693im       0.249083+0.0679046im     -0.0180739+0.0540956im    -0.0668479-0.139586im     0.0283967-0.0970464im     0.355516+0.00238874im   -0.0883167-0.110121im       0.169928+0.179994im    -0.114567+0.127158im     -0.0983852+0.122312im      0.0241519-0.0526401im     0.249783-0.40302im      0.00113687-0.0303533im    -0.158612+0.0591184im    -0.0388844+0.0144937im     0.113458+0.0278147im     0.0473141-0.078288im      0.168643-0.226012im     -0.0723764-0.0382946im      0.0874919+0.103733im       0.0608459-0.127638im    -0.0280912+0.102555im      -0.107167-0.0824592im    0.0114866+0.0585115im
   -0.12362+0.0470232im       0.218249+0.15941im        -0.108023+0.0759034im     0.0655099-0.130911im     -0.0115189-0.314508im      -0.0115728-0.117078im      0.0344272-0.0649797im   -0.247225+0.0596941im    0.0149027-0.158282im      -0.121284+0.0726492im      0.0964528+0.264527im       0.226946+0.0479562im    0.0778475-0.136169im     0.0381855-0.0107991im     0.0104278+0.0790916im    -0.0281949-0.083854im     0.086376+0.0659746im    -0.0877873-0.060219im     -0.0345042-0.078223im    -0.0418089+0.0390974im      0.112558-0.423443im       0.15354+0.0125371im   -0.00266155+0.024327im     0.0711194-0.21291im       -0.185143+0.0182768im      0.14518-0.0404278im    -0.0888952-0.0373975im     -0.0172816-0.184642im      -0.0651419-0.0467354im    0.0817908+0.00541841im     0.202756+0.0124044im    0.0397223+0.107149im
  0.0324538+0.00837263im      0.093466-0.194278im       -0.228948-0.0404694im      0.170456-0.0310997im     -0.151561-0.0477771im     -0.0568408+0.0910549im      -0.14497+0.252971im   -0.0740113-0.17442im      -0.141489+0.011816im       0.124773+0.0784175im      0.0644223+0.0339266im    -0.0807831-0.0208425im    0.0536771+0.111518im     -0.087374+0.0584948im     0.0639712-0.0693962im     0.0900471+0.0477424im   0.0693067+0.201144im       0.232996-0.17204im      -0.0729831-0.142308im      0.154232-0.0226181im     0.0580694-0.105353im       0.10315-0.246096im      -0.101666+0.234882im    -0.0605914+0.0473219im      0.113924-0.26847im      -0.174409+0.0675784im     -0.192544-0.0592431im       0.049436+0.0482691im      -0.106421-0.10072im      0.0979474-0.224976im     -0.0971482+0.127462im     0.0438389-0.00547539im
  0.0940234-0.0410377im      0.0853664-0.0614741im      -0.087871-0.0201153im     -0.134484-0.00364683im   -0.0482446-0.032382im      -0.0893504-0.108533im      -0.156083-0.0542645im    0.036551-0.0522238im    0.0542756+0.125384im       0.018386-0.118036im       -0.103728+0.00996072im    0.0403812-0.235474im    -0.0783436+0.0598076im     0.138861-0.028047im      0.0935243-0.0296429im   -0.00409699-0.182969im     0.114136+0.10367im       -0.115511-0.215951im     0.00746503-0.0641282im     0.128818+0.155175im      -0.119997+0.0377919im   -0.0734621+0.22603im       0.0371883-0.332934im      0.164404+0.0852656im     -0.192722-0.109435im    -0.0335095+0.164739im     -0.0674111+0.105176im      -0.0431021+0.0105937im      -0.175032-0.106259im       0.42291+0.0563047im    -0.0699007-0.00200713im   -0.155856-0.168448im
   0.236696-0.153207im     -0.00190311+0.0443965im       -0.20002-0.0841805im     -0.221192-0.14109im        0.323936+0.00305479im   -0.00956131+0.0154757im    -0.0361266-0.0955764im    0.180334-0.0848257im    0.0192861-0.0238412im     0.0628106-0.0622425im     -0.0354854-0.0454034im      0.154389+0.150932im    -0.0289676+0.0250509im    0.0224829+0.0278295im    -0.0787826-0.115703im      -0.187112+0.0816531im    0.209206-0.00443708im     0.100392+0.217838im      0.0102334+0.189053im     0.0777781+0.0664835im     -0.212551-0.00924811im   0.0215551-0.2368im        -0.131823+0.0956255im      0.18503-0.198005im      -0.031154-0.0857666im    0.0841387-0.0805203im    -0.0863822+0.0911763im      -0.058819+0.206576im        -0.13477-0.147508im     -0.011869+0.0667631im      0.163408+0.117493im     0.0774353+0.0153493im
  0.0928591-0.0386786im     -0.0108983-0.0995521im     -0.0805331-0.0963954im      0.279128+0.151295im     -0.0517383-0.174045im        0.013801+0.0634595im     -0.182149+0.045242im    0.0235412+0.163378im     0.0856761-0.163665im       0.365398-0.158017im      -0.0022706-0.252128im        0.18806-0.0273677im     0.142991-0.270802im      0.207957+0.0544367im    -0.0517772+0.0330008im     0.0410467+0.0392801im  -0.0775976-0.118584im    -0.00091562-0.101727im     -0.0766699+0.0235211im    -0.155166+0.21015im       -0.119198+0.0654771im    0.0144439+0.0837096im      -0.14744+0.0867972im    0.0197484+0.0115825im     0.0200652+0.0191028im    0.0941858+0.197132im       0.226667-0.0272607im     -0.0178736-0.0372451im     -0.0327576-0.0374413im   -0.0392443-0.00951822im    0.0432481+0.12606im     -0.0548647+0.191076im
  0.0884653-0.276097im        -0.26211+0.165929im       -0.107956+0.054762im     -0.0855425-0.0812654im     0.0233772+0.00924302im    -0.0876633+0.0608056im     -0.148804-0.0290647im   0.0333541+0.217527im    0.00367741-0.0354319im   -0.00673277+0.114673im       0.0547708-0.0528112im     -0.107239+0.0274913im   -0.0978874-0.0061356im     -0.17767+0.0291191im     0.0870046-0.109095im      0.0333207+0.147059im    0.0428781+0.0660755im     -0.142679-0.211793im       0.152625-0.318545im     -0.140611+0.228441im      0.0505356+0.00928015im  -0.0359006-0.00901502im     0.126573+0.0615016im    -0.136008-0.111421im     -0.0644103-0.0247427im     0.140995-0.262922im      0.0811465+0.00189897im    -0.0302277-0.0572427im      0.0357869-0.273294im    -0.0905977-0.121071im      -0.115609+0.0123616im     -0.22522-0.0214586im
  0.0645672+0.274512im       0.0953607-0.208114im     -0.00512552+0.0247518im     -0.264081-0.170787im       0.182972+0.0636659im      -0.107354+0.0350964im    -0.0835514+0.0297094im  -0.0217205+0.0847295im    0.0689862-0.177802im      -0.176446-0.177315im       0.0728914+0.00444797im   0.00674999+0.0650845im     0.179884+0.0578093im   -0.0128985-0.0282088im      0.146214-0.111583im       0.219672-0.193434im    -0.095224-0.269204im      0.0375786-0.0789771im      0.123284-0.121406im       0.13688+0.127479im     -0.0356775-0.0594045im    0.0421347+0.00163948im   -0.0631854+0.0960242im     0.107151+0.00456263im   0.00018882+0.0103626im    -0.138333-0.0207743im      0.217461-0.275001im        0.160681-0.0157624im      -0.111649+0.00690722im   -0.194439+0.0259603im    0.00359568-0.00798063im  -0.0883758-0.15827im
 -0.0595482-0.0180961im     -0.0833166+0.084852im        0.109212-0.0985911im    -0.0148193-0.0549223im     0.0404978-0.104657im       -0.266976-0.141933im     -0.0684324-0.104053im     0.112478-0.142029im    -0.0929855+0.084782im       0.149939+0.0652184im       0.212166-0.10834im       -0.188399+0.0935952im    0.0685467-0.141076im     -0.159777-0.220334im        0.11017-0.125493im      0.0397633+0.0221709im   0.0864417-0.0246276im    -0.0385951+0.0178254im     0.0837577-0.02811im       0.247459+0.102413im     0.00807327+0.0229518im   -0.0542363+0.0854493im    -0.0246606+0.21688im      0.0571156+0.145581im     -0.0988522-0.107764im      -0.02763-0.0381421im     0.0893424+0.179535im       0.0319961-0.303113im        0.119493+0.282933im      0.128809+0.147515im       0.151624+0.132668im      0.146936+0.0927845im
  0.0511855-0.130472im        0.153355+0.0833988im     -0.0616289+0.241675im       0.101291+0.130024im       0.151098-0.0296671im     -0.0492938+0.00759736im     0.333246+0.23811im    -0.0330011-0.0188669im   -0.0581292+0.00065266im     0.177294+0.194422im        0.071627+0.0101756im     -0.169028+0.00817607im     0.02557+0.0867852im    0.0657123-0.195039im      0.0137759+0.0163787im     -0.132643-0.0812554im  -0.0733065-0.15189im       0.0671745-0.0487016im     0.0550522-0.158599im     0.0593143+0.18427im       -0.221019-0.069756im     0.0517747+0.111922im       0.201636-0.0377668im     0.254904+0.0783062im      0.202292+0.0709444im    0.0766966+0.0321475im     0.0450097-0.0368381im       0.145175+0.173257im        0.169265-0.162353im     0.0476921-0.0440066im      0.115451-0.0765672im     0.117207-0.0290094im
  0.0177186+0.105702im      -0.0231405+0.0565828im     -0.0756728-0.0498121im     -0.111634+0.0249283im   -0.00221716-0.197im           0.217373-0.168435im     -0.0392186-0.15828im     -0.124918+0.0731822im   -0.0979585-0.0879114im       -0.1278-0.199757im        0.222338-0.0111015im     -0.153314+0.112374im     0.0196012+0.0128129im     0.203878-0.0395695im    -0.0958507-0.0147563im    -0.0966104-0.063279im      0.07704+0.160515im       0.192427+0.126409im      -0.229409-0.102729im     0.0616984+0.19058im       0.0255157+0.200847im     -0.186955-0.185034im       0.145585-0.054196im        0.0867+0.135742im      -0.142293+0.0138734im   -0.0138113-0.0441662im       0.10534-0.0853237im      0.0135402+0.0435076im       0.208194+0.0228671im    0.0471953-0.295497im      -0.154876-0.0777118im    0.0389747+0.139859im
 0.00101345-0.0531003im      0.0287804+0.110835im        0.184378-0.239485im      0.0403705-0.0313595im     -0.132399+0.0201556im     -0.0480787+0.0350687im   -0.00213059+0.21165im      0.237772+0.0860655im    0.0540065-0.020489im     -0.0111519+0.0176445im      0.0332881+0.2318im         0.115738+0.294015im      0.108201+0.0112343im    0.0233935-0.157626im      0.0963001+0.140008im      0.0683235-0.0790522im   0.0250443+0.195293im     -0.0365986+0.00184477im     0.116309-0.178862im     0.0743832+0.0144868im    -0.0342221+0.101469im     -0.265208-0.089302im      -0.123039+0.0741077im    0.0234403-0.0737735im    -0.0199702+0.0493712im   -0.0254543+0.28809im     -0.00305182+0.110814im      -0.0920339+0.0985992im     -0.0488931-0.0675678im   -0.0839592-0.0483352im      0.151816-0.393961im    -0.0711528+0.00490506im
  -0.134475-0.147715im      -0.0547427+0.0248277im      0.0202219-0.0772013im    -0.0705233-0.142075im      0.0128708-0.158498im      -0.0229073+0.0330152im     -0.113095+0.0994246im    -0.20094+0.233185im     0.0234628-0.369764im      0.0736596+0.0836902im     -0.0450491-0.0892508im     0.0785474+0.10772im      -0.274858+0.0986081im   -0.0433018-0.0842989im     0.0856071-0.0653885im      -0.24863-0.030868im    0.0471588-0.149529im      -0.207159+0.0563679im     0.0401411+0.0184166im   -0.0416295-0.0174676im       0.16318+0.0672595im    0.0662327-0.131425im      0.0471707-0.0670929im    0.0123157+0.105167im      0.0537429-0.0910189im    -0.168075+0.278136im     -0.0338009+0.0986703im       0.160445+0.0745681im     -0.0325845+0.109934im     0.0168839+0.0855338im     -0.196739-0.00308465im    0.232591-0.128794im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.020917844398152852 + 0.2414900350186819im
    0.06339986060912478 + 0.08019489650063322im
 -0.0016155202503458671 + 0.14701242732209688im
   0.021628152222362446 + 0.057298093781385236im
  -0.026163024488349985 + 0.22653137467075712im
    -0.1393164616109479 + 0.031418180934897524im
    0.16672242682481908 - 0.04442790032226144im
   -0.09177912884943333 - 0.11516460807509225im
    0.09562513056892874 - 0.015966814320225692im
   -0.10387762652165504 + 0.024699467768717853im
    0.04438992402868793 - 0.05717007288148679im
   -0.07628872798576292 - 0.15283532482766393im
    0.14023977031733745 - 0.2374206392684455im
   0.053309319804395565 + 0.21005097682615734im
   0.014766850640417202 - 0.04985781628399777im
   0.006802182877629093 - 0.06901390525581381im
     0.3543459958474663 + 0.0im
   0.017474852952320583 - 0.03817575843099086im
  -0.046813704093406454 - 0.004614323762522511im
   -0.24646568261044696 + 0.01752103271360999im
   -0.01921604372453424 + 0.16996576500467991im
   0.056906866935706624 + 0.08897943384624979im
   -0.18008431526403412 - 0.23241164555399546im
   -0.09641699408519448 + 0.11027279448961974im
    0.10469332594753761 + 0.0013811461323411456im
    0.14367867865477266 + 0.17761339817126315im
    0.30393342505114035 + 0.09679007485054159im
    0.14757408208407213 - 0.07059863730598717im
    -0.0786504787673937 + 0.0753552005274349im
  -0.031065831200100202 + 0.058167416825701125im
    -0.1711210836530003 + 0.12118304832119413im
    0.01773975862747263 + 0.06918727861903037im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 12 January 2023 15:02">Thursday 12 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

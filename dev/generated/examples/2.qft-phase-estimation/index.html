<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.35103-0.177631im        0.260147+0.0180606im    -0.225614+0.0830973im     -0.0392828-0.0521103im    0.0145498+0.205157im       -0.202824-0.119312im   -0.00330399+0.0127814im      -0.085595-0.00146156im   0.0570534-0.183271im      -0.142376+0.201989im       0.0946122-0.00226209im  -0.0942233-0.0192315im   -0.0636729+0.0926449im    -0.0824399-0.0868233im      0.124681+0.0635237im      -0.177332+0.00461533im  -0.0412835+0.0977663im      -0.145402-0.0604665im      0.105077-0.0330048im     0.152111+0.166378im     -0.0114873+0.125607im       0.17708-0.14988im      0.0205793-0.119937im    0.00797316-0.0510887im        0.137451-0.242155im      -0.0544558+0.0115675im      0.269825-0.0347892im      -0.141569+0.0470239im   -0.0730181-0.0719504im    -0.0272611+0.0926355im  -0.0970184+0.0390848im    -0.147816-0.00976561im
 -0.0342863+0.144627im       0.0207048-0.214727im      0.154205+0.0974493im        -0.2766-0.262342im     0.0432869+0.0410056im     -0.0984262-0.0440654im     0.110048+0.143672im      -0.0182846+0.0772779im    0.0693022-0.211954im       0.055574+0.15483im        -0.163021+0.0626151im   0.00520794+0.00507389im    0.168451+0.057078im      0.0237895-0.0285717im    0.00140252+0.0501928im        0.19289+0.132081im     -0.133361+0.0262575im   -0.000105673+0.07477im      -0.0679898+0.23084im       0.119344-0.112698im     -0.0653955+0.0743748im     0.161504+0.111958im     0.0790576+0.0504221im    -0.140823+0.0849944im      -0.0538663+0.181496im       0.0360332-0.00286177im     0.140987+0.172276im       -0.106284-0.167389im      0.140151+0.251906im       -0.13271+0.0760145im  -0.0286588+0.242097im    -0.0303403-0.122226im
 0.00774953-0.178006im       0.0967979+0.0198162im     0.120012-0.225768im      -0.0668779+0.120197im     -0.154219+0.0187039im       0.170314-0.175366im     0.0136814-0.198031im        0.103656-0.00374828im    0.056709+0.0327092im      0.240748+0.00800716im  -0.000256448-0.0408487im   -0.0770526+0.070078im     -0.172242+0.167259im       0.159652+0.158153im       0.103735+0.16533im         0.127893+0.0326103im   -0.0730752+0.0714042im     -0.0302716+0.102927im       0.105797-0.31805im       0.164052-0.0488245im     0.0292167+0.167514im       0.19131+0.180299im    -0.0883121+0.0446044im   -0.0631521-0.353528im         -0.07173+0.22605im        0.0601062-0.0507418im     0.0609256-0.00152887im   -0.00798087+0.0106713im   -0.0900892-0.0345501im   -0.00927377+0.102996im    0.0281408+0.0749798im    0.0793618-0.0473456im
 -0.0695537+0.0933362im     -0.0172448+0.0453939im   -0.0394061-0.0197244im       0.365848+0.0482289im    -0.200521-0.0353055im     -0.0948214+0.42124im         0.1016-0.0850407im      -0.109859+0.07859im      0.0645865-0.140329im      0.0157722+0.0576691im    -0.00851185+0.0607553im     0.134994-0.136257im     -0.112035+0.0800541im    -0.0769435+0.178107im   -0.000457035+0.208912im       0.0824302-0.055838im    -0.0304798-0.00803545im    -0.0274194+0.180691im     -0.0666783-0.0836886im    0.0559335+0.118511im      0.0864451-0.0836349im     0.106065+0.00211548im  -0.0347339-0.306384im    -0.0693626+0.216092im        0.0297017+0.0815304im      -0.083786+0.0910926im      0.152192+0.0667424im     -0.0344922-0.117169im     -0.173665+0.100373im      0.0747902+0.0331363im    0.200286+0.0952582im    0.0765705+0.0381456im
 -0.0216849+0.0241518im      0.0519617-0.197564im    -0.0546343+0.0848226im       0.128401-0.08622im       0.243426+0.125246im       0.0168344-0.0762649im   -0.0518717-0.0765587im      -0.281681-0.0893884im   -0.0277305+0.182782im      0.0563581-0.069251im       -0.134901+0.0500722im   -0.0522823-0.00882559im   0.0074883-0.357465im    -0.00370375-0.143304im      -0.031237+0.000264963im   -0.0409399-0.162847im    -0.0755752+0.101346im      -0.0392348-0.0864885im      0.198354-0.15657im      0.0174635+0.0433461im     0.0202076-0.0535029im    0.0683815+0.340318im     -0.106748-0.042432im     0.0311297-0.0148051im       0.0505547+0.0965283im     -0.0635503-0.0248603im      0.131588-0.0913765im        0.10657-0.084626im     0.0152808+0.312756im       0.118466+0.147052im    0.0338352-0.0319368im   -0.0275075+0.27645im
  0.0704973-0.0153914im     -0.0935324-0.00108354im    0.121846+0.12869im         0.207148-0.0130612im    -0.130289+0.0895906im        0.26085-0.0415229im    0.0793792+0.201136im        -0.13676-0.11941im      0.0174072-0.14638im       0.0474497+0.0934231im      0.0211178+0.0912717im     0.141269+0.110259im    -0.0354292-0.107315im      0.0290027-0.307096im     -0.0153232+0.0775114im     -0.0367924+0.101436im    -0.0146592+0.0926904im     -0.0264399-0.0437672im    -0.0792711-0.0920019im   -0.0259212-0.301709im     -0.0814518+0.0202349im     -0.10059-0.0951022im     0.143255-0.0457599im   -0.0104837-0.290595im       -0.0446287-0.156114im       -0.109329+0.138313im     -0.0624729+0.000580561im   -0.0345873-0.238863im    0.00796208-0.100836im     -0.0368749+0.129393im     0.363503-0.0441002im   -0.0439977-0.0496313im
 -0.0525841-0.113307im       0.0598263+0.247648im     -0.035836+0.0312463im    -0.00529194+0.0851025im     0.102017+0.104215im      0.00566073-0.19253im       0.278925-0.211025im      -0.0202022-0.0627126im   0.00656632-0.142503im      0.0910456-0.0918361im      -0.140728+0.131818im     0.0399116-0.0777483im    -0.256688+0.0828423im     0.0411793+0.174281im      -0.290164-0.0663165im      -0.190068+0.0897942im     0.103392+0.0885029im       0.164554+0.00662758im     -0.13521+0.173389im     0.0233001-0.21346im       -0.193796-0.147667im     0.0233748+0.0251356im   -0.0471283+0.130779im     0.0645617+0.115845im       0.00838288-0.0950559im     -0.0313704-0.168805im       0.124075-0.0710026im       0.110121-0.151961im    -0.0729098+0.0294064im     0.0864741-0.0255125im   0.0126842+0.176206im     -0.136328+0.097608im
  -0.247105-0.053067im      -0.0446671+0.14974im      0.0316301+0.0951674im       0.187381-0.130514im    -0.0108598+0.102085im      -0.0409199-0.112936im     -0.224892-0.0880753im       0.401911-0.133979im    0.00850265-0.0162873im      0.125697+0.0842327im       0.310601-0.0677044im      -0.1101-0.0736962im   0.00519291-0.239673im      -0.109661+0.0415475im     -0.108269-0.158182im       0.0412516+0.0628im       -0.132481+0.0217536im     -0.0914103-0.10209im       0.0339189-0.0175317im    0.0399806-0.0129251im     -0.105589+0.0424935im     0.172267+0.0328359im     0.238289-0.112813im     -0.050013+0.106023im     -0.000434675-0.11205im         0.281592+0.0145157im     0.0972786+0.0115667im     -0.0047686-0.0230108im    0.0710132+0.0267649im       0.10905-0.0172059im    0.128357+0.118739im      0.110294-0.0371831im
  -0.130948+0.000698797im    0.0408745+0.10163im     -0.0813514+0.0672634im     -0.0954847+0.0893544im     0.129865-0.0775617im    -0.00257324+0.0290761im    0.0618492-0.0955456im        0.05616-0.074778im      0.162688-0.210319im     -0.0399141+0.240341im       -0.354274-0.116267im    -0.0851793-0.0248994im   -0.0149417-0.07262im        0.276708-0.0394407im      0.207538-0.00953703im     -0.123127+0.14089im       0.142309+0.00582892im    -0.0870212+0.0469421im      0.039857-0.079636im     -0.100236+0.0651794im    -0.0281238+0.0248449im    -0.150292-0.0505129im    0.0983798-0.093791im    0.00375827-0.0312166im        0.184012+0.191453im        0.289822+0.151832im      0.0348697+0.141446im      -0.0267956-0.0651166im     0.112834-0.0537747im       0.14823-0.186751im    0.0953717-0.163706im   -0.00632126+0.219018im
 0.00326115-0.0426831im     -0.0144851+0.0106196im    -0.120872-0.0373956im      0.0684725+0.021977im     0.0710335+0.0132379im    -0.00713278+0.137955im       0.16767+0.144412im       0.0856075-0.0407465im    -0.272089-0.0173466im     0.0296277-0.316466im        0.124142+0.0662219im     0.171316+0.158368im     -0.152676-0.132231im        0.25499-0.0453281im      0.107007-0.0708965im      -0.097943+0.00671506im  -0.0495462-0.0323702im      -0.056007-0.0901168im     0.0554619-0.127396im     0.0257593+0.11561im       0.0124435+0.131398im    -0.0442742-0.0622715im   -0.0531689+0.0469317im    0.0157292-0.000688536im      -0.16959+0.0235629im         0.1139+0.0901275im    0.00463284+0.136997im       -0.339587-0.246858im    -0.0111611+0.137393im      0.0691116-0.210785im    -0.218939+0.23781im      -0.114356-0.0544844im
   0.192094+0.00262021im     0.0882142-0.00137667im   -0.202849+0.0083118im     -0.0500427+0.0455893im    0.0355948-0.0249833im     -0.0374544+0.160616im       0.16057-0.0834453im      -0.070695-0.0392906im    0.0574178-0.219281im     -0.0677245+0.0327575im        0.33906-0.196119im      0.093179+0.170196im      0.146044+0.00463299im    -0.116246-0.0207731im    -0.0287754-0.100093im        0.143588+0.125615im    -0.0344352+0.0854791im       0.108653+0.117077im       0.088382-0.0053169im   -0.0902772+0.000789556im    0.131247-0.209456im      0.108819+0.268309im     0.0493487+0.197938im      0.027726-0.144037im        -0.050714+0.0520055im      0.0900664-0.094746im      0.0450675-0.12597im         0.127509-0.162439im     0.0539435+0.04508im        0.097958-0.316431im     0.108564-0.170974im    0.00719641-0.11738im
  0.0618705+0.0031552im      -0.127393-0.191131im    -0.0871326-0.055175im       -0.293182+0.0684071im   -0.0511691+0.00786685im     0.0518717+0.0130723im    -0.217007-0.134284im      -0.0305352-0.16536im       0.130572+0.0504836im      0.183404+0.0742624im       0.264965+0.0633381im     0.170578-0.147236im    -0.0136659+0.0131658im     0.0298898+0.0198265im    -0.0877699+0.210871im       0.0644158+0.152883im      0.121972-0.101626im      -0.0058787-0.0680408im     -0.232674-0.0678121im     0.060575+0.134225im      0.0491195-0.216811im     -0.113057-0.0591437im   -0.0424877-0.10363im      0.0759925-0.0843212im       0.0387064-0.159475im       0.0902381-0.150635im     -0.0795128+0.234911im      -0.0714524-0.0962955im    0.0936911+0.176981im       0.124775+0.114072im   -0.0457912-0.0170513im    -0.225403+0.145471im
 -0.0779975-0.148317im      -0.0662121+0.0594868im     0.015267-0.124172im     -0.00232589-0.0789665im    -0.135714+0.0117885im      -0.220104+0.0103261im      0.09731+0.0637418im     -0.0650465+0.0890905im   -0.0827247+0.0848698im     -0.152815+0.00373006im     0.0721047-0.0453646im    0.0230407+0.294294im      0.065023-0.0361579im      0.119825+0.12357im        0.122817+0.0195607im      0.0536563+0.123084im     -0.155226+0.11337im       0.00723472-0.27806im       -0.160402+0.0654464im  -0.00266942+0.0799289im    -0.0647594-0.129784im     0.0279365-0.0183459im    -0.236601+0.00676465im   0.0278427+0.0574019im       0.0617822+0.0048944im       0.260166-0.12888im       0.0139625-0.0428194im        0.03861-0.181711im     0.0114339-0.138972im      -0.294264+0.225374im     0.149843-0.0778845im     0.102333+0.308795im
  0.0718391-0.219476im       -0.155281-0.125873im     -0.099582-0.0348244im      0.0149569-0.164269im     0.0919427+0.14118im       -0.0111753+0.158848im      0.135323-0.0458499im     -0.0231292-0.0535128im    0.0591931+0.198527im      0.0724188+0.156048im       -0.014067+0.019004im     -0.175091+0.152693im      -0.14793+0.083067im        0.14709-0.327087im     -0.0244168-0.0269731im       0.155155-0.0263122im     0.128525-0.317224im        0.116836-0.0994798im   -0.00689182+0.0954568im   -0.0788665+0.015072im      -0.179215-0.0715132im     0.287017+0.0019915im   -0.0662519-0.157733im     0.0137525+0.089047im        -0.132726+0.109093im    -0.000773093-0.0256736im    -0.0554136+0.103927im         0.10606+0.0826533im   -0.0866735-0.21882im        0.154345-0.0810453im   0.0634595+0.075363im    -0.0367026-0.0894922im
   0.214596-0.11124im        0.0318588+0.102816im      0.339143+0.04141im       -0.0339471+0.00485495im   0.0390382-0.0456611im      0.0175935+0.0909106im    -0.184135-0.17572im        -0.266572-0.181404im     0.0521132+0.113829im     -0.0642052-0.106468im       -0.114144-0.0675283im       0.1648-0.116767im    0.00991287+0.0346389im     0.0183094+0.0691236im      0.242951-0.26778im         0.128715+0.0720883im   -0.0945449+0.176347im       0.0925521-0.0535177im     0.0210554+0.217596im    -0.0401552+0.0229066im     0.0942769+0.102101im      0.141029-0.00235517im  -0.0457276-0.0605835im     0.015648-0.0451143im        0.103395-0.191965im        0.114164+0.128034im       -0.17476+0.124951im       0.0758089-0.0776485im    -0.102828-0.0158405im      0.167729-0.0523771im   0.0178747+0.227376im     0.0638577-0.0372188im
  -0.269417+0.134855im      -0.0617219+0.0907728im    0.0933821+0.142861im       0.0572665+0.0498655im    0.0842759+0.056694im       0.0478715-0.252749im     0.0131294+0.0896681im       -0.21214+0.039432im      0.132488+0.0187779im     -0.105463-0.0351081im       0.180366+0.0815309im     0.160011+0.11136im       0.108096-0.0479415im      0.121461+0.107228im       0.104718-0.0757709im       0.243647+0.0722483im     0.305435-0.071599im       0.0160618+0.19854im       0.0747541-0.0481574im    0.0297344+0.06038im      -0.0208384-0.12937im       0.193071-0.0770891im    0.0431263-0.0720192im     0.336787-0.0358468im      -0.0177718+0.0344561im      0.0625115+0.170564im       0.197392-0.0866371im     -0.0343583+0.0743053im    -0.125365-0.0932986im    -0.0638969+0.0884488im   -0.167065+0.0159467im    -0.127699-0.0300422im
 -0.0418918+0.141235im      -0.0640223+0.184386im     0.0135937-0.117525im       0.0344284+0.0804311im    0.0126954+0.00750945im      0.142297+0.0346146im     0.054691-0.0857759im     -0.0660209+0.0803232im   -0.0170937-0.147524im    -0.00254396+0.00710015im   -0.00880204-0.23394im     -0.0432934+0.194675im      0.189176-0.119211im      -0.166211-0.0387296im     0.0427309+0.0180488im      -0.252331+0.260402im      0.374765-0.0700182im       0.124054-0.296477im     -0.0106847-0.021176im   -0.00135432-0.00312912im    0.0951139+0.177973im      0.133535+0.042482im     -0.147674-0.173454im     -0.032558-0.0327499im     -0.00970137-0.0172453im      -0.106879-0.149324im    -0.00469909+0.110846im      -0.0161522+0.159027im     0.0502659+0.219705im      -0.023945+0.0879679im  0.00925651+0.163993im      0.117393-0.10412im
   0.112821+0.0858054im     -0.0241049+0.148071im      0.153688+0.165958im        0.159143-0.0227903im     0.247904+0.161798im       0.0889686-0.0377787im    0.0436824+0.111418im        0.133026+0.0215142im    0.0955888-0.0460072im     0.0280442+0.122556im     -0.00254684+0.170377im     0.0819635+0.112323im      0.262011+0.153714im      0.0988958+0.0983972im     -0.265386+0.14152im         0.162139-0.086665im     0.0177823+0.21598im       -0.0801224-0.188755im    -0.00022627-0.0777752im    0.0262425+0.199308im      0.0998591-0.0561571im   -0.0352477+0.0583818im    -0.200994-0.0193073im    -0.201695-0.0378643im       0.0784344+0.0425839im     -0.0492234-0.0604528im     -0.165164-0.0386457im       -0.11765+0.110364im     0.0791439-0.200897im       0.160251-0.166082im   -0.0283292+0.137263im    -0.0331243+0.117935im
 -0.0830507+0.0455125im     -0.0528089+0.224745im     -0.161839+0.137891im       -0.115696-0.0881531im    -0.109089-0.192887im       0.0526018-0.137379im      0.142234+0.173024im       -0.100781+0.0172811im    -0.197141+0.17913im        0.197642+0.188031im       -0.094804-0.117006im     0.0327402-0.0221456im     0.068417+0.217867im       0.133819-0.016331im      0.0300126+0.16247im       -0.0414393-0.119828im     -0.114721-0.0759177im     0.00321421-0.0199924im      0.162483-0.0799302im    -0.264994-0.0588172im      0.230402-0.192238im      0.178959-0.00112139im    0.101696+0.052373im    -0.0155809+0.0134848im      0.00368428-0.337283im       0.0886113-0.0223763im     0.0396325+0.0133072im     -0.0295118+0.0383908im    -0.034104+0.146006im      0.0850186+0.0127682im  0.00148207+0.116073im       0.15108+0.0540496im
   0.127584+0.0218858im     -0.0857972-0.143099im     -0.117916+0.0851297im       0.149566+0.133114im     -0.060276+0.15904im        -0.186526+0.0105377im       0.1766+0.000995039im     -0.16944+0.0995777im    0.0968529+0.0774975im      0.212418-0.0927536im     -0.0663046-0.0745288im    0.0104075-0.137408im     0.0229725+0.021773im    -0.00250764+0.0542614im     -0.164981+0.132187im        0.182129+0.0210385im    0.0597309+0.0816384im      -0.112098-0.287299im     -0.0701038-0.0949708im    0.0703037-0.23088im      -0.0225997+0.232153im    -0.0386417-0.0201375im    0.0311418+0.115995im      0.228531+0.0681825im        0.134698-0.0498024im       0.328506+0.147123im     -0.0321713+0.0622708im      0.0723649+0.168861im   -0.00364105+0.0899571im    -0.0960085-0.150113im   -0.0592224-0.0985494im     0.092127-0.157078im
   0.115897-0.0740444im       0.125492+0.0941656im     0.191377+0.230147im       -0.136676+0.0119314im    -0.185806+0.0239324im    -0.00863896+0.0757068im    -0.110439+0.0902735im       0.131315-0.113037im    -0.0771233-0.107336im     -0.0391481-0.079962im       0.0170941+0.064092im    0.00646455+0.0809988im    -0.204136+0.0794024im     -0.068608-0.119147im     -0.0312416+0.0474911im       0.045587-0.18764im       0.250444+0.0295942im      0.0377879-0.337255im     -0.0428423+0.109317im     0.0700929-0.020241im       0.244283-0.193158im    -0.0220579-0.0787114im     0.149297+0.0416834im    0.0221856-0.0395291im        -0.10755+0.309077im       0.0529909+0.130323im       0.204128-0.01952im          0.11474+0.0137481im   -0.0860779+0.137013im      0.0691607+0.0566885im   -0.111604-0.0719168im     0.191355+0.121041im
  -0.149133+0.13271im       -0.0144304-0.0764137im    -0.205507+0.027298im        0.128033+0.00253184im    0.140882-0.0586156im     0.00335392-0.135322im      0.188816-0.137229im     -0.00876165-0.116334im    -0.0731625-0.0608443im    -0.0523729-0.00272165im     0.0682609+0.05226im       -0.23467-0.0958401im    -0.170634+0.0150276im     -0.183379-0.0588726im      0.176398+0.0858553im        0.21582+0.0147251im    0.0288495+0.220158im       0.0652678-0.0387932im      0.280893+0.084197im      0.141985+0.00230323im    0.0447437-0.256899im     -0.111964-0.293924im     -0.137148-0.0296367im    -0.104833-0.12686im         0.0129412+0.0166498im      0.0316947+0.00888671im    -0.221138+0.174831im        0.103217-0.0851091im    0.0935133-0.00572759im   -0.0943267+0.0721696im  -0.0840467+0.118437im       0.13913-0.112733im
  0.0608008+0.225828im     -0.00717436+0.106166im     -0.165567-0.226225im      -0.0220494-0.117191im      0.115386-0.0406941im       0.156165+0.0685494im     -0.10164-0.118361im       -0.273789+0.201989im     -0.040249+0.149421im       0.173659+0.0481522im       0.028055+0.0742962im   -0.0331959+0.116643im     0.0189571-0.037618im      0.0497107+0.0752466im     0.0752338+0.026119im      -0.0696284+0.0763877im   -0.0850277+0.0854192im     -0.0813574-0.1447im       -0.0700129+0.151847im      0.294463-0.100917im      0.0675129-0.0614363im   -0.0886118-0.0649472im     0.436873-0.124925im     -0.142325-0.00695745im      -0.117187+0.102032im       0.0734224-0.0189742im     0.0410596-0.181466im       0.0539712-0.0038029im   -0.0863673-0.173053im      0.0446926-0.104857im   -0.0961262+0.0539859im   -0.0716789+0.0583837im
  0.0724885-0.115809im      -0.0760794+0.194415im      -0.21096-0.191627im       0.0204318-0.170272im    -0.0462272-0.0643089im     -0.0579058-0.0796028im    0.0507898+0.0683812im      0.0526456-0.115399im     -0.211935+0.00920325im    0.0267536+0.0381372im      -0.107842+0.062983im      0.113086-0.0898766im     0.207562+0.213775im      -0.159685-0.0533477im      0.015055-0.164192im         0.17242-0.13412im        0.20455+0.097292im      -0.0824271+0.0866926im     -0.130493-0.113315im      0.134032+0.102884im      -0.119276+0.212139im    -0.0132155+0.0346795im    0.0961351-0.164465im      0.262666-0.0677006im      -0.0933482+0.060915im       -0.105661+0.0224365im    -0.0655502-0.00661436im      0.221506-0.17336im        0.26432+0.065528im      0.0137745-0.0225066im  -0.0199122+0.0562197im    0.0627513+0.166531im
  -0.169731-0.0732488im        0.39968+0.124635im      0.043801-0.140857im       -0.108389-0.033992im      0.111753+0.014585im        0.129278+0.246063im     0.0674832+0.0713438im       0.030508+0.132378im      0.143316+0.129095im      0.0951554-0.0672564im       0.102646-0.139662im    -0.0852416+0.0722557im    -0.100764-0.0255128im    -0.0302832-0.136509im      -0.022435+0.0541071im       0.275366+0.00087473im   0.0275064+0.0837833im       0.154593-0.03983im       -0.125321-0.134224im     -0.149414-0.0199248im    -0.0689796+0.0188426im    -0.174732+0.0436962im    0.0445139-0.0155275im   -0.0647054+0.0507517im        0.248337-0.206231im       -0.137473+0.214218im       0.179244+0.0136289im      0.0892077-0.0446003im     0.190953-0.0335617im    -0.0665853+0.0489292im   -0.152817+0.131036im    -0.0373207+0.0327059im
    0.04365+0.0450664im      0.0646535+0.0564232im     0.102216+0.0167513im         0.1682+0.114596im      0.032873-0.0969458im     -0.0829977+0.020275im     0.0865775+0.0665776im       0.196138+0.0756656im   -0.0114415+0.276677im      0.0990175-0.127666im       -0.102834-0.086927im       -0.0838+0.278405im    -0.0167493+0.134071im      -0.069988-0.039448im     -0.0582798+0.0117038im    -0.00391902-0.0166429im     0.130762-0.0350615im    0.000273692+0.166961im       0.075262+0.308646im      0.354421+0.0882813im    -0.0184406-0.0423846im     0.121506+0.0447396im    0.0782076-0.00714115im  -0.0502009-0.150555im         0.155657-0.174046im       0.0742341+0.0795043im    -0.0572168+0.12446im         -0.10358-0.0287249im     0.042153+0.220275im      0.0298649+0.0223476im    0.156789-0.25495im      -0.234344+0.070767im
   0.144954-0.0430434im     -0.0125524+0.0760797im    -0.110437-0.0309147im        0.12169-0.0895889im     0.127501-0.100782im    -0.000630513+0.134303im    -0.0226779+0.292291im       0.0826385-0.192762im      0.258419+0.117014im        0.23162-0.033095im       -0.105749+0.10049im     -0.0508043-0.226177im     0.0158165-0.00406825im    -0.211551+0.118561im       0.223135-0.0168486im      0.0429132+0.162527im      0.197274-0.0985551im         0.1357-0.0994891im     0.0784234-0.0227819im    -0.112792+0.0955954im    -0.0460281-0.0123891im  -0.00825159-0.00766741im    0.056944+0.245457im    -0.0466446-0.0403052im       0.0347653+0.121076im       0.0882138-0.121088im     0.00978163-0.276317im       -0.205009-0.0831582im    -0.134545+0.0128227im     -0.146237+0.107383im     0.102047+0.0922104im   -0.0629286+0.0158528im
  0.0484839+0.133599im      -0.0681908-0.129848im      0.152118+0.15533im        0.0303118+0.0597632im   -0.0313569-0.00265323im      0.145384-0.0673253im     0.208059+0.0329199im      0.0256358+0.0408119im    0.0300906+0.147759im      0.0427962+0.00451904im      0.245186-0.125745im    -0.0284708-0.247375im    -0.0109039+0.133156im       0.204956-0.0302271im     0.0222876-0.133136im      -0.0658467+0.0950065im     0.130139-0.0690951im     -0.0451004-0.0487013im      0.121684-0.0153909im     0.072232+0.120791im       0.167806+0.29084im      0.0361073-0.111932im    -0.0168059+0.0267185im    -0.230819+0.213803im        0.0201412-0.00356151im    -0.0757468-0.118196im       0.127759-0.0526875im       0.308732-0.338533im     0.0505427-0.0788604im     -0.045852+0.0126672im  -0.0268471-0.134487im     -0.033078+0.103372im
   0.089083-0.0832092im       0.237215-0.0765484im    0.0098347-0.000384085im      0.33843+0.073316im      0.175894-0.35426im        0.0484804-0.0219469im   -0.0158287+0.0330437im     -0.0832448-0.00117381im   0.0479581-0.0613807im       0.26071+0.0889879im       0.147338-0.078461im     0.0296831+0.00407066im   0.0686333+0.124808im      0.0680645-0.0249085im    -0.0905884-0.15106im        -0.190527-0.0444083im    -0.147124+0.0779468im     -0.0259942-0.0143758im     -0.122447+0.119386im      -0.15447-0.0502532im     0.0312612-0.0512464im    0.0791072-0.0814636im   -0.0442419-0.0176929im     0.186669+0.0365279im      -0.0713617+0.256864im       0.0537169-0.0230406im     0.0315376+0.188859im      -0.0586352+0.0456462im     0.204031-0.0799307im     0.0468105+0.307323im    -0.145832-0.0623602im   -0.0183547-0.062418im
  0.0435469-0.0592803im      0.0836312-0.196217im     0.0809376+0.0175885im      0.0761414+0.076563im      0.149135-0.0926644im      0.0836283-0.152907im      0.144759+0.109171im        0.151754+0.0673444im   -0.0650172+0.212108im      -0.218683+0.141901im      -0.0224963+0.0542295im   -0.0622959+0.0382348im    0.0491345-0.102415im      -0.123663+0.192007im       0.174056+0.0800161im       0.124234+0.00144714im  -0.0941109+0.0230661im       0.182036-0.0871583im     -0.221483-0.0690791im   -0.0214274-0.108336im      0.0269405+0.0711339im   -0.0489943-0.125162im      0.150034-0.092094im      0.199187-0.0401034im       0.0777612+0.0108678im      -0.131194-0.314867im       0.183655+0.181667im      -0.0593039-0.0807142im    -0.195908+0.061377im       0.236784-0.198801im    0.0356368-0.0550311im     0.110219-0.00615045im
  0.0386489+0.19507im       -0.0878539-0.140817im    0.00483375-0.0877504im      -0.116587-0.0717871im     0.291913+0.137993im      -0.0561442+0.143648im     0.0520958+0.0294078im        0.17266+0.0121167im   -0.0862236-0.0623435im     0.0827529-0.234176im       -0.048308-0.0441088im    0.0149262-0.157017im     0.0536417+0.187279im      0.0208333+0.111709im     -0.0803991-0.258687im         -0.1126+0.122512im    -0.0655627-0.0177376im     -0.0720827-0.110291im      0.0272843-0.151104im     -0.039937-0.0408395im    -0.0136968-0.232592im      0.134805+0.0310519im    0.0850025-0.101931im     0.0565316-0.254497im         0.043258-0.0773918im      -0.163761+0.151281im       0.156594+0.247992im       0.0153152+0.0431035im    -0.170143-0.145284im      -0.163166+0.0444193im   0.0838166-0.0884528im      0.16921+0.123006im
  0.0686169-0.237518im       -0.128516-0.00736283im  -0.0525152+0.0424425im     0.00158925-0.0738393im      0.26716+0.0653669im     -0.0535701-0.149621im    -0.0718593+0.0101906im     -0.0409019+0.0773171im    0.0471214-0.0329618im     0.0484185-0.110664im      -0.0381141-0.0612782im     0.274699+0.0829353im   -0.0869679+0.0388777im      0.148441+0.0478753im    -0.0772772+0.120563im      -0.0500616-0.00851797im  -0.0268299-0.0914599im       0.330535+0.0772592im      0.117648+0.0357524im     0.124402+0.279168im      0.0785723+0.0348214im    -0.294216+0.0285265im     0.171384-0.106533im    -0.0144677+0.0544128im       0.0352751-0.0173346im      0.0333322-0.0234843im      0.115237-0.00454844im     0.0479742+0.0144422im     0.131119-0.00211661im   -0.0543496+0.131222im      0.18308-0.0199559im     0.316076-0.273568im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.05688173356271274 - 0.0775886894293029im
   -0.12813370580971994 + 0.093729904178324im
     0.1645338172904531 - 0.06391079251011085im
     0.0771285047031939 - 0.07286845866917062im
    0.13931872526875252 + 0.1654533219301381im
    0.04683507036295837 + 0.09458000253174502im
   -0.14353246118939159 - 0.1597445954136945im
   0.051445626403976756 + 0.003109368765867585im
 -0.0005532340063517551 + 0.0964533626869619im
    0.11916661522975448 - 0.24561402287118872im
   -0.15646058743100766 - 0.1358920515161437im
   -0.09998686783954841 + 0.04196630736764207im
     0.3527867007172878 + 0.0im
   -0.06860325450443461 - 0.03668710621260799im
  -0.060109150074433654 - 0.27080204405018177im
   0.042018167757750614 + 0.12245300689081436im
   0.022972173131723533 + 0.013623122916605442im
   -0.06196404472544687 + 0.3451559888705033im
   0.018204310310188796 + 0.06836650451424026im
   -0.06486680462544137 + 0.054469906289269315im
 -0.0030192235936115346 + 0.11585303782193236im
   0.002044538353225549 - 0.15599195269770894im
    0.08233750066229883 + 0.13528803187493812im
    0.10488396132236806 + 0.05412189376812745im
    -0.1494052071375831 - 0.10511264631632344im
  -0.032698090430112146 - 0.07042844812690316im
     0.1361454780373295 + 0.13236615653662878im
  0.0006001660308893657 - 0.11033644248158592im
    0.04463938706472252 + 0.10507606363527777im
   -0.14566638050727124 + 0.08697283899472116im
 -0.0004443380037258959 + 0.06441236171559145im
   -0.26393205419796273 - 0.1943452284612937im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 14 August 2023 17:00">Monday 14 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

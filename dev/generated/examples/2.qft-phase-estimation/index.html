<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0451501-0.166522im         -0.1767+0.166033im     -0.0159756-0.0448229im     -0.191434-0.0618703im    0.0280586-0.0304317im      0.211211-0.0157492im      0.154936+0.0746917im    -0.0650419+0.188926im      -0.217088+0.323875im      0.0810196-0.050667im       0.295752+0.0654556im      0.053325-0.0565715im    0.0635584-0.0834982im      0.164438+0.0815223im     0.0637034-0.207993im      0.0812687-0.0337251im      -0.111417+0.144814im         0.12472-0.0613245im    -0.063209+0.0629302im     0.143162-0.095382im    -0.0877172-0.0532708im     0.0131211-0.046203im        0.18685+0.100358im       -0.0911455+0.102993im      0.0290588+0.255295im     0.0341984-0.0321494im   0.0178807-0.00453186im     -0.138087-0.153947im     -0.0484945+0.00618004im   -0.105858+0.205349im        -0.169752-0.0977291im      0.109631+0.0971861im
    0.116721+0.22225im       -0.0512072-0.232774im       0.166852+0.057766im      -0.158596+0.154991im     -0.078439-0.138584im      0.0136101-0.0244977im      0.113225+0.203734im    -0.00579328-0.038987im       0.210574-0.129819im      -0.173592+0.0831685im     -0.107031+0.0644816im      0.132777-0.049955im     0.0303825+0.0179977im     0.0175372+0.132155im     -0.0795194-0.0173968im    -0.0949372+0.000356523im   -0.0916833+0.128862im      -0.0545409-0.0954669im   0.00214817-0.0709183im   -0.0313947-0.0497634im    0.0303755+0.00533595im    -0.217956+0.0590146im    -0.0975154-0.0389388im      -0.0784676+0.186645im      -0.283387+0.213035im      0.229395-0.105321im    -0.107328+0.0973505im       0.015585+0.0935521im     0.0536371+0.0637211im     0.179348+0.283437im        -0.148645+0.0952621im     0.0668378+0.158516im
  -0.0614959+0.105005im       0.0598258-0.0387103im      0.263453-0.078025im       0.157921-0.107738im      -0.07892-0.0323392im     0.0754086+0.111587im      0.0788816+0.0395388im    -0.0583643-0.0848146im    -0.0137012-0.189616im      0.0205975-0.088033im      0.0398936-0.142028im    -0.00533577-0.173255im      0.175403+0.0199958im      0.217742-0.0164515im     -0.030253-0.0595153im     -0.113142+0.283246im      -0.0438205+0.0656105im   -0.000289667-0.0936292im     0.174252+0.15657im      -0.226503-0.103441im    -0.0068489-0.0324951im      0.089844-0.0214449im     -0.170126+0.0426714im       -0.202953-0.00396783im    0.0502041-0.0244188im    0.0425821-0.0214625im    0.187187-0.115173im       -0.415277-0.165221im      0.0330877+0.051457im     -0.137868-0.0306481im       -0.053879+0.0832345im     -0.169644-0.150304im
   0.0518136+0.0862778im        0.14921+0.0236389im    -0.0299347+0.00151643im   -0.0193309-0.207774im     -0.188049-0.0319635im    -0.0153532+0.108662im     -0.0672321-0.0273849im      0.287402-0.081307im       -0.18801+0.113297im      0.0788745+0.110243im      0.0312066-0.0839328im       0.03247+0.0375743im     0.194039-0.0472542im    -0.0607704-0.0304081im      0.275892+0.0712626im     -0.141895+0.127084im       0.0639535-0.0532499im       0.103725+0.136955im      0.106394-0.0140043im   -0.0821449-0.0294646im     0.115979+0.181102im     -0.0164846+0.00214224im   -0.0339364-0.0256764im       0.0282892+0.207261im       0.249362-0.0306377im     0.246097+0.100512im    -0.239701+0.32221im       -0.0268475-0.0747119im     0.0347032-0.248396im     0.0953558+0.101786im       -0.0219286+0.0103279im     0.0665774+0.0653078im
    0.216183+0.179144im       0.0435263-0.14725im       -0.154493+0.0846868im   -0.00171648-0.00962835im     0.01243-0.070008im      -0.331987+0.10202im        0.321285+0.11312im      -0.0550207+0.0965117im     0.0737076+0.123705im    -0.00475236-0.139666im      0.0362422+0.02749im       -0.170964-0.00312671im   -0.118472-0.100426im       0.137629-0.100489im     -0.0159642+0.0429721im      0.114248-0.00609847im     -0.201848+0.172345im      -0.0806003-0.0768797im     0.217341+0.00962771im   0.0578296-0.0254105im    -0.100987+0.0829939im     0.0911983+0.0276316im     0.0979392+0.0284339im      -0.0881597+4.19745e-5im    0.0851515+0.0267783im     0.195574+0.0978379im   -0.115195+0.114959im       0.0959856-0.0584589im     -0.210189+0.0166814im    0.0631112-0.291318im        0.0525306-0.113852im      -0.182055-0.130016im
  -0.0277495+0.156978im       -0.147979-0.106655im      -0.047373+0.0686689im     -0.175973-0.0993512im    0.0909667+0.122706im      0.0519398-0.113709im       -0.04473-0.0270222im    -0.0390721+0.138397im       0.172627+0.0789529im      0.100769-0.0282524im      0.131578+0.142105im      -0.194806-0.243435im     0.0877672+0.237876im     -0.0468381+0.237794im      0.0839129-0.0369625im    -0.0296787-0.0878095im       0.208221+0.115571im        0.256939+0.0743595im     0.129198-0.00423836im   -0.170138-0.0262262im     0.212671+0.188497im       0.303885+0.0056646im     -0.118753+0.0432135im       -0.108517+0.0886205im   -0.00900762-0.0474616im    -0.120412-0.0417107im   -0.051385-0.0797387im       0.128264+0.151519im      0.0687581+0.0402464im    0.0787957-0.130293im        -0.161595+0.0124353im    -0.0466716-0.0334064im
   -0.119333+0.00574266im    -0.0111577+0.063939im      -0.019554-0.102133im     0.00831317+0.263263im     0.0881909-0.169416im     -0.0247711+0.0203188im     0.0248655-0.216893im     -0.0962429+0.0312495im     0.0778049-0.156267im      -0.137073+0.0916643im      0.262396-0.0123029im    -0.0223422+0.083206im     0.0580299-0.0401408im    -0.0837989+0.201474im      0.0305313+0.0204395im       0.21975+0.161556im       -0.236117-0.0488002im       0.169068+0.0839642im    0.0839291+0.0455049im    -0.157015+0.0437231im    0.0139361-0.0395829im       0.07261+0.18953im       -0.083309-0.306366im         0.101671+0.199329im     0.00595458+0.035007im     0.0336545+0.0327872im  -0.0124288+0.0514973im     -0.0245853+0.188832im       -0.17391-0.121503im     -0.230432+0.0558222im       0.0902003-0.243679im      0.0528895-0.0784259im
 -0.00410071+0.0502125im      0.0119084-0.0102844im      0.183254-0.198674im     -0.0975864-0.0880341im    0.0522861-0.144253im       0.143753+0.0578769im     0.0233931-0.300217im       0.231124-0.0669543im     0.0301759+0.103731im       -0.20597+0.070884im     -0.0409252+0.206294im       0.280533-0.182227im     -0.109794+0.115078im       0.300644-0.122801im     -0.0741693-0.041411im      0.0173637-0.154119im      -0.0771373-0.15834im        0.0105663-0.152961im   -0.00328597-0.149186im       0.13418+0.120876im      0.082375+0.0260563im      0.214921+0.174951im     -0.0440695+0.0661214im      -0.0513455+0.0311211im    -0.0732422-0.10176im     -0.0083885+0.166319im    -0.129705-0.0366694im    -0.00830513-0.0513747im     -0.156714-0.053863im     0.0084969-0.0987081im       0.0728573+0.0922803im     0.0871297-0.0827331im
   0.0461143+0.0639504im      0.0434689+0.0615195im     0.0695135-0.0268023im     -0.140058+0.0422357im   -0.0898445+0.288515im    -0.00201515-0.0890205im     -0.208201-0.227062im      0.0417836+0.141423im      -0.067705+0.0955103im     -0.268303+0.124102im     -0.0992115+0.0408062im     -0.147449+0.209288im     0.0581134+0.0544188im      0.162288+0.230384im     0.00329289+0.0761293im    -0.0148124+0.138246im      -0.0431485+0.0672348im     -0.0185045-0.106478im     0.0591512+0.173052im      0.143681-0.121557im      0.146384+0.106334im     -0.0995849+0.015099im    -0.00526678+0.000508988im     0.0381572-0.34711im      -0.0576079+0.184725im    -0.0763678-0.0349432im  -0.0797438+0.176018im       -0.207628+0.0410949im     -0.119248+0.0731045im    0.0642016-0.0704748im       0.0848436-0.0375111im     -0.185843+0.0775992im
  -0.0571034+0.00985948im  -0.000606347+0.0705813im    -0.0868214-0.227881im      0.0818373+0.114754im      0.118066-0.136161im      -0.102716-0.0412568im    -0.0662272-0.166348im      0.0534249+0.1414im       -0.0138644+0.0205776im      0.130538-0.246539im      -0.200421+0.113773im      0.0413619-0.103204im     0.0700381+0.0203408im     -0.244403+0.0260415im   -0.00161566-0.162128im      -0.143614+0.00253183im     0.0204968+0.143992im      -0.0574048-0.0243464im     0.184985-0.147077im      0.204568+0.221314im      0.270416-0.00648942im   -0.0823029-0.0701511im     -0.064239-0.125026im        -0.185823-0.142393im       0.119796+0.257949im      0.206559-0.0883176im    0.198332-0.0606362im      0.0171633-0.0473336im    -0.0422952-0.178157im     -0.016521+0.0765511im       0.0524117+0.030387im     -0.0539104-0.0428867im
   -0.107179+0.136767im     -0.00919943-0.105091im      0.0923776-0.21303im       -0.134457+0.0791801im    -0.179847+0.0324113im   0.000290793+0.188961im     -0.0423192-0.00649224im    0.0754967+0.23296im        0.157384-0.196665im       0.285298+0.0906353im     0.0355467-0.0363672im     -0.131748-0.13129im      -0.179832+0.0594257im      0.066733+0.108991im      -0.106047-0.12557im       0.0755258-0.0191034im      -0.155591-0.0844331im       -0.02521+0.16036im     0.00916528-0.0315369im     0.269548+0.0582907im   -0.0748035+0.026673im        -0.2064-0.0344347im     0.0952224+0.0467361im      -0.0466072+0.0848308im      0.133601-0.184362im     -0.240802+0.166457im     0.131868+0.228005im      -0.0585629-0.0292141im       0.11972-0.0831363im    0.0259019+0.0259284im      -0.0840806-0.0390332im     -0.111999+0.116347im
 -0.00848843+0.0139943im       0.167958-0.00289501im    -0.129732+0.100967im       0.117449-0.0775805im    0.0754219-0.0252991im      0.303402+0.0106774im     0.0157597+0.0448109im    -0.0947147-0.136192im      0.0489077-0.0992433im    -0.0880895+0.0211069im      0.136952-0.137105im     -0.0124473+0.00692562im   0.0393447+0.0235831im      0.144083+0.0932451im      0.196944-0.0428986im    -0.0459592-0.310484im       -0.105884+0.115361im       0.0100782-0.0178019im    0.0266811-0.0666718im   -0.0102111+0.0585241im    0.0655833+0.251009im      -0.262624-0.0603047im     0.0879052+0.050573im         -0.18999+0.149375im      0.0253402+0.106848im      -0.20946-0.0861395im    0.115455+0.0622377im      0.0654663+0.038472im     -0.0935666-0.0432968im    0.0219332+0.000603264im       0.44803+0.115082im     -0.0771243-0.0889734im
  -0.0984746-0.0290464im      -0.150041+0.203138im      0.0773632+0.199657im       -0.16456+0.0329071im     0.139686-0.109015im      0.0358745+0.0424096im    -0.0318208+0.103151im       0.271345+0.195186im     -0.0864027+0.0209656im     0.0299754+0.157222im      -0.070695-0.0290781im     -0.233886+0.139865im    -0.0403283-0.112855im      -0.142683-0.179684im      0.0753389+0.0508489im     -0.115442-0.0212817im        -0.1514-0.119178im       -0.138771+0.0910401im    0.0699348+0.0141188im    0.0186368+0.00178425im  -0.0600589+0.0133837im      0.196121+0.137106im      -0.207921+0.0852513im       -0.130362+0.154729im      -0.216489-0.0136098im   -0.0964568-0.148566im     0.217931-0.00145763im    -0.0735479-0.0430825im     -0.169017-0.0299462im     0.242502+0.0960753im       0.0509595-0.00483194im    -0.135847-0.129504im
  -0.0822707-0.0971975im     -0.0300416+0.026204im       0.192411+0.0244662im   -0.00703698-0.0354716im   -0.0271818-0.151795im    -0.00838456-0.138625im       0.204103-0.110997im      0.0255548-0.160738im      -0.152121-0.0360633im      0.232292+0.168755im       0.202766-0.122225im     -0.0482204+0.0231063im   -0.0422722+0.0196979im     0.0701559+0.0690827im     0.0963651+0.155309im     -0.0303296+0.023231im        0.111653+0.156579im        0.123999+0.0344057im     0.126833-0.0285539im      0.26584-0.0135759im    0.0629648-0.287312im      -0.115457+0.0218822im      0.140362-0.152696im        -0.211876-0.185836im      -0.165534-0.267632im      0.114425-0.145352im    -0.143016-0.0430064im      0.0620506+0.207721im     -0.0221707-0.00740289im    0.116131-0.0287335im    -0.000219803+0.0909721im     -0.122901-0.0484656im
   -0.100861+0.0128533im       0.253271-0.0467592im    -0.0887126+0.0339899im     -0.349296+0.231967im      -0.13768+0.146968im     -0.0842389+0.140259im       0.126684+0.01457im        0.175366+0.00315315im    -0.138267+0.0454784im     -0.147734+0.0703353im    -0.0851457-0.0219381im    -0.0315162-0.312842im    -0.0175591-0.122404im       0.126124+0.0322612im      0.222981+0.246702im    -0.00348655-0.0358141im       0.129616+0.0052699im       0.138429+0.10292im      -0.115057-0.0080884im   -0.0703356+0.128837im    -0.0376765-0.141879im     -0.0413878-0.00179165im    0.0283071-0.0832013im      0.00912026-0.0107862im   -0.00732298+0.141985im     0.0657682+0.0897459im     0.25785-0.201595im        0.125352-0.0581691im      0.059973+0.0971983im    -0.138315+0.0296771im       0.0376164+0.0251248im     -0.128217-0.0498974im
    0.150672-0.107975im       -0.163962-0.0582348im   -0.00985649+0.0817383im     -0.113644+0.0460357im     -0.13308-0.115373im      0.0908791-0.034764im      -0.255555-0.0416412im      0.021604-0.17956im       -0.107099+0.0461132im    -0.0023915+0.0631858im        -0.148-0.119671im     -0.0824601-0.0299888im    -0.205153-0.0758046im     -0.011314+0.0297522im     -0.244174-0.00622863im     0.193888-0.162783im       -0.147377+0.0210984im       0.138656+0.122603im      0.141867-0.11659im      -0.304561-0.0851682im     0.115158-0.126539im      -0.107215-0.0287047im     0.0509658-0.123866im        -0.163158-0.0587801im     0.0254824+0.155208im    -0.0831059+0.0222431im   -0.152365-0.0978587im      -0.037642-0.274891im        0.14609-0.199462im      0.091423-0.110693im       -0.0639359-0.0725447im    -0.0633462-0.149731im
  -0.0313298+0.229793im       -0.283176-0.00455437im    -0.139369-0.137328im       0.116288-0.00995786im    0.223803-0.00203139im    0.0200084+0.0484417im       0.19851+0.0210525im    -0.0764008+0.00733101im   -0.0333677+0.0128992im    -0.0890533+0.159771im      -0.159681-0.246417im        0.13291-0.103572im     0.0247844+0.0637647im     -0.129434-0.0134442im      0.184301+0.0883067im       0.12703-0.0595298im      0.0847637-0.17742im        0.0118891+0.0606469im    -0.146854+0.024678im     0.0366605-0.135395im      0.186568-0.132664im     -0.0937433-0.226885im       0.014833-0.1391im       -0.000596382+0.0579288im      0.084081+0.0673395im    -0.111471+0.130483im   -0.0329844+0.0169579im      -0.171973-0.0642552im     -0.322173+0.114994im      0.151355-0.0823959im       -0.168495+0.0736386im    -0.0765773+0.0255418im
  0.00367673-0.101977im        0.141356+0.0763774im     -0.141248-0.0885224im       0.12995+0.0654338im     0.141912-0.0878749im     0.0820601+0.0131412im      0.190415+0.163416im       0.171247-8.46749e-6im    -0.138248+0.0400156im     0.0278043+0.0771496im     -0.118043-0.0291051im        -0.147-0.0814024im    -0.262245+0.186589im      0.0747164-0.0274784im     -0.190134-0.111264im     -0.0153971+0.212862im        0.199051-0.122257im        0.176315-0.0198306im     -0.13198-0.0704008im   -0.0271525-0.0325315im     0.100048+0.157783im      -0.170825-0.0102445im     -0.119801+0.134548im        -0.054075-0.0198979im     -0.153184+0.0987224im   0.00887143-0.0921085im   -0.106667+0.246761im    -0.000285501+0.143938im       0.047051+0.0818835im    -0.195565+0.00152967im     -0.0633369-0.205256im     -0.0184498-0.273324im
  -0.0476054-0.0475582im      0.0292617-0.051536im      -0.134427+0.193913im       0.154329+0.0709817im    0.0618907+0.0225172im     -0.234271-0.0476431im    -0.0890815+0.00799577im      0.14036-0.0491297im     -0.162545-0.00158832im   -0.0191257-0.0682945im      0.132839+0.0675491im      0.125833-0.185646im     0.0680578-0.188352im     -0.0683675-0.0845468im     0.0495455-0.0767081im      0.174955-0.0182182im     -0.0412765+0.151884im      0.00151834-0.0998979im   -0.0373843+0.0812841im     0.190988+0.155517im       0.18282+0.0990436im    -0.0479709+0.136305im     -0.0381635-0.147343im        0.0690573+0.19936im       -0.275462-0.0204958im    -0.237039-0.0101701im  -0.0897198+0.111124im        -0.28652-0.0565213im       0.26405+0.0621629im   -0.0255907-0.184289im        -0.105286+0.129123im     -0.0939121+0.0488207im
  -0.0614877-0.168194im        0.235764-0.11805im        0.148578+0.101463im      0.0899594+0.0189338im     0.097818-0.0454326im    -0.0906023-0.140306im      -0.138397-0.0621817im    -0.0455593+0.151452im     -0.0785628-0.266346im     -0.0115693+0.00817929im   -0.0839322+0.230806im     -0.0468195-0.055842im    -0.0571693-0.0236543im     0.0384113-0.0949282im      0.029449-0.275344im       0.165953-0.0573552im       0.175188+0.0544415im        0.14241+0.222487im    -0.0730066+0.0698729im    -0.112461-0.185435im    -0.0699414-0.0448908im     0.0669229-0.051709im       0.203559+0.0760046im       0.0437591+0.0603625im    -0.0514651+0.0652706im     0.123268+0.0782274im  -0.0392473+0.110565im      0.00479267-0.0383963im     -0.325785-0.0804865im     0.037294+0.106805im       -0.0285978+0.267972im       -0.18932+0.019569im
  -0.0384099+0.17732im         0.160178-0.0323506im      0.113055-0.231549im      -0.154728-0.175622im      0.230921-0.11231im       -0.228977+0.0127379im    -0.0368134+0.0495329im    0.00138241+0.0858675im     0.0417144+0.00544253im    0.0446175+0.168385im      -0.103632-0.0662866im     -0.169671+0.178686im    0.00377535+0.126049im     -0.0549715-0.00317625im     0.106344+0.0575613im      0.181138-0.110186im      -0.0844804+0.279025im       0.0932736-0.0935217im    -0.270669-0.0759487im    0.0090472-0.128744im     0.0912611-0.0477862im    -0.0296225+0.128095im      0.0226609+0.0902042im        0.135605+0.0404337im     0.0737151-0.064022im     0.0425744-0.238578im   -0.0117618-0.1186im         -0.122679-0.200226im       0.164062-0.0394088im    -0.128126-0.0118533im       0.0978646+0.0990356im      0.175091-0.125041im
   0.0166945-0.0539508im     -0.0926865-0.0303461im     0.0395861-0.0985725im     0.0351973-0.110405im     -0.110163+0.0466331im     -0.183509-0.0802075im    -0.0500264+0.0158323im    -0.0104335-0.120553im       0.113394-0.0898589im    -0.0700664-0.285096im     -0.0833766+0.0675006im    -0.0637511+0.174094im     -0.122118+0.0112754im      0.272291-0.0835583im        0.2164+0.0508737im    -0.0344507-0.239036im      -0.0412211-0.198659im        0.131844+0.323823im      0.134822+0.172044im      0.184219+0.0601024im     0.127831-0.0920987im     0.0293102-0.0726644im    0.00214048-0.00498951im      0.0303399+0.146202im     0.00683773+0.12974im      0.0414386-0.119766im    0.0102169+0.0145386im      -0.166202+0.1177im        0.0997695+0.197339im     0.0120332+0.124291im       -0.0638064-0.124205im        0.14847-0.226006im
   -0.138232-0.159316im       -0.174896-0.152024im      0.0722371+0.00982153im    0.0184772+0.10891im      -0.131642-0.0475803im     -0.171941-0.0918458im     0.0794935-0.133059im      0.0228786-0.0530325im     0.0215314+0.100311im     -0.0900659+0.134471im    -0.00815455+0.093954im     -0.0115554+0.0623236im      0.33921-0.0265415im    -0.0820767-0.00441105im  -0.00777199-0.0317338im      0.164537-0.133751im        0.162203+0.0783621im      0.0907643-0.0239502im     0.057065-0.0723945im    0.0739157-0.111678im      -0.17467+0.128675im      -0.274337-0.171897im      -0.235755+0.292033im       -0.0498371+0.0242274im     -0.057223-0.094871im     0.0639384+0.248106im     0.171286-0.0351552im     -0.0812959+0.00320932im  -0.00255858-0.0567241im    0.0657152-0.0820317im       0.0484151-0.16624im        0.129724-0.203606im
   0.0506268-0.0514739im       0.220816+0.095097im       0.114205+0.131327im      -0.211618+0.0148773im    -0.110968+0.182584im     -0.0176454+0.211262im      0.0618179+0.0827759im     -0.060022-0.0686526im    -0.0783628-0.171496im       0.148321-0.0493619im      0.115058-0.0933914im    -0.0957678+0.0206881im     0.278369+0.199424im      -0.132979-0.133138im     -0.0605418-0.218652im       0.195701-0.12525im      -0.00231176-0.135629im        -0.13887+0.025296im    -0.0138195-0.154327im     0.0787392+0.0854163im       0.0993+0.0299703im    -0.0573772+0.196506im     -0.0993603-0.0813473im      -0.0762886-0.133798im      0.0760699+0.17314im      -0.024567+0.0667695im   -0.227187-0.145165im       -0.062229+0.0743596im      -0.18626+0.178503im     0.0539149-0.0114722im      -0.0921092+0.00180146im     0.142503-0.111459im
  -0.0547223+0.0792992im     -0.0111968-0.176395im      -0.183084+0.140759im     -0.0864601-0.10433im       0.188995+0.0684802im      0.068328+0.0453713im     -0.047451-0.0776013im   -0.00290376-0.0397523im     0.0976791+0.0546821im      0.220405+0.203476im     -0.0954224-0.0292668im      0.116323+0.0915111im     0.162604-0.0140654im      0.108939+0.00446825im    -0.300302+0.112362im      -0.130368+0.122094im       0.0813315+0.0262156im       0.108641+0.217682im      0.297617-0.04228im       0.203952+0.105217im     -0.232407-0.0241338im    -0.0551386+0.0117938im     0.0102592-0.0232465im        0.208799+0.109308im      -0.050755+0.199947im    -0.0640783-0.102118im   -0.0604151-0.051696im      -0.0428309-0.112855im      -0.145866+0.028554im     -0.218143-0.0433174im      -0.0146598+0.187146im      0.0572259-0.107861im
   -0.238302-0.0151966im      0.0480583-0.0860871im    0.00362627+0.0635682im    -0.0906262+0.154264im       0.10709-0.0247006im      0.169365-0.075322im     -0.0293144+0.0226342im        0.1029+0.124476im      -0.110801-0.101087im       0.041342-0.215874im      0.0502168-0.0323612im      0.106201-0.171222im    -0.0348438+0.187193im     -0.0148139-0.0222888im      0.136558+0.140306im      0.0653412-0.144523im      -0.0236519-0.0674487im      -0.212798-0.078888im      0.307638+0.0668566im   -0.0867255-0.132095im     0.0261089-0.206938im      -0.187295+0.01705im      -0.0612239+0.297855im         0.268191+0.0203721im      0.050606-0.0138656im    0.0854367-0.231079im    -0.164133+0.0402645im     -0.0248907-0.0457462im    -0.0279553-0.0620404im   -0.0421015-0.184143im         0.003859-0.181583im    -1.84132e-5+0.124388im
  -0.0728384-0.120846im       0.0382878+0.040032im     -0.0655431-0.255802im      0.0640875-0.0215576im    -0.096996-0.022779im       0.159467+0.106922im      0.0347856+0.0824003im    -0.0338306-0.0111103im      0.196095-0.01657im      -0.0856604-0.0268994im   -0.00177518+0.0740699im     -0.171793+0.0342987im   -0.0653769-0.182232im      -0.230812-0.107949im      0.0893509+0.0950759im   -0.00448836+0.0670432im       0.115588+0.173272im         0.15909-0.0931335im     0.303741+0.118554im    -0.0201674+0.0243675im     0.147688-0.13956im      -0.0811619+0.242681im    0.000272786+0.142177im       -0.0112437-0.0485081im     -0.103393-0.0315716im    -0.191366+0.216807im    -0.117742+0.0816552im       0.129397-0.269255im      -0.110772+0.250292im    -0.0025954+0.136244im      -0.00366161+0.0978242im      0.129678+0.0251185im
    0.339335-0.205606im       0.0526995+0.0703778im      0.161002-0.203649im       0.035377+0.0544755im     0.106963+0.082202im      -0.128289-0.0801499im    -0.0393228+0.160935im     0.00192746-0.103314im      -0.103145+0.127623im      -0.025861+0.0837552im    -0.0402414+0.00167286im   0.00963122-0.117104im     0.0363402+0.157701im     -0.0856111+0.290848im      0.0113857+0.0166774im     0.0415682-0.0955671im      0.0620264-0.141367im       -0.199071-0.0847761im     0.301523-0.0195401im    0.0987606-0.139089im    -0.0599074+0.129584im    -0.00715493+0.0545997im     0.0706792-0.137641im         0.175571+0.218633im      0.0146904-0.159565im    -0.0317785+0.0171647im   0.0594384-0.0862682im      0.0746824-0.115624im    0.000922924+0.0816953im   -0.0668994+0.205516im      0.000444361+0.0324743im     -0.234037-0.146518im
    0.297853+0.106078im        0.203758+0.186386im      0.0844363-0.0677846im      0.116432-0.117456im      0.155074+0.12692im       0.0319352-0.0650842im     0.0935114-0.0292804im     0.0997441+0.00691266im     0.261466-0.0419038im    -0.0364837-0.00998133im     0.107818-0.0717864im     0.0612627-0.138798im      0.166712-0.0572767im     -0.121745-0.0936041im     -0.146983+0.0743229im     0.0740082-0.203262im        0.121711-0.0674617im       0.289286+0.10074im     -0.0185691+0.0212242im    0.0348376+0.0879443im    -0.167708-0.147006im      0.0113871+0.06875im      -0.0368159+0.0442188im      0.00948817-0.1119im        -0.116193+0.0684335im    0.0369683-0.104567im    0.0522813+0.076462im       -0.120748-0.108768im      0.0693581-0.128577im       0.15956+0.0229064im       0.0680526-0.322948im      -0.172753+0.186365im
   -0.138963+0.246099im       0.0972712+0.249927im     0.00313603-0.0673188im     -0.184215+0.0667848im    0.0776981-0.2625im         0.197823-0.00276189im  -0.00302151+0.0954271im     -0.292147-0.230555im      -0.147734-0.0714711im     -0.120577+0.0268837im    -0.0281536+0.229196im       -0.12996+0.0969413im    0.0419814-0.132404im       0.123789-0.0776242im    -0.0766838-0.00406698im     0.101531-0.112765im        0.268737-0.00455743im     -0.100441+0.0746439im    0.0925659+0.0889346im     0.125789+0.011156im    -0.0341195+0.203526im     0.00241309-0.020074im     -0.0723498-0.17165im         0.0576035-0.029727im      0.0685382-0.0783855im    0.0658425-0.0564183im     0.11273+0.105055im       0.0468322-0.126858im      0.0987131-0.0285655im    0.0453073-0.152654im        -0.206779-0.0520921im    -0.0357486+0.0831241im
    0.117473+0.0340804im       0.204135-0.0502892im      0.158872+0.0879198im       0.16614+0.0753731im     0.126734-0.12662im        0.121173+0.335398im      -0.255669-0.103968im      -0.217192+0.212503im     -0.0621109+0.209689im      0.0239682-0.0708052im      0.015813+0.0747452im    -0.0981095-0.0386952im    0.0655949+0.105125im      0.0488343-0.0208108im     0.0492239+0.200759im     -0.0595268+0.114875im       0.0610115+0.0290836im    -0.00758988-0.0515176im   0.00505673-0.114525im    -0.0442711+0.0882741im   0.00226443-0.126151im     -0.0903291-0.0935346im      0.244502-0.0521831im       0.0766629+0.127282im      -0.156207+0.00374855im  -0.0172854+0.10426im      0.093067+0.0113281im     -0.0867512+0.0950933im     0.0528641+0.0486408im     0.308521-0.0528893im      -0.0851797-0.123431im       0.166296-0.192311im
   -0.122086+0.0989187im        0.10456+0.0369682im      0.099678+0.0445957im      0.168571-0.113154im      -0.13889+0.253137im       0.110887-0.0343098im      0.224971+0.0163913im      0.144784+0.0797154im   -0.00153377-0.0808172im      0.142804+0.104931im      -0.185354+0.357027im     -0.0991933-0.0307822im     0.100708-0.223845im   -0.000424715-0.0190541im     -0.034661+0.0475312im    0.00746968-0.142703im       -0.105683+0.00333369im    -0.0506078-0.216818im     0.0682623-0.128096im    -0.0471636-0.215669im     0.0792618-0.0919086im     0.0600158-0.273024im      0.0568925-0.296602im        0.0358489+0.0621627im    -0.0537712+0.00549731im   -0.155432-0.104066im   -0.0505706+0.0180234im      0.0503797+0.0180654im    -0.0318043-0.0770009im    -0.119953+0.0301012im      -0.0065223-0.161537im       0.141592-0.0889885im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.17197354174527354 - 0.13384195873923632im
   -0.08277553434366891 - 0.024147786943747696im
    0.10749707750348708 - 0.1544377388584388im
    0.30628685039996106 + 0.0im
    -0.1441520192476604 + 0.16106817914247215im
   -0.12714042929721306 + 0.11573056702649166im
   -0.15304388566682314 + 0.19456869069845134im
     -0.257025333943397 - 0.1311841394252719im
    0.11324900596723803 + 0.060169677058190846im
 -0.0031411034047311975 + 0.0008234338043058028im
    0.08633411763940242 - 0.06970500650930483im
   -0.18345520590965678 - 0.14036514142232476im
   -0.05611839821332122 - 0.10863081966536055im
   -0.04338849626964536 - 0.0367041461896586im
   0.012977082726157928 - 0.231467891290593im
   0.013120080555418237 - 0.09276707545564039im
    0.08291773944000427 - 0.05564263728041538im
   -0.10903024044966902 - 0.023146445600961883im
    -0.1383079173548914 - 0.05734275474323822im
    0.16093802305329757 - 0.007589589177510278im
     0.1320449490408873 - 0.043197805978003316im
      0.253589531778544 + 0.1679017222295028im
   0.015092175728486177 + 0.03070808220457577im
   0.045911898792555986 - 0.1555287198520155im
  -0.052256880516999525 - 0.134743294513325im
    0.12439846191347108 - 0.16480630723161846im
   -0.04973031409303766 - 0.0968249620011175im
     0.1924428202297483 - 0.05325816474955002im
    0.07029629738579651 - 0.019852798403615764im
   -0.07533183840742086 + 0.045456238036698786im
  -0.002409005837086593 + 0.297316215766587im
    0.05146382442303827 + 0.05279805015102996im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Wednesday 24 August 2022 22:26">Wednesday 24 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

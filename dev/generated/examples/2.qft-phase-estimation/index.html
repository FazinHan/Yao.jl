<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.313857+0.15104im      -0.0920015+0.0275194im    -0.00850335-0.178078im      -0.105056+0.00631016im   -0.0614805+0.255562im    -0.0339765+0.0279494im      0.075562+0.0522761im       0.1293+0.0709846im    0.0265152-0.113521im     -0.041495-0.150225im     0.0506976-0.0403751im   -0.0887134+0.197829im       0.124385-0.150425im   -0.0850448-0.0223508im      0.13146-0.133019im     0.0405549+0.199701im    0.0493874+0.16178im      -0.173753+0.0860375im     0.126044+0.229035im     -0.114365-0.0793951im    0.0168065+0.0675362im     -0.121578+0.102388im       0.114636+0.109606im    -0.00343328+0.176724im      0.0522943-0.0218479im    -0.107732-0.012312im    -0.0253915+0.0669287im     0.260373-0.0400903im   -0.0709683-0.125656im       0.198862+0.213429im      -0.196115-0.0837221im    0.0827344+0.160562im
   0.0383917+0.149132im       0.309295+0.0332469im     -0.0140277+0.0132283im     -0.145672+0.0580789im     -0.229158-0.0113849im    -0.058608+0.286186im      -0.146515-0.0636268im     0.113078-0.115587im     0.0829164+0.00404748im   -0.138516+0.0207067im    0.0498671-0.0979739im    0.0171298+0.0861615im     -0.120301-0.0109531im   -0.113337+0.116645im    -0.0387581-0.253444im      0.124171+0.35809im    -0.0192813+0.116204im      0.117647+0.0288473im   -0.0776306-0.0798077im    0.0492131-0.0373511im   -0.0301029-0.144421im      0.0502831-0.0360152im     -0.130696-0.057604im       -0.04758+0.0184315im     0.0509751+0.208423im      0.274604+0.0931493im    0.0707933-0.164428im    -0.0349419+0.111973im     -0.152384+0.0050215im     -0.120964+0.0130847im      0.183794+0.0176351im     0.161552+0.0255086im
   0.0830385+0.273556im       0.123235+0.020547im        0.241275+0.428612im      0.0345191-0.0242891im     0.0336047+0.0904055im    0.0895979-0.0545088im     -0.185354+0.0615195im   -0.0959052+0.0731537im    -0.229377-0.0253626im   -0.0327211-0.0955704im     0.202213-0.0306422im    0.0377997+0.0658138im    -0.0197892-0.0583211im    -0.02849-0.233692im     -0.152152+0.00414648im   0.0600311+0.10074im     -0.115492+0.00359986im  0.00262156+0.00153066im    0.102991-0.0587822im    0.0652072-0.0495495im     0.300286-0.0997044im        -0.112-0.0298772im    -0.0816415+0.00593644im    0.0918425-0.0260409im     -0.172594+0.0998961im   -0.0655109-0.0665136im   -0.0826703-0.122595im     0.0469169-0.248401im      0.103483+0.0598777im     0.0832705+0.0296818im    -0.0713942+0.0866097im    -0.164898-0.138338im
  -0.0626385-0.0163617im    -0.0996231-0.207574im      0.00876026+0.0143069im      0.165202+0.251804im    -0.00380958-0.207808im      0.050212+0.0649424im       0.09422-0.281734im    0.00289601+0.234601im    0.00307482-0.139937im     -0.162271-0.0156767im     0.288186-0.00832194im   -0.094744-0.0263675im   -0.00189741+0.0352096im  -0.0420579+0.0119625im   -0.0288426+0.0632059im     0.171571-0.014542im   -0.0221695+0.0654967im   -0.0735235+0.165718im    -0.0517933+0.0798911im   -0.0727081-0.119794im    -0.0276984+0.00104753im   0.00634665-0.165432im     -0.0577015+0.174212im      0.0158709-0.149861im      0.0304797+0.0167118im    -0.122951+0.259402im      0.116039+0.033912im     0.0512783+0.225933im     -0.153673+0.103173im       0.257913+0.0761249im      0.109654+0.15384im      -0.143601-0.127603im
 -0.00830091+0.0680211im     -0.206451-0.122881im        0.154155-0.128236im      -0.304683-0.0557652im      0.185076+0.28171im       0.169788-0.0291484im     -0.146248-0.320586im      0.224828+0.136426im      0.019815+0.163019im     -0.135159+0.0736565im   -0.0111659+0.0648011im   -0.0100904-0.211033im      -0.132923+0.0836392im   0.0967821-0.114168im    -0.0323143+0.0598629im    -0.036961-0.055882im    -0.140552-0.0124384im    -0.210792+0.1239im       -0.149627-0.0865627im   -0.0255443+0.129462im      0.163126+0.105267im      0.0398381-0.0117715im    -0.0709133-0.0807652im      0.178946+0.116437im     0.00745233+0.019815im     0.0846119+0.0757246im    0.0254218-0.0223969im    0.0808861-0.0497814im   -0.0662331+0.0247173im     -0.133755+0.0264355im      0.118295-0.0742123im     0.137316+0.00492758im
   0.0733901+0.0182448im      0.191808+0.0755457im     -0.0992039-0.0747568im    -0.0516707-0.09623im        0.129769+0.0685114im     0.229785+0.219328im      -0.116354-0.0421858im    0.0195337-0.0287727im    0.0226984-0.0650118im    0.0523802+0.0332176im     0.165581+0.0155892im     0.314317-0.150175im       0.148629-0.138393im    -0.135106-0.174815im      0.322056+0.11521im     -0.0708408-0.119373im     0.173943+0.271616im      0.125848-0.211833im    -0.0538208+0.0118762im     -0.10148-0.104432im     0.0309401+0.0334986im      0.148119-0.016401im    -0.00100377+0.00958415im   -0.0395717+0.0160269im     0.0592483+0.0432432im    -0.264958+0.115046im       0.12488-0.0512667im     0.032304+0.0179071im    0.0769134+0.0265986im    -0.0658081-0.0981324im     0.0606296-0.119859im    -0.0224252-0.197026im
   -0.127806-0.103844im     -0.0163945+0.0248431im     -0.0931843-0.097746im      -0.059089-0.0248325im    -0.0996824-0.0217394im    -0.106932-0.030733im       0.175048+0.125008im    -0.0635644-0.048057im     -0.147366-0.159205im     0.0590121-0.00786231im   0.0614779+0.241924im     0.0459771+0.0279672im     -0.347369+0.21676im     -0.367158-0.108545im    -0.0190692+0.0569324im    0.0612151-0.0839676im  -0.0764792+0.245059im     -0.194104-0.0253073im     0.115873-0.116474im    -0.0140857+0.00574929im    0.167922-0.00749448im    0.0709006-0.0849905im      0.213002+0.172844im     -0.0183796+0.0635592im     -0.123695+0.0525206im     0.188252+0.00809089im   -0.153574-0.0314865im      0.12571-0.004582im   -0.00122326-0.0431672im     0.0266434-0.06081im        0.150772-0.218891im      0.010862-0.0849844im
    0.267063+0.13237im       -0.113278-0.0885207im      -0.213271+0.0111516im      0.164731-0.148424im      0.0326649+0.0147599im    -0.262278+0.119548im     -0.0959288+0.112627im     0.0787597+0.267631im     0.0168786-0.241307im    -0.0498084+0.0975222im   -0.0639796+0.212833im      0.159921-0.0407257im     -0.157406+0.111527im   0.00709652+0.0433338im    0.0113847-0.255118im    -0.0544556-0.164867im      0.07921-0.186335im     0.0403836-0.0185654im    -0.223198+0.0255691im    0.0968305+0.00775477im   0.0673317-0.063251im     -0.0964815+0.102784im      -0.226343-0.00178138im    0.0709467-0.0820381im    -0.0742996+0.166696im     -0.110154+0.139035im     -0.140396+0.0534581im   -0.0367308+0.0381471im   0.00337072+0.0833837im     0.0131102-0.0793242im    -0.0859509-0.14815im     0.00565146+0.0526236im
   0.0111617+0.00126833im    0.0277032-0.00368238im     -0.223461-0.0333177im    -0.0349582-0.161121im       0.229037-0.0426131im     0.155852-0.106586im    -0.00657668-0.169818im     -0.251432+0.0119233im     0.290941+0.26165im       -0.05812+0.0118663im     0.103768+0.010033im      0.100334+0.144159im     -0.0775469-0.0735118im   0.0521063+0.0672985im    -0.105867+0.00992329im  -0.0814073-0.0561295im  -0.0266778+0.012367im    0.00538262-0.0462485im   0.00356112+0.0718175im    -0.130597-0.355291im     0.0993656+0.00139295im    0.0130896+0.132im       -0.00138479+0.108221im      -0.236931-0.138577im      -0.177313+0.182145im      0.247143+0.00830998im   -0.183002+0.0379108im     0.101964-0.051956im     -0.146771+0.0599418im     -0.029267+0.0512142im    -0.0998115+0.0201885im   -0.0725051+0.128711im
   -0.138249-0.0957526im   -0.00394075-0.00578332im    -0.0171545-0.153977im        -0.1288+0.136337im      -0.088714+0.145055im     -0.221713-0.0416279im      0.174572-0.0781922im     0.113981-0.0330749im  -0.00814046-0.086414im      0.254361+0.173786im     0.0772767-0.0846381im    0.0771151-0.00352112im    0.0485888-0.149563im    0.0838564-0.00427215im   -0.218114+0.0472655im     0.092796-0.111189im    0.0304656-0.089591im     0.0561096-0.032143im     -0.130178+0.321375im    -0.0639832-0.133425im      0.212458-0.175836im     -0.0188098-0.0333546im      0.114471-0.233494im     -0.0439667+0.208574im      -0.144398+0.168672im    -0.0587153+0.128252im    -0.0208544-0.277137im     -0.131246-0.0208631im     0.117746+0.040479im     -0.0134944+0.136665im      0.0173666+0.0271604im    -0.112126-0.00300592im
   -0.106928-0.133965im      0.0535431-0.18154im        -0.105024-0.125805im     -0.0317159-0.0249772im     -0.170083-0.127376im      0.102223-0.0361005im     0.0343545+0.152421im      0.104929-0.0385625im     0.138731+0.0767097im    -0.170431-0.0669341im     0.331248+0.161947im      0.135468+0.11256im        0.106491+0.121463im     0.142663-0.00730947im  -0.0115797-0.00749873im   -0.155191-0.0247282im    0.029605+0.0205949im    -0.079231-0.0580404im     0.119732-0.0174112im    0.0939685+0.189589im     0.0788394+0.0624899im     -0.104156+0.0953104im    -0.0677004-0.107066im      0.0948084-0.159616im       0.261938+0.069743im     -0.115132-0.0267562im    -0.159464-0.353306im     0.0682271-0.158419im       0.10092-0.00938918im     0.125254+0.0478505im      0.134832+0.0910014im    0.0313918+0.203474im
   -0.118326-0.147707im       0.275036+0.0540081im       0.115533-0.151377im     -0.0905639-0.0607557im     0.0459409-0.0208211im   -0.0818682-0.026251im      -0.093561-0.00662188im    0.184927+0.093159im     0.0505143-0.0846626im    0.0047293-0.250149im    -0.0821588-0.0114178im    0.0817264+0.0649697im      0.139588+0.0825792im    0.072344-0.0717952im    -0.133547+0.0485373im    -0.134735+0.0659549im    0.317592-0.22153im     -0.0915581+0.204703im     -0.081521-0.0756649im    -0.119967-0.142112im    -0.0702427-0.167371im     -0.0649203+0.00568063im    -0.107784+0.159207im      0.0282955+0.0185488im     -0.178057-0.150655im     0.0304233-0.0541261im    -0.187086-0.0258945im     0.281438+0.116879im      0.098498-0.0640786im     0.0140674-0.13265im       0.0870488+0.0477026im    0.0242692-0.23461im
   -0.156021+0.0663366im      0.146758+0.13789im         0.065808-0.0249631im     0.0405787-0.0807482im      0.120902-0.0953586im     0.203641+0.0819656im     0.0832546-0.0485777im    0.0443722-0.046745im     -0.136686-0.196681im    -0.0475507+0.100326im      -0.23325+0.0788753im   -0.0489922-0.0218423im      0.280879+0.0805872im   0.0558111-0.0481029im    0.0595696-0.0546021im      0.11608-0.116331im     0.170794+0.0936569im     -0.10303+0.109603im    -0.0629207-0.0412644im    0.0996433+0.0771058im   -0.0330525+0.147151im       0.102407-0.0949345im      -0.15642+0.146071im      -0.124336+0.146351im      -0.138053+0.221925im      0.130122+0.104285im     -0.163926+0.0352501im    -0.189394-0.212344im     0.0495392-0.00674429im     0.188729+0.221378im      0.0478763+0.0881786im    0.0148172+0.255053im
   0.0366905+0.0224496im    -0.0111878+0.147103im       0.0201455+0.0388143im   -0.00327577-0.0141206im     -0.143141-0.214799im    -0.0307715-0.222372im     -0.0943434-0.0528078im     0.185466-0.133139im      -0.19556+0.100193im    -0.0842857-0.0969069im     -0.12045+0.167787im      0.145983-0.125128im      -0.107312+0.0353141im     0.31187+0.248504im       0.12869+0.0696965im     0.167521+0.0322621im   -0.099891+0.0947081im    0.0155267+0.0957892im     0.123578+0.0509354im   -0.0527494-0.227909im     0.0807605-0.0380201im      0.037878-0.124747im     -0.0861028+0.06605im       -0.120601+0.131591im       0.125014-0.030674im     -0.267041+0.086926im     -0.229638-0.0936201im    -0.025887-0.0406335im    -0.219826-0.0631026im     -0.124212-0.0238288im      -0.10248-0.123583im    -0.0152567-0.0599538im
    0.129012+0.154622im      0.0622354-0.0669763im      0.0722665-0.0115057im     0.0489243+0.125452im      0.0216552+0.0935542im   -0.0629886-0.00314043im     0.174527+0.0466497im     0.173107+0.12325im      0.0967328-0.189585im     0.0426955-0.0172132im    0.0483878+0.32044im      -0.106842-0.254348im      0.0909885-0.234834im   -0.0509702+0.239987im     0.0941937+0.299403im    -0.0362455+0.011567im    0.0132061+0.0467965im      0.16054-0.0456196im    0.0554812-0.148768im    0.00510833-0.102323im     0.0608324-0.0116595im     0.0454637-0.00605408im   -0.0231986-0.00138903im    0.0118876-0.0659416im    -0.0120406-0.219048im      0.339825-0.0270218im   -0.0684747-0.149538im     0.0418252-0.116852im    -0.0105567+0.181029im     -0.0564526-0.0946591im     -0.100508+0.181745im     0.0325912+0.107558im
  -0.0691409+0.0313065im     0.0815314+0.141935im      -0.0612506+0.0388348im     -0.115855+0.113362im      0.0981141-0.02962im      0.0490074+0.20843im        0.129291+0.0796959im   -0.0359953+0.242932im     0.0187431+0.146453im    -0.0969403+0.375839im     -0.107851+0.0799329im   -0.0841174-0.142446im     -0.0725783-0.0430012im    0.248843-0.031246im      0.114137-0.121246im      0.102879+0.240469im    0.0411955+0.0561107im   -0.0658429+0.123223im      0.174731+0.0850642im   -0.0287379-0.111219im      0.049106+0.00891359im  -0.00986766+0.0522627im      0.127987-4.23323e-5im     0.146341-0.0874348im   -0.00023332-0.0132338im   -0.0197286-0.165034im     -0.100827-0.02516im      0.0109866+0.154483im      0.276959-0.0434022im     0.0806987-0.222825im       0.090597-0.110867im     -0.246683+0.0861063im
    0.135676+0.00019046im   -0.0698174-0.235264im      -0.0376072+0.00992747im    0.0189473+0.0975941im     -0.196186+0.178131im      0.196785-0.0452678im     -0.139149-0.131263im    -0.0968663-0.174669im    -0.0269305-0.176469im    -0.0492916-0.0285611im    -0.242321+0.22822im     -0.0628038+0.102008im      0.0242967+0.0570079im   0.0262513+0.0114602im   -0.0632556-0.0559856im    -0.282107+0.0302637im   0.0667619+0.231695im    -0.0516256+0.214149im     0.0358811+0.0650311im    0.0172343+0.0532253im    0.0817226-0.174036im       0.193266+0.212729im       0.103085-0.06911im       -0.148147-0.0287766im    -0.0388639+0.00888157im  -0.0803124+0.0251051im   -0.0370232+0.0409181im    -0.116626+0.126635im     0.0824826-0.0202251im     -0.129675-0.103239im       0.042474+0.238642im     -0.246161-0.0384856im
  -0.0373891+0.0327307im      0.131646-0.0308064im       0.251916-0.102956im      0.0738757+0.115459im       0.175751+0.00407656im    -0.10634+0.059366im      0.0859608-0.0134311im    -0.150834+0.0699483im    -0.202477-0.108714im     -0.252666+0.153585im     0.0594611-0.00940594im    0.174641+0.0477266im    -0.0500384-0.0455169im   0.0719201-0.112658im     0.0503148-0.100141im     -0.201225-0.162582im    -0.063425-0.0224799im     0.076246+0.189503im      0.100363+0.125871im     -0.158231+0.196911im     0.0442647-0.023344im     -0.0190386-0.0696021im    -0.0148268-0.0143702im      -0.32275-0.152251im      0.0936773-0.107743im      0.145286-0.0903663im    0.0347794-0.187081im    -0.0278581+0.119913im     -0.042508-0.161574im      -0.132617+0.11297im       -0.236058-0.117003im      0.157265-0.044542im
   0.0721343+0.112267im         0.1653+0.056272im    -0.000877018-0.111095im       0.104486-0.119491im     -0.0305762-0.0874355im   -0.0176681-0.131217im      0.0137081-0.206895im    -0.0793321+0.067074im    -0.0909217+0.110777im    -0.0122507-0.0502486im   -0.0282508+0.0562534im    0.0921417-0.00307148im     0.101117+0.134272im    -0.166846+0.104419im     -0.148505-0.0183776im     0.134843+0.226023im   -0.0530355+0.0647592im    0.0568151-0.135805im    -0.0722845+0.373433im     -0.219491+0.25299im      0.0986501+0.0623614im      0.156574-0.0194318im    0.00615758-0.0480532im      0.140178-0.187199im     -0.0660165-0.269813im    -0.0249404+0.0959563im    -0.187729+0.133452im    -0.0497482-0.0169381im     0.241593+0.151063im     -0.0656505+0.0286156im     0.0609836-0.00812665im    0.152384+0.0522134im
  -0.0215146+0.18498im       0.0154737+0.0559651im      0.0621818-0.00466101im    -0.171221-0.0160989im      0.102128+0.158749im    -0.0692216+0.0108545im      0.145933-0.136042im    -0.0114715+0.0190025im     0.147674+0.0247106im   -0.0586511-0.190462im    -0.0164065+0.0110759im    -0.259942-0.046068im      -0.192199+0.181586im    0.0863065+0.0872134im     -0.12222-0.100312im     -0.104832-0.0721486im    0.154382-0.0840027im     0.405407-0.145689im      0.115661+0.0547079im    0.0685814+0.107957im     0.0365021-0.0604146im      0.171598-0.0142355im     0.0389708+0.29481im       -0.177049+0.0143252im      0.108773-0.032329im     -0.168995+0.0340796im    0.0855431-0.0896871im     -0.03382-0.181222im     0.0420897-0.0551671im      0.196825-0.0175413im      0.153584-0.133486im    -0.0780329-0.0463495im
    -0.11127-0.116607im      0.0774307-0.316145im       0.0110829+0.292818im        0.12672+0.193331im       0.148077+0.0962002im    -0.231269+0.0112754im    -0.0113674+0.119106im      0.247271-0.0299444im    0.0141792+0.229456im     -0.135421+0.0469682im    -0.104349-0.103602im    -0.0875257+0.123113im      0.0340501+0.151221im    -0.162371+0.00593215im    0.101958+0.0332021im    -0.116977-0.0280931im    0.104661+0.111626im      0.105117-0.0687089im    0.0508042+0.167142im    -0.0147994-0.152424im      0.217982+0.336547im      0.0757811-0.0460538im     -0.100704+0.0218862im     -0.027014+0.161243im     -0.0463446+0.0629993im   -0.0454766+0.00409446im  -0.0904871+0.0624027im    0.0339672+0.0815073im    0.0421727-0.0313891im    -0.0775832-0.0970102im    0.00702172+0.0936675im     0.131041+0.0444917im
 -0.00590899+0.064009im      -0.116041+0.129987im        0.188614+0.0458013im   -0.00293819+0.257796im      -0.189851-0.0695695im    -0.040097-0.0822913im    -0.0690629-0.117908im       0.03449+0.0972113im  -0.00783371+0.160482im     -0.011983+0.101224im      0.130772+0.110717im     0.0315763+0.087707im       0.113042-0.042076im    -0.136432+0.0573601im     0.129619-0.167566im     0.0362108-0.182027im    0.0408382-0.191433im     -0.103516-0.123029im      0.155021-0.0172532im  -0.00164747-0.0133224im    -0.238961+0.062595im       0.370751+0.416571im     -0.0576627+0.0638819im     0.0669929+0.0921993im    -0.0916095+0.0901668im    0.0842949-0.0273726im   -0.0944668-0.101625im    0.00680785-0.0046911im    0.0630113+0.046156im     -0.0142383+0.0847721im    -0.0258632-0.0801452im   0.00817127-0.217563im
  -0.0953662+0.194801im       0.137636-0.133878im      -0.0724753+0.0328232im      0.140577-0.119497im      0.0444227-0.0480083im    -0.158654-0.066475im     -0.0781566-0.0918769im    0.0520892-0.130294im    -0.0809709+0.00991528im   -0.116537+0.134446im    -0.0691661-0.0665361im    0.0903352-0.124897im      -0.144812+0.0529924im   0.0262637-0.0815031im   0.00235196+0.0204942im   0.00327642-0.101078im    0.0861789+0.0131075im    -0.178529-0.0342077im   -0.0291373+0.0817001im     0.237163-0.246239im     -0.126557-0.262345im       0.228735+0.0496916im      0.231529+0.126699im       0.184595-0.0687864im      0.027392-0.139792im    -0.0622404-0.0826866im     0.245688-0.0947166im     0.196083-0.0756081im    0.0771495-0.0321104im    -0.0157055+0.186243im      -0.058569+0.144267im      0.127689+0.233364im
   0.0385623-0.25366im        0.163192-0.0421423im      0.0209529+0.00474908im    -0.104385-0.169061im      -0.123346-0.0138289im   0.00862994+0.08816im       -0.143887-0.0676909im    -0.238623+0.0211343im   -0.0570039-0.105312im    -0.0107779+0.211237im    -0.0296934-0.0566157im    -0.247295+0.110117im     0.00172759+0.0704702im  -0.0642387+0.134557im      0.246752+0.221215im     0.0608244-0.0312015im   -0.139124-0.217475im      0.161526+0.0372838im    -0.123621-0.091462im    -0.0234437-0.0259563im     0.304082-0.0813763im      0.200719+0.12449im       -0.103094-0.0818993im     0.0861277+0.0619592im      0.135999-0.0906023im   -0.0123295+0.0718977im     -0.07683+0.00755265im    0.197133+0.0258963im    0.0131088-0.181654im       0.194375+0.129538im       -0.10181-0.0280118im   -0.0325745+0.0427383im
    0.132619+0.0385271im     0.0841328+0.0119367im      -0.215971+0.0592046im      0.162416-0.195386im      0.0971515+0.039642im     0.0492705-0.132981im       0.293363+0.128392im     0.0454158+0.168281im     0.0346109+0.086038im     -0.121276-0.0659033im    -0.114437-0.104001im     -0.250685+0.0852967im      0.220065-0.0447791im   0.0436961-0.14483im       0.107476-0.0165306im    0.0663227-0.0924279im   -0.151522-0.0479592im   -0.0360997+0.107111im     0.0491966+0.0104887im    0.0538955+0.118024im    0.00732242-0.255238im       0.204454-0.104045im       0.132846-0.0712748im     0.0115099+0.0601906im      0.135272+0.195076im    0.00753023+0.0467868im    -0.114507-0.1337im        0.103701+0.0664118im   -0.0823286+0.187822im      -0.196623+0.00148484im     0.130379+0.00373748im   0.0938365-0.24938im
    0.161677+0.0722931im      0.121665-0.00939358im    -0.0678739+0.013573im       0.117521+0.082026im     -0.0843685+0.0141706im     0.029573-0.186621im       0.188624-0.0186959im   -0.0480883+0.105378im    -0.0303766-0.0156823im     0.154026+0.234077im    -0.0165482-0.08867im      0.0674965+0.166846im      -0.147465+0.0964883im    0.264808+0.0725491im    0.0320053+0.236209im     -0.223922+0.156958im    0.0834842+0.129688im     0.0246315+0.0141718im   -0.0458883-0.0125523im   -0.0295674+0.0524711im    -0.118044+0.119896im      -0.101475+0.0593655im     -0.061991+0.163916im       0.230404+0.00140286im   -0.0114908+0.146207im      0.133028+0.259405im      0.124904+0.0111576im   0.00851427-0.209025im     0.0648559-0.26961im       -0.102534+0.076278im      0.0319188+0.00635841im   0.0597532-0.239863im
   0.0415375-0.0887158im    -0.0645694+0.157138im       -0.175244-0.105891im      0.0874063+0.279483im      -0.180074+0.0462122im    -0.072488+0.009781im     -0.0128502-0.0839764im   0.00416618+0.116726im     -0.214322+0.151439im     -0.155623+0.0136048im    -0.261625+0.0858626im   -0.0928569-0.0863561im     0.0951965-0.0794107im  -0.0499757-0.155621im     -0.130851-0.0277526im   -0.0763515+0.020668im    0.0762208-0.0285542im    -0.102392-0.297016im    -0.0830739-0.167494im     -0.147892-0.156295im      0.165943-0.0838309im    -0.0623301-0.0910999im     -0.127077-0.0814905im     -0.191558-0.206188im       0.204771+0.0782036im     0.011851-0.0730024im     0.109438+0.116005im      0.135487-0.230304im     0.0608875-0.0598022im     0.0345658+0.113573im      0.0969981+0.0271697im    0.0365056-0.0562091im
    0.118146+0.14485im       0.0160049+0.124343im      -0.0464108+0.138589im       -0.15489+0.168468im       0.117985+0.171787im    -0.0389672-0.161143im       0.089544-0.0608227im    0.0185108-0.234286im     0.0250469+0.0870133im     0.112283+0.112742im    -0.0507815+0.0691341im     0.239085+0.0159826im     0.0124317+0.141736im   -0.0605867+0.0952798im     0.227565-0.00554351im   0.0888643+0.0188781im   -0.131807-0.210648im    -0.0586768-0.0516505im     -0.12618-0.138264im     0.0123563+0.184898im    -0.0276431-0.00822519im    -0.146595-0.107094im       0.097307+0.112752im      -0.220542-0.0965103im     0.0397698+0.0996216im   -0.0677134+0.0884148im   -0.0693671-0.0451119im     0.220742+0.251695im      0.182347+0.0163865im      0.149847-0.000868842im   0.0139108+0.309601im     0.0122754+0.0149707im
   -0.179857+0.0112165im      0.125949-0.247116im        0.106734-0.198941im      0.0334892-0.0326539im      0.166347+0.0343805im    -0.124027-0.0394234im    -0.0735667+0.00664471im  -0.0385479-0.0519606im    -0.140753-0.00443214im    0.228888-0.00610623im  0.00511599+0.0445314im    -0.120516+0.0724569im    -0.0461561-0.0115786im    0.115285+0.0430858im    0.0412135-0.00169056im   0.0174609+0.256698im   -0.0287031-0.00376201im   -0.139267+0.0513297im     0.125084-0.146524im     0.0691283-0.0683441im   -0.0448065+0.0505508im     0.0381794+0.141751im     -0.0299408-0.0834867im     -0.233335-0.0827301im      0.148499+0.163405im    -0.0757254+0.206426im      0.105734+0.0896856im    0.0570495-0.0818512im     0.190856+0.433382im      0.0733526-0.0619183im     -0.150989-0.205496im     0.0905108-0.0706858im
   -0.142563+0.0065606im     0.0233299-0.0570197im     -0.0944344+0.119964im      0.0773887+0.0176659im      0.145348+0.0267055im    0.0847982-0.0206485im     -0.125449+0.136538im      0.202872+0.129736im    -0.0603368+0.00115357im  -0.0013431-0.118092im     -0.055277+0.0129485im    0.0446988-0.0372841im     0.0731478-0.0533845im   0.0802819+0.177386im    -0.0904697-0.106604im    -0.0571092-0.0226214im   -0.186028+0.132543im      0.173494-0.0312802im   -0.0537554-0.299947im     -0.160954-0.0659373im    0.0359916-0.039776im      -0.069209+0.228398im       0.328163-0.0299876im     0.0232738-0.0539758im    -0.0748677-0.0900475im   0.00462025+0.130354im    -0.0517079+0.00558561im   -0.142236+0.195216im      0.115124-0.129088im       0.144174+0.404756im       0.120991-0.136022im      0.101066-0.0535359im
   -0.104118+0.200666im       0.074529+0.147976im       0.0855525-0.0862406im    -0.0184648+0.0104577im     0.0206371+0.0101275im     0.157759+0.0965723im    -0.0712492+0.211582im      0.123002+0.114416im     0.0165196-0.0389707im   -0.0191974-0.00444677im   0.0647097+0.0427592im     0.019619+0.149054im      -0.273671+0.0712462im  0.00890354+0.004085im     0.0920136+0.0758803im    0.0510686-0.0927839im    0.147493-0.183805im    -0.0508619-0.0277644im    0.0256038+0.216244im      0.182771-0.10153im      0.0473449+0.0875472im    -0.0281317+0.0322411im      0.183478-0.301636im      -0.144665-0.0326649im      0.205627-0.133298im     0.0937497+0.112208im     -0.116737+0.322642im    -0.0356053-0.0668913im    -0.091844-0.000909893im  -0.0571172+0.142442im       0.141625+0.236627im     -0.057427-0.180221im
   0.0392174+0.235263im      0.0404326-0.0220478im      -0.145128+0.00710182im      -0.2603-0.0725505im      0.204582-0.10722im       -0.29671+0.043891im     -0.0691281+0.0706882im   -0.0253897-0.0331174im    -0.246063-0.0345801im      0.15581+0.146213im     0.0722095-0.0846321im    -0.111396+0.153729im       0.148325-0.103993im    0.0523452+0.110212im     -0.191261+0.0323417im    0.0327568-0.147003im    0.0865009+0.115706im     -0.175891-0.0540559im    0.0234442-0.124946im     -0.158162+0.128787im     0.0500398+0.131722im      0.0592659+0.148716im     -0.0943026+0.0951656im    0.00140736-0.07222im        0.131354-0.137016im    -0.0755692-0.0303477im    -0.022833-0.0285331im    0.0327563+0.0598719im     -0.25137-0.015571im      -0.161776-0.00965977im     0.228704+0.109414im     -0.207319+0.038144im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.10230419500783779 - 0.04793421385457874im
  -0.13784480184988515 - 0.1297763857120892im
   0.09307000262163419 + 0.10271272635871065im
  -0.10072019232448337 + 0.12850007560433122im
 -0.044849686691262686 + 0.2233078839519977im
   0.22546746285154062 + 0.022920032846051017im
  -0.11124846380302332 + 0.15245104228569573im
  -0.09822182372094072 - 0.10551026112490523im
  -0.14864222153558743 + 0.03800791963395477im
   0.12992708306439937 - 0.11267054983816106im
    0.2914434823240197 + 0.0im
   0.06502847006787678 - 0.11637483297988077im
   -0.2168812248314937 - 0.08862827163006215im
    0.1552534434766974 - 0.03797837600492195im
   -0.1669608135986792 - 0.22642925120449522im
   0.01909082049696936 + 0.04374833463414499im
 -0.019095642055737053 - 0.11026372455603033im
  -0.06954674199211636 - 0.05151585188741244im
  -0.04559664304895079 + 0.008297712625087297im
  0.037528374681866504 - 0.11324987548284843im
  0.023620089530570244 - 0.2874639729906908im
  -0.09088380746026203 + 0.017356058827775092im
   0.11978223606993944 - 0.08107145570826786im
   0.20577368297898987 - 0.013652296778805507im
  0.011395364060657099 - 0.19889052375526525im
   0.03645271803692661 + 0.2829629931190536im
   0.18204138832027333 - 0.1555244114095489im
   0.07555139951129654 - 0.10123440143071967im
   0.02267773669402472 - 0.030429617073225154im
  -0.03760258716278911 - 0.0758644454098086im
  0.052233204376049724 + 0.09594521884812587im
 -0.053924691626857674 + 0.13704428172750593im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 1 March 2023 19:13">Wednesday 1 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

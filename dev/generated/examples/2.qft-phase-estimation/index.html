<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0474839-0.0874808im    -0.0706075-0.10894im      -0.0278381-0.137603im      -0.159568+0.0446148im     0.0158424+0.119677im     -0.12522+0.170664im       0.118125+0.064877im      -0.039634+0.144731im      0.0713365+0.245904im      0.0125862+0.0324203im    -0.172276+0.0331773im    -0.0497351-0.0857791im     0.207022-0.142852im      0.0524174-0.060873im       0.261259+0.0960671im      0.257293-0.0240977im     -0.128387+0.101396im       0.170642-0.0798403im     0.125864+0.197851im     -0.0110392-0.0603424im      -0.112971+0.007583im       0.0428267+0.171567im     -0.041331-0.113454im       0.177176+0.0610897im     0.0510271-0.189327im      -0.0422022+0.0974034im    -0.12613+0.123868im   0.00951972-0.0564096im     0.108028-0.196625im     -0.0747166-0.119646im       -0.294722+0.00937224im    0.0311992-0.217858im
   0.181484-0.195561im      -0.043447+0.0117872im     0.0913168+0.119886im      -0.107497+0.147247im    -0.00168046+0.146832im   -0.0674179-0.155253im      0.0330516-0.0360932im      0.165956+0.208537im        0.02887+0.0472478im      -0.11954+0.188725im       0.24065-0.145085im      -0.046208-0.0659692im   -0.0236254-0.170579im      -0.181598+0.124461im     -0.0777951+0.153032im    -0.00749271+0.137791im    -0.00108083-0.0685951im     -0.201612+0.0830313im     -0.23507-0.13158im      -0.0577513+0.00717678im     -0.131775-0.0830762im       0.112053+0.0243913im    0.0744812-0.168952im     -0.0343239-0.0108504im      0.135546+0.0613223im      0.0335728+0.0832766im  0.00713197-0.0738505im  -0.0646067-0.071112im    0.00892461-0.402164im      0.0197021+0.160784im        0.100255+0.0830307im     -0.147908-0.0965928im
  0.0749793-0.114113im      -0.127175+0.129879im      0.0581379+0.119596im      0.0845696+0.0794431im     0.0978808-0.0755794im    0.188602-0.146248im      0.0505236+0.0328222im    -0.0472313+0.0331255im     0.0726233+0.0791996im    -0.0353211+0.0335302im    -0.182233+0.0680227im    -0.0737614-0.138123im       0.12254-0.175377im      -0.227983+0.118239im      0.0484841+0.0387724im     -0.162158-0.291473im      0.0988702-0.201403im       0.147311-0.0932575im   0.00430853+0.180359im      -0.116686+0.164116im       -0.119363-0.0439862im      -0.168226+0.231079im    -0.0431306+0.0270227im    -0.0507266-0.0579669im      0.145507+0.128411im      -0.0185515-0.20007im    -0.0640649-0.0803379im   0.0128832+0.157621im     -0.131289+0.156554im     -0.0663851+0.115365im        0.100663-0.206433im       0.096416-0.198752im
 -0.0488739-0.0222441im     0.0350165+0.0107534im     -0.258746+0.0743583im   -0.00998749-0.0563996im     -0.114424+0.0494563im   -0.121396+0.122658im      -0.101921-0.0133635im      0.173562-0.0858909im      0.450424+0.0771084im     0.0037283+0.201923im     -0.146154-0.134899im      -0.168487-0.00678986im   0.0144432+0.0632873im     -0.213042-0.0587708im     -0.180918-0.197543im     -0.0533874+0.165269im      0.0512067+0.0408657im    -0.0262418+0.081831im     0.0332965+0.0947505im      0.196544-0.0605058im      0.0294513-0.0327236im      0.0918849+0.0213463im    0.0530869-0.204713im      0.0402816-0.0123522im    -0.0143451+0.342513im     -0.00558196-0.0545336im  0.00456252-0.0124im      -0.110001-0.0346128im    0.0310145+0.146152im     0.00448864+0.0418033im      -0.208149-0.0933035im       0.14815-0.0242167im
  0.0161334+0.210947im     -0.0571449+0.120749im      0.0405522+0.21882im        0.155848-0.0759998im     -0.157491+0.0895027im    0.145425-0.188362im       0.125614-0.11342im     -0.00435184+0.124594im    -0.00709696-0.0625625im     0.0187189+0.0031967im    -0.191606+0.0652208im     0.0803506-0.179031im      0.043949-0.0640039im    -0.0570768+0.0647685im     0.0610539-0.0586314im      0.246502-0.159144im       0.060557-0.00602945im     0.208966+0.127051im     -0.207006-0.0748611im      0.277244+0.150111im       0.0694806-0.109116im        0.141484+0.0297055im   -0.0913633-0.0352231im    0.00872728+0.0820322im     -0.153726+0.0979451im      -0.111133+0.234958im    -0.135665+0.0186231im   0.0301843-0.0540459im     0.036773-0.0247153im      0.138427-0.0158118im      -0.133768-0.0256316im      -0.20141+0.253752im
    0.16766-0.041669im       0.151272-0.0499258im      0.214589+0.160728im       0.121318+0.237921im     -0.0244515+0.0358172im  -0.0947997-0.187941im     -0.0141141+0.151393im      0.0256212-0.036392im      0.0632726+0.0245965im    -0.0988517-0.0486215im    -0.130518-0.143397im      0.0521746-0.133978im     -0.281014+0.080902im      0.0247819-0.0576175im     0.0843617-0.0993928im     0.0351386+0.137586im       0.146898+0.0950806im      0.173727-0.2182im        0.125553-0.0161477im     -0.245638-0.0914314im       0.320424-0.0312596im     -0.0166576+0.155987im     0.0409858-0.132977im     -0.0369214+0.05443im       0.0499102+0.040666im        0.195283-0.0392756im   0.0766076-0.128313im    0.0354361+0.0433803im    0.0542128+0.0576495im   -0.00323626-0.225458im        -0.10334+0.047671im      -0.210013+0.0111625im
   0.265255-0.0654277im    0.00589375+0.122473im      0.0329882-0.142371im     0.00852116-0.054833im      -0.199585-0.0267684im  -0.0757072+0.0333573im    -0.0290131-0.0119983im      0.144121-0.172901im     -0.0204794-0.272745im      -0.170989-0.264301im    -0.0543499-0.042702im      -0.165909-0.192619im     0.0703413-0.109586im     -0.0128476-0.176864im      -0.188078-0.0597348im      0.219094-0.0392649im     -0.073742-0.0381647im    -0.0816892+0.0883485im    0.0412538+0.120677im      -0.212798+0.064739im       -0.101133+0.0742843im      0.0146715+0.0755391im  -0.00652232-0.101154im      -0.140842-0.230923im     -0.0963368-0.10164im     -0.000960248+0.0110726im   0.0953123+0.291219im   -0.0505863+0.0304041im     0.132961+0.0344681im      0.204258+0.0356737im      0.0646521-0.158843im     -0.0770399+0.010569im
  0.0646395-0.0331903im     0.0849855+0.108351im    0.000230289+0.282476im      -0.122466+0.0397676im      0.151508+0.111142im    -0.152273+0.163054im       0.165164-0.350751im     -0.0875448-0.231376im       -0.19839+0.0767286im     0.0156905+0.114581im     -0.161744-0.0562777im      0.135196-0.027322im      0.114063-0.0241885im     0.0362934-0.0404842im    -0.0682809-0.0268999im     -0.123632+0.0473247im      0.113002+0.0352934im     0.0179331-0.0622025im     0.118457+0.0732248im       0.14481-0.0486717im       0.172919-0.152799im         0.10122+0.166331im      0.105692-0.117999im      -0.166909+0.0419876im    0.00127533-0.278487im      -0.0129756-0.0180453im   0.0276951+0.151065im   -0.0430064-0.131628im    -0.0500461+0.0642097im    0.00256725+0.25898im         0.176443+0.0505587im     0.0308424+0.019791im
   0.167987+0.18302im      -0.0800278+0.0326112im    -0.0480542-0.0624982im    -0.0429718+0.138056im      0.0315752+0.0250446im    -0.06047+0.0964899im     -0.113544+0.108975im       0.119922-0.133068im     -0.0403462+0.0354933im     0.0303292-0.171443im     -0.135454+0.099179im       0.231994+0.182276im     0.0851034+0.0690917im    -0.0478382+0.0713377im    0.00555919+0.139848im     -0.0347461+0.0378103im   -0.00140452-0.0427479im      -0.23184-0.2221im        0.152502+0.165884im      -0.126596+0.0322381im      0.0184319+0.0108927im       0.209361+0.117561im    -0.0667161+0.16311im       -0.118999+0.0515362im    -0.0314479+0.320215im      -0.0509448+0.224203im    -0.113857-0.108117im    0.0371697-0.215244im     -0.208725-0.182262im      0.0681488+0.0571277im     -0.0330944-0.191498im     -0.0399125+0.103254im
   0.250837-0.0297599im      0.050602+0.128681im      0.0450086-0.0174818im     0.0257738+0.184663im        0.11813+0.163141im    0.0781729+0.0107872im     0.0277949+0.137094im     -0.0918262+0.134857im      0.0288356-0.130785im       0.147949+0.265221im     -0.205094-0.217414im       0.032479+0.242229im     0.0725764+0.0182801im      0.177915-0.290248im     -0.0851235-0.180249im      -0.223904-0.103209im      -0.202268-0.0926835im      0.106621-0.0145146im   -0.0376826-0.133399im       -0.12953+0.141749im       -0.121911+0.0123801im      0.0267477-0.19175im    -0.00892544+0.0571798im       0.13708-0.00428492im   0.00217668-0.0665373im      0.0692816+0.135537im    0.0148116-0.0290246im  0.00453611-0.0920871im     0.146801+0.0498604im     0.0248893+0.133537im      -0.0812721-0.155438im    -0.00231025+0.0591444im
  0.0309985-0.353207im      -0.257191+0.0486514im     0.0397865+0.00450949im  -0.00937863-0.0555001im    -0.0125213+0.187243im     0.117135-0.132867im     -0.0558865+0.120677im      -0.116995+0.00128041im     0.111542+0.0572782im     0.0547127-0.208849im     0.0311732-0.156041im      -0.127678-0.05665im     -0.0531911+0.121163im     -0.0411977-0.153701im       -0.12155+0.367274im     -0.0777969-0.0376269im     -0.127425+0.112058im      0.0298169-0.0797627im     0.120564-0.0832276im      0.173731-0.180078im         0.21944-0.0714158im       0.128054-0.110191im    -0.0290845-0.00325499im     0.041955-0.156427im      -0.107034-0.0424192im      -0.118926+0.0830896im   -0.251589+0.0526301im   0.0960035+0.0110174im    -0.135684+0.147074im     -0.0577996+0.0658433im      0.0772341-0.0282793im    -0.0497171+0.0155945im
 -0.0221615-0.0757014im     -0.039845-0.156839im    -0.00371323-0.144408im      -0.252153-0.029989im       0.127949-0.103184im     0.135506-0.00821338im     0.138938+0.00349968im   -0.0950195+0.103431im       0.155626-0.0798795im   -0.00128333+0.0887307im   -0.0470793-0.209003im      0.0843791-0.230019im      0.018374-0.11717im        0.150957+0.183331im      -0.128824-0.0237977im      -0.12602+0.132637im       0.200664+0.0893732im    0.00165023+0.0306728im    0.0677252+0.353903im     -0.0345175+0.181944im       0.0670965-0.204684im        0.133543-0.153363im     0.0332464+0.263077im      -0.118004-0.186007im     -0.0366791+0.00875248im    -0.0745489+0.153084im    0.0994604-0.0569062im   0.0372841+0.139139im      0.115637-0.031941im       0.045492-0.119202im      -0.0119782+0.0662658im   -0.00835499+0.112987im
 -0.0819914+0.144478im      0.0919684-0.233912im       0.150199-0.249316im     -0.0346791+0.00429935im    -0.061186+0.255604im     0.285595-0.122548im       0.216421-0.142516im      0.0524009-0.0484838im    -0.0192922-0.0749448im    -0.0372059-0.0155634im    -0.107194-0.246404im       0.193372+0.024654im     -0.214585+0.0152843im     0.0781191-0.0130335im     0.0646002+0.100197im      0.0279595-0.0819985im    -0.0113944-0.171808im     -0.0953478-0.104672im    -0.0216186-0.0805413im     0.0578223-0.0257769im     -0.0463836+0.0355975im        0.16337+0.0469489im    0.0692502-0.0592469im    -0.0688188-0.00476813im   -0.0882136+0.169263im       0.0238122-0.2504im     -0.0103254+0.220095im   -0.0647501+0.0182651im   -0.0601296+0.006978im       0.085098+0.0823974im      -0.149311+0.0575039im      0.208885-0.218075im
  0.0434281-0.107675im       0.174039+0.00542839im    -0.101624-0.15692im        0.255924-0.0584295im    -0.0589645-0.195483im    -0.106033-0.0358883im    -0.0537531-0.129461im      0.0931072+0.176178im     -0.0325628+0.0308399im     -0.134902+0.0659381im    0.0632278-0.112021im       0.234318+0.257792im     0.0931599-0.154079im      0.0455772-0.139283im      0.0844002+0.176606im       0.116993-0.181672im       0.192575-0.163837im      0.0684315-0.0309488im     0.256634+0.0985611im     0.0870997-0.104295im        0.162813-0.0390912im      0.0136192-0.121712im    -0.0238708-0.140194im       0.151649-0.155296im        0.18917+0.10033im        -0.170883+0.0108003im   0.0439454-0.0872185im  -0.0536841+0.112318im      0.107723+0.00487469im     0.122929+0.130779im        0.065616+0.0681699im    -0.0539377+0.0866166im
  -0.021225+0.0644363im       0.02277+0.204557im      0.0558291+0.0441311im   -0.00198716-0.255919im      0.0862855+0.126863im    -0.117361+0.220014im      -0.085797-0.206437im     -0.0438439+0.194382im     -0.0910908-0.0719038im     0.0710356-0.403776im    -0.0223741-0.301621im     -0.0552494-0.0233103im    -0.118863-0.209267im      -0.144081-0.047791im      0.0254644-0.142572im     -0.0433817+0.0710708im     0.0120933+0.019099im      0.0246763+0.0199833im    0.0852512-0.0197867im      -0.10367+0.227644im        0.108964-0.0401571im      0.0340657-0.199379im    -0.0452887+0.0254098im      0.089067+0.262027im       0.134016+0.128862im       -0.048346-0.0721162im  -0.0893992-0.0232925im   0.0952207+0.0466628im   -0.0368941-0.107891im      -0.100806-0.0473658im      0.0104944-0.0118651im     0.0294735-0.166533im
   0.110287-0.0940378im     -0.128235+0.0638462im    -0.0348347-0.0762743im      0.189549+0.0253291im     0.0433471+0.0767533im  -0.0529418+0.153738im      -0.139293+0.2182im         0.224312+0.181362im      0.0390053+0.0590407im      0.149815-0.0775658im   0.00214201+0.0194546im      0.240144-0.0838567im   -0.0987772-0.0317128im      0.210069+0.258153im     -0.0885539+0.0633224im    0.00187844-0.189869im      0.0886005+0.0768111im   -0.00423436+0.111217im    -0.0308854-0.0181869im      0.155472-0.0029678im      0.0388144-0.0879199im     -0.0592098-0.0393093im    -0.105416-0.0800463im     -0.284122+0.108738im     -0.0508294-0.0200852im      0.0348311-0.136616im     0.225011+0.115919im    0.0805257-0.253263im      0.242444+0.0963443im     -0.198079+0.0557138im    -0.00476782-0.0511929im     0.0162649-0.124995im
  0.0705846-0.0855639im     -0.112855+0.0178077im    -0.0524472-0.0921462im       -0.2283-0.189241im      0.0328323-0.0279371im  -0.0966371-0.189951im      0.0989261+0.037503im      -0.225072-0.00487242im     0.194014-0.117764im       0.064587-0.0481918im     0.124878-0.0554697im      0.242304+0.162187im    -0.0712228-0.0755213im     -0.097458-0.0726131im    -0.0631372-0.00798247im    0.0738125+0.0913422im     -0.069656-0.202586im      0.0167257+0.0197989im     0.127458+0.0556278im      0.126744+0.0603192im      -0.149048-0.170495im       -0.211081+0.229026im     -0.202425-0.0906805im      0.114961+0.201092im     -0.0713582+0.0206895im       0.193555-0.0104549im    0.236039+0.0789257im   0.0174139-0.136222im     -0.187306+0.107816im       0.021121-0.0719816im       0.028864+0.0715109im     -0.184538+0.0908409im
 -0.0775003+0.00855113im    0.0415061-0.0488805im     0.0776463-0.059158im       0.386649+0.0483356im    -0.0788644+0.151322im   -0.0998206-0.072361im      0.0414919+0.0813926im     0.0259363+0.0246377im     -0.098103-0.129395im      -0.244472+0.118805im    -0.0656588-0.0548109im     0.0490445-0.060545im      0.139226-0.136107im       0.037926+0.00345059im    -0.186281-0.127529im     -0.0158778+0.17312im      0.00272582+0.167047im     -0.0253644+0.0636188im    0.0997981-0.0155069im      0.108008-0.161038im       -0.074618-0.0686643im      -0.038658+0.117125im     -0.208821+0.228157im        0.12235+0.090186im      -0.120782-0.00364277im    -0.0288345+0.269248im    0.0929657-0.028584im      0.10038+0.0839037im    -0.222317+0.0198311im    -0.0354571+0.00859975im      0.144727+0.0253119im      0.156701-0.322281im
  -0.100174-0.104623im      -0.305501+0.0384987im      0.221043+0.104385im      0.0538536+0.0810902im      0.012319-0.0587745im  -0.0676753+0.12178im       0.0419246-0.188497im      -0.113765-0.116667im       0.074883+0.169574im      -0.201686+0.0183317im    0.0403733-0.000355489im   0.0518042+0.0287823im   -0.0148086+0.0787199im      0.130774-0.0551802im    -0.0204197-0.0887936im   -0.00303483+0.134931im     0.00438107-0.176262im       0.174241+0.0639741im    0.0135155-0.0812406im     0.0930095+0.07804im        0.0686388+0.174065im       -0.112094-0.0370577im    -0.220636+0.198399im    -0.00176222-0.285317im      0.0906118+0.227747im       0.0644559-0.0875943im  -0.0422728+0.10592im      0.084402-0.292913im       0.16335-0.173095im       0.174868-0.109602im       0.0284851+0.0132369im     0.0223153-0.102459im
  -0.107179-0.0796401im    -0.0575565-0.0452676im    -0.0685335-0.0545114im     0.0373155+0.172559im       0.142679+0.122066im   -0.0979267+0.175087im    -0.00129768-0.0788587im      -0.15337+0.0685519im     -0.046162-0.00424535im    -0.113525-0.0424813im    0.0846846-0.00759776im     0.042214-0.0951964im    -0.169101-0.175771im      0.0623641-0.0982541im     -0.216782-0.0589758im     0.0282371-0.0284929im      0.121564-0.225714im      -0.113518-0.0819946im    -0.225066+0.0408171im     -0.112208-0.16169im       -0.0481431+0.143592im       -0.282074+0.0584771im   -0.0171746-0.0484171im      -0.17401+0.0552335im    0.00414834+0.016834im       -0.247057+0.193126im     -0.18725-0.0444455im  0.00984525+0.0248069im   -0.0683367+0.209625im     -0.0509171+0.06909im        -0.344186+0.108301im     -0.0441777+0.158765im
   0.151175+0.119707im     -0.0337374-0.206767im     -0.0341052+0.101216im      0.0899091+0.0578124im     -0.170013+0.0349171im  -0.0442064+0.0550954im     0.0922201-0.0528651im    -0.0643903+0.161018im     -0.0351112-0.190127im     -0.0458588+0.232533im     0.0202447+0.0680084im    -0.0745007-0.0834574im    -0.161125-0.0186533im     -0.178238+0.06179im       0.0731937+0.120662im      -0.137053+0.04027im      -0.0240976+0.0369041im    -0.0749507+0.0349971im     0.169725+0.226335im     -0.0685203-0.119388im        0.124862+0.000540177im    -0.248796-0.224376im     -0.092473+0.171118im       0.127513+0.121406im      -0.139528-0.0429566im      -0.091749-0.259946im    -0.135374+0.222718im    -0.168963-0.185077im    -0.0014529-0.0703284im    -0.0306582+0.0584238im    -0.00902256-0.186774im        -0.1467+0.0895837im
 -0.0773909+0.166999im      -0.130521+0.204594im      0.0471415-0.210987im      -0.068502+0.258486im     -0.0616523+0.238012im    -0.138572+0.159344im     -0.0449799+0.20392im       0.0527631-0.103334im     -0.0557838+0.0585609im     0.0240581+0.0670443im     0.194649+0.104558im      0.0726579-0.0772246im   -0.0733507+0.0277302im      -0.16854-0.104101im    -0.00493495-0.0280072im    -0.0188763-0.0427005im     0.0308737+0.0622249im      0.106502-0.0301552im    0.0647953+0.0775388im      0.147875+0.105656im      -0.0525796-0.246706im      -0.0556809-0.0563631im    0.0972998+0.10465im       0.0415524+0.0595317im   -0.00767792-8.642e-5im       0.0649739-0.167482im    -0.113105-0.040382im    0.0894418+0.256901im      0.104079+0.0393685im      0.379293+0.156355im       0.0121832+0.18327im       -0.117999-0.042364im
  0.0913755+0.23587im       -0.107916-0.211423im     -0.0770366+0.0998871im      0.114552-0.0734058im     0.0459161-0.179654im   -0.0908758+0.0762902im    -0.0332865+0.136082im      -0.122269+0.201391im      -0.170327+0.0773211im    -0.0505816-0.102469im   -0.00998268-0.21078im       -0.190564+0.0612384im    0.0212799+0.04704im        0.085315-0.0970573im    -0.0123936+0.0344715im     -0.193782+0.0214752im     0.0747348+0.137975im      0.0435212-0.0441253im    0.0244654-0.099772im         0.1835+9.60763e-5im     -0.246313-0.0937116im      0.0996666+0.12461im      -0.224651-0.0295803im     -0.272203-0.136267im       0.146341+0.00379883im      0.159793-0.0784302im  -0.0505586+0.0997628im   -0.245083+0.148908im     -0.112787-0.0210692im     0.0861876+0.0440922im      -0.145874+0.0388679im     -0.155426+0.0365362im
 -0.0437069+0.219851im      -0.137886+0.109403im     -0.0679534-0.0682019im     0.0134879-0.0425654im      0.167415+0.345207im    0.0781962-0.175988im     0.00230084-0.189423im       0.184916+0.0571276im      0.132758+0.0870751im     -0.156306-0.0402655im     0.088122+0.0716231im     0.0517062+0.0668091im    0.0353441+0.0424598im     0.0170469+0.049532im      -0.143894+0.0967586im    -0.0280895+0.101949im       0.151265+0.0133986im    -0.0415772-0.0416496im     0.172172-0.0296197im    -0.0409099+0.127588im    -0.000415563+0.115947im      -0.0606191-0.0177389im    -0.203015-0.103793im      0.0120527-0.017382im     0.00369097-0.329604im        0.117439+0.0237505im   -0.110366-0.19902im     -0.314131+0.055094im      0.147857+0.0659958im     0.0229234-0.187185im       0.0166694-0.195468im      0.0871259+0.0480804im
  0.0857022+0.136846im    -0.00525339+0.0508471im      0.167168+0.182011im      0.0178304-0.0284865im       0.10342-0.184175im   -0.0138974+0.0844607im      0.200359-0.0794903im      0.245752+0.0329871im    -0.0301662-0.0368196im    -0.0819807+0.0711645im     0.259205-0.0147757im     0.0132165-0.0147686im   -0.0200345+0.159421im      -0.140823-0.126731im      -0.011912+0.12098im       0.0708649-0.0379251im     -0.188442-0.00570435im     0.108852-0.0465063im    0.0533971+0.0964176im    -0.0661788+0.060096im       -0.110873-0.197173im       0.0563482-0.216479im    -0.0323627-0.0794876im     -0.119616-0.121903im      -0.100947-0.0937472im      -0.167072+0.0212696im    0.153123-0.207724im     0.116816-0.179368im     -0.204205+0.204466im     0.00911306-0.114814im       -0.273836+0.0350333im     0.0871276-0.191467im
     0.1706-0.0681171im      0.236455-0.105149im      -0.106501-0.0299295im     0.0744651+0.0416713im     0.0300929+0.127618im    0.0801909-0.166917im     -0.0784779-0.180672im     -0.0967722-0.0013688im      0.183015+0.0849581im      0.101375-0.129092im     0.0870099+0.0116984im    -0.0950719+0.0828821im    -0.179342+0.115139im       -0.13667-0.131386im       0.141642-0.0851096im      0.217032-0.00111488im     0.109924+0.136663im     0.00501245+0.219674im     0.0196611+0.0650136im   -0.00941268-0.0443791im      -0.111322-0.0840522im    -0.00265419+0.113498im      -0.12392+0.377935im      -0.188437-0.041669im       0.175578-0.159328im     -0.00720381-0.0299785im  -0.0137218-0.136343im     0.160934-0.144794im     0.0551228-0.0265744im     0.0436325+0.25959im       -0.0766537-0.0115681im      0.131131+0.0230968im
 -0.0528379-0.0984645im      0.152057-0.0393823im     -0.159946-0.0235823im    -0.0716414+0.0745707im     0.0467493+0.0740105im    0.128176-0.0466309im      0.118967+0.038331im         0.1698+0.141952im       -0.20571+0.155201im      0.0811113-0.10012im      0.0380267-0.0521916im     -0.187093+0.0292742im     0.309414-0.00422845im  -0.00383606+0.169338im      -0.072534-0.254024im       0.129434+0.0710473im     -0.246596-0.354729im     -0.0177333+0.0274589im     0.084317+0.0237082im     -0.002184-0.178734im        0.271597-0.111087im      -0.0121823-0.067107im     -0.144445+0.127352im      -0.141384+0.00240348im    -0.097916+0.0365609im       0.178914-0.113436im   -0.0755495-0.074071im    -0.044636-0.0137324im  -0.00814616+0.0912051im     0.0866056-0.000604086im   -0.0329027+0.0455458im     -0.174258-0.0480696im
 -0.0188286-0.212731im       0.111442+0.164565im     -0.0744303+0.0119322im     -0.110275-0.0398983im    -0.0382829+0.0245324im    0.161538-0.0340092im     -0.110907-0.0227593im     0.0724273+0.120993im      -0.186665-0.0689335im    -0.0297545+0.133488im     0.0508242+0.192749im       0.182195+0.109991im     -0.112847+0.0926719im      0.135316-0.178831im     -0.0116882-0.146841im     -0.0722197+0.0909098im     0.0969738+0.102947im        0.10448+0.222029im     0.0234667+0.139964im      -0.155557-0.0508878im       -0.18733-0.154127im        0.154489+0.114956im    -0.0961393-0.111141im      -0.102339-0.0231972im     -0.061909+0.150853im       -0.113199-0.121027im    -0.393463+0.101092im   -0.0519442-0.0272013im   -0.0390556+0.0250107im    -0.0849419-0.258585im        0.103512+0.0510224im    -0.0731686-0.10104im
  0.0485098-0.0247761im     -0.186359-0.0789229im     0.0948344-0.174728im      -0.183865+0.0677566im      0.205885-0.303524im    0.0398213-0.0348509im      0.224628+0.0743693im      0.130207-0.0407813im     -0.124402-0.0850731im       0.10475+0.113557im      0.105055-0.0325616im    -0.0983483+0.0513759im    -0.162475-0.0820085im     -0.138684-0.0923552im    -0.0670628-0.212188im       0.125617-0.15285im        0.091669+0.168973im     -0.0595823-1.17923e-5im   0.0155374-0.161654im       0.119931-0.128642im        0.228317-0.0108156im       0.021376+0.0873574im    -0.116585-0.0299106im    -0.0216541+0.214926im       0.183197+0.0275905im     -0.0969568+0.131818im    -0.120391+0.0407003im  -0.0693787-0.0294872im    0.0942184+0.0149343im      0.139155-0.0695774im      0.0933617-0.268839im       0.163137-0.0505677im
  0.0584063-0.0486986im      0.221941+0.0338163im     -0.166852+0.186247im       -0.12013+0.0447856im      -0.15161+0.0494296im    -0.20253-0.0131463im     0.0820541+0.0834389im   -0.00676441+0.113146im      0.0859189+0.0869674im      0.164156+0.0109312im   -0.0426219+0.0432752im     -0.145751+0.0276123im   -0.0880689+0.0114987im      0.212431-0.0590603im    -0.0060817+0.163933im       0.125092-0.0773322im      0.144183-0.0291174im     -0.160555-0.225924im     -0.165638-0.0787654im   0.000983102+0.281073im       0.0704298-0.0300896im     -0.0978914-0.0197991im    -0.116108+0.169466im      0.0315075-0.00148591im   -0.0358021+0.039328im       -0.164789+0.0536557im  0.00818016+0.0691096im    -0.20855-0.0665496im   -0.0768719+0.156526im       0.248246-0.17625im         0.194387+0.113273im      0.0934994-0.246411im
   0.105769-0.176588im     0.00163171-0.066993im      -0.203508+0.00816934im    0.0339388-0.0436704im    -0.0312363-0.0153489im    0.075465+0.185626im      0.0968002-0.272105im     -0.0317974+0.112521im       0.126608-0.115404im      -0.133132+0.0251438im     0.156479+0.101567im       0.105528-0.00397782im  -0.0345868+0.273769im       0.145167+0.14433im     -0.00469083-0.024193im       0.124424+0.0520422im     -0.177792+0.149855im       0.194957-0.34582im      -0.102063-0.00915344im   -0.0241991+0.0367121im     -0.0216963-0.0131675im      -0.075202-0.0653705im   -0.0252036-0.0590329im     -0.102186+0.155437im      0.0334201+0.130991im        0.182612+0.123847im   -0.0373556+0.0569749im   0.0869332+0.290371im   -0.00681293-0.0238637im     0.0673265+0.180087im       0.0830386-0.225196im     -0.0422975-0.0761459im
 -0.0734224+0.0425186im      0.130003+0.194672im       0.219772+0.116569im     -0.0989364-0.147004im     0.00306698-0.0357369im   -0.128208-0.0802658im      0.182674+0.0585634im     -0.156237+0.154578im      0.0865919+0.216248im      0.0352067+0.0448405im    -0.122947+0.000773708im    0.107079-0.0559209im   -0.0670974+0.275099im      0.0507386+0.0456048im     -0.225282-0.100787im      0.0964291-0.291831im     -0.0510149+0.0957817im     -0.291697+0.16889im       0.283053+0.0417396im    -0.0337054-0.113431im      -0.0697624+0.159006im       -0.158192-0.0772093im    0.0145794-0.054687im     -0.0952309-0.0306778im    -0.0586461+0.0608158im      0.0112821+0.0269532im  -0.0422207-0.0350166im   0.0184981+0.192041im    -0.0330281-0.202374im      0.0472429+0.0894649im     -0.0471209-0.0248814im    -0.0660656-0.068607im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 0.010097168312745748 - 0.07661928399470506im
  0.15019272330639005 - 0.16501784117598323im
 -0.04484843783047198 - 0.03694793699192479im
 -0.05774379701173874 - 0.0609968912736326im
 0.024047160659825935 - 0.06046385547105218im
   0.4391538203133013 + 0.0im
 -0.10371780715482358 + 0.03610818504750553im
 -0.13867072235807304 + 0.07745229032401628im
 -0.25224404674169854 - 0.05938508964202011im
 -0.07950575991861872 + 0.11607474585275963im
  0.10805418291367938 + 0.031602793142132664im
 0.027104170026479833 + 0.05842984152668684im
  0.09945893603931821 + 0.13990283696405623im
    0.205693058435163 + 0.041405258504406746im
 -0.10616172262063474 - 0.006359798254439005im
 -0.08143242290253605 - 0.08374724905363048im
 0.025908871217764185 - 0.15459739724298827im
 -0.03786861947637541 - 0.003161084563494927im
  0.13432247085976357 - 0.06663812668608063im
 0.058987985851853726 + 0.08308589712598448im
 0.023366329077785998 - 0.15614876315942677im
  0.01911517939518664 + 0.12380680609512597im
  0.06203626783532165 + 0.06170112505860241im
  0.08183531220232387 + 0.09197117341954485im
 0.029729058238065174 + 0.05620934578635327im
  0.19771135005996907 + 0.06697417824178366im
  0.10861287029241228 + 0.13541845468652644im
  0.11318151323872905 - 0.0731802561132812im
 -0.01168199936889556 - 0.15892638433613124im
  0.23924770184667957 - 0.22525012132224453im
  -0.3754184056155005 + 0.011020425418278636im
 0.056948446707162134 + 0.036099475127700835im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 15 December 2022 05:48">Thursday 15 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

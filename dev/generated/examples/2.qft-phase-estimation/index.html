<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0110022-0.203428im    -0.00796862-0.084783im    0.00160191+0.100374im      0.0290404+0.189217im     -0.0187435+0.0148158im      0.151147-0.241463im    0.0788929+0.054979im     -0.0986787+0.00248555im   0.0667253+0.0868751im     -0.226016+0.0995741im      0.0188658-0.227806im     0.0426969-0.175125im      0.0827512+0.138726im    -0.253328+0.0401121im      -0.15942-0.0879525im      0.120652-0.00734241im   -0.0340563+0.0545456im      0.077554-0.192979im     -0.0402142-0.063914im     -0.114391-0.200553im       -0.137208-0.161461im      0.0600159-0.0670288im    0.0437524+0.00755011im   -0.144535-0.202455im     -0.0755985-0.105171im     -0.0127593+0.0118199im      0.06665-0.0956393im     0.0990091-0.0829917im      -0.142585+0.141158im    -0.0998038-0.0434346im     -0.30049-0.109284im    -0.0285297-0.28404im
  -0.111213-0.0521033im     -0.148897-0.0720597im     0.042735+0.117875im     -0.0810973+0.271043im        0.03498-0.180005im       0.026993+0.0615172im   0.0933275+0.0828808im    -0.0758209-0.0422729im    0.0265415+0.00763524im     0.127846+0.123039im        0.167971+0.0355608im    0.0115671+0.103124im      0.0983712+0.196688im     0.154503-0.103356im       0.330269-0.0708036im    -0.0779611-0.276918im     -0.0417031+0.0795844im     -0.220726+0.00360383im   -0.0299568+0.016876im     -0.018678-0.00327623im    -0.0245283-0.0323233im     0.0335357-0.065048im    -0.0689375+0.169462im    -0.0872285-0.0428482im     -0.207556+0.090598im       0.173236+0.0210001im    -0.342647-0.0158367im    0.00710657-0.138813im      -0.0722349-0.0400579im     0.120984-0.286428im     0.0583745+3.16743e-5im    0.116075-0.0302315im
   0.161883+0.0289835im     -0.180387+0.0131322im   -0.0445582-0.117348im      -0.102681+0.102558im       0.133156+0.166716im      0.0146317+0.148648im    0.0678501-0.112176im      0.0133941-0.180365im    -0.0143002+0.2538im         0.125555-0.0709902im       0.273493+0.0287267im    0.0790579-0.0427869im    -0.0378505+0.0660448im  0.00330624-0.123391im      -0.245774+0.139528im     -0.0762095-0.329094im      -0.059657-0.0563605im       0.15817+0.107285im      0.0938518+0.0686982im    -0.166859+0.100447im      -0.0956542-0.00824084im   -0.0691643-0.0837237im    -0.150135+0.022617im     0.0265836-0.0687072im     -0.172915-0.0989187im    -0.0960433-0.013183im     0.0813152+0.106955im     -2.6794e-5+0.153215im        0.128161-0.0235011im    -0.154211+0.0163698im   -0.0368154+0.306255im    -0.0910374-0.149217im
  0.0158741-0.101253im     -0.0668134-0.0236961im    -0.149554+0.0600363im     0.0330975-0.200526im    -0.00771905+0.0489796im    -0.0865917-0.0325584im    0.106264-0.0985928im     0.0308172+0.0426452im     0.161311+0.183377im      -0.233454-0.0258494im       0.156579+0.132711im    -0.0740607-0.229122im     -0.0790409-0.0681458im    0.162255+0.203331im       0.203934-0.14036im      -0.0792684+0.0408064im      0.233506-0.0565046im      0.124302+0.0133958im      0.101837+0.224181im     -0.276138+0.0421033im    0.000606648-0.0640343im    -0.0952635-0.0497257im   -0.0117552+0.198562im      0.103092+0.0345459im       0.19102+0.0497696im     -0.042614+0.193349im     -0.122639+0.047831im       0.106398+0.0418831im    -0.00601375+0.278117im     0.0703924-0.0950587im     0.137063-0.0859971im   -0.0157994-0.119394im
  0.0681306+0.164834im       0.131241+0.130588im     -0.193428-0.0930064im      -0.10456+0.00412373im    -0.147573-0.0385091im     0.0129466-0.0498715im   -0.178528-0.051738im       0.204147-0.109316im    -0.0376225+0.064844im      -0.114218+0.142234im       -0.116391+0.10554im     0.00409837-0.174194im      0.0521361+0.040682im    -0.128202-0.199424im       0.135784+0.0454446im      0.174284-0.0389943im     0.0355497+0.187859im      -0.121905-0.0267323im      0.197891+0.00355148im   0.0825517-0.107225im        -0.16961-0.0528139im     -0.105792-0.0715412im    0.0201134+0.227918im      0.109511+0.255619im      -0.154383-0.0438718im      0.278772-0.195497im     0.0085697-0.111177im      0.0783741+0.0980024im      0.0317674+0.131137im     -0.229406+0.0201948im     0.111014-0.0215277im    -0.121562+0.00630424im
  0.0999912-0.0229496im     0.0777847+0.0329162im   -0.0208412+0.0176006im     0.0810895+0.00783254im     0.143777-0.0582295im    -0.0225647-0.145618im    -0.307011-0.0484562im     -0.082737-0.0456562im     0.043983-0.0806714im     0.0209194-0.00769999im    0.00185479+0.0839811im   -0.0538663-0.165059im      -0.131341-0.136214im      -0.2387+0.0945238im    -0.0948512-0.0655716im    -0.0869389-0.0868957im     -0.178794-0.0509129im     -0.308051+0.198666im       0.288309-0.0320424im    -0.107596-0.13064im         0.267969+0.0598161im     -0.173057+0.0723685im   -0.0484671-0.120297im     -0.111922-0.00226227im   0.00204376-0.0550704im      0.181646+0.211441im    -0.0331299+0.148673im      0.0978513+0.142175im      -0.0829793-0.0460483im      0.10123-0.210245im     -0.135719+0.0701427im    0.0713308+0.0115211im
  -0.186182+0.0312375im    -0.0729701+0.0280081im    -0.282532+0.0278929im     0.0136934+0.137073im     -0.0333372-0.133073im       0.053853+0.136534im   -0.0320077-0.077943im     -0.0504476-0.227043im     -0.264751-0.215313im     -0.0153957+0.145318im       0.0416642-0.105943im      0.154027+0.00167108im    0.0581848-0.0996268im    0.152124+0.235767im      -0.033297-0.0474722im    -0.0131614-0.0199345im     -0.206905+0.147704im     -0.0635329+0.0104428im    -0.0682154-0.0152116im    0.0121859+0.000217551im    -0.158381-0.0680771im     -0.207584-0.0616019im    -0.166822-0.0561181im   -0.0140878-0.121037im       0.131325+0.178079im     -0.0884021-0.00397915im    0.183737+0.0463425im      0.128186+0.193817im        0.226502+0.224939im     0.0657004+0.0402213im   -0.0240326-0.14038im       0.107891+0.0629514im
  -0.264943+0.0669519im      0.041597+0.0912875im      0.10403-0.259642im     -0.0487136+0.160269im       0.142597+0.258114im        0.18603-0.154157im    -0.169745+0.0304483im   -0.00450546-0.0324591im     0.142835+0.188644im     0.00433148+0.110729im        0.114756-0.0523736im    -0.305007+0.218346im     -0.0585377-0.0907588im   0.0816143+0.0504191im     0.0595465+0.0478394im     0.0645338-0.024835im       0.100023+0.0673891im     0.0967019+0.06863im     -0.00761755+0.0258412im    0.0568887-0.262913im       0.0433511+0.0795235im    -0.0566999+0.0208499im    -0.266793-0.0431832im    -0.223971-0.0379402im      0.151061-0.0553188im    -0.0515989-0.158093im    0.00381256+0.0817107im    -0.0416464+0.000193619im   -0.0171039+0.0757376im   -0.0536084-0.063352im      0.160936-0.176884im    -0.0566327+0.0546833im
  -0.141056-0.0867638im    -0.0539829-0.0831056im    -0.272458+0.0369752im     -0.123807-0.0374353im    -0.0902242+0.0701348im      0.141101+0.0781125im    0.336473+0.172419im       0.263765-0.0940709im    -0.133528+0.0333364im    -0.0991218-0.0786164im     0.00450286-0.0871451im    -0.227346+0.196257im     -0.0348227-0.0478068im    -0.17308-0.0707416im    -0.0337654-0.039617im      -0.203305+0.00306895im   -0.0749665+0.0716131im    -0.0948624+0.0817774im      0.112454-0.0288388im    0.0956454-0.119086im       0.0776491+0.0588619im      0.101872+0.185981im     0.0181656+0.00931364im   -0.139283+0.21381im       0.0559684+0.0408039im   -0.00114271+0.29381im      -0.170632-0.0346567im   -0.00544481+0.0629637im       0.131643-0.0196095im   -0.0416329+0.157995im     -0.100745+0.0198212im    -0.136044-0.112191im
   0.123367-0.130704im     -0.0699495-0.0217754im     0.128166-0.0359876im     0.0858666-0.093817im      -0.161018+0.0317232im     0.0958939-0.155173im     0.284482+0.0280566im     -0.114842-0.0575529im   -0.0460582-0.332171im      0.0067721-0.21463im         0.101706+0.141622im     0.0475383+0.112157im      -0.213937-0.0433496im  -0.0507449-0.0359898im        0.1864+0.0530002im     0.0698712-0.0510135im     0.0991875-0.0769501im     0.0180984-0.137897im       0.106473-0.0946336im   -0.0876322-0.0427164im      -0.327632+0.172636im      -0.109316+0.135578im     -0.117407-0.0264718im    -0.111717-0.0545761im      0.052862-0.0272384im      0.200745-0.146144im       0.11862-0.00183837im  0.000600467+0.208864im        0.024692-0.0620941im    0.0877652-0.15424im     0.00238113-0.033022im     -0.217371+0.0111054im
   -0.11242+0.0928317im      -0.16146-0.0254579im    0.0586019-0.00525655im    0.0733538-0.105615im     -0.0707055-0.0536842im    -0.0107424+0.165022im     0.194036-0.130247im     -0.0375855+0.153392im     0.0213104-0.0134765im        0.1619+0.0569013im     -0.0845875-0.239753im   -0.00991294-0.18974im      -0.0545443+0.0212151im  -0.0260186-0.100878im       0.166295-0.14848im        0.097795+0.0491136im     0.0845557-0.0158898im      0.132764+0.10219im        0.236304-0.103029im    -0.0097415-0.15851im         0.203773-0.258745im      -0.224828+0.0706464im    -0.232011-0.183698im     0.0316087-0.0798124im     -0.254983-0.0708818im     -0.130666-0.0810612im      -0.1385-0.113225im        0.11877+0.0486639im     -0.0068705-0.0285658im    0.0691589+0.142007im     -0.038807-0.0316216im     -0.16671+0.161545im
 -0.0731381+0.0496262im      0.244163+0.113481im    -0.0731528+0.0763237im       0.12619+0.115982im     -0.0515901+0.0158309im     -0.164108-0.0679372im   0.0985647-0.00531508im  -0.00831079-0.0338326im   -0.0857612-0.139139im      0.0209717+0.271949im        0.139521-0.0499378im    -0.117664-0.187746im     -0.0773684+0.0444103im  -0.0439999+0.0732811im      0.107647-0.0929198im     0.0355782-0.0535646im    -0.0270343+0.00456577im     0.376586-0.153946im        0.25345+0.164878im      0.100947-0.041792im      -0.0964132+0.0357942im      0.237042+0.0668582im   -0.0456243-0.0789825im   -0.0731165+0.0567011im     0.0238173+0.0883543im   -0.00616095+0.0317957im   -0.0375316+0.0887175im     -0.167704+0.121837im      -0.0599548-0.196576im    -0.0562838+0.0227475im    0.0262847+0.254017im       0.29933+0.0423209im
  0.0678124-0.155426im       0.184891-0.229343im    -0.0825549+0.107179im       0.135557-0.0777316im    -0.0167911+0.00977455im    0.0830977-0.0171517im    0.143377-0.116852im       0.112566+0.00497287im   0.0105711+0.263447im     -0.0919721+0.150706im       -0.174212-0.138828im    -0.0149681+0.263949im      -0.172347-0.120227im    0.0152804-0.0842615im    -0.0292557+0.0610606im     0.0232015-0.10719im      -0.0534849-0.178157im       0.102092+0.030667im      0.0362652+0.0769155im    0.0878102+0.124944im       0.0143851+0.0520306im      -0.33109-0.0775935im     -0.05912-0.0606181im    0.0372813+0.0712671im     -0.104811+0.307272im      0.0893177-0.0764368im     0.146409-0.0804989im    -0.0130429-0.139153im       -0.102238+0.0117849im   -0.0702965-0.240529im     -0.107466+0.0063503im     0.161167+0.112323im
  0.0566145-0.110798im       0.183449-0.211492im      0.127649-0.0969362im     0.0209552+0.116417im      0.0496967-0.0886535im     -0.222081+0.0778632im   0.0949508-0.0593813im     0.0852645-0.245159im    -0.0890384+0.0638992im   -0.00899523-0.00355918im    -0.0643328-0.0807899im    0.0270642-0.134331im       0.190208-0.197976im    -0.156031-0.060562im        0.12538+0.00929033im     0.219424+0.0785393im     0.0836721+0.0644969im      0.052923-0.0508959im     -0.105319-0.128153im    -0.0293102+0.118463im        0.285544+0.0711774im     0.0204584+0.152994im     -0.225758+0.291587im    -0.0415593-0.222776im      0.0771211-0.00286628im    0.0905959+0.098384im     0.0393446+0.140803im      -0.183704-0.0413345im       0.214919-0.0205389im   -0.0465157-0.0783601im    0.0213406-0.00717292im   -0.113288-0.0104063im
  -0.152974+0.186424im     -0.0239474+0.0526804im   -0.0574167+0.0836809im    -0.0830706+0.0625986im      0.107973-0.0124867im    -0.0978981+0.0106551im   0.0125298+0.0461923im     -0.130349-0.0505511im   -0.0157191-0.0233571im    -0.0948197-0.299911im      -0.0293556-0.064073im     -0.284576+0.162599im      0.0632806+0.16515im     -0.221036-0.0837461im      0.160872-0.141226im      0.0970354+0.0783866im      0.106063+0.00035952im    -0.175753+0.0725205im      0.117037+0.163409im    -0.0139648+0.113518im      -0.0277857-0.0941684im    -0.0921413-0.121612im     -0.061745+0.0560437im     0.115451-0.186104im       0.234117+0.0320114im    -0.0435651-0.0879888im     0.235748-0.192265im     -0.0512221-0.0504442im     -0.0528918+0.0578752im    0.0392911-0.0132579im    -0.125046+0.365308im      0.062234+0.0254476im
   0.096745-0.200921im       0.133051-0.117437im     0.0405178+0.00801321im   -0.0831268+0.0834823im     -0.352994-0.194742im       0.301176-0.125472im   -0.0306715+0.0396591im     -0.030554+0.144809im     0.0294155+0.0296913im     0.0994879+0.120561im      -0.0516114+0.0136965im   0.00272366+0.00166729im     -0.05671+0.0793109im   -0.122955-0.00992413im    0.0249437-0.116255im      -0.144473-0.0758547im     -0.134178-0.0412926im    -0.0599177-0.0492971im     0.0284027+0.148263im    -0.0863246+0.0737617im      0.0764579-0.0435597im      0.098262-0.173851im     -0.222688+0.0375462im     0.078744+0.119521im       0.156611-0.271433im      -0.166468-0.0525266im     0.103079+0.153863im     -0.0543878-0.116197im        0.192916+0.107839im     0.0902523+0.0600536im     0.122157+0.150313im     -0.091481+0.220984im
  -0.077906+0.124299im      -0.156318-0.0028387im     0.312979-0.0372907im     0.0637583+0.182443im      0.0763547+0.117688im       0.110331+0.231775im    0.0066136+0.112329im     -0.0142512+0.163767im     -0.108777-0.130954im     -0.0223019+0.160697im     -0.00134079+0.0591582im   -0.0434502-0.0821898im    -0.0941573-0.101431im    -0.238986-0.0123373im     0.0701857+0.162851im      -0.157097+0.100867im      -0.019152-0.302181im        0.15265+0.016254im     -0.0266952-0.0354127im    0.0371405-0.128883im       0.0469493+0.135783im       0.042009-0.102297im     0.0117767+0.273282im      0.162612+0.113468im      -0.055602+0.0413556im      0.105252+0.0587096im    0.0905449-0.121371im       0.117857+0.0292362im       0.156253+0.26629im        0.08011-0.0213008im    -0.114603+0.0226404im     0.160637-0.0324704im
 -0.0508528+0.00903192im    -0.154148+0.136247im     0.0900235+0.286659im     -0.0962286-0.238891im      0.0783245-0.153389im    0.000708421-0.0333977im   -0.068004+0.105283im       0.161842+0.014257im    -0.0211124+0.212096im      -0.166088-0.17463im       -0.0698255-0.0750978im    0.0217939-0.03614im        0.145085-0.0784717im   0.0613056+0.216im          0.172999-0.00715491im    -0.069594-0.126788im     -0.0983884-0.124921im    -0.00699908-0.0526241im       0.15612-0.0104444im   0.00336942-0.148634im       0.0152382+0.0987273im     0.0591486-0.00565032im  -0.0782687+0.0461069im   -0.0832097+0.0186941im     -0.203634-0.0533858im     0.0220688-0.296878im      0.199247+0.167905im      -0.256718+0.000367209im     0.183687-0.0837166im     0.115195+0.104716im    -0.0914281-0.0943148im      0.12698-0.1112im
 -0.0141742+0.439177im      0.0894908-0.11946im     -0.0391954-0.0787508im       -0.3347-0.0161579im     -0.230426-0.0960172im     0.0231645-0.116036im      0.07728-0.0375008im     -0.147052+0.0222699im   -0.0560933+0.102574im      0.0498322+0.0186011im     -0.0154142-0.0765822im   -0.0126826-0.116889im      -0.201707+0.167389im   -0.0744787+0.117974im      0.0615967+0.087123im      -0.160961-0.0332924im     0.0415644-0.100714im      0.0105533+0.0515731im    -0.0892216-0.0463114im    -0.145557+0.0896976im      0.0426327+0.149008im     -0.0662158-0.0121521im    0.0866743-0.0990643im    -0.131224-0.224507im      -0.098643+0.0826157im      0.176305+0.180356im     0.0686635-0.0333976im     -0.260107+0.010611im      -0.0575943+0.0979522im   -0.0976161+0.122296im     0.0817241-0.170966im     0.0349021+0.00621411im
  -0.212542+0.154731im       0.212584-0.0532336im    -0.141359+0.191341im      0.0968264+0.00140898im   -0.0317627+0.223898im      0.0713588+0.0642867im   0.0139962+0.0113016im     0.0440487+0.11608im     0.00431306-0.095682im      0.0288257+0.0229116im       -0.12031+0.137343im     0.0217792-0.0874929im      0.181777+0.207301im   0.00423062+0.0213503im      0.173685+0.12568im        0.114046-0.210089im      -0.290508-0.205546im       0.123591+0.194999im     -0.0600528-0.0173771im    0.0145397+0.0131344im      0.0505046-0.0322223im    -0.0347125+0.0309711im     0.091193+0.108484im    0.00499022-0.028282im       0.103917-0.00319156im    -0.121174+0.0293117im      0.14858+0.157119im      0.0463367+0.0230705im      -0.137814-0.122893im     0.0831296-0.133989im     0.0294087-0.0661881im    -0.368828-0.149202im
  0.0378688+0.00497261im     0.155489+0.0868703im      0.13676-0.275805im       0.126236-0.189221im      -0.134186+0.0410698im     -0.110511-0.106887im     0.112223-0.0459369im     -0.100267-0.173231im    -0.0220892+0.0705253im    -0.0361927+0.100638im       0.0838613-0.0437799im     0.037135+0.0939364im      0.173589+0.176641im    0.0998173-0.0730496im    -0.0741554+0.0615725im     -0.157342-0.201304im      0.0495918-0.0264646im    -0.0678649+0.0175642im     0.0834286+0.119138im      0.199899-0.14056im        0.0969747-0.18095im       0.0470664+0.272905im      0.147948+0.0538573im   0.00785496-0.0861309im    -0.0376212+0.0421525im      0.123472+0.00803648im     0.18921+0.0389287im      0.104123-0.0971182im      0.0335623+0.248048im      0.371037+0.116638im    -0.0320959+0.0590728im    0.0183934-0.00471533im
  0.0953424+0.0880595im     -0.136353+0.190392im    -0.0436608+0.149929im     -0.0396881-0.228037im     0.00264655+0.0198281im     -0.108126-0.0369574im    0.231894+0.143554im    -0.00807552+0.120419im      0.127048-0.0202068im    -0.0547795+0.140075im       0.0474089+0.10394im     -0.0228936-0.0423587im     0.0339869+0.168362im    -0.186427-0.104354im      -0.152524+0.151337im      0.0329088-0.151203im       0.115663+0.156047im     0.00293411-0.137668im       -0.10545-0.176887im      0.115179-0.0761442im       0.248937-0.0675648im    -0.0935917-0.287016im     0.0274763-0.00329924im   -0.182313-0.0539229im      0.203516+0.121007im     -0.0406699-0.0140114im    0.0333201+0.115829im      0.0840955+0.0890907im       0.231902-0.0501931im   -0.0511341-0.195862im     0.0740171-0.0308654im    0.0992854+0.18545im
  0.0497634-0.0450581im      0.114457-0.139654im      0.116252-0.021453im      0.0374326-0.142379im       0.337129+0.0247947im     0.0818318-0.314955im    0.0822163-0.0231588im     -0.175162+0.105113im     -0.183562+0.0679668im     -0.115842+0.147992im      -0.0504704+0.0504027im   -0.0896108-0.0633545im   -0.00606125-0.0136485im   0.0798656-0.205112im       0.158003+0.0194054im    -0.0870498+0.0583292im    -0.0644425-0.114154im      -0.171303+0.202956im     -0.0489321-0.164508im       0.11467+0.120789im       -0.226481-0.272616im       0.039689-0.105057im    -0.0612769+0.0577888im    0.0177239-0.0566686im     0.0314349+0.0478218im    -0.0554777+0.0313397im    -0.132062+0.118555im     -0.0566323+0.248618im        0.124199-0.0491273im   -0.0925748+0.228437im   -0.00642753-0.0109117im    0.0695666-0.0330096im
  -0.205445-0.0470272im     0.0906817+0.00404764im     0.11432+0.0139146im     0.0821039+0.101548im      0.0133196+0.063973im    -0.00240037+0.136868im    -0.163323+0.173272im       0.294711+0.249108im    -0.0695301+0.223905im     -0.0399504+0.106994im      -0.0177005+0.0466905im     0.264022+0.140244im     -0.0160322+0.0523669im   -0.132073-0.0657895im     0.0717939-0.0261361im     -0.104855-0.0318412im      0.199162+0.0524729im     -0.106661-0.140227im      0.0758648+0.0751964im     -0.30133+0.144361im      -0.0521527-0.128306im      0.0840816+0.156607im     0.0615261-0.172321im    -0.0413822-0.219524im      0.0541358+0.116241im       0.128571+0.016609im     0.0884421+0.0262756im      0.137461+0.258658im       0.0553209-0.0989333im   0.00369313+0.0582322im    0.0294556-0.00874199im  -0.0319735+0.0972774im
 -0.0734102+0.0369632im     -0.151509-0.0528272im    -0.155106-0.0129282im     0.0617888+0.330512im      0.0342296-0.170103im     -0.0584517-0.102853im     0.108408-0.132993im       0.180806+0.0313648im    -0.198127+0.0483801im     -0.080646+0.00279592im   -0.00929936+0.195805im     -0.103326-0.126721im      -0.075956-0.119176im     0.087527-0.209514im     -0.0554779+0.228394im      -0.130366+0.0238893im     0.0450502-0.0498613im     0.0126401-0.112863im       0.147642-0.262316im     -0.102461+0.0436035im      0.0667772-0.0908449im     -0.120921+0.0868976im     0.217597-0.0315705im     -0.10797+0.000485835im    0.170546-0.160518im      -0.130896-0.229338im     0.0327244+0.0648645im     -0.108712-0.149026im       -0.183275+0.0656467im     0.196164+0.0248897im    0.0538023+0.0196662im    0.0754187+0.0153052im
   0.176416+0.218492im      -0.266626-0.121603im    -0.0776485-0.0550879im    -0.0751452-0.0176478im    -0.0702738+0.0942778im    -0.0426484-0.212393im    -0.191914+0.0386285im      0.159524+0.0688341im   -0.0954305-0.198694im       -0.14799+0.18826im       0.00475933-0.298548im     0.0154342+0.0364134im     -0.102842-0.193861im   -0.0679232+0.0870529im     0.0883407+0.0223888im     -0.148306-0.183524im       0.200054+0.027205im     -0.0364595-0.0747519im    -0.0880598+0.0390918im     0.204964+0.116155im       0.0428479-0.0940403im     0.0585156+0.0456703im    -0.113481-0.0209746im     0.229458-0.0750834im     0.0305681+0.028872im     -0.0750534-0.0411527im   -0.0149318+0.0891194im     0.0647503-0.0771692im     -0.0601098-0.173172im     0.0822131-0.136709im     0.0206065+0.082979im      -0.14803-0.232499im
  -0.150029+0.0081473im      0.252592+0.0881807im     0.108966+0.0344941im    0.00689988+0.0249031im     -0.116552-0.116471im      -0.227101-0.0776552im   -0.138535-0.117197im      0.0300563-0.101091im     -0.105359+0.0337621im     0.0539462-0.263833im    -0.000408635+0.118916im    0.00609829+0.121728im      -0.128514-0.0527009im   -0.103213+0.0785021im    -0.0454442+0.0925485im     -0.249967-0.110303im      -0.014736-0.0428077im      0.220241-0.07345im       0.0888015+0.0233175im      0.18102+0.112439im       0.0166546-0.161075im      0.0402489-0.285017im    -0.0640372+0.03374im     -0.0456874-0.0957037im     0.0426308-0.0170119im    -0.0240166-0.0920912im    -0.334803-0.149194im       0.122261+0.00811555im      0.115747+0.00823939im  0.00450822-0.034051im     -0.222246-0.197922im      -0.16011-0.0586056im
   0.091387-0.13556im       -0.157812+0.028357im      0.127555-0.231335im      0.0948099-0.0126307im     0.0230827+0.0961525im    -0.0242148+0.137791im     -0.14214-0.0331484im    -0.0430711-0.149541im     -0.102269-0.0682433im     -0.154262+0.0707552im      -0.205479+0.0180093im    0.0305063+0.0366368im    -0.0262488+0.225945im   -0.0586028-0.0325171im      0.233593-0.0744423im     0.0032342-0.193363im      0.0615909+0.19146im         0.16356+0.152595im       0.199817-0.154507im     -0.131409+0.118273im      -0.0461013+0.0519184im    -0.0269003-0.234017im     0.0420043-0.163309im    -0.0847099+0.173676im       0.143784+0.00980027im   -0.0178548+0.20312im       0.111758-0.0117339im    -0.0988292-0.266321im       0.0559749-0.125257im     0.0494571+0.120017im    -0.0607108-0.184666im     0.0513685-0.088819im
  0.0703099-0.10314im        0.111729+0.0211514im    0.0180259+0.0208846im    0.00186621-0.131259im      0.0227201+0.046096im       0.122606+0.108647im    -0.063176-0.0610609im      0.250461+0.0319625im    0.0842785-0.0540099im       0.12429+0.0264898im      0.0438829-0.392214im     0.0295933-0.0408785im     -0.107832+0.0867301im   0.0493415+0.074185im      0.0466466+0.138886im    -0.00883082-0.0701092im     0.0608686+0.212577im      0.0280139+0.216004im     -0.0445325-0.139044im    -0.0155996+0.0237035im     -0.0840836+0.0868517im   -0.00777688-0.0840936im      0.19467+0.23602im     -0.0209694-0.0941947im      0.179618-0.170049im      0.0100937-0.0846545im    -0.152536-0.0624461im     -0.223706+0.255529im       -0.141663+0.127636im      0.198879-0.0426364im    -0.216329+0.0972557im    0.0567229+0.152477im
  0.0101144-0.0341467im   -0.00714393-0.012707im     -0.120325-0.0502963im      0.176046+0.119072im      -0.182305-0.129066im      0.0318544-0.0806016im  -0.0688827-0.160633im       0.196176+0.0977855im     0.171552-0.0149773im     -0.053702-0.115023im       0.0622793+0.0821875im   -0.0146164+0.0123681im     0.0972735-0.0100502im    0.300225+0.00680621im     0.134665-0.0217523im    -0.0372749-0.127517im       0.141603-0.182997im     -0.0173441+0.0987218im    -0.0546507-0.304988im      0.101692-0.284727im       0.0369223+0.0893174im      0.157279-0.13898im     -0.0539901-0.0823364im     0.101937-0.205341im      0.0603576+0.0159068im      0.109501+0.214548im      0.143104-0.10381im       0.0828848-0.00491741im      0.087812-0.049896im     -0.253346+0.0833101im    -0.133129+0.189488im     0.0345107+0.0686569im
 -0.0702253+0.0142031im      0.023774-0.112808im      0.151406+0.00816822im    0.0451415+0.176104im       0.138338-0.0984706im     -0.118498-0.0672971im  -0.0337677+0.115026im      0.0896331-0.0575953im   -0.0299062+0.0862254im    -0.0637563-0.218074im       0.0469251-0.247484im     0.0117928-0.266988im      -0.106938+0.191209im    0.0338945+0.000490458im   -0.194172-0.119693im      0.0411691-0.185537im    -0.00146272-0.168238im    -0.00998819-0.00995786im    -0.159958-0.0142694im     0.032646-0.182858im       -0.123469-0.104696im      -0.100385+0.0613904im    0.0334513-0.133264im      0.161621+0.308674im       0.191902+0.111627im      0.0892182+0.0510413im   -0.0198902-0.161073im      -0.152978+0.0471788im       0.185535-0.0744118im     0.108587-0.111887im      0.212136-0.0461106im    -0.122675+0.113558im
  0.0343419-0.024495im      -0.167074-0.167088im      0.065672+0.0361722im   0.000554205-0.143981im     -0.0905499-0.238797im       0.161833-0.116215im    -0.253408-0.0201632im     0.0428724-0.162818im     -0.231325-0.0452871im     0.0535979+0.143515im        0.222826+0.0196501im   -0.0639077+0.0961129im      0.282877+0.199561im   0.00712334+0.0110548im     -0.122179+0.177027im      0.0948611+0.222586im       0.201953-0.215399im      0.0818306+0.064228im        0.16985+0.107121im     -0.116248-0.0637443im      0.0775629-0.019217im      0.0044288-0.0385418im    0.0301904+0.108643im     -0.114498+0.0729944im     0.0152049+0.219007im      -0.145398+0.0449116im   -0.0201748-0.111719im     -0.0624904+0.116828im        -0.06352-0.13739im     -0.0250543-0.0697061im   -0.0493693-0.0293475im    -0.125314+0.0823881im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.018917482464429702 + 0.11072973523018799im
   0.047577367433381076 + 0.08543688998825055im
    -0.1979531057725185 - 0.16775575052047065im
    0.22744343694864375 + 0.24600272348269217im
    0.03918860444330624 + 0.09211348079513249im
    0.00775588933607619 + 0.04138227104779867im
   -0.10295571952976491 - 0.12355307940787445im
   0.019434018600994606 - 0.04605197403605671im
    0.16715135271485354 - 0.05560234915173444im
    0.08084531003567492 + 0.08670125626584278im
   -0.05261218504944379 + 0.06604188127272483im
   -0.10414681763237203 + 0.3396327646103428im
   0.008130186191984037 - 0.001749129933842207im
   -0.00661915992251088 + 0.07952743151905363im
     0.3719676362503366 + 0.0im
     0.1851386611628347 - 0.06023569519730577im
   0.021505150423118246 - 0.1291889904881695im
    0.12851622883473326 + 0.15422436326821756im
    0.03522450369293095 - 0.15347305575954914im
  -0.034637434019354346 + 0.12422002987298124im
   -0.09477030503830634 - 0.16963791599209405im
    0.28624594552093185 + 0.012009010460173965im
   -0.13385658103936296 - 0.01634466588007616im
   -0.10311265196296586 + 0.04030514460632738im
   -0.07592726144970373 - 0.22410802490568968im
   0.007238046186862982 - 0.025089532748951426im
   -0.01204402606133519 - 0.1424108237846094im
    0.13891196744075612 - 0.09068812324894893im
   -0.13541429343774072 + 0.03798597594239353im
 -0.0074147500533847865 + 0.10046424889387631im
  -0.010009905760552728 - 0.10859017952922836im
   0.013158996338552675 + 0.03466596882945685im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 10 June 2022 03:12">Friday 10 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

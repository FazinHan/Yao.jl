<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.127259-0.137632im       0.0312415+0.0189408im   0.00864481+0.0528808im     -0.172854+0.180917im      0.0546577-0.0178693im      0.134148+0.142941im        -0.25142-0.0100941im    -0.0533914-0.0739441im      0.0353385-0.0527942im    -0.198246-0.0817134im   0.0829938-0.196492im    -0.0493989+0.0351819im      0.217959-0.260084im      0.112881-0.00604967im     0.174154-0.0698856im    -0.00202658-0.0787159im      0.195891-0.0903705im    -0.184822+0.0955988im      0.0471169-0.0859492im    -0.0172484+0.0514646im     -0.209305+0.00733077im    -0.180818+0.1338im        0.100684-0.101268im    -0.00823047+0.0732726im     -0.116638-0.0902245im     -0.020553-0.136249im      0.0937112-0.18193im       0.0365361-0.0668569im      -0.241481-0.0752305im      0.110213+0.0379841im      0.245303+0.036028im      -0.152359-0.206892im
   0.0049478-0.257608im      -0.0565417+0.0400645im    0.0625528+0.117901im      0.0461635-0.132448im      0.0385526-0.00756083im   -0.0265279-0.0833571im      0.0784811-0.209433im      -0.227191-0.0503595im      -0.252429-0.083002im      -0.23204+0.0544781im   -0.150711+0.0953121im   -0.0590522-0.0208865im      0.066229+0.0750443im     0.052557-0.0259926im     0.0124393+0.0104944im      -0.232625-0.300593im      -0.117679-0.0740883im    0.0737613+0.0652382im     -0.0595407+0.117536im     -0.0682986+0.012264im       0.242556-0.0655853im    -0.0779439+0.108558im      0.137177+0.14168im      -0.0402353+0.0367982im     -0.170259-0.177693im      -0.237974+0.00541941im   -0.0248342-0.0499797im     0.0191386+0.181232im        0.093202-0.177266im     -0.0320445+0.183317im     0.00523456-0.0327613im     -0.178615+0.145806im
   0.0321482-0.00500805im    -0.0725054+0.0501494im    0.0364793-0.105165im      -0.121145+0.0540062im       0.03063+0.0471614im    -0.0568369+0.254318im       -0.192469+0.0421675im    -0.0578582+0.103797im     -0.00370949+0.0429252im    0.0854786+0.195009im     0.113235-0.0491096im   -0.0170093+0.141865im      0.0144759+0.00876849im  -0.0776224-0.0265345im    -0.0457974-0.204672im       0.0720962-0.240473im      -0.028866-0.0516459im    -0.010957-0.255399im       -0.109317+0.0777087im      0.100844-0.0569681im    -0.0572871+0.161416im    -0.00773751+0.157488im     -0.217498+0.0428496im       0.22669+0.0373267im     0.0840152-0.382623im      0.0368999+0.0342644im     0.0675651+0.127507im      0.0376934-0.0741293im      0.0795452-0.263007im     0.00315565-0.185706im      -0.245373-0.118001im     -0.0764719+0.101076im
    -0.10222+0.2656im        -0.0438137-0.132302im     0.0721373-0.0371846im     -0.156504-0.154869im      0.0999804+0.0695692im    -0.0536011-0.000512857im    0.0201399-0.00880324im   0.00928867-0.1027im          0.159849+0.0547605im     -0.11706+0.0631299im   0.0757904-0.10166im      0.0882219-0.0169905im     -0.246802-0.191105im     0.0472475+0.100983im      0.0897369+0.0735536im     -0.0757677-0.0164463im     -0.187532-0.0541058im   -0.0670306-0.197393im       0.0410915-0.0582111im      0.193394+0.205433im     -0.0494943-0.0269004im    -0.0797458-0.0323774im     0.207137+0.00037188im    0.0234674-0.0180847im     -0.200186-0.076338im    -0.00650037-0.160823im       0.184536+0.105542im      0.0211174+0.356997im           0.194+0.122847im      -0.142415-0.203381im       0.089819+0.126604im     -0.0450825+0.0998739im
    0.243252+0.168749im       0.0667648+0.0310642im  -0.00879766+0.0311627im     0.0563959-0.0876951im      -0.21531+0.0251126im      0.111242-0.0643371im    -0.00277854+0.0674598im      0.202933+0.176243im        0.208188-0.0752961im    0.0643214+0.0958667im   -0.163286+0.29822im      0.0505166+0.120016im        0.24488-0.0603464im   -0.0448118-0.132239im      0.0447288-0.038468im       0.0075351-0.125269im      -0.100962+0.165475im    -0.0961767+0.0374209im       0.107753-0.109609im   -0.000769901+0.256978im      0.0016213-0.0909335im     -0.011416+0.0834762im     0.108086+0.0198667im      0.251455+0.116263im      0.0675404-0.0540393im     -0.243941+0.151113im       0.102798-0.0931519im     0.0140218-0.105933im       0.0861808+0.051838im     -0.0541748-0.0207559im     0.0761267+0.15933im       -0.205035-0.0906013im
  -0.0345532+0.270046im      -0.0571154+0.0384128im    0.0220418+0.0836931im      0.103827-0.0794003im      0.153191+0.154115im     -0.0742538+0.00518043im     -0.100715-0.00397887im    -0.104509+0.0868839im   -0.000837396-0.275424im      0.204552+0.0524834im  -0.0895576+0.0805621im    -0.181193-0.0289468im   0.000341302-0.125808im    -0.0606888-0.0278721im     -0.239009+0.00567987im     0.0989868-0.186267im       0.199838+0.141353im     0.0956051-0.0847671im      0.0781753+0.072609im      -0.213433+0.0928576im     -0.207428-0.0258942im     -0.107886+0.0239831im   -0.0881392-0.155283im      -0.390244-0.147649im      -0.234761+0.0539965im    -0.0961545-0.0372663im     0.0375171-0.037911im      -0.116907-0.04374im         0.100152-0.101914im       0.071871-0.0475918im    0.00318163+0.046132im      0.0141033+0.0603989im
  -0.0129558-0.127762im        0.120992-0.214115im    -0.0132353-0.0342923im   -0.00338254-0.0533966im     -0.274407+0.132042im      -0.119784-0.103108im       -0.316202-0.135311im     -0.0121164+0.022255im     -0.00760987+0.0222584im    0.0710716-0.0195545im   -0.187207-0.115782im      -0.16742-0.0657838im    -0.0421737+0.139047im      0.294924+0.0976883im     -0.138933-0.108691im      -0.0882347-0.0482533im     0.0548941+0.00396556im   -0.225295-0.0569194im      -0.133706-0.185422im     -0.0879472+0.0800849im     0.0933221+0.0816813im      0.162632+0.0963156im    0.0202784-0.0129506im     -0.184617-0.0565921im      0.236127+0.0355455im      0.123368+0.145274im       0.174742-0.0155695im    -0.0327626+0.0559349im     -0.0688465+0.067814im     -0.0465937-0.154777im       0.086464+0.104444im     -0.0773918+0.189558im
   0.0183121+0.0609631im      -0.148426+0.135333im     0.0821192-0.0893248im      0.309797+0.171442im       0.130236+0.0370416im    -0.0436861-0.242144im      0.00317654+0.0168634im    -0.0190031-0.223829im       -0.137375-0.115154im      0.237348+0.0215935im    0.129946+0.154281im      0.042126+0.0667223im      0.107772-0.0617342im     0.204609+0.146521im      0.0213829-0.129351im      -0.0335903-0.0303126im    -0.0848004-0.152385im      0.059071-0.133709im        0.146151-0.0764324im     -0.141695+0.0255186im      0.143942-0.0972707im      0.082163+0.0443409im   -0.0791496-0.200362im        0.12237+0.123223im      0.0284168-0.04864im        0.147482-0.121056im       0.280308+0.173253im       0.189859+0.0262266im      -0.113125+0.0385517im    -0.0504829+0.113784im       0.134823-0.0497567im    0.00917116-0.0380258im
   0.0219445+0.0430243im      -0.117439+0.0115029im  -0.00802941-0.111177im    -0.00706914+0.0533502im      0.209443+0.194735im    -0.00933214-0.172541im       -0.319108-0.153979im      -0.151481+0.0813227im      -0.280958-0.135264im     0.0607812+0.0359763im   0.0331372-0.23251im      0.0696576+0.0936376im     0.0648687+0.178197im     0.0125421-0.0485853im       0.13647+0.000499462im      0.15636+0.170778im      -0.130996+0.0700475im     0.149217-0.00860781im     0.0589629+0.0725616im     0.0813182+0.0741463im     -0.072715+0.0188632im      0.110672-0.0539938im   0.00688741+0.229299im       0.176784-0.0346127im    -0.0642152+0.0610229im    -0.0824033+0.129794im     -0.0925552-0.0372678im     -0.295931-0.035799im     -0.00953596+0.0434537im     -0.205289-0.0451479im      0.152712+0.155667im     -0.0412414-0.152002im
  -0.0850174-0.00297167im     -0.282207+0.119632im     0.0849488-0.155392im     -0.0832717-0.0572136im     -0.104008+0.0114741im    -0.0719603-0.104571im        0.117468+0.0809748im      0.181012+0.385519im      -0.0248518-0.179453im     -0.203908+0.0613513im   0.0607628-0.0861637im   -0.0904699-0.0314594im     0.0631501-0.188107im      0.320434+0.0995821im    -0.0842851+0.289813im       0.0800898-0.0140558im    -0.0230464+0.154799im     0.0834897-0.0591835im     -0.0901451-0.193813im       0.109512-0.194223im       0.163172+0.0344366im    -0.0798536-0.0210238im   -0.0251834-0.0344083im     0.0790557+0.00907608im    0.0289126+0.0555987im    -0.0521634-0.127483im      0.0384601+0.0663522im     -0.164256-0.10339im        -0.124719-0.100424im      0.0327435+0.051817im    -0.00271123+0.0132317im   -0.00509922+0.105331im
   -0.122104-0.00539221im    -0.0204594+0.0745664im   -0.0484096+0.315506im      -0.138372+0.131514im      0.0165794+0.0736664im      0.430834+0.0317458im      0.0814497-0.0984878im     0.0250185+0.108589im      -0.0731991+0.0997554im  -0.00523525-0.132903im    -0.051259-0.201435im     0.0101936-0.0754164im     0.0619343-0.0400965im    0.0375784-0.0380218im    -0.0904878+0.131547im      -0.0224018-0.0117532im    -0.0305021+0.0107532im     0.104611-0.148345im       -0.178813-0.0542026im     0.0261998+0.175739im    -0.00872271-0.126734im      0.0456171-0.0534066im    -0.248067-0.149454im    -0.00156811+0.00560623im    -0.027753+0.0159618im     0.0346665+0.316658im       0.245971+0.127907im      0.0274207+0.000772546im     0.198156+0.0777462im     -0.131753+0.165884im    -0.00545191-0.154962im     -0.0398636-0.0430702im
  0.00600413+0.00605899im     0.0150195+0.0602204im   -0.0409487+0.0421677im     0.0222271+0.0367568im    -0.0323165-0.144474im      0.0511171-0.17948im        -0.208124+0.115187im      -0.293134-0.12301im         0.256997+0.071488im    -0.0829923-0.166177im    0.0303759+0.152915im     0.0995918-0.0503421im    -0.0866839-0.0539164im   -0.0705962-0.292365im      0.0611951+0.0524529im     -0.0422766-0.0420858im    -0.0018323-0.0354538im    0.0729585-0.00881486im    -0.0977136-0.152315im     -0.0305374-0.214527im     0.00224093-0.121781im     -0.0878975-0.13115im      -0.217334-0.0914034im     0.0266979+0.0302683im     0.0842538+0.00729313im    -0.167268+0.0984032im     0.0241607+0.21202im       -0.186973+0.103017im       -0.149217-0.240016im     -0.0928229-0.105624im        0.12891+0.236564im      0.0911575+0.152424im
   -0.175224+0.0443489im      -0.121705-0.0969501im    -0.258896-0.251847im      -0.106705-0.0282241im     -0.133645-0.00235772im    0.0359646+0.0355167im       0.078833-0.103602im     -0.0855399-0.0157372im      0.0445802+0.126366im      0.211925-0.125496im    -0.105512+0.116648im     -0.220325-0.117258im     -0.0936513-0.158968im     -0.079284+0.155576im       0.139692+0.165172im        0.049491-0.0504216im     -0.112594+0.0733589im    0.0110646-0.074911im       0.0340922+0.0872485im     -0.261945-0.00106207im    0.0141742+0.0846394im     0.0748792-0.0638837im    -0.197822-0.0438279im      0.221146+0.0758578im     -0.052018+0.0139368im      0.121277+0.0169767im     -0.180691-0.274697im      0.0252912+0.130219im      -0.0120029-0.170047im     -0.0747595+0.0363489im      0.181845-0.0502192im     -0.210478-0.0129381im
  -0.0506428-0.0291769im      0.0832882-0.135049im     0.0568245+0.0578704im     0.0606185-0.271301im       0.185448+0.082887im      0.0378261-0.0597553im      0.0640081+0.00765981im    0.0633129+0.114761im       0.0826403+0.0135608im    0.0148068+0.29247im     0.0385961-0.12128im     -0.0141283+0.0623467im     0.0217403+0.112916im    -0.0629506-0.152686im       0.145376+0.11993im       -0.0337979+0.161486im       0.179331-0.230153im    -0.0997565+0.0775105im       0.123222-0.309514im        -0.2357+0.0520554im    -0.0604235+0.0806484im      0.129489-0.142178im    -0.0448387-0.0899727im     0.0586597-0.173236im      0.0557723-0.0124452im    -0.0224356-0.110884im      0.0198149+0.0361931im     0.0411587+0.0550036im     -0.0538836-0.274639im       -0.22646+0.163157im      -0.148576-0.0968381im     -0.180132-0.00347711im
     0.13274-0.244909im      -0.0878788+0.0505799im    -0.194437+0.0489972im    -0.0238384+0.100133im      0.0292913+0.00589898im    -0.177018-0.130263im      -0.0144147-0.01266im        0.118734-0.211502im         0.10618+0.149377im      -0.20969+0.239849im    0.0236927+0.00355429im  -0.0653712+0.199709im      0.0954481-0.1448im      -0.0272608+0.135118im      -0.286387+0.0252636im      0.0224067+0.246294im     -0.0463887+0.0374992im    -0.132215-0.124799im      -0.0185592+0.212052im      -0.107153+0.0677079im    -0.0850763+0.226788im     -0.0115053-0.246862im     -0.158866+0.0251783im    -0.0617818+0.0585399im    -0.0769705+0.0866122im      -0.28528+0.0563081im     0.0699257+0.0813825im     0.0460962-0.0256581im      0.0138212+0.0108134im    -0.0283498-0.00213299im    0.0797176+0.00213441im   -0.0944546+0.0261653im
    0.024034-0.12214im        -0.440777+0.0261233im   0.00942171+0.0627705im      0.131475-0.0329003im    -0.0459109+0.22497im      -0.0671538-0.0138616im       0.016387+0.100514im      0.0939689+0.0645528im     -0.0717228+0.190552im     0.0836142-0.010592im    -0.145467-0.127722im     0.0690736-0.204418im      -0.106759+0.136331im     -0.100975+0.055498im      0.0765169-0.0412299im      -0.305689+0.0197003im     0.0688927-0.0376174im    -0.031843+0.0746376im         0.2449+0.0133937im      0.122471+0.0525942im    -0.0114847-0.0567147im     -0.336487-0.0624764im    -0.208058-0.127578im      0.0260086-0.103598im       0.104911-0.0740875im    -0.0981327+0.0542335im      0.027314-0.0803082im    0.00717679+0.036194im      -0.0697959+0.0412101im      0.156181-0.167833im     -0.0352808+0.0985353im    -0.0629566-0.123796im
   -0.208103-0.000114893im    0.0118415+0.0751456im    -0.193067-0.359881im       0.282603+0.11762im       0.0697204-0.0688982im     0.0744918+0.147746im      -0.0677258-0.127431im      0.0162481+0.0376362im      0.0439203-0.212373im     -0.136806-0.0197554im    0.118161+0.208488im    -0.0689919-0.0335358im     0.0162218+0.209477im    -0.0817963+0.0424575im     0.0397317+0.0488803im     -0.0455259-0.0353175im     0.0388082+0.00566017im   -0.144653+0.04873im       -0.0711306-0.0423561im       0.23716+0.0122853im    -0.0975998-0.0259696im    -0.0195237-0.260141im     0.0491739-0.100321im      -0.117599+0.081775im     -0.0508979+0.00475112im   -0.0240151+0.173987im       0.141248+0.00917742im   -0.0852461+0.136143im      -0.0829923+0.135278im    -0.00294337+0.00381966im    -0.254927-0.0729971im     -0.259495+0.0067549im
   0.0872794-0.274751im      -0.0562285-0.0387853im   -0.0259939-0.110047im       0.123312+0.13051im       0.0293663+0.133961im     0.00493303+0.0211361im      -0.171004-0.179508im      0.0620966+0.141861im        0.240463+0.152274im     0.0394044-0.0348075im    0.115004+0.0166958im    0.0284352+0.136657im      0.0735502+0.049979im     -0.178309-0.084996im     -0.0443044+0.257029im       0.0881026-0.230702im     -0.0996739-0.19901im       0.162419-0.0537591im    -0.00493717-0.0285208im     0.0146185-0.0352653im    -0.0550072+0.00425782im   -0.0949161+0.286451im    -0.0273183-0.0441693im     0.0258133-0.183958im     0.00308474+0.273329im     -0.0143399-0.201608im      0.0274896-0.131485im      0.0930777+0.0687377im      0.0650636+0.23788im      -0.0715457+0.108635im     -0.0061425+0.0420601im     0.0786234+0.15694im
   -0.193459+0.0377772im      0.0905804+0.0433527im     -0.30279-0.0427937im     -0.167419+0.264265im     -0.0627825-0.0443972im     -0.198531-0.282979im       0.0811554+0.0866629im    -0.0425318-0.0313171im     -0.0449252+0.0450187im    0.0887873-0.0553604im   0.0167918+0.00468569im   0.0773047+0.10855im       0.0511616+0.180964im     -0.107799+0.000717992im  -0.0494283+0.0761072im      -0.214883+0.0844629im     0.0158294+0.117891im      0.118879+0.134643im      -0.0787072-0.18936im      -0.0598712+0.194214im     -0.0214726+0.173229im      -0.175688+0.230466im      0.144927-0.0419498im     0.0317528+0.0197063im   -0.00771541-0.0160549im     0.0302851-0.143932im       0.189744-0.000330198im   -0.203653-0.0108885im       0.191935-0.184165im      0.0447884-0.0321432im     -0.123224-0.101266im      0.0405997-0.0836763im
    0.111113+0.0252198im      0.0425673+0.0273871im    0.0618125+0.15513im       -0.085058+0.237252im     -0.0168059+0.182375im     -0.0713202+0.0681065im     -0.0582817+0.162427im     -0.0675083-0.0142347im      -0.174929+0.147217im    -0.0144546+0.0949231im    0.171417+0.136106im     0.0735828-0.176264im     -0.0616956-0.0170994im   -0.0660939-0.00982165im     0.228263+0.176242im      -0.0444125-0.0762171im     -0.175662+0.159066im      0.122372-0.0625655im     -0.0323031-0.194062im      -0.162014-0.123969im     0.00905349+0.0800329im     0.0340606-0.161563im     0.0739806+0.1153im        -0.288525+0.0773387im    -0.0190404-0.0182478im     0.0539074-0.0596377im     0.0468833-0.0816613im      0.160515-0.275151im      -0.0405514+0.120734im       -0.11391-0.0948039im    -0.0995811+0.0825576im     -0.309644+0.0665995im
   0.0953897-0.0830488im       0.115803-0.112954im     0.0644446-0.0374176im     0.0601165+0.072612im    -0.00876879-0.147847im      0.0111313+0.150355im       -0.167209-0.0947253im     0.0865086-0.0804341im      -0.142329-0.129998im     -0.114679+0.0903328im   -0.253234+0.104945im      0.246558-0.286509im       0.148766+0.00952648im   0.0647802+0.0726774im     0.0537141+0.170849im      -0.0407085+0.0960706im    -0.0128331+0.242886im    -0.0179951+0.0286444im      0.0543768-0.0914597im     -0.110071+0.184395im      -0.185221+0.0524676im    -0.0989804+0.0561743im    -0.281368-0.0417652im      0.136429+0.0193567im      -0.10952-0.125166im      0.0566461-0.197858im      -0.142637+0.146406im      -0.033714+0.0732039im     -0.0305703+0.107647im      -0.105611-0.0267071im    -0.0568321-0.101264im       0.191224+0.190544im
     0.16193-0.0868545im      0.0970473+0.232979im     -0.100369-0.0181676im      0.140548+0.00437686im   -0.0907588+0.108349im       0.100551+0.0689908im     -0.0228486-0.00425297im    -0.168144+0.200485im       0.0286523+0.0547186im     0.115608+0.253154im    -0.111228+0.134772im      0.189268+0.078922im      -0.103102-0.0145517im     0.169986+0.224406im      0.0264598+0.0564197im      -0.065628+0.0384881im    -0.0453157-0.228249im    -0.0358673-0.0246364im      -0.389632-0.0952059im     0.0348584+0.0716942im     -0.111876-0.0387844im    -0.0783163-0.161089im     0.0553105-0.0240833im    -0.0573139-0.0670403im     -0.103065-0.0290471im      0.162874-0.0773168im      -0.19973+0.03591im      -0.0292728+0.0135568im       0.124434-0.124763im        0.14997+0.0136112im      0.161898+0.104237im      0.0619679-0.230762im
   -0.208199+0.00671488im      0.136416+0.104561im     0.0627178-0.0374576im     0.0567806+0.0816016im     0.0731276+0.104745im      -0.234709-0.010053im       0.0886405-0.0647542im    -0.0242821+0.0990036im      -0.173773-0.0190461im    0.0272097-0.132802im    -0.146474-0.103709im    -0.0665353-0.00820555im   -0.0479976-0.172288im     -0.206322+0.0631188im    -0.0751083+0.0537579im     -0.0033602-0.130495im      0.0956143+0.0282095im    -0.170306+0.285073im       -0.156718+0.0602477im     0.0641875+0.0288403im     -0.125371-0.0627905im     0.0185042-0.0199387im   -0.0236259+0.0122399im      0.194864+0.0348213im      0.125832+0.125155im      -0.042476-0.0720278im    -0.0588542+0.345269im       0.325657-0.115088im       0.0645334-0.0225907im     -0.168649-0.00616201im    0.0118164+0.303842im     -0.0904312+0.0156958im
    0.120579+0.104598im     -0.00602312-0.0827597im   -0.0756446-0.0183974im      0.187932-0.0641609im     0.0803012-0.110307im      -0.108658-0.16175im          0.06651-0.0917064im    -0.0116832-0.108671im        0.100179+0.138719im    0.00637705+0.0756291im  0.00971865-0.167708im     -0.247834-0.0280516im      0.195123-0.0916352im    0.0612013-0.0575746im      0.100226+0.192448im       -0.108311-0.244162im      -0.157827+0.0193001im   0.00916347+0.0496714im      -0.101781-0.0018685im      0.127589+0.0802166im    -0.0127359+0.090728im      -0.109303+0.0114409im     0.109999-0.122174im     -0.0822813-0.0946786im    -0.0831316-0.114333im       0.105207+0.252213im       -0.18578+0.0773373im     0.0647513-0.20208im        -0.199335-0.00483094im    -0.232449-0.19463im      -0.0330463-0.175352im       0.205596-0.182308im
 0.000971666+0.16866im        0.0941059+0.251785im      0.298297-0.0547695im     0.0130345+0.0486384im     -0.269384-0.106113im       0.071187-0.0605895im      -0.240061-0.0892448im    0.00318381+0.00379375im    0.00162244+0.0163442im     0.204933-0.0869093im    0.194779-0.0938907im   -0.0715669-0.00572029im   -0.0133966-0.0118664im   -0.0662357-0.028573im       -0.13848+0.190302im        -0.14814+0.176426im      0.0986031+0.02361im     0.00537561-0.00107198im  -0.000406407+0.115653im       0.015026-0.00908887im     0.109901+0.21389im        -0.10209-0.0839166im    0.0836214-0.091563im     -0.0573205-0.0976668im      0.132455-0.328192im      -0.187562-0.0823084im     -0.180352-0.0249185im     0.0730531+0.135198im       0.0626535+0.126411im      -0.108032+0.186675im      0.0565595-0.0496379im    -0.0761281-0.0392892im
   0.0121479-0.0560263im     -0.0808644-0.198796im      0.105445-0.043303im    -0.00510711+0.0811278im     0.0355328-0.300113im      0.0649555-0.0245017im    0.000438344+0.0346971im    -0.0554872+0.0938328im      -0.101695-0.0744812im     0.110467-0.064255im   -0.0196063+0.0628928im     0.014432+0.260424im       0.159741-0.0860479im   -0.0288051+0.149213im       0.165084+0.0723308im     -0.0554381+0.166001im       0.178265-0.0313008im   -0.0645665-0.0321097im      -0.152254+0.0705951im     -0.103154-0.0870602im      0.132712-0.306357im      -0.131757-0.0466434im   -0.0254168+0.102123im     -0.0378765-0.262833im       0.042297+0.0657148im     -0.090246-0.0271715im     0.0613252-0.0425282im     0.0701211-0.0456465im       0.179042+0.0359225im     -0.102668-0.423797im      0.0317904-0.183053im      -0.115674+0.0469943im
  -0.0860039-0.0287456im        0.12511-0.0241103im     0.258182-0.00240049im    0.0445578+0.0486588im     -0.163366+0.0173204im     -0.128495+0.112769im      -0.0520993+0.117496im       0.195787-0.108256im        0.138857+0.0272823im    0.0811843-0.0513869im   0.0500318-0.145066im    -0.0299404+0.191356im      0.0516516+0.104624im      0.231795+0.132387im     0.00627205-0.153905im       -0.113608-0.226534im     -0.0276426+0.116851im      0.348573+0.20935im        -0.027071-0.108032im     -0.0419727-0.0562124im     -0.146297-0.0464035im   -0.00959106-0.255083im     -0.168339+0.144484im      0.0590684+0.0544006im     -0.190883+0.166883im     -0.0895827+0.0577685im   -0.00831322-0.0855035im     0.0632663+0.223719im       0.0582276-0.103242im     -0.0758374-0.0132676im    -0.0611636-0.0561963im     0.0154683-0.113806im
   0.0146932-0.0956936im       0.016511+0.24472im       0.112381-0.114237im     -0.0695412-0.0208209im     0.0745178-0.109855im     -0.0343823+0.0392164im     -0.0722982+0.00935211im    0.0641406+0.0966322im       0.023978-0.0778586im    -0.276094-0.0793376im   0.0679055+0.0653756im    0.0345914-0.0919988im     -0.037035-0.0175649im    0.0450554-0.135256im      0.0983015-0.144856im       0.0541078-0.00463211im  -0.00523203-0.0412709im     0.114997+0.108807im    -0.000424188+0.157367im      -0.216897+0.290222im       0.320781+0.268137im      0.0120338-0.106951im    -0.0448259-0.2469im         0.041163-0.208877im     -0.0514911+0.113463im       0.214069+0.0978786im     0.0687765-0.112314im      0.0926791-0.0233399im        0.15426-0.0469694im    -0.0406664-0.202296im     -0.0636567+0.203085im      0.0569452-0.0712188im
  -0.0214038+0.196331im       0.0490255-0.0322212im     0.163687-0.204971im      -0.125424+0.0108838im      0.034609+0.199214im      0.0671786+0.00536547im      0.263557+0.000543963im   -0.254116-0.009936im      -0.0259226+0.217337im    -0.0797233+0.0837775im    0.147069+0.0736758im     0.186313+0.145982im       0.289213+0.0139483im     0.101526+0.0607125im     0.0919633-0.0503847im     -0.0358898-0.126922im      -0.060104+0.172217im     -0.264842+0.178078im       0.0265353+0.0863134im    0.00359817-0.0285515im     0.0288118+0.114506im      0.0239555+0.110096im      -0.28808-0.0602095im     -0.194471-0.181606im       0.142815+0.081682im     -0.0228791+0.0367837im    -0.0369048+0.0471638im      -0.14403+0.143146im       0.0046046+0.0826374im     0.0468704+0.0937423im     0.0467195+0.0262367im    -0.0055418-0.00936349im
    0.180625-0.107811im        0.213029+0.0593931im   8.74081e-5-0.0279772im   -0.00334596+0.0256088im      0.156989+0.227711im       0.192197+0.0687994im     -0.0644093+0.0736813im     -0.105948+0.00297161im    -0.0811765-0.035368im    -0.0042793-0.0389636im   -0.111286+0.020196im     -0.254876+0.0514111im    -0.0779832-0.305658im    -0.0522267+0.182764im     -0.0269389-0.0592517im      0.0212829+0.150346im      -0.289011+0.1144im       0.0802762+0.119595im       0.0497799-0.0218787im    -0.0211335+0.00112635im    0.0119555-0.0735476im     -0.141317-0.0370225im     0.128883-0.080198im      0.0268487-0.0510272im      0.327733+0.0228046im    -0.0903034-0.0467579im       0.11915-0.109229im     -0.0682792+0.204072im       -0.127437-0.0998915im    -0.0687011-0.0333835im     -0.287621-0.0806267im      0.164252-0.0267257im
   0.0273283+0.0518165im      -0.207997-0.186307im      0.083917+0.0436797im      0.294917+0.128271im     -0.0278438-0.101406im         0.0325+0.250289im      -0.0305112-0.0698237im      0.187873-0.030934im       -0.132382+0.0178464im   -0.0534051-0.0526539im    0.154647-0.0303187im    -0.119604+0.133212im      -0.113753-0.0534993im    -0.078752-0.222662im      -0.112514-0.00116327im     0.0287832+0.169132im      -0.340855+0.131033im      -0.16329+0.128113im      -0.0603798-0.1946im        -0.154919+0.00178653im    0.0319519+0.0130534im    -0.0987021+0.159114im    0.00316299+0.0962259im    -0.0850793-0.0761921im    -0.0372658-7.61943e-5im     0.144853+0.089131im     -0.0490768+0.15785im      -0.0325195+0.110281im        0.120422-0.208105im       0.155057+0.0606339im      0.129693+0.0896947im     -0.075331-0.0890395im
    0.113463+0.185965im      -0.0810054-0.0484901im    0.0162806-0.0296105im     -0.140566-0.0432656im      0.208245-0.0498633im    -0.0646762-0.0121115im      -0.272551+0.164658im      0.0569598-0.145517im        0.121607+0.0669856im   -0.0741705+0.088738im     0.158334+0.0289571im      0.03745-0.260553im     -0.0878754+0.0645923im    0.0861565+0.20783im       -0.219512+0.102968im      -0.0403871-0.0583447im     0.0541722-0.067411im    -0.0722597+0.131377im       -0.213839+0.109189im      -0.200197+0.0455293im      0.106574-0.29995im      -0.0599397+0.21014im    -0.00146282+0.0256801im      0.151053+0.00273293im    0.0507679+0.13229im     -0.00649181+0.0917361im     -0.104807+0.0153328im    -0.0978337-0.0259532im    -0.00663429+0.0353856im    -0.0256348+0.158743im      -0.197648-0.0238616im     -0.191253-0.187042im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.24231637365903924 + 0.006628672528331228im
    0.2082495035831125 + 0.021334479030064114im
  -0.11064063240563654 - 0.08051292605481511im
    0.3380259071515813 + 0.0im
  0.008207671782003514 - 0.025979237108786975im
     0.257845257398129 + 0.06260117159864173im
   0.04530750199537267 + 0.08668315976189211im
  -0.13848848337114558 + 0.015036956069581015im
   0.15807135673375108 + 0.12602381312424596im
  0.030976210885433328 - 0.04453863597343443im
   0.10971596450120638 + 0.20777785510679114im
 -0.061327294128920115 + 0.09627490294708099im
  -0.14133898492150085 + 0.02580111614340618im
    0.2049116299677628 + 0.1644925221475596im
  -0.27522505929023733 - 0.07556699441521895im
  -0.01179499996560468 - 0.00950651893417344im
  0.005218799018893343 + 0.0876009784781797im
   0.07661343430012077 - 0.048910253112104535im
    0.0683878986642193 - 0.02407289443675411im
  -0.09627384999145122 - 0.23661875130524082im
   0.07051196298609794 + 0.022464043837575727im
   -0.1348918740050104 + 0.06010087022147076im
 -0.039892691304414876 - 0.052110843163881204im
   0.15535914860715722 + 0.19675232125157413im
   0.10364323034487478 + 0.22582894956123625im
    0.0327984449545618 - 0.08497238568637973im
  -0.15014544745392325 - 0.0493758323408872im
  -0.20882958213731267 + 0.015127475692268123im
  -0.08585452989424083 - 0.09850760282654933im
  -0.12527246995202942 + 0.041064231335781624im
    0.0887423490811004 + 0.07077116446371923im
   -0.1010643604636055 + 0.05966534824770629im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 14 August 2023 17:05">Monday 14 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

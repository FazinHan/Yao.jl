<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.168504-0.0716277im     -0.199569-0.221495im      0.138628+0.194483im    -0.0907548+0.105971im    -0.162044+0.0622087im   -0.00661202+0.100075im     -0.0902049+0.0115719im     -0.209931-0.0657749im     0.0625389-0.175432im       0.199811-0.0568669im     0.0568963-0.145131im         0.262953+0.0243711im      0.156702+0.233035im      0.133314-0.127985im       -0.220995+0.0540477im      0.184489-0.0176547im   0.00900515+0.0167142im    -0.0201601+0.0388258im       0.124972+0.0339889im     0.134282+0.104012im    -0.0839207+0.218662im     0.0353796+0.164172im      -0.127296+0.190281im       -0.185669-0.0769016im    -0.00693737-0.0660653im    -0.0576378-0.0507525im    -0.0375448+0.10927im        0.0799658-0.021536im      0.0738011-0.12402im       -0.118068+0.0987797im      0.0985995-0.0873993im    0.0208079+0.128947im
  -0.0845602-0.11201im       -0.111815+0.166108im     -0.100546+0.161564im    -0.0605997+0.183719im    -0.171451+0.0497042im      0.211046+0.139214im      -0.049262+0.161331im      0.0688839+0.00838403im   -0.0432045-0.00836461im     0.261754+0.0520515im     0.0682149+0.0480807im        0.158253+0.0164496im     -0.147938+0.19092im     -0.0385391+0.197877im       -0.285763-0.109665im     -0.0901203-0.00929232im   -0.111184-0.00330313im   0.00363004+0.0526046im      -0.172926-0.22202im      0.0237335+0.0410519im    0.0651391+0.0607649im     0.018811-0.202339im       0.121953-0.184764im      -0.0632557+0.118923im      -0.0906929+0.245435im      0.0688789-0.128731im      0.0753154+0.0622229im      -0.156181-0.020192im      -0.167017+0.167109im    -0.00741339-0.120555im      -0.0289514+0.149626im     0.0205674-0.00617197im
   0.0483542+0.150308im      0.0360875+0.147333im    -0.0542727-0.193668im     0.0995393+0.0684331im   -0.218316+0.0726921im     0.0708861+0.0945604im      0.171166-0.152464im     -0.0378573+0.209079im       0.124974-0.265389im     -0.0437271+0.159295im       0.111937-0.0563551im        0.145791+0.0384656im     -0.110214-0.0430371im    0.0870549-0.132091im       0.0576048+0.170981im     -0.0657837+0.110654im     -0.201466-0.208296im      0.0229937-0.236858im       0.0926101-0.106004im      0.120243-0.0391991im   -0.0369233-0.0501614im    0.0266169+0.268385im    -0.00160647-0.184158im      -0.0417128+0.0778975im      0.0236781+0.0500466im     0.0468815+0.132213im     -0.0498463+0.0205432im      -0.237258+0.0110181im     0.0865612+0.0515263im     -0.203406+0.0862223im     -0.0995862-0.0541951im    -0.171299-0.120461im
  -0.0696476-0.0530089im     0.0111475-0.0349818im    0.0239661+0.333055im       0.06904-0.161792im    -0.243698+0.0929775im     0.0918036-0.143829im      -0.026086-0.0612763im     0.0169696-0.135086im     -0.0337068-0.0401207im       0.14761+0.193003im      0.0432488-0.0442347im       -0.116569+0.0703117im    -0.0304245-0.142718im     -0.060324+0.0323421im       0.177513+0.243057im        0.13353-0.162028im     0.0265926-0.153892im       0.120831+0.000594734im     0.014303+0.0855791im    0.0203815+0.0129694im        0.193-0.0413998im    -0.126144+0.150707im      0.0337317+0.034791im         0.13797+0.152319im       -0.263403+0.123969im       0.212191-0.0341785im      0.104425+0.109178im        0.100169-0.104778im        0.26205-0.144011im      0.0685866-0.162175im      -0.0278643+0.129465im     0.0401071+0.00441925im
  -0.0183017-0.109342im       0.211568+0.0132458im    -0.146649+0.0332929im   -0.0775733+0.138038im   -0.0763489-0.128077im     -0.0484302+0.205876im       0.167684+0.0492365im     -0.108197-0.123855im       -0.14091-0.184916im     -0.0550222+0.0108243im     -0.045085+0.0715044im        0.229319-0.291656im     -0.0828339+0.0702653im    0.0996016+0.0673591im         0.3647-0.100084im     -0.0931361+0.00604982im    0.205491+0.00926271im    0.0105939-0.0243497im      -0.123452+0.135456im    -0.0629615-0.0922335im   -0.0324407+0.0263982im    -0.109234+0.0551266im     0.0389284-0.109041im       -0.192348+0.179341im      -0.0644403-0.0795438im     -0.196658-0.235344im      0.0620082-0.0408998im     -0.0645112-0.079688im      0.0868445-0.229222im       0.107621+0.00469767im     0.0992635-0.00707615im   -0.004131+0.00318534im
   0.0412508-0.142815im     -0.0882026+0.0543798im   -0.0576146+0.238942im      0.257178+0.100408im     0.148053-0.0749241im     0.0389031+0.0352725im      0.154369-0.182351im       0.106625-0.0585433im      0.281887+0.217793im       0.102747-0.10243im       -0.110562+0.100949im            0.161-0.0524787im    -0.0847951+0.0166847im   -0.0786713-0.127037im       0.0176599-0.120787im     -0.0678308+0.115001im       0.11161+0.0838271im     0.0158467-0.161035im       0.0436928+0.00116615im    0.255754-0.16091im       0.084112-0.0596366im   0.00734164-0.10173im      -0.0064303+0.144208im     -0.00484739-0.198227im      -0.0259804+0.0211228im   -0.00183567+0.0789643im     -0.041651+0.0769034im      -0.173685+0.149721im       0.127733-0.270414im     -0.0727526-0.141347im       -0.173658+0.0442014im     0.101652-0.148289im
   -0.136919-0.115698im      0.0653927+0.123748im      0.162663+0.0306115im    0.0746813-0.0597668im    0.080819+0.0755197im     -0.171832-0.111225im      -0.298642-0.0510478im     0.0495695+0.0652516im     0.0292203-0.0264681im     0.0272128+0.179235im    -0.00567215+0.139511im         0.200903-0.137116im       0.217961+0.187067im     0.0359043+0.174912im       0.0800148+0.0096338im    -0.0919152+0.0805488im   -0.0526686+0.125697im      -0.144103-0.0561496im       0.170448-0.0592343im    0.0819121+0.17867im      -0.161112-0.0326167im    -0.140086+0.0822129im      0.127129-0.0796981im       0.133599+0.0290622im      -0.206631-0.0667974im     0.0206326-0.00885957im    -0.186781+0.0792834im     -0.0657795+0.0812089im     0.0632955+0.114502im          0.195-0.149304im     -0.00418893-0.337137im     0.0365861-0.0984493im
   -0.188791-0.0474354im      0.168871-0.163083im     -0.124833+0.0694449im   -0.0329307-0.0853342im    0.247191-0.11408im        0.102144+0.00982699im     0.155622-0.0598611im      0.121513+0.061555im     -0.0243499-0.0699199im     0.0430508+0.00716826im    0.0908289-0.0701494im        0.264049+0.188133im      0.0195072+0.0751708im   -0.0366702-0.0127792im      0.0879251+0.0918992im     0.0320752+0.162557im      0.236518-0.238929im      -0.250069+0.0906906im      0.0201275-0.126061im    -0.0248662+0.162159im      0.309712-0.0329702im     0.160963+0.0557311im      0.126337+0.0577016im       0.146045+0.00325925im     0.0755859+0.025113im     -0.0287717-0.0211689im       0.15364+0.0764719im       0.102167-0.0232393im     -0.117658+0.094968im      -0.176394+0.0407139im       0.108657-0.206367im      0.135031-0.0202649im
   0.0671047-0.149878im     -0.0105688+0.164459im      0.142659+0.194412im   -0.00131027+0.194423im    0.0624042-0.0689092im    -0.0719439-0.0888109im     -0.103863+0.185063im      0.0456002+0.0501188im    -0.0356909+0.0321637im    -0.0646799+0.1241im        -0.184954+0.185177im       -0.0574592+0.013255im     -0.0306995+0.00672275im    0.266032-0.30133im         0.092559-0.0712205im     0.0763914+0.109641im     -0.138518+0.0224154im     -0.153445-0.0918043im      0.0368196+0.0373484im    -0.193042+0.0978348im    0.0422848-0.0790745im   0.00925678-0.0293856im     -0.121114-0.0863219im     0.00164397+0.000353252im   -0.0711939-0.166393im      -0.017184+0.0381053im      0.275633+0.247937im       0.0890251-0.206445im    -0.00893937+0.117885im      -0.209142+0.109904im      -0.0223453+0.173107im    -0.0022836-0.188529im
 0.000957761-0.0791801im   -0.00205583+0.00223539im  -0.0360379+0.305345im     -0.057051+0.116258im   -0.0571032+0.00433819im    -0.217599+0.100534im      0.0553759-0.0203628im    -0.0777164+0.151646im    -0.00769309-0.112731im     -0.0913153-0.22771im      -0.0429969+0.0217747im        -0.20162+0.144854im      0.0743636-0.0211559im    -0.219376+0.196805im       0.0474948+0.00633456im    -0.173074-0.0459788im   0.00218924+0.0170816im     0.0632301+0.0626801im      -0.389397-0.0462064im    -0.109526+0.0227121im   -0.0440935-0.0618454im    0.0279342+0.153233im     -0.0980029+0.121848im       0.0786901-0.125771im       -0.213438+0.0349716im    -0.0593787+0.0836733im    0.00122379+0.206512im       -0.115521+0.102597im      0.0193462+0.0536078im     -0.129188+0.175134im      -0.0219661-0.236583im     -0.201174-0.0519181im
   0.0606531-0.0925461im     0.0663572+0.0377884im   -0.0394159-0.056151im     -0.020279-0.149173im   -0.0393418+0.127375im       0.105953+0.0446426im   -0.00740288+0.207774im    -0.00997975+0.0173797im     -0.145292+0.0272953im      0.349371+0.189364im      -0.095373-0.135483im        0.0371474-0.082821im      0.0579283-0.0170587im    -0.213656-0.00174765im     -0.135644+0.0930064im     -0.213765+0.0303188im     0.114682-0.0649254im    -0.0641871-0.0813944im     0.00212606+0.193588im     -0.192607+0.128303im    -0.0504551-0.263726im     -0.216044-0.0313001im      0.148012+0.0898584im      -0.064869-0.176957im       0.0993218-0.171876im      -0.166851+0.117551im     -0.0241183-0.049072im      0.00945869-0.0550552im    0.00347677-0.0913112im     -0.177475+0.0487977im      -0.303006-0.00436764im   -0.115001+0.0514048im
  -0.0313333-0.00978339im    -0.270658+0.0673482im    0.0045436-0.248625im    -0.0409302+0.0302214im    0.113254-0.0575475im     -0.116379+0.00592519im   -0.0163073-0.155526im     -0.0434589-0.0853339im    -0.0244623+0.132305im       0.240625+0.149727im       0.229587-0.0784455im       0.0325299-0.14098im      -0.0506261+0.031068im       0.13513+0.0579502im       0.100224-0.0587715im     0.0450373-0.00220803im    0.246923+0.0373133im      0.276419-0.123509im      -0.0277347+0.0221017im   -0.0595882-0.0762483im    0.0478429-0.16316im      -0.125018+0.016718im      -0.100158+0.0307322im       0.106142+0.0281976im      -0.179507-0.0270421im      0.118455+0.0535073im      0.140452+0.212076im       -0.073865+0.186621im      -0.130714+0.149703im     -0.0800941+0.298706im       0.0864379+0.0127676im    0.0923467+0.189285im
    0.161417+0.0643748im     0.0450235+0.111421im      0.106627-0.0309457im   -0.0942955+0.191865im    -0.128876+0.220811im      0.0272731-0.277726im     0.00417402+0.0605814im    -0.0349592-0.253386im      0.0540843-0.0208415im   -0.00860608-0.0217507im      0.149179+0.112422im        0.0817135-0.00978865im   -0.0737534-0.372911im    -0.0373809+0.0455909im     -0.0588341-0.197682im     -0.0629064+0.128456im      0.110517-0.136689im      -0.145223-0.0989415im     -0.0926593-0.0783001im    0.0682526+0.0815895im  0.000353941-0.0112704im     0.187203-0.101179im      0.0920385+0.148609im       0.0240292+0.17226im         -0.19075-0.134023im      -0.123064-0.0812712im     -0.121437-0.119526im        0.174695+0.209875im       0.142824+0.0731098im     -0.144688+0.0648513im      0.0151744-0.0403107im    0.0395389+0.0199868im
   -0.192646+0.0549461im      0.187743-0.0923979im   -0.0611195+0.0267411im    0.0923957-0.0519827im   -0.170893-0.021767im     -0.0621262+0.0572656im    -0.0561612-0.180785im     -0.0700689+0.0712932im     -0.184619+0.227203im     -0.0180026+0.0397029im     -0.200242-0.0549319im      -0.0142914+0.0197442im   -0.00266843-0.016906im      0.047873-0.00999756im    -0.0783379+0.0923878im    -0.0176291-0.0359164im   -0.0169463+0.13342im        0.198518-0.232416im       0.0334788-0.164099im      0.140755+0.028855im    -0.0416231+0.262692im     0.0060644-0.158946im       0.263758-0.15088im        0.0405996-0.173742im       -0.191452-0.150718im     -0.0743034-0.117709im       0.157837-0.111982im        0.191961+0.0925857im   -0.00622243-0.048336im      -0.287948+0.113765im        0.133027-0.00527552im  -0.0969592-0.00901001im
  -0.0179184+0.106509im       0.199431-0.0909155im   -0.0240271-0.076433im    -0.0272082-0.1701im       0.166499+0.0325173im    -0.0858502-0.00345167im    -0.134247+0.0438312im     -0.148808+0.130137im      0.0762888+0.0156622im      0.130023-0.0235196im     -0.122718-0.149642im         0.220563+0.168994im       0.205994-0.0158748im    0.0250433+0.0866607im      -0.178436-0.214075im    -0.00135245-0.0871974im   0.00130321-0.0525627im     0.0611318-0.0325328im      -0.135115+0.267411im     0.0221406-0.183058im      0.130642-0.00548432im    0.187864-0.0349096im    -0.0451786-0.0569346im      -0.106006+0.262772im       -0.207465-0.176848im      0.0758056+0.209324im      0.0711252-0.000568801im    -0.158192-0.00221538im     0.108165+0.034893im      0.0199895-0.0587905im      0.0911209+0.166291im    -0.0330454-0.237584im
    0.185297-0.11266im       -0.103384+0.171687im     0.0903572+0.0527606im     0.063615-0.208025im    0.0406136+0.110952im     -0.0835259+0.24224im        0.200495-0.0165283im    -0.0430912-0.0443951im     -0.108805+0.0968655im     0.0705126+0.045539im      -0.164574+0.0889749im       -0.153536+0.109024im      0.0522494+0.102429im     0.0802085+0.150755im         0.10372-0.0575178im       0.13336-0.226128im       0.17595-0.303059im      -0.137692+0.0896922im       0.207882-0.00139778im    0.119226-0.0101098im   -0.0103494+0.0517941im    0.0170081-0.243604im     -0.0955997-0.134183im      -0.0495834+0.102147im        0.123803+0.0020417im      0.054612-0.14111im       -0.112982+0.0116797im    -0.00393083+0.169832im       0.126415+0.140355im     -0.0956421+0.115615im      -0.0150208-0.0917145im    -0.187323-0.121743im
   -0.121902-0.169781im     -0.0808935-0.192898im      0.123998+0.0414434im      0.10867+0.0614721im    0.140447+0.00893223im    -0.109273-0.0260527im     -0.166933-0.0872369im      0.209573+0.199814im      0.0602772-0.218816im      0.0776935+0.00820939im     0.023829-0.0976199im     -0.00422532+0.022417im     -0.0717975-0.32946im     -0.0650782+0.0693613im     -0.0709159+0.00376159im     0.126426-0.0616435im    0.0982942-0.194917im      0.0762844-0.119347im      0.00626393-0.106545im     -0.196713+0.117061im    -0.0860078+0.179914im    -0.0976465-0.0946548im     -0.134516-0.176036im     -0.00342027-0.058924im        0.120901-0.0668753im     -0.289293-0.158109im     0.00110715-0.0313325im       -0.25892+0.0598974im      0.146522-0.00747044im    0.0770626+0.0297392im     0.00830821+0.15897im       0.129885-0.00663287im
   0.0698644-0.227527im      0.0455879-0.0963171im     0.176814-0.242523im     0.0797235+0.138912im    -0.285499-0.226698im      -0.104257+0.120759im     -0.0304355-0.191392im       0.127467-0.13508im        0.190079+0.0794589im      0.159783+0.0561518im     -0.281911-0.260139im       -0.0703356-0.00688644im     0.171585-0.101336im     -0.027374+0.087187im        0.108525-0.0224043im     -0.175939+0.120137im    -0.0547922+0.0657857im     -0.163676+0.0408755im      -0.110766+0.0189644im    0.0311804+0.0769103im     0.085181+0.0479813im   0.00984668-0.010669im      0.0083043+0.0312908im       0.119395+0.189839im        0.141269+0.169296im    -0.00223065+0.0556038im     -0.145146+0.0866558im      0.0864082-0.114152im     -0.0341439+0.0420012im    -0.0551963+0.0310854im       0.136201+0.116458im    -0.0243668+0.00207374im
  -0.0827217-0.174293im      -0.059809-0.208084im    -0.0588297-0.0863154im    0.0113262-0.229609im    -0.213771+0.118446im     -0.0491492-0.010853im        0.23134+0.172348im      -0.024323-0.0872508im     0.0646918+0.0340832im    -0.0529738-0.0940445im      0.255097-0.0343135im      0.00878418+0.0471934im      0.230619+0.0592199im     0.108244-0.0459263im       0.150555+0.0760286im    0.00476202+0.113504im     -0.144148-0.0777303im     0.0336398-0.320222im       -0.117295-0.101609im    -0.0955338+0.121563im     -0.110207-0.0834384im     0.138756-0.398771im     -0.0736299-0.000934875im   -0.0428012-0.0563291im     -0.0361468-0.037503im     0.00934323+0.0513692im   -0.00408392+0.176732im      0.00194983-0.00288566im   -0.0907255-0.120104im       0.194654-0.051205im       0.0163869-0.0118897im    0.0106782-0.119793im
   0.0716057-0.0500447im      0.153393-0.0739604im    0.0392964-0.0657074im   -0.0628572-0.0610794im  -0.0495868+0.113912im     -0.0596613+0.172641im     -0.0143719-0.137559im       0.300279-0.188232im      -0.107065+0.226374im     -0.0933897-0.151052im    -0.00647711-0.000482368im     0.0301628+0.00811993im    -0.089463-0.0401258im   -0.0272879-0.0877579im      -0.173495+0.104409im       0.233861-0.125029im    -0.0646593-0.0161189im    -0.0739229-0.104528im       0.0335253+0.0396866im    -0.020941-0.20248im      -0.133371-0.26024im      0.0463686+0.13386im        0.135863+0.0529821im      -0.155059+0.0691382im      -0.108222+0.0587687im     -0.280504-0.0616182im     0.0313161+0.272544im       -0.138722-0.0948824im     0.0116361+0.215264im     -0.0350746-0.180758im       0.0703122-0.102809im     0.0217958+0.116157im
   -0.267475-0.0248143im    -0.0438883+0.0800218im   -0.0218713-0.0196437im     0.174962+0.0536487im   -0.160038+0.00832739im    -0.178768-0.0422889im    -0.0115771-0.022208im      -0.092606+0.0703603im     -0.114384+0.126308im      -0.175075-0.112627im      -0.117075-0.161113im          0.16876+0.137928im     -0.0212822-0.0120039im    0.0501625-0.0417854im      -0.113663-0.0476179im    0.00418827-0.0248299im     0.174024+0.0407377im      -0.11856+0.0998422im      0.0214457-0.222493im     -0.150956+0.0629199im   -0.0439766-0.317187im    0.00736947+0.00594184im    -0.290826-0.174445im       -0.159032+0.152959im      -0.0385791-0.00723456im     0.189594+0.0132285im    -0.0962374-0.0774243im      0.0841133+0.0135173im     0.0814252-0.184743im      -0.122402-0.0991831im      -0.159118-0.0271239im     0.110244+0.261503im
    0.147186+0.211098im      0.0753816+0.0544101im   -0.0443724+0.121082im    -0.0544656+0.177597im    -0.102323+0.218033im      -0.186622+0.249774im      -0.119256-0.0633234im      0.166496+0.135368im      0.0660923+0.0398361im   -0.00309581+0.0305603im      0.248869-0.0421576im       -0.146575-0.0574136im      0.128092-0.045082im     0.0768504+0.0191451im   -0.000863162+0.0591573im     -0.169328-0.0184693im    0.0156148-0.0209721im     -0.108253+0.251934im        0.111774-0.061417im     0.0646186+0.0503198im     0.105416-0.194806im    -0.0488178-0.12798im        0.162412-0.0934324im       -0.07723-0.0618335im       0.119274-0.164475im       0.035757+0.153222im       0.180161+0.0666452im     -0.0176823+0.12233im        0.052443-0.242476im      0.0619414+0.000912867im     0.277113+0.0951764im     0.144364-0.00508523im
    0.153148+0.0769785im      0.113147+0.0262143im    -0.138452-0.0015727im     0.240207+0.0171038im  -0.0857024+0.00579048im    0.0419329-0.089758im       -0.15177+0.10791im      -0.0662917+0.143118im      0.0453719+0.0665162im     0.0254464-0.168763im      0.0344559+0.00899013im       0.296338+0.0532057im     0.0183351-0.101704im     -0.121455-0.108553im        0.345583-0.114568im        0.09975-0.147728im    -0.0215478-0.0045631im      0.200015+0.169849im        0.145092+0.0506918im   -0.0736266+0.183389im    -0.0109919+0.0164356im    -0.138952-0.0817178im     0.0280428-0.014029im       -0.118377-0.033784im     -0.00278407+0.266619im      -0.188998+0.145519im     -0.0741218+0.173145im        0.156986+0.188843im      -0.138123+0.14874im      -0.0568498-0.0669044im       0.061171+0.0906807im     -0.12004+0.0238473im
   -0.131793-0.100465im    -0.00726543+0.108754im    0.00423143-0.0831162im  -0.00879262+0.117641im    0.0458162+0.130203im     0.00194117-0.00011612im     0.173919+0.0640746im      0.166466+0.102081im       0.206706+0.11233im         0.09772+0.154043im     -0.0914073+0.0780621im       0.0247464-0.163418im      0.0754555+0.0209033im     0.081305+0.0115315im      0.0567531-0.103592im       0.300324-0.132623im     -0.169948-0.166584im      0.0524928+0.0568354im      -0.261753+0.0611784im    -0.307686-0.0301104im    0.0112819+0.115947im     0.0882599+0.106298im       0.161977+0.000903776im    -0.108266-0.212181im      0.00189396-0.0263268im       0.19397+0.100938im      -0.162378-0.128594im       0.0700285+0.0523519im       0.07481-0.102087im      -0.143683-0.121206im        0.208546-0.147951im    0.00563418+0.146142im
  -0.0268497-0.0354153im    -0.0916711-0.0737883im   -0.0109859-0.0831893im    0.0655051+0.103023im     0.145452+0.0116604im     0.0589802+0.0592644im       -0.3412-0.106159im     -0.0181794+0.121961im      0.0449727+0.162359im     0.00167693-0.213481im       0.211922+0.0194279im      -0.0969361-0.135878im       -0.15076+0.134459im    0.00372652-0.0717055im       0.125374+0.104987im     -0.0476423+0.0272676im     0.145671-0.150149im      0.0163106-0.077195im       -0.173795+0.0487353im    0.0863915+0.229961im    -0.0015412-0.00145106im   0.0916577-0.0678788im     0.0493777+0.112559im      -0.0652454+0.149605im       0.0700552-0.160692im       0.172221-0.114615im     -0.0342212-0.0200533im    -0.00897478-0.214587im       0.113859+0.0212768im     -0.101449-0.214236im      -0.0071834+0.0309271im    -0.419564+0.0517668im
  0.00471896-0.187379im       -0.29267-0.0222159im    -0.120424+0.0357551im     0.194488-0.176348im    -0.087018-0.0287528im     0.0120093-0.0901747im      0.125701-0.00584996im    0.0700913+0.151939im       0.131376+0.0735167im     0.0198271+0.0627091im      0.152636-0.0239496im       0.0983187-0.0198254im    -0.0536993-0.117124im      0.173761-0.0303278im     -0.0508344+0.0499447im     -0.232118-0.237219im      0.049605+0.0961777im     -0.192719+0.196026im       -0.103849+0.176003im     0.0896013-0.0721611im     -0.15671-0.056382im      0.220243+0.247462im      0.0275307-0.176107im       0.0930663-0.0832787im     -0.0805156-0.15546im       -0.170992-0.149774im      0.0518456-0.0547692im       0.182683+0.0422567im     -0.129666+0.0824411im     0.0735041-0.0320737im      0.0513857+0.113812im     -0.106839-0.0479413im
    0.138957-0.330312im     -0.0488525-0.10006im      -0.141593-0.199865im     -0.111769-0.0969177im  -0.0148205+0.172429im      -0.132251+0.107526im     -0.0823848-0.138475im      0.0818042+0.0250632im    -0.0253498-0.147247im      -0.159248-0.0951779im     0.0359017+0.142867im        -0.056751-0.0233274im      0.124214+0.184983im     0.0213965-0.0241547im      0.0321843-0.00959502im  0.000459382+0.0708399im   -0.0983156+0.000600744im    0.101506+0.0734331im     -0.0147118+0.0741824im     0.048659+0.131465im      0.220351-0.09138im      -0.083145+0.0741067im    -0.0455067+0.0318257im     -0.0372643-0.0601129im      -0.203716+0.119229im     -0.0400368-0.0681426im     0.0409552-0.358907im       0.0540572+0.114481im      0.0462268+0.109873im      -0.242444-0.0817604im      -0.159655+0.20994im       0.227354-0.0918688im
    0.207027+0.0614152im      -0.13269+0.209995im     -0.176084+0.0185443im     0.276436-0.188837im     0.101322-0.111402im       0.020487+0.0368413im    -0.0323784-0.109628im      -0.110282-0.0468336im    -0.0734041+0.131931im      0.0421342+0.00521474im     0.143158+0.0493479im       0.0417761-0.0554825im      0.148225-0.208437im     0.0488612+0.400259im      -0.0310733+0.0235685im      0.069017+0.195348im     -0.219332+0.0689092im    -0.0679552+0.00702004im     0.0656777-0.0917787im    -0.172126+0.0496377im    0.0353954+0.0604751im    0.0420704+0.0251625im     -0.125631+0.126007im       -0.116523+0.00517128im    -0.0421622+0.070165im      -0.131024-0.0337772im      0.169627-0.102836im       -0.067885-0.294953im      0.0639757-0.115758im      -0.144665-0.0192784im       0.115024-0.0915146im   0.00119074+0.0162703im
    0.122354-0.0346764im    -0.0756161+0.114422im     -0.121487-0.239838im     -0.179028+0.0419652im  -0.0939379-0.00274048im     0.121745-0.391083im     -0.0185875-0.114869im       0.322744+0.11352im      -0.0575663-0.00536979im   -0.0326692-0.0181809im    -0.0574141+0.0327621im      -0.0371116+0.134231im      0.0736445+0.159002im     0.0182653+0.0657641im      -0.115025-0.0782494im      0.100486-0.0277068im     0.246191-0.0127875im     0.0641623+0.051856im      -0.0650359+0.0466208im    0.0893821+0.0776759im    -0.176175+0.0478109im   -0.0676187-0.0189108im     -0.019231-0.0861594im      -0.028135+0.0731907im    -0.00592109+0.167625im     -0.0937935+0.0593457im      0.173254+0.112923im        0.037714-0.0927132im     0.0416149-0.373707im     -0.0302769+0.0594899im      0.0279447-0.154322im    -0.0898023-0.213776im
    0.119404+0.129169im      -0.194651+0.0625292im     0.018821+0.119974im       0.08106-0.119439im    0.0864105-0.119603im      -0.141918+0.132647im      0.0462071-0.0916607im      0.065412-0.0282633im     -0.152797-0.224245im       0.200697-0.147188im      0.0124668+0.240453im        0.0422818+0.198955im        0.13618+0.0234422im    0.0839394-0.220863im       0.0296511-0.0372775im      0.033569+0.0109859im    0.0539017+0.0524938im     0.0441908-0.101481im       -0.220055-0.072063im    -0.0415196-0.0231775im    -0.216305-0.00442947im  -0.0478338-0.0437095im      0.299652-0.0963967im        0.22629+0.235915im       0.0747411+0.0107861im    -0.0611344+0.251663im     -0.0718584-0.145855im       0.0918455-0.0910753im     0.0561897-0.0215083im    -0.0367206-0.0801759im    -0.00982142+0.0582092im    0.0823319+0.18668im
    0.018221-0.0450175im     0.0385672+0.203773im     0.0319796+0.0113534im    -0.204508+0.0640145im   0.0255765-0.0686893im    -0.0195169+0.174188im      0.0209994-0.0106692im     -0.128898+0.0886568im      0.225879-0.0213913im     0.0426197+0.0830276im    -0.0445326+0.0754659im    -0.000795237-0.0274289im    -0.0116118-0.00597616im   -0.280887+0.140989im      -0.0262771+0.137579im       0.333815+0.0383202im   -0.0332615+0.100628im        0.11845-0.153479im     -0.00324198+0.0831935im     0.175512+0.160489im     0.0696857-0.185506im      0.213262-0.0029387im     -0.200586-0.222204im        0.163231+0.0890066im      0.0740624-0.114619im      -0.227937+0.0366146im      0.117074-0.0231348im       0.237572+0.0749942im     -0.118592-0.100749im      0.0801656-0.158226im      -0.0335762-0.0118022im   -0.0525933+0.131034im
   0.0881003+0.156163im     -0.0017823+0.089513im     0.0228051-0.0138029im    0.0674481+0.0203423im     0.10102+0.175505im       0.134805+0.111396im      0.0999959-0.0498331im     0.0887511-0.245729im       0.136403-0.114703im       -0.21067-0.0902399im     -0.112448-0.200726im         0.079533-0.0732318im      0.112757+0.118943im      0.130686+0.0820197im     -0.0704523-0.112918im      0.0716026-0.147831im      0.181002+0.0825611im     0.0359504-0.0369182im      0.0748493-0.207531im     -0.186502+0.234074im      0.150411-0.0360072im    0.0466439+0.086827im       0.094244-0.0476558im       0.251961-0.167839im       -0.199504-0.0518949im    -0.0713652+0.0323653im    -0.0886047+0.0185925im     -0.0523377-0.154547im    -0.00674768-0.0373869im      0.133796+0.0627396im     -0.0681718+0.252948im      -0.25547+0.00237312im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.17051470070218108 + 0.005293497390199786im
    0.1512602583128296 + 0.13497086944501374im
  -0.05929935953476205 + 0.030554276870367617im
 -0.051730120038494795 - 0.07177165013057085im
  -0.10587660347753756 - 0.04529737010378714im
    -0.106418076037981 - 0.055648667142659765im
  -0.04573963545115895 - 0.11407686119586764im
 -0.028415056431629778 + 0.037219265439321234im
  -0.03458423293772588 + 0.07255074406425079im
  -0.10236436664246738 - 0.08848490575675375im
   0.02893631644231962 - 0.0045723207991108655im
  0.050162114623297505 + 0.03446039564311082im
  -0.21288452522679727 - 0.12516131979107176im
    0.1715737107080564 - 0.16257366089910946im
  -0.14180051717132963 + 0.04010562942805309im
    0.3616757560250588 + 0.0im
   0.10894125226662467 + 0.0015903347281385212im
  -0.10786491063851787 - 0.10967767259829289im
   0.09796785131962711 - 0.01459631690657519im
  -0.22612475250729616 + 0.030258075747190503im
  -0.10347559128330312 + 0.022430573534227703im
        0.073571129415 + 0.06612348036098457im
   0.07133408242292878 - 0.07363442679552691im
   0.19697058977605514 + 0.03981830112102932im
    0.0962282801835823 - 0.16966990057497172im
    0.2148100385956007 - 0.21984742261352402im
   0.16128748850900806 + 0.085295605596713im
  -0.33325308645403734 - 0.004996885719380237im
   -0.1943385522137676 + 0.08898331856109185im
  -0.07791765161582022 - 0.04141034030256564im
  -0.18754815153932503 - 0.08543515757699739im
   0.12337180788411496 + 0.1284129460144158im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 7 March 2023 21:04">Tuesday 7 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

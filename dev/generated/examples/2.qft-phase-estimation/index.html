<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.311667-0.0630205im     0.0564332-0.0553048im    -0.0617074+0.0367887im     -0.146643-0.0109778im     -0.120657-0.0230755im     0.0775651-0.094076im      0.0318417+0.0349792im   -0.0519595+0.0950444im      0.0511555-0.0335506im    -0.206827+0.0988335im     0.0456683+0.208785im     -0.0900322-0.168369im        0.107444-0.133264im      -0.252758+0.055206im        0.135633+0.025859im      0.237034+0.169077im      0.0116685-0.0680142im    -0.108958+0.0133431im      0.164912+0.190689im     -0.124557-0.0362964im     -0.14118+0.061403im       0.175054+0.0463553im   0.0179761+0.0463028im     0.107646+0.0995857im    -0.0354032+0.0489476im    -0.117944+0.12499im      0.0715592-0.118665im     -0.270632+0.0856233im    -0.0683707-0.302065im       0.147172-0.0152573im    0.0643635+0.17631im     -0.125277+0.0638934im
  -0.142018+0.27182im      -0.0557856-0.208969im       0.125942+0.0174007im   0.000935744-0.151163im      -0.102472+0.0601359im    -0.0845043+0.00855952im    -0.316283+0.0132787im     -0.12111+0.00871737im      0.239114-0.0105077im    0.0157614-0.162923im      -0.140634+0.183448im      -0.149841+0.0859532im       0.151927+0.112663im     -0.0108099+0.029956im     -0.00615846-0.201832im     0.0405466+0.160352im      0.0128671-0.146215im      0.111436-0.118949im       0.162449-0.0117876im    -0.116173-0.00212149im    0.148692+0.181566im      0.0409748-0.139964im    0.0500486-0.102023im    -0.0588969-0.199684im      -0.107319+0.114185im     0.0410152-0.010801im     -0.256065+0.0178567im    -0.140394+0.0680652im     0.0560684-0.0311469im     0.0117917-0.0140343im    0.0109862-0.244157im   -0.0215489+0.0980796im
    0.10483+0.0905825im      0.289256+0.0775192im   -0.00953371-0.0766491im    -0.0265791-0.131308im       0.103937-0.142803im     0.00676958-0.0850741im    -0.0847078-0.139857im    -0.0471255+0.315649im        0.223247+0.183498im     0.0632146+0.106351im    -0.00763138+0.0372627im    -0.0985083+0.149174im      -0.0179138-0.087057im       0.062524+0.0742278im      -0.162958+0.0694934im    -0.164429-0.186701im      0.0682387+0.0643881im    0.0134955-0.0431896im      0.144449-0.200632im      0.271401+0.0165956im    -0.250019-0.215294im       0.168042-0.0615103im   -0.101368-0.0738202im   -0.0553529-0.0011942im      -0.21313+0.025075im    -0.0792857-0.0498864im    0.0124282+0.0183391im   -0.0653118-0.0193488im    -0.0803443-0.172535im     -0.0633066+0.00414343im  -0.0310509-0.039566im     0.187579+0.11759im
 -0.0636656+0.0287932im    -0.0373111+0.150018im      0.0771243-0.0153989im      0.185298+0.00633786im    -0.173226+0.0672849im     0.0917349-0.0186725im    -0.0587361+0.0895548im   -0.0375956+0.0223331im       0.105852-0.265921im       0.18969+0.124507im      -0.070248-0.17688im        0.156913-0.0500248im     -0.0393976+0.0703857im     0.0725707+0.230558im      -0.0726613+0.0346769im   -0.0324314-0.0811462im      0.291388+0.152196im      -0.04188-0.195886im     -0.0221473+0.0390206im    -0.096664+0.273162im    -0.0752622-0.106998im       0.167462-0.028683im    0.0153872+0.0104777im    0.0715604+0.260266im      -0.049964+0.186681im     0.0849907+0.147335im    -0.0720803+0.0978959im    -0.213464-0.00594798im   0.00188749+0.0668214im      0.149255-0.00390717im   -0.106193-0.0557001im   -0.261823-0.0920624im
   0.213422+0.0371203im     -0.182156+0.111318im      -0.164639+0.233595im    -0.00661676+0.107696im        0.12889-0.229919im      0.0607093+0.0151776im     0.0677242-0.0235626im    0.0455595+0.185545im      -0.0864484-0.137245im     0.0674242+0.00499152im    0.0287768-0.0395175im     0.0740815+0.037875im       -0.236352+0.164003im    0.000904281-0.0793251im     -0.0315315-0.120125im      0.257922+0.0608313im       0.19169-0.114321im     0.0338656-0.0180247im     -0.162905+0.0697262im    0.0825438+0.0325195im   -0.0231408+0.0441246im      0.204452+0.0935229im  -0.0403624-0.0463043im     0.100329-0.221104im     -0.0402735+0.0346171im     0.126082+0.0152788im      -0.0537-0.2201im      -0.0430743+0.0547022im      0.222449-0.0562057im    -0.0886733-0.00761683im   -0.139637-0.283838im     0.205019-0.0125972im
  -0.203886-0.0151585im     -0.178868+0.162804im     0.00658665-0.172686im       0.022785+0.0789023im     0.0584346-0.0585818im     0.0657053-0.172803im     -0.0202497-0.0243164im    -0.103097+0.10785im       -0.0720525-0.249042im      0.271963-0.0323837im    -0.0126511-0.0240415im     -0.052679-0.0703793im     0.00400756-0.0147976im     -0.162974-0.281822im      -0.0620818+0.154031im       0.07556+0.0538697im      0.116911-0.0495974im    0.0914394-0.098293im      0.0452556+0.0268931im    -0.054056+0.0736719im   0.00450172+0.0858936im     -0.132006-0.248019im   -0.0148382+0.0126097im    -0.315996+0.0917844im     -0.101675+0.0494454im    -0.205439+0.0381775im     0.107801-0.254612im      0.179232-0.056952im     -0.0762558-0.170348im    -0.00289037-0.0208102im     0.154014+0.0465423im   0.0444648+0.184496im
 0.00433805-0.0447755im      0.173831-0.17972im         0.17591-0.188665im      -0.122777-0.0837836im         0.155+0.192336im      0.0727081+0.115426im      -0.219188-0.205788im    -0.0380408+0.0106207im      -0.172697-0.144082im    -0.0178843-0.0427964im     0.0645507+0.00646401im   0.00808093+0.12597im       -0.0544667+0.0818823im     -0.202625+0.0116808im     -0.0180639-0.141971im      0.157945-0.119889im       0.178023-0.0251478im   -0.0116117+0.328689im      -0.194373+0.0407304im    0.0104608+0.253874im    -0.0906278+0.0830644im    0.00622427+0.0279337im   0.0300584+0.179661im    -0.0536559+0.0451301im     0.0518594-0.0324799im   -0.0501221-0.113959im     0.0625727+0.0742456im   -0.0979522-0.0893582im     -0.098108-0.0587464im      -0.10291+0.332368im    -0.0308305-0.103919im   -0.0224886-0.0231222im
   0.260161+0.0656624im      -0.21094-0.233244im      -0.040826+0.181079im       0.181726+0.112493im    -0.00748103+0.14702im       0.0724085+0.106379im    -0.00720844-0.173829im      0.100321-0.169943im      -0.0388722+0.0686445im     0.043083-0.105748im       0.104872+0.0220314im    8.52021e-5-0.00118719im      0.109798+0.0633899im     -0.040893+0.1224im       -0.00800568-0.0532889im    -0.147155-0.0413827im      0.254411-0.082341im    -0.0726834-0.148307im       0.159176-0.136953im      0.123842+0.126836im     0.0601142+0.217335im       0.203447+0.139885im   -0.0463162-0.0893148im   -0.0280022+0.146084im    -0.00170128+0.0490373im    -0.229025-0.0574807im    0.0778486+0.0686865im     0.280137-0.207683im     -0.0173831-0.0984364im    -0.0774976-0.112589im     0.0597048+0.0895983im   0.0340657+0.0380689im
   0.108755+0.0238758im      0.107938-0.145666im      0.0656911+0.0324844im      0.112681+0.145121im     -0.0463131-0.0999583im     -0.277287+0.205171im      0.0954755-0.00724046im   -0.101396-0.0279541im      0.0873438-0.0638545im     0.142584-0.0357806im     0.0515688-0.0913554im   -0.00705447-0.0334348im      -0.155789-0.235237im      -0.160873+0.00868023im    -0.0943745-0.111323im     0.0392213-0.111511im     0.00916456-0.379772im     0.0320961-0.0717502im     -0.170932+0.039059im     0.0538786+0.0169893im    0.0482362-0.158132im      -0.135494-0.119622im    -0.206665+0.174536im     0.0414131-0.0828719im     -0.138147-0.11698im     -0.0900121-0.140649im    0.00187771+0.110225im     -0.093523-0.0941008im     0.0772274+0.00275305im     0.289008-0.191164im      0.146305+0.0029431im   -0.117668-0.00653579im
  0.0548871+0.00037126im     -0.07095+0.0128037im    -0.0405628-0.288377im     -0.0636225+0.164102im      0.0517122-0.0775958im     -0.146983+0.0316869im      0.179297+0.0432803im    -0.145431-0.240716im      -0.0680136-0.120601im      0.141754+0.0753857im    0.00618544+0.130445im      0.0771726-0.0467888im       0.144405+0.10104im       0.0744122+0.0746728im      0.0343307-0.14551im     -0.0660911-0.0746348im     -0.152887+0.070902im     -0.134698+0.0582218im     -0.162563+0.174344im   -0.00672328-0.24118im      -0.149059+0.0970951im        0.2449-0.0763946im  0.00163412-0.0731879im   -0.0166583+0.206953im      -0.146021-0.0223894im     0.122434-0.090039im     -0.245608+0.125211im    -0.0505034-0.16994im      -0.0834214-0.0645276im    -0.0634078-0.0280875im    0.0300067-0.106787im     0.159731+0.264533im
   0.232191+0.141307im      -0.116151+0.143869im      0.0141963-0.0915004im      0.217334-0.134228im     -0.0682699-0.244503im       -0.15538+0.10151im       -0.194617-0.0642566im    0.0676848+0.00470563im     -0.135728-0.0506714im     0.132136+0.211489im       0.163616-0.159005im     -0.0861421+0.0961663im       0.230143-0.100398im     -0.0201504-0.14864im         0.293623-0.215923im     -0.175815+0.0625506im   -0.00837505-0.030252im      0.064465+0.240674im      0.0576628-0.0424265im    0.0316483-0.054146im    -0.0728645-0.0539635im    -0.0357106+0.0532145im    0.168762-0.0260328im    -0.147773+0.0292233im     0.0701204+0.00659665im    0.063961-0.00590609im    0.114376-0.050266im    -0.0150206+0.11801im      -0.0582486-0.0050585im    -0.0177926-0.143448im    -0.0924012-0.0976585im   -0.215545-0.0592309im
 0.00455667-0.0402132im      0.124403-0.242873im      0.0618136+0.183997im       0.220988+0.151806im      0.0197869-0.0723989im     0.0575635-0.179442im    -0.00392489+0.271505im     -0.112993+0.222257im        0.059769+0.127503im    -0.0119113+0.101579im       0.129881+0.0414754im    -0.0624852-0.114819im       0.0048054-0.0357001im     0.0224663-0.193163im       -0.189711+0.0498232im    0.0550646+0.113152im    -0.00824599-0.159733im     0.0215313+0.0290939im  -0.000143286+0.125701im     0.0860196+0.0500875im   -0.0175138+0.0727698im   -0.00438539+0.0834521im    0.119759+0.0791047im    -0.136963+0.275665im     -0.0351086-0.0260876im      0.28173-0.0561834im   -0.0140057+0.147283im     0.0223333-0.0536063im    -0.0718498+0.122414im      -0.365225+0.00292947im   0.0785926-0.0826284im   -0.145333-0.000273611im
  0.0166511+0.147523im      0.0821282-0.224789im     -0.0160864-0.162996im      -0.222034-0.0059556im     -0.169755-0.146081im      0.0243979-0.0684515im    -0.0435276-0.188834im      0.130404-0.0834572im     -0.0270961-0.0556535im    0.0909528+0.188864im     -0.0827119-0.0860056im     -0.025832-0.238151im      -0.0287381-0.0397425im      0.132803-0.0306644im      -0.130428+0.0723731im     0.164875+0.183884im     -0.0877673+0.0286625im    0.0527524+0.0698066im      0.199754+0.027837im     0.0436806+0.0855641im     0.194902-0.184492im       0.113967-0.0748592im  -0.0298955+0.22643im       0.128502+0.0423704im      0.181764-0.084088im    -0.0890098+0.0715323im   -0.0540391-0.0247225im     0.159736-0.243717im     -0.0792544+0.0388101im    -0.0446647-0.16961im      -0.245663-0.186683im    0.0376652-0.000999902im
  0.0526133-0.120874im       0.150584-0.228227im     -0.0120068-0.00140619im     0.279007-0.263495im      0.0916319-0.183621im      -0.129494+0.212361im      -0.157693+0.200108im     -0.123409-0.173454im      -0.0733943-0.18316im     -0.0756533+0.214047im      -0.145354+0.0539589im     0.0505323-0.0533399im      0.0898615-0.0701445im    0.00722623-0.143757im     -0.00443836+0.166817im     0.0177974-0.203153im     -0.0291755+0.00976445im  -0.0293223-0.0800789im     0.0371775+0.0322755im    -0.118145+0.214727im    -0.0224946+0.00840443im    0.0566399+0.0119037im   0.0225842-0.0859369im    0.0904471-0.00373935im     0.026491-0.0895923im   -0.0883889+0.15705im      -0.113174-0.141035im     0.0949616+0.09738im        0.142662+0.0260271im    -0.0700447+0.0488731im     0.065193+0.09157im      0.311561-0.0448389im
 -0.0707277+0.056266im      0.0528529+0.0484196im     -0.140529+0.118118im       0.104253+0.132433im    -0.00118116+0.0149768im      0.105887+0.024583im      -0.210295+0.13405im       0.171911+0.0445186im     -0.0594386-0.0623157im    0.0783617-0.0765631im     -0.158242+0.168479im       0.126801-0.0551212im      -0.099764-0.453355im       0.235642+0.065837im        0.178413-0.0551352im    0.0519707-0.174908im     -0.0593659+0.0891613im    -0.164645+0.0810949im     0.0542569+0.0436973im    0.0291676-0.124875im      0.147758-0.0550067im      0.100413-0.032775im     0.149643+0.156906im     -0.031507-0.0360808im    -0.0750941+0.123193im      -0.12181-0.207549im    -0.0418221-0.0712572im     0.099731-0.0681546im      0.114287-0.150042im     -0.0451494+0.218804im      0.106601-0.111655im     -0.14655+0.0249559im
  -0.125712-0.0230114im      0.102633+0.0200274im      -0.29753-0.0626566im      0.102068-0.162956im      0.0427279+0.0993379im      0.030887-0.0250244im    -0.0281249+0.0637904im     0.112704-0.000715198im     0.106247+0.0873314im    0.0545196-0.0727118im     0.0747856-0.109076im       0.144846-0.173527im       0.0761071+0.0902259im    -0.0318253-0.0575161im       0.044344+0.106342im      0.375443-0.0183215im     -0.168653-0.0853405im    -0.103271+0.21877im       -0.112722-0.174665im    -0.0113318+0.0712393im    -0.105079+0.09065im        0.125803-0.0289968im   0.0770248-0.311008im     -0.077583-0.0677431im     -0.215438-0.0376274im    -0.144048+0.0554142im    0.0730254+0.238519im     0.0625877-0.0747538im    -0.0143512-0.00913838im      0.11693-0.19989im     0.00721891-0.159099im   -0.0981061-0.140516im
   -0.13673+0.0765654im    -0.0580597+0.0727548im     -0.128562-0.162892im      0.0654049+0.118301im      -0.129367-0.251937im      0.0796025+0.099641im      0.0924982+0.0490252im     0.247494+0.0283203im       0.123328-0.164983im     -0.114648-0.192043im     -0.0915061+0.165474im     -0.0505656-0.0548752im     -0.0825358+0.10357im        0.055162+0.0434992im      0.0182739-0.1022im        -0.17305+0.0258406im    -0.0979442-0.19301im       0.116908+0.192115im      0.0125747-0.179551im     -0.143386+0.31711im       0.109526-0.0722057im      0.198728+0.0254278im   -0.100458-0.0313121im  0.000544701+0.0437098im    -0.0580999-0.218334im      0.106611-0.0610929im    0.0977899-0.0323155im    -0.147995+0.0320267im     -0.113389-0.056919im       -0.17703+0.0512825im    0.0951332+0.239571im    0.0121282-0.0265914im
  -0.176971+0.0314575im   -0.00989186+0.0193886im      0.179788-0.00606957im   0.00180949+0.0800291im    -0.0883545+0.0631421im     -0.127141+0.363262im       0.159001-0.0440326im   -0.0381225+0.201077im       0.0281066+0.108611im    -0.0259009-0.0412922im     0.0590268-0.0630766im    -0.0219437-0.310525im        0.133664-0.0743464im      0.280993-0.131945im       0.0544743-0.129977im      0.179216+0.0032705im    -0.0302376+0.0526281im     0.149879-0.10013im       -0.134529-0.220122im      0.241921+0.0243847im   -0.0557805+0.176042im      0.0635378+0.136161im     0.105434+0.111442im     -0.105827+0.123294im       0.117378+0.0594032im    -0.112695+0.135095im    -0.0762008-0.0980909im    -0.156298+0.0551361im   -0.00194063-0.0936254im     0.0864121+0.0917144im   -0.0533856+0.0776029im    0.121403+0.0216386im
  -0.118919+0.067293im     -0.0274991+0.114724im     0.00527356+0.402601im     -0.0664809-0.0771877im      0.122697+0.0545265im    -0.0266238+0.12399im      -0.0148213-0.102791im     0.0481767+0.0977916im    -0.00848591-0.263566im    -0.0303653+0.158073im      -0.219882+0.0946582im      0.163915+0.105106im      -0.0263767+0.028757im      0.0221413+0.0081444im      0.0285805-0.176488im     0.0508041+0.0437604im     -0.106626-0.0789179im    0.0538907-0.109482im       0.228995+0.0638662im    0.0708761-0.0928932im    -0.161862+0.0756674im     -0.091755-0.130721im     0.109282-0.0224836im   0.00666035+0.192007im     0.00375698-0.395331im     0.0458728+0.0678211im     0.184217+0.205856im     0.0227124-0.121313im      -0.157184-0.0186216im      0.101243+0.032511im    -0.0164035-0.0224408im    0.083117-0.0297771im
  -0.098833+0.120144im     -0.0329713-0.105661im      0.0429278-0.0190147im      0.198138-0.156121im      0.0777199-0.121163im     -0.0419137+5.70564e-5im     0.145522-0.0376385im    -0.129843-0.0751002im     -0.0613636-0.123197im     0.0669117-0.0750479im   -0.00713817+0.0992271im   -0.00566596-0.0293117im       -0.06491-0.0701682im     0.0771877+0.334512im      -0.0392028+0.0663681im      0.23885+0.150892im       0.274558+0.0524692im    0.0678322+0.0734974im     -0.065963+0.0623803im     0.131786-0.300764im     0.0727127-0.130863im     -0.0686696+0.10121im    -0.0549527-0.135637im    -0.0582293-0.0521269im    -0.0689289-0.139613im     -0.165544+0.00789179im  -0.0907324-0.00969256im   0.0362232+0.22327im       -0.307903-0.026616im      -0.208784+0.0228553im   -0.0850079+0.146232im    -0.100227-0.137708im
   0.109509-0.162727im      0.0164948-0.0578845im    -0.0231263+0.064138im     0.00670318-0.0623825im      0.172579-0.0762122im      0.127984+0.108304im      -0.023629-0.226163im      0.162506-0.00295259im     0.0209862+0.0342765im     0.191907+0.0934981im    -0.0358855+0.0936951im      0.245147+0.0754022im     -0.0168703+0.0437358im     0.0514349-0.194233im        0.187492+0.119148im     0.0917407+0.09993im      -0.0543048+0.0461345im      0.17648-0.0390015im     0.0143659+0.0909225im     0.101463+0.120506im      0.273734-0.117779im      -0.149572+0.112661im   -0.0341533-0.13186im      -0.029151-0.0447397im    -0.0266936+0.241486im       0.09669-0.0140246im     -0.21254+0.206892im     -0.232744-0.0757653im     -0.155941-0.00897798im    0.0331459-0.021844im      0.128295+0.205425im   -0.0300047+0.236301im
  -0.227456+0.136898im      0.0245773-0.0218386im      0.025582-0.0284748im     0.0954726+0.0451148im     0.0517835+0.352593im      -0.153376+0.173412im     -0.0730742+0.103643im     0.0983475+0.0989119im       -0.19525+0.0240301im    0.0227834+0.120142im       0.109751+0.0878109im      0.159568+0.0339335im     0.00932593+0.0229593im     -0.192573-0.0102489im     -0.0710833+0.0410606im    -0.026192+0.0794541im   -0.00515807-0.0990049im     0.256237+0.0895387im     0.0626816+0.0373598im   -0.0618633-0.233872im     -0.022192-0.270984im       0.290721-0.0369811im   -0.104559+0.0143481im      0.10271-0.048845im      0.0129646+0.265466im      0.181822+0.130908im      0.125108-0.045654im     0.0699893-0.0840552im     0.0435443-0.13205im       -0.078596-0.0928315im     0.043093+0.130997im    0.0901056-0.0713348im
 0.00654594+0.250805im     -0.0976878+0.0817824im      0.217211+0.148732im     -0.0434914+0.112655im      -0.187684+0.0304886im     0.0920523-0.0853244im   -0.00866129-0.0798922im    -0.181627-0.0864797im       0.107348+0.0895207im    0.0422365+0.0230094im     -0.110929-0.0295194im      0.173933-0.0362729im      0.0125985-0.277472im     -0.0841498+0.0169118im       0.104854+0.228211im    -0.0804145-0.021613im     -0.0781234-0.201404im     0.0626999+0.0898511im      -0.26298+0.0714844im    -0.101711+0.191979im     -0.120893+0.0069156im     0.0469205+0.116584im     0.207265-0.087966im      0.112675-0.151946im     -0.0170085+0.0723952im    0.0440167-0.04074im      0.0595865+0.0422108im     0.146141+0.079054im      -0.310217-0.00251766im   0.00730228+0.0190462im    -0.123876-0.0148915im    0.242856+0.081463im
 -0.0144403-0.0914542im    -0.0374102-0.160635im       0.110916+0.0794158im      0.170391+0.047403im      0.0214162+0.0361299im     0.0683311-0.102795im     -0.0636593+0.0367742im     0.226804+0.286356im       -0.299914-0.0808244im   -0.0779391-0.136298im      0.0117305-0.117673im      -0.107496-0.0734664im       0.204904-0.171064im     -0.0188269+0.0629017im      0.0634656+0.0650971im    -0.135651+0.153197im     -0.0149963+0.199249im     0.0407568-0.0667685im       -0.1607+0.0155705im    -0.148478+0.0215974im    -0.119549-0.0550072im     0.0967071+0.0298782im   -0.236495-0.0273942im   -0.0686367-0.221962im     -0.0689148-0.291262im    -0.0120114+0.111718im     -0.130102+0.12426im      -0.029605-0.0996947im    -0.0423433+0.0531536im      0.130086+0.0163096im   -0.0790209-0.0887952im   0.0184155+0.257321im
 -0.0612984-0.0399466im     -0.015654-0.0436019im     0.0761218+0.0806043im     -0.189067-0.170041im     -0.0988921+0.0840792im   -0.00856776-0.100489im     -0.0546099-0.012999im      0.159596+0.146089im       0.0388358+0.00889748im   0.0825403-0.043154im       0.334573+0.0842987im     0.0113205+0.0526113im       0.131444-0.00157015im     0.215988+0.11409im        0.0734921-0.0471977im   -0.0213519-0.0775746im     0.0838198-0.0407725im     0.069028-0.0589661im      -0.24968+0.265955im     -0.111917+0.0889099im    0.0385744-0.17591im      -0.0985439-0.113606im     0.229942-0.149473im     0.0809823+0.164953im      0.0186762-0.162868im      -0.15817-0.142708im    -0.0287863-0.135018im    -0.0893772-0.0922018im      0.178581-0.0671904im     -0.147929-0.26197im      0.0872751+0.0735264im    0.158623-0.0890925im
   0.145106-0.169972im     -0.0545572+0.0827358im     0.0648689-0.0749326im      0.103021-0.0770242im      0.229869+0.0436212im    0.00800002-0.222145im      0.0117044+0.00767817im   0.0346538-0.0470833im       0.153795-0.0882267im     0.144678-0.182133im     -0.0659643+0.153307im      -0.137003-0.0666373im       0.118445-0.0143336im     0.0934217-0.000925673im    0.0144606-0.105683im      0.024004+0.00231329im   -0.0853874+0.0224705im     0.376923+0.0297358im    -0.0363307-0.0522447im   -0.0717661+0.0316131im    -0.104629-0.0109715im     -0.120702+0.199864im   -0.0118347+0.279034im       0.26722+0.101665im      -0.135724+0.0504602im    0.0807576+0.0687137im     -0.06787+0.140795im      0.267801+0.0382699im     0.0498563-0.245513im      0.0983833-0.0235091im   -0.0322916-0.0568748im   0.0395013-0.199091im
   0.193462-0.0822865im    0.00411606-0.169679im     -0.0095365-0.0734948im     0.0430646-0.0710165im     -0.157913+0.106208im      0.0226055+0.0280364im      0.175628+0.0674544im    0.0301303+0.0390678im       0.114585-0.0869066im    -0.112275-0.19327im       -0.151139-0.17931im        0.124596-0.0615877im       0.222009+0.0270475im     0.0984644-0.025856im      -0.0886296-0.103586im      0.059706-0.101769im       0.203138+0.0781169im   -0.0376172+0.112431im       0.140089+0.0761913im    0.0433011-0.0640772im    0.0596079-0.189142im      -0.143225+0.0131643im    0.139584-0.0548875im    -0.128216-0.127079im      -0.108453+0.0267716im     0.340959-0.0298153im     0.162979-0.243163im     0.0195831-0.178988im      -0.209528-0.0286744im      0.163489+0.0357539im     0.173412-0.0960583im    0.177675-0.0463915im
 -0.0326584-0.140682im       0.036581-0.0489598im     0.0204613+0.0352473im    -0.0977365+0.132975im      0.0538629-0.115814im     -0.0270678+0.194889im      -0.267143-0.0566043im   -0.0634159-0.0308221im     -0.0860283-0.0389371im    -0.185278+0.0322524im   -0.00207509-0.177778im      -0.304002-0.227163im        -0.16002+0.0780335im     0.0692007+0.185787im        0.135796+0.0672874im    0.0152386+0.217218im      0.0141849-0.047911im    -0.0226996-0.0725224im    -0.0767827-0.0670534im   -0.0162536+0.00125841im  0.00233576-0.172664im      -0.125593-0.11545im     0.0656706-0.297987im     0.0200181+0.189414im      -0.141388+0.154181im       0.21432-0.166973im     0.0676621+0.0694008im     0.208665+0.0101337im     0.0506406-0.207654im       0.095628+0.104267im    -0.0578075+0.0139173im   0.0489284+0.0340816im
 -0.0487031+0.0627687im      0.109471-0.1007im       -0.0687913-0.155293im       0.119101+0.00230198im    -0.129095-0.0441299im      0.188138-0.297059im       0.142246-0.145741im      0.023802-0.0264853im      -0.110194-0.142534im     -0.031863+0.26712im      -0.0196237-0.0847425im     0.0230055-0.0570931im   -0.000599768-0.135741im      0.0140739+0.182417im      -0.0511064-0.249602im   -0.00142131-0.0465952im    -0.0397317-0.210029im     0.0865202-0.116898im     -0.0382733-0.149397im    -0.0530611-0.111735im    -0.0413647+0.105457im      -0.221687+0.0764605im   0.0933875-0.144418im    -0.0798593-0.166793im      0.0939557+0.149475im     0.0158936+0.146252im      0.077085+0.174817im     -0.113603-0.160138im       0.272097-0.104709im      -0.117169+0.133828im     0.0326889+0.106883im     0.117604-0.00283437im
 -0.0440296+0.0274961im      0.289257+0.00997198im   -0.0118147+0.0525074im    -0.0351307-0.0235919im     0.0144433+0.133113im       0.248566+0.00141735im    0.0661238+0.131529im      -0.14991-0.209713im      -0.0335288-0.206216im      0.125693-0.0911814im       0.26065-0.212036im      -0.150833+0.200312im      -0.0510201-0.0375645im      0.146385-0.0113033im        0.23959+0.220779im   -0.00743467+0.0121589im    -0.0477078-0.151421im      0.123429-0.0473286im      0.198161-0.0314295im   -0.0233696-0.103364im      0.144454+0.0908086im      0.169264+0.193679im   -0.0486665+0.094044im     -0.163819+0.0459611im    -0.0758896-0.12471im      0.0878596-0.101193im     0.0322915-0.04816im      -0.165504-0.00745102im    0.0228352-0.0532387im      0.116094-0.0395654im    -0.141453-0.0356387im    0.161124-0.0152572im
   0.208691+0.0896741im    -0.0111561+0.155151im       0.171411-0.00835566im    -0.141913+0.0164205im     -0.119672-0.0589431im    -0.0982962-0.0223507im    -0.0416997+0.168989im    0.00416778+0.0453439im      -0.186715-0.0480854im    -0.139053+0.0301259im     -0.228899-0.170189im     -0.0268625-0.00464278im    -0.0843389+0.0649628im     0.0299152+0.0302322im     -0.0473164+0.253868im      0.034942-0.0567582im      0.133945+0.137948im      0.298163+0.120851im     0.00560704-0.100719im    0.00509259-0.0999623im    0.0886855+0.179176im      0.0746736-0.0134571im   0.0686255-0.0147433im    0.0132797-0.0185117im     0.0957342-0.0360298im    -0.113757-0.131119im    -0.0321898+0.280518im     -0.108558-0.022241im      0.0439718-0.113478im     -0.0847122-0.158147im      0.428645-0.091836im    0.0298448-0.0756711im
  0.0447714-0.00021241im     0.104844+0.0636025im   -0.00827959+0.200355im      -0.203601+0.019021im       0.203029+0.00354318im   -0.0519794+0.0608575im      0.161178+0.141983im      0.120418+0.00170458im    -0.0320349-0.075198im      0.279414+0.0671454im      -0.17095-0.0674641im     -0.356681-0.0413351im       0.189711+0.0784317im    -0.0481591+0.083921im       -0.135645-0.100087im    -0.0874583+0.144752im       -0.03012-0.0906345im    -0.129372+0.0608983im    -0.0444509+0.0493998im    -0.081574+0.050752im     0.0671818-0.174516im       0.137697+0.107177im     0.246271+0.0483865im    -0.142297-0.106067im     -0.0779815+0.202252im     -0.237294+0.0722271im     0.022122+0.0893508im   -0.0110009+0.0122665im    -0.0415952+0.242678im      0.0156561+0.124325im      0.105979+0.0873505im   0.0977426-0.083942im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.09445802259610604 - 0.0032708371753808444im
    0.1442954163552066 - 0.0684778744344673im
  -0.07410366106940217 + 0.2617535139831328im
  -0.08345144237951793 + 0.01409281438949313im
   0.15211587653975678 + 0.21115378855794595im
   0.05170501126062918 + 0.16922772027742258im
   -0.1253445375981223 - 0.057359678998561495im
   0.10093413393237913 - 0.19004165797418734im
    0.1616683035033857 - 0.04968790289724285im
   0.17740136443303947 - 0.042437970704620374im
   -0.1272224004858406 + 0.25974534459467835im
   0.18131655666586188 - 0.03724909590429081im
   0.08227634705457448 + 0.09328087687361089im
   0.18503260522567064 - 0.045982923975686756im
   0.24501090620189625 + 0.07543596462331315im
   0.05035297304899168 - 0.07692983089036538im
   0.33910165579791784 + 0.0im
   0.09772430678256042 - 0.024270254388374404im
  0.060426184670036145 - 0.07820877703038968im
  0.023002395122360866 + 0.07691300878733534im
  -0.06585353229478927 + 0.0813370776563765im
  -0.10126000107370774 - 0.10821835992814423im
 -0.041825951100409715 - 0.07076076288760767im
  -0.16942833918695135 + 0.05703607732285884im
 -0.011913258891930066 + 0.15145939330155822im
   0.14374718725709534 + 0.05430967989097539im
   0.07802922604770345 + 0.2904278535451323im
 -0.030660355889549726 - 0.0342488753433557im
   0.07829003318528024 + 0.06051778375009842im
 -0.031639676437244954 + 0.15314089030533973im
  -0.04693272917826544 - 0.013359037861425492im
   0.10413687824469971 - 0.12068786108357614im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Saturday 18 June 2022 23:43">Saturday 18 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

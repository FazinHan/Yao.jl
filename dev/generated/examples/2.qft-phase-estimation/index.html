<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.395688-0.300759im     -0.0706782-0.0128821im     -0.101939-0.132999im      0.0622551-0.10052im        -0.070647+0.0511149im     -0.257159+0.0869089im   -0.0549785+0.0145095im      0.0238374+0.155019im     0.0509888+0.0998765im      -0.15466-0.253483im      0.149701+0.0840962im    -0.0418811+0.0111716im      0.0122478+0.0506143im     -0.0604509-0.141703im    -0.00447573-0.055672im    -0.00318686-0.154148im    -0.00137112-0.120669im      -0.113584-0.0386227im      0.0344627+0.146866im      -0.0680526+0.0195044im   0.0448537-0.158339im      0.0725188-0.0249855im    0.00669593-0.13505im       0.150682+0.126174im     0.286296+0.0850248im   -0.0331878+0.184952im    -0.0961417+0.170219im      0.0418631+0.212477im     -0.113073+0.0408951im      0.122333-0.00731218im    0.0359261+0.0647625im     -0.0558092-0.129966im
 -0.0621238-0.122248im       0.364144-0.0606688im     -0.101407-0.0934839im    -0.0422208-0.000451551im     0.176903-0.0567639im    0.00113605-0.114313im       0.22656-0.016264im       -0.162588+0.120975im      0.117412-0.0909405im      0.184133+0.00624878im  -0.0336866+0.173745im      0.0012194+0.031674im       -0.113082-0.0393084im     -0.0645473-0.084046im      -0.220208-0.0598799im     -0.178191+0.108472im        0.16423-0.0884403im     0.0821477+0.0463211im       0.334582+0.03042im       0.00660909+0.141713im   -0.0194933+0.0631799im    -0.0162719-0.0911725im      0.102571+0.0119528im  -0.00640967-0.0934054im    0.164209+0.0372729im     0.031992-0.0861467im   -0.0602446-0.0756055im     0.0274422+0.0591422im    -0.218866+0.161311im      -0.188036+0.296116im      -0.116268+0.0648695im        0.01396+0.00554494im
  -0.229999-0.0154354im      0.102247-0.00792328im     0.455734-0.114492im      -0.134721-0.00656653im     0.0816416-0.0501755im   -0.00427993+0.211081im      0.158414-0.0256328im     0.00848495-0.118257im    -0.0879576+0.102809im      0.0884294-0.0761161im   0.00531728-0.0354089im    -0.0589359-0.0713616im      0.0599915+0.101986im       -0.112067+0.00216147im     0.112007-0.045577im       -0.03069-0.0387457im      0.154014+0.017893im     -0.0945136-0.195304im     -0.00607263+0.115879im        0.057368-0.0520878im    0.300527-0.182828im      0.0125533-0.216974im     -0.0640192+0.089436im    -0.0392435+0.141993im   -0.0658211-0.191878im     -0.134418+0.0652288im   -0.0653119+0.00775946im      0.27423+0.0677676im   -0.0997536-0.0297533im        0.1286+0.0236816im     -0.208541+0.047592im      0.00547751-0.0413846im
  0.0293104-0.0574583im      0.168309+0.0982946im      0.006389+0.0232216im      0.329516-0.379514im      -0.0916278-0.120084im     -0.0473495-0.17641im      0.0293363+0.158609im      -0.0277857+0.0136187im    -0.139659-0.0883489im     -0.074393+0.151726im      -0.03816+0.0184073im      0.137235+0.226992im        0.126103+0.0217929im      0.0510363+0.0515839im     0.0503351+0.0729014im    -0.0198603+0.0751884im   -0.00428949+0.0463154im    -0.0469281+0.111406im      -0.0655289-0.013204im        0.122429-0.210713im     0.155411-0.0180493im     -0.112467+0.171113im     -0.0564176+0.13092im     -0.0253281-0.0311999im  -0.0123874-0.0877487im   -0.0440135+0.0854168im    0.0850529-0.0115186im     0.0780814-0.0812889im    -0.070577+0.0453869im    -0.0411412+0.0241226im    -0.0717203+0.362842im       -0.152599-0.287072im
  0.0916394-0.0488298im     -0.092393-0.206728im     -0.0525314-0.0979915im     -0.122713-0.238178im        0.403941-0.0786529im     0.0605692-0.212478im     -0.141619+0.000712467im   -0.0232223+0.0164943im   -0.0791267-0.0982158im     -0.158425-0.189109im      0.134305-0.161058im      -0.138555+0.0247838im       0.207425+0.0574361im      0.0246148+0.0792349im    -0.0194299+0.0402434im    -0.0353095-0.00988501im    0.0140015+0.220218im      0.0738581+0.0893397im       0.138823+0.0315028im      -0.018271-0.0245351im   0.0494607-0.00573929im    0.0345987-0.132301im      0.0203659+0.18394im       -0.18872+0.151441im    -0.105252-0.104046im      0.125921-0.248462im     -0.171602+0.0716018im    -0.0659417+0.0238913im   -0.0844558-0.0900672im    -0.0880454-0.0904946im      0.132777-0.12377im      -0.00794072-0.130995im
   0.109948-0.0733034im     0.0559074-0.0771287im    -0.0437084+0.0194484im    -0.0210656+0.0800246im       0.151764-0.194198im       0.244483-0.0964654im    0.0809627-0.176607im      0.00980964-0.0739496im    0.0562316+0.278393im      -0.232257-0.0518962im   -0.0875311+0.153235im       0.137881-0.117751im     -0.00865186+0.0198385im       0.114994-0.0452551im    -0.0617353-0.147865im       0.107675-0.182482im     0.00646532+0.0793427im      0.291824+0.201283im       0.0104926+0.0655178im     0.00754162-0.0464847im    0.114645-0.0607366im   -0.00846064-0.0862541im     -0.173641+0.0242081im    -0.139423-0.0834216im   0.0979514-0.0540572im    -0.237353+0.173329im      0.237064-0.02136im      -0.0379913-0.00335101im    0.318252+0.0682388im   -0.00693551+0.0787613im     -0.056651-0.0478176im     -0.0606401-0.0712883im
   0.134526+0.0953875im      -0.17073+0.0441528im     0.0852251-0.0603456im    -0.0409225-0.120856im     -0.00385795-0.0661796im    -0.0137503-0.180066im      0.428917-0.161211im      -0.0152752+0.0934899im    0.0620829-0.164492im      -0.193513+0.120506im     -0.194471+0.0365008im     -0.118358-0.217042im       -0.164419+0.00318089im     -0.139497+0.13656im         0.16224+0.093023im        0.10096+0.289631im     -0.0185403-0.0432186im    -0.0881099-0.0623118im      0.0756895-0.0325348im       0.140474+0.0725102im  -0.0710674-0.00188281im     0.200103-0.0617705im     -0.043394+0.177312im    0.00380616-0.0391197im   0.0802665+0.0936171im    0.0608756+0.102184im      0.118771+0.149604im        0.05467+0.190096im     0.0690335-0.079329im     -0.0718331-0.165217im      0.0490381+0.0241001im     -0.0169289-0.00756606im
   0.109534-0.0499267im    -0.0227802-0.126123im       0.110934-0.11202im      -0.0709437+0.152237im       0.0849252-0.0799976im     0.0643067-0.0104453im  -0.00845791+0.124243im        0.371429-0.208741im    0.00233568-0.162562im      0.0933711+0.0596177im     0.106251+0.051894im       0.225837+0.105851im        0.157988+0.0464535im       0.113487-0.0373797im     0.0727273+0.0154463im    -0.0827954-0.0293925im    0.00608617-0.213924im     -0.0465674+0.000352947im    0.0244123-0.000805754im     0.152353-0.189423im    -0.221029+0.150031im       0.184586-0.0744354im     -0.165602+0.054668im    -0.0302299+0.0780603im   -0.155131+0.179648im      0.162329+0.242426im    -0.0422312+0.147295im      0.0274416+0.0958352im    0.0415437-0.0114304im     -0.142271+0.279816im    -0.00382157+0.00550042im    0.00233402+0.0145908im
 -0.0522666+0.0186534im     -0.191037-0.234352im       0.104904-0.0163492im      0.103756-0.0545789im      0.0954698+0.157072im     -0.0123442-0.017102im   -0.00331986+0.00447844im      0.151892+0.079295im      0.500363-0.104643im    0.000402198-0.0650113im     -0.14924-0.000641112im  -0.0799662+0.0286444im      0.0782269-0.207473im        0.108622-0.0799342im       0.14774+0.166167im      0.0500294-0.0165023im     0.0444836+0.221693im     -0.0719511-0.0381672im      -0.116589-0.0493378im      -0.111809-0.250166im     0.103897+0.032126im      -0.119738-0.231147im      0.0677991-0.117429im     0.0724705-0.166596im     0.079735+0.0931486im   -0.0574041-0.00656109im    0.112337-0.167757im      0.0901196+0.00401513im  -0.0975219+0.135669im     -0.0753476+0.102826im      0.0341519+0.0137532im     -0.0975819+0.00990475im
 -0.0982676-0.0494061im     -0.014935+0.109124im     -0.0972432+0.149628im     -0.0231829-0.134646im      -0.0602438-0.32im           0.276968+0.131518im    -0.0985811-0.139954im       0.0122182+0.103329im     0.0332809+0.131352im        0.19711-0.154422im    0.00911693+0.0282695im    -0.0236162+0.0176823im      0.0747123-0.113705im       -0.199936-0.232629im     -0.0117983-0.0421019im      0.154824+0.206487im       0.233193+0.120503im      -0.146841+0.0789371im     -0.0864482-0.0216466im       0.101134-0.0848946im  -0.0493722+0.044828im     -0.0223463-0.0495423im    -0.0646367-0.160703im     -0.140306-0.134457im    0.0573387+0.12618im       0.154715+0.0796717im    -0.127869+0.165837im      -0.050395+0.0127647im   -0.0616805-0.299236im     -0.0104272-0.0333007im    -0.0389247+0.0124955im      -0.176725+0.0200768im
   0.251434+0.11619im      -0.0143284+0.0477378im      0.148564+0.116284im     -0.0159131+0.0515152im      -0.130495-0.0760334im    -0.0116635+0.0646299im   -0.0171219+0.0398672im     -0.0360888-0.0566037im   -0.0443264-0.0716345im      0.195279-0.0138021im     0.271654-0.0564497im    0.00870016-0.0240113im     -0.0501576-0.158027im       -0.177964-0.192407im      -0.114175+0.189586im      0.0834386-0.0866932im     -0.147366+0.247047im      -0.160858+0.120593im       0.0212493+0.000773308im    -0.105733+0.17095im     -0.180886-0.213671im     -0.0621381-0.176351im       0.110953+0.183842im    -0.0836275-0.0582248im   -0.128912-0.148385im    -0.0359585-0.0169567im     0.194825+0.0667769im     -0.033386+0.159771im      0.126992+0.191039im      -0.200539+0.0800949im    -0.0727299+0.107621im     -0.00463494-0.0825897im
  0.0158229-0.051981im     -0.0217547+0.198025im      0.0116002+0.0148344im    -0.0464055-0.120068im      -0.0652433-0.0262562im    -0.0294203-0.181021im    -0.0695236-0.00685924im    -0.0374783-0.017953im     -0.017086-0.0157657im     0.0821695-0.301525im     -0.165044+0.0790807im      0.150079-0.0253066im   -0.000913572-0.00882687im       0.25977+0.0604326im   -0.00659136+0.109962im      -0.317132+0.0720973im     -0.130491+0.0142085im     -0.136906+0.1628im        -0.0203193-0.31726im       -0.0241451+0.162921im    0.0306206-0.231179im       0.100865-0.125027im     -0.0585188-0.0869105im   -0.0975471-0.0252807im   -0.060927-0.116931im    -0.0938559+0.194303im      0.142642-0.0194408im     0.0988138-0.0363341im    -0.203592-0.188713im      0.0370446+0.0942295im       0.10148-0.136914im        0.129193+0.174556im
 -0.0562879+0.151995im      0.0493995-0.0594634im    -0.0238577+0.107927im    -0.00742306+0.212439im        0.139481+0.288022im     -0.0381067-0.193685im     0.0348955+0.0198076im     -0.0669279+0.196859im     -0.123192-0.0885785im     0.0317068+0.0383342im      -0.1486+0.205036im       0.127974-0.00823003im      0.261491+0.125734im      -0.0641196-0.0505832im     0.0909063-0.00357834im    0.0353188-0.0146679im      0.115745+0.0898325im    -0.0457445+0.0944236im      0.0532894+0.00620828im     -0.212222-0.0513152im   -0.155877-0.114087im     -0.0792319+0.0852629im     0.0280204-0.124553im       0.11689+0.0358801im   -0.026072-0.158142im       0.14587-0.0555436im     0.164154+0.211579im      0.0813671+0.183215im     0.0806417-0.215486im       0.218034+0.0972257im     -0.175098-0.0755326im      -0.177402-0.112329im
  -0.112966-0.133489im     -0.0201248-0.00148499im   -0.0763278+0.0472202im    -0.0349566-0.0137019im     -0.0700201-0.043187im      0.0253363+0.0460633im     0.153592-0.111903im        0.125515+0.0635177im   -0.0257191+0.0130853im     0.0720933-0.152421im     -0.179786-0.0124234im    -0.0702444+0.2363im          0.183264+0.172154im       0.0611572-0.0681539im     0.0316689+0.108945im        0.11083-0.0646888im    -0.0549282+0.0215859im     -0.208863-0.0211819im        0.19005+0.056996im       -0.170253+0.230872im    0.0539109+0.182156im     -0.0979954+0.0525522im     -0.153101+0.222385im    -0.0685635+0.183214im    -0.115383+0.153501im     0.0606257+0.126832im      0.179485-0.275396im       -0.29455+0.120167im    -0.0533024+0.146307im       0.152102-0.107876im     -0.0974571-0.0112728im     -0.0646621+0.0557454im
  0.0220471+0.0370313im     0.0433049+0.0223475im      0.109445+0.0442615im     0.0423254-0.0397189im      -0.106599+0.0355177im     0.0242913+0.0631153im    -0.216208+0.00025931im     -0.149816-0.0529078im     0.134021+0.132019im      0.0398252-0.0169805im     0.174754-0.0437799im     -0.207963+0.0124553im      0.0852889+0.0549917im      0.0811115-0.0645663im      0.503165-0.0896866im    -0.0588547+0.298091im      0.0563853-0.110756im      0.0810881+0.0635874im         0.2963-0.205094im       -0.266685+0.0185779im  -0.0717721+0.0379173im      0.121926+0.114859im      -0.179533+0.0608391im   -0.0165323+0.0676678im    0.134034-0.0188229im    -0.114173-0.0465221im    0.0176663+0.00646115im    0.0284325-0.0398206im     0.143579+0.0666229im     -0.139864+0.0801594im    -0.0734441-0.0216256im     -0.0215033-0.0714698im
  0.0820048-0.144559im      -0.192103+0.0526152im     -0.177705-0.0470397im     0.0125507-0.0175262im     -0.0331463+0.18065im       -0.187646+0.0234218im    0.0572512+0.0330345im     0.00321677-0.211999im      0.178203+0.0598976im      0.213197-0.0747281im    -0.178695+0.0275638im    -0.0285522+0.0491321im      0.0170563-0.0842645im     -0.0254594+0.0323646im     -0.245711+0.0893862im       0.29573+0.107515im       0.151789+0.100597im       0.176817+0.0903183im       0.149667-0.0686066im    -0.00702579-0.0249752im    0.119459-0.0764194im      0.139834+0.178807im      -0.128341-0.0355747im   -0.0976988+0.121133im    -0.210518-0.0572183im     0.143535+0.0311316im   -0.0783073+0.0943845im      0.264002-0.102719im      0.117409+0.0714783im    -0.0450944-0.0627661im     -0.198778+0.036271im        0.190021-0.0256207im
  -0.211933+0.211281im     -0.0164813-0.118497im      0.0131958+0.0451691im    0.00162705+0.0196892im      0.0478389+0.00185768im    -0.243598+0.0651731im   -0.0952884+0.0135983im    -0.00185309+0.0454757im   -0.0102353+0.0877485im     -0.101598-0.249118im     0.0816181+0.00365817im    0.0123409+0.200197im        -0.34922-0.128383im         0.22724+0.0231282im    -0.0874963-0.131081im      -0.137111+0.0869453im     0.0564367+0.00442448im      -0.1337-0.0694118im      0.0171625+0.195433im     -0.00724298+0.0613898im    0.106076+0.178884im      0.0221806+0.0732933im      0.140177+0.0495689im    -0.164337+0.0252267im   0.0170589+0.00620961im      0.2277+0.150815im      0.268659+0.115353im       0.136838+0.019697im      0.179311-0.0837134im      -0.14826-0.0382779im     -0.016339-0.0444461im      -0.095096-0.164096im
 6.32803e-5+0.111052im      -0.072065+0.194054im     -0.0830335-0.0320974im      0.230357+0.0762894im      -0.190579-0.0687414im   -0.00722601-0.0851473im    0.0741247+0.0120066im       0.112484+0.24867im      -0.105841+0.0700302im     0.0574985-0.222496im     -0.190612-0.0828277im    -0.0444146+0.0508982im      0.0447049+0.0249733im       0.124896-0.240298im       0.086128-0.107881im     -0.0823936-0.0960921im     0.0909834+0.0222795im      0.149221-0.208554im       0.0427804+0.156108im        0.156212-0.0650648im   -0.116822-0.090252im       0.122588-0.125412im      -0.179372+0.149317im     0.0463496-0.0930088im  -0.0380963-0.210428im       0.16713-0.259744im    -0.0732973-0.0499908im      0.139553+0.0075794im     0.116607+0.182203im     -0.0305572+0.0775924im      0.199689-0.000371153im   -0.0345786+0.10616im
  -0.260296-0.0608515im   -0.00827656+0.027358im      0.0921186+0.0630496im      0.224229+0.0787981im      0.0597388-0.00323028im   -0.0764002-0.0314554im    0.0570199-0.0577494im       0.224637-0.16378im     -0.0386082-0.086583im     -0.0540416-0.0848097im   -0.0167523-0.0482585im    -0.0658388-0.0773093im      -0.135079-0.055097im       0.0405902-0.0505038im    0.00316971-0.285928im       0.121173+0.023599im      -0.075808+0.292126im     0.00353172+0.0126479im        0.28821-0.0227903im      0.0819854-0.147782im    -0.217002-0.182208im       0.105446+0.110275im       0.120056-0.16688im     -0.0113818+0.225727im    0.0633024-0.0260252im    -0.133272+0.0111686im    0.0669223+0.0433383im     -0.276138+0.0247142im    -0.151231-0.0640195im     0.0282535+0.0448909im     0.0957013+0.228636im        0.111625+0.014546im
 -0.0453327+0.0718794im    -0.0236436+0.175384im      0.0104754-0.0629403im     -0.204916+0.118345im       0.0469468+0.162254im      -0.125456-0.227315im       0.12791+0.126464im      -0.0723388-0.0883599im    -0.142156+0.1424im        -0.107908-0.103858im      0.250091-0.0662117im    -0.0332773+0.0814115im       0.104278-0.220213im       0.0263824+0.0407043im    -0.0836065+0.140433im       0.241891+0.0299732im    -0.0211484-0.0130356im     -0.165017-0.155737im        0.236158-0.0262383im       0.179565-0.073988im    -0.028157-0.0413859im      -0.12023+0.00358095im    -0.249375-0.0968419im    0.0496044-0.214241im     0.149348-0.00512879im   -0.060061+0.0860862im   -0.0874334-0.284846im     -0.0481831-0.0557224im    0.0536192-0.15115im      -0.0512364+0.0938568im     0.0518567-0.0647656im      -0.119023-0.075445im
  -0.137823+0.136344im      -0.023699+0.130122im       -0.26576-0.156567im      0.0687057+0.0374102im     -0.0187425+0.238114im      -0.109808+0.138617im   -0.00416169-0.196875im       -0.120051+0.177364im     -0.022468-0.204883im     -0.0454074+0.0451085im     0.271283-0.163373im      0.0915141-0.0120881im       0.196546+0.000681356im    -0.140318-0.0530423im    -0.0603096-0.0434591im     -0.128343+0.0690575im     0.0983106+0.0812912im       0.11911+0.0453027im     -0.0555575+0.0457896im      0.0963226-0.121151im     0.200318-0.0330154im     0.0428156-0.0188176im     -0.169587+0.0582855im    -0.145064+0.0814652im  -0.0847056+0.204285im       -0.2591+0.0768593im     0.210077+0.0703029im    -0.0208832+0.144236im    -0.0252577-0.0103101im      -0.12025+0.055266im      0.0325172-0.00252464im     0.0154353+0.225142im
 -0.0304067-0.0266141im    -0.0153282-0.0780872im     -0.106865+0.0662755im        0.1694+0.0784673im      -0.189745+0.107684im       0.180856+0.0691853im     0.250847+0.00362686im    -0.0278738-0.0970242im    -0.141477-0.0451809im     -0.238024+0.0495049im     0.060033-0.0127626im     -0.234201-0.00699516im       0.26181-0.181452im        0.184936-0.0100799im    -0.0424442+0.0861745im     0.0152257-0.0277371im      0.205795-0.209837im     -0.0962006+0.0699355im      -0.120245+0.0419742im      -0.105472+0.0796762im  -0.0324104+0.00663638im     0.296587-0.0753156im      0.281169-0.151574im     -0.336274+0.0127216im   0.0123447-0.164955im    -0.0150371+0.0370098im   -0.0681011-0.0926546im   -0.00436087+0.0047805im   -0.0378004+0.0101939im    -0.0215443+0.0649004im    -0.0425397+0.00412497im   -0.00547697-0.0529408im
  0.0278641+0.0134337im      0.135797+0.245336im    -0.00767646-0.305623im      0.0124185-0.037757im        0.118688-0.0956298im     0.0256583-0.137522im    -0.0390254+0.0880276im      0.0628822+0.0941204im     0.082382+0.141242im      0.0123426+0.089529im      0.152624+0.048651im       0.172467+0.136036im       0.0286881-0.0476446im       -0.10237+0.121919im       0.105632+0.143913im     -0.0183121+0.0295021im      0.102186+0.17552im      -0.0621372-0.193421im      -0.0362993-0.0834596im     -0.0318046-0.0472191im   0.0235901+0.0607598im      0.227031-0.115744im       0.173216-0.189812im    -0.0902989+0.143282im     0.170287-0.111298im      0.180034-0.00690723im    0.144896+0.0196637im      -0.19414-0.102175im      0.202243+0.194189im       0.161053-0.112919im      -0.145241-0.00173512im      0.108022+0.196926im
  0.0547622-0.108461im      -0.109383+0.0829194im       0.18238+0.00539601im   -0.0309688-0.0414143im     -0.0612994+0.109111im       0.110021-0.110768im     0.0987676-0.356491im        0.136656+0.136401im     -0.116503-0.0268083im    -0.0947399-0.142877im      0.151552-0.192507im       0.115342-0.101598im      -0.0488887-0.00743878im      0.126508-0.0521989im     -0.115914+0.03453im      -0.0654426+0.0686767im      0.142432+0.0221732im     0.0509246-0.00338367im    -0.0487317-0.0211547im      -0.209824-0.061948im    0.0960885+0.180244im     -0.0181803+0.106105im      0.0525166+0.0337518im      0.39805-0.076058im   -0.0832081-0.192301im     0.0668468+0.102353im    -0.0951136+0.0740737im     -0.179443-0.154876im     -0.027471-0.0144609im     -0.195188+0.0640486im     -0.256982+0.0493842im      0.0839778+0.0192332im
 -0.0694361+0.0232266im    -0.0590631-0.0691986im    -0.0319491-0.0340243im     -0.161812-0.14883im        0.0858669+0.0831478im    -0.0890535-0.122779im     -0.131254-0.109334im       -0.074007-0.143085im     0.0163013+0.0110069im     0.0341729-0.0304707im    -0.146243-0.198127im      0.0745811-0.0728839im      0.0573357+0.145825im        0.145945-0.173356im      -0.142283+0.0776im       -0.0174119-0.0118944im      0.026055-0.0343202im     -0.162229-0.026346im       -0.186796+0.108314im       0.0765447+0.049697im    -0.390077+0.0891304im     0.0504681+0.0327244im    -0.0365276+0.0830789im   -0.0947233+0.0935613im    0.347911-0.00345554im   -0.230749-0.124403im    -0.0123815+0.00125949im     0.140119-0.066249im     0.0857168+0.0104339im    -0.0191707-0.0633931im     -0.258689+0.25196im       -0.0792657+0.175566im
   0.203822+0.145148im      0.0739342+0.18827im      -0.0798026+0.206913im      -0.142304+0.0229479im       0.082107-0.0313769im    -0.0419799+0.048908im      0.134409-0.157913im      -0.0111505-0.202058im      0.154872+0.0464701im    -0.0895679-0.134092im     -0.089532-0.0157228im     -0.112241-0.062744im        0.208777+0.0167079im      -0.137438+0.192899im     -0.0151213-0.179623im      -0.217675+0.0297989im     -0.199255+0.0951346im   -0.00641905-0.256418im        -0.19465-0.0526065im     -0.0189745+0.029074im    0.0340812+0.0534911im     -0.109914+0.156582im     -0.0605557-0.217496im     -0.080629+0.162643im   -0.0444714-0.0614351im     0.172313-0.0226784im   -0.0262786-0.0141578im    -0.0104094+0.0298328im   -0.0248343+0.138692im      -0.159396+0.21224im      0.00687423+0.159329im       -0.195393-0.0170698im
   0.131727-0.189852im      0.0363439-0.111965im     -0.0413955+0.117053im      -0.168611+0.0756447im       0.144959+0.0488254im      0.177724-0.185712im   0.000547897+0.045989im       -0.159058-0.00785524im   -0.110988-0.0677683im     0.0224772-0.0351182im    0.0261995-0.0508567im     -0.148177-0.00867142im     -0.140672-0.00176451im    -0.0628962-0.372515im       0.070343-0.120652im     -0.0803536-0.0890876im     0.0581412-0.128956im      -0.208296-0.121507im      -0.0231167-0.222632im        0.145119-0.297677im     0.127006-0.0441962im     0.0619349+0.24343im       0.0527005-0.0767476im   -0.0176614-0.0145485im   -0.163477-0.00568445im   0.0408178-0.0116178im     0.254418-0.108386im      0.0838881+0.0481348im    0.0043482+0.150757im     -0.0285353-0.213443im    0.000714781+0.0172013im      0.0815216+0.0843481im
 -0.0473755-0.00462607im     0.313683-0.0538947im    -0.0326087-0.07581im       0.0788004+0.0355214im     -0.0934031-0.131706im       0.047691-0.0677409im   -0.0923004-0.0196696im     -0.0489757+0.0520513im    -0.108963-0.217729im      -0.180636-0.0594873im   -0.0667188-0.0705019im      0.174116-0.122451im       0.0118648+0.00109168im   0.000553142-0.117239im      0.0841794+0.076101im       0.251738-0.0905316im     -0.249935+0.164336im      0.0209954-0.23013im         0.154127+0.0347785im       -0.23429+0.0994141im  0.00733676+0.133095im      0.0703036-0.0038851im   -0.00270986-0.234142im    -0.0434712+0.0140791im     -0.1244+0.10782im     -0.0521089+0.138661im     -0.141353+0.0223459im      0.350943-0.0642127im   -0.0284669+0.00705759im    -0.199042-0.137773im     -0.0239535-0.0567438im     -0.0786523+0.0904818im
 -0.0508966-0.0330768im     0.0635872+0.22736im        0.172702-0.136507im     -0.0463189+0.0134994im      0.0135081+0.0696764im     0.0417777+0.0895551im   -0.0453531+0.203585im         0.15897+0.281639im    -0.0925472-0.0519651im     0.0147253+0.0244563im   -0.0742654+0.083326im      -0.234814-0.326435im      -0.0185374-0.097704im        0.216556-0.0123542im     -0.273856+0.00945653im    -0.068326-0.0155571im    -0.0824285-0.074707im     -0.0238313+0.143564im       0.0435027-0.248357im      -0.0927868-0.132006im    0.0810223+0.0821521im     -0.169474-0.0632816im     -0.078068-0.0293929im    -0.135885+0.190016im    0.0292431+0.135163im     0.0400186-0.0650168im    -0.110756+0.0479327im    -0.0168763+0.104908im      0.248678+0.0387445im    -0.0316446-0.0940594im    -0.0148023+0.151599im       -0.160432-0.00712112im
  0.0289885+0.197976im       0.139734+0.176296im      0.0612858+0.159121im      -0.229836+0.0171685im     -0.0730065-0.10913im      -0.0732611-0.157897im      0.145036-0.0801735im          0.159+0.0670208im     0.220433-0.121468im      0.0481656+0.0922958im     0.135201-0.26234im       -0.127829+0.0443769im        0.12717+0.0602767im      0.0701313-0.140291im     -0.0510709-0.0656026im     -0.102039-0.178278im      0.0407203+0.0842396im    0.00815157+0.201299im        0.094583+0.0380133im     0.00436898+0.0708817im   0.0664037+0.0677723im      0.135804+0.0294955im     0.0488647-0.0715884im    0.0228456-0.0612463im   0.0431246+0.21079im      -0.015067+0.0229079im   0.00475871+0.0657848im      0.190909-0.223828im     0.0374808+0.00400828im     0.330228-0.0424436im     0.0980711+0.0198803im       0.149301-0.248776im
 -0.0294849-0.142456im     -0.0620409+0.120025im      0.0808345+0.0390728im      0.168725+0.221295im           0.133+0.0991115im     0.0686169-0.139327im     0.0228226-0.0576424im      0.0511482-0.00401379im    0.103646+0.128707im      0.0954237+0.121756im     0.0843227-0.019334im       0.274093-0.139846im       0.0519203+0.117539im       0.0355602-0.0901439im    -0.0497668-0.00324326im     0.115012+0.134799im       0.226418-0.0436536im     -0.169103-0.125582im      -0.0999746-0.0667456im     -0.0516179+0.225768im      0.04941+0.0366242im     -0.191309+0.0573841im     0.0216408+0.0908064im    -0.138741+0.191615im    0.0899603-0.0331168im   -0.0517729+0.00751661im  0.00411252+0.0913291im     0.0965214-0.0974061im    -0.100385+0.121845im      -0.130812-0.0785137im      0.449264-0.0552797im     -0.0123089-0.193571im
 -0.0322463-0.0265073im    -0.0603783-0.0696045im      0.129631-0.306056im      -0.115825-0.118196im      -0.0887657-0.0807872im     0.0686561+0.198146im     0.0246961-0.157801im     -0.00535632+0.188042im     0.0182907+0.00336746im   -0.0236206+0.081228im     -0.120277+0.0151509im      0.135934+0.0192634im       0.115446-0.27577im       -0.0515904-0.111798im     -0.0185042+0.0370094im    -0.0295672-0.117269im      -0.154531-0.0346271im    0.00252453-0.1096im        -0.0184839-0.0367076im    0.000697237+0.0110078im   -0.111527+0.0287717im    -0.0250699+0.319632im      -0.126826-0.0712321im    -0.133189+0.0680824im    0.108377-0.0842119im    0.0368898-0.210962im      0.171535-0.0722671im     0.0175123+0.0563976im   -0.0487202-0.155197im     -0.0537072+0.130012im       0.028022-0.0970372im       0.341206-0.310636im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.02700269217486755 - 0.11998666602880508im
  -0.14273199937715697 + 0.05330364832102098im
    0.1075859461883228 - 0.07929659285935747im
    0.3888364632142868 + 0.0im
  0.043040421459010436 - 0.0276843005165209im
   0.22815783558845015 + 0.01461151596423063im
   0.10976330234701548 + 0.15694962054655415im
  0.025675952646763152 + 0.05108002416974572im
 -0.027224155735181277 + 0.17909485946917875im
  0.056971467816698984 + 0.0312093279800352im
  -0.06601768468853399 + 0.12454678552512642im
   0.10737155319004568 - 0.09209131238471648im
   0.11882799850132274 + 0.028225568865101636im
  -0.11963280298034726 - 0.17859249340518885im
  0.017719568976439604 - 0.053736149747687076im
 -0.026597280861758645 - 0.0520981533049347im
    0.1553280951742149 - 0.11598627464110026im
   0.09915824402254887 + 0.1598221186608799im
   -0.1409467481459725 + 0.07809165895510627im
    0.1952520920035734 - 0.11831974975536456im
   -0.1259735450867287 + 0.04518085484731522im
 -0.009966187141871608 + 0.12354724824002912im
   0.05233751513136088 + 0.16782283200241502im
   0.07150000580296002 + 0.13210140344666593im
    0.2629713693184435 - 0.0008975901326811218im
  0.030993704691548375 + 0.09731246218651733im
  0.030556079582413014 - 0.16751817289197296im
  -0.09942615626768676 - 0.10326088919710445im
   0.09818585613824654 - 0.2488519993046464im
  -0.16458080434260394 - 0.11222851563507553im
  -0.06874289186607899 + 0.12490225403888872im
   0.21313677415316953 + 0.09585046045344205im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 3 March 2023 14:47">Friday 3 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

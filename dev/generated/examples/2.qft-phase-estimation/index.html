<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.130927+0.23023im        0.129443+0.147744im     -0.0209175-0.0145281im     -0.021586-0.11046im      0.0148488-0.0996015im       0.128054-0.0629609im      -0.194755-0.0433323im     0.0529914+0.118227im     0.0936062-0.0704544im   -0.0450167+0.0396013im     0.0696881-0.214068im      0.0825346-0.154325im      0.091506-0.0851662im     0.0320417+0.00899692im     0.123887-0.13618im       0.179951-0.106012im       0.173239-0.0697936im     -0.216657+0.0020645im    -0.0221858+0.058761im     0.0538123+0.0305625im      0.046889+0.127889im     -0.216882-0.132349im      -0.00544618-0.0954004im    -0.0986018-0.0865144im   -0.00893171+0.0938947im     0.209136-0.0626606im    -0.0431845+0.336601im    -0.0179932+0.262009im     0.0621149-0.104314im     -0.137889-0.0782959im    -0.048579+0.155432im      -0.23904-0.186251im
  -0.209929+0.0869807im    -0.0276869+0.204865im      -0.187226-0.142474im      0.0480793-0.139714im    -0.0743332-0.0302984im         0.1214+0.056478im        0.215506-0.0180229im      0.219088+0.141536im     0.0446273-0.0471602im    0.0680943+0.0894664im     -0.200783+0.166221im      -0.115951+0.0732443im    0.0513149+0.039755im       0.210844+0.150119im     -0.0391232-0.0430616im    -0.150362-0.0790732im    -0.0209012-0.0378399im     -0.133974-0.047498im      -0.133788-0.13896im      -0.122372+0.0437439im     0.0517572-0.191601im       0.10291-0.0118573im       0.0994575-0.0400273im     -0.029086+0.0567216im    -0.0606902-0.017874im    -0.0373062+0.0353669im    -0.0233172-0.11814im      -0.134238-0.11501im       0.173823-0.235846im      -0.11245+0.283368im      0.177989-0.118747im     -0.222176-0.118517im
   0.174616-0.0797654im       0.13972+0.0264279im     0.0775356-0.151003im       0.135518-0.0786611im   0.00797477+0.0834211im      -0.190422+0.00446579im     0.0695393-0.109812im       0.156535-0.168467im       0.19984+0.0214368im    -0.175118+0.00573121im     -0.06478+0.179848im       -0.29904+0.136182im      0.124363+0.301608im      -0.190553+0.0322122im     -0.139971-0.138563im      0.260467+0.0305349im     0.0742676+0.0471814im    -0.0520524+0.0738263im     0.0552533+0.160656im      0.078192+0.0364743im      0.164356+0.00581265im   0.0151513-0.0551184im       0.0252308+0.00658506im    0.0109334-0.0328717im     -0.321025+0.0250171im    -0.120056-0.0830066im     -0.035335-0.0341324im     0.104619+0.110247im     0.0683923-0.0422732im      0.16968-0.0483872im    -0.045357+0.0935093im    -0.109491-0.1193im
  -0.238012-0.00204271im    -0.122054+0.0614461im   -0.00500267+0.179212im       0.111461+0.210141im    -0.0045294+0.03228im       -0.0753729+0.212711im       0.0174214+0.172385im      0.0477026-0.0650491im   0.00456717-0.0447296im   -0.0393593-0.045293im       0.105861-0.00814408im    -0.151445+0.116588im     0.0026252-0.0633133im       0.11357+0.181536im      -0.199365-0.1255im      -0.0364941-0.0509553im     0.0202872+0.238025im      -0.382579+0.0793458im    -0.0784689-0.0120136im    -0.169302+0.0940876im    -0.0219861+0.026969im     0.0549681-0.106934im        0.0619432-0.0582549im      0.194297-0.0665418im       0.10193-0.150034im    0.00405434+0.138052im       0.206185+0.0475955im      0.12919+0.235089im    -0.0967406+0.178563im     0.0877342-0.0966768im    0.0569944+0.098181im    -0.0168582+0.161im
  -0.057008+0.0129303im     -0.108267-0.0200192im       0.03563+0.137304im      0.0577712-0.0486965im      -0.2006+0.102039im      -0.0616704+0.144823im       0.0255403+0.00236648im    -0.278541+0.0215032im    -0.372825+0.221495im     0.0453397-0.183814im     -0.0382948-0.13667im        0.113231+0.136142im    -0.0537945+0.0940258im    -0.0448897+0.0861826im    -0.0501748-0.196659im      0.158592+0.0205789im     0.0359059+0.013837im       0.043482+0.25317im       -0.158582-0.0526609im    0.0143906-0.148207im      -0.101827+0.0311034im    -0.038502+0.0373916im       -0.111215+0.138662im    -0.00198149+0.0440491im      -0.17179+0.278735im    -0.0972706-0.00322539im   -0.0161771+0.0784747im     -0.13189+0.138339im     0.0400027-0.0503737im    0.0608612+0.241462im      0.183352+0.0158591im   -0.0791682-0.0995916im
  0.0559138-0.15867im      -0.0566916+0.0187495im     -0.151009+0.113988im       0.104553+0.0934283im    -0.177389-0.0472933im      -0.071943+0.103454im       -0.175295-0.00497783im    0.0249152+0.131674im      0.175056+0.04233im     -0.0313743+0.236233im       0.275215+0.0430874im     0.0187695-0.20981im     -0.0469034-0.1024im         0.138785+0.0607301im    -0.0329302+0.139661im    -0.0113544-0.0266797im    -0.0880322+0.13556im        0.170769-0.000591175im   0.0844215+0.188014im     -0.107507-0.0500721im    -0.0329554-0.0138158im   0.00328246+0.0160169im       -0.163836+0.0115384im     -0.131776-0.230226im      -0.292646-0.0802233im    0.0756161-0.0984627im    -0.0350684-0.0349025im     0.123813+0.0552296im    -0.160127+0.122324im     0.0200308+0.32643im       0.137557-0.0916097im    -0.112169-0.140082im
 -0.0804253+0.00707804im    0.0288055-0.116761im     -0.0653123-0.0593419im   -0.00558381+0.111471im     0.0301227+0.151599im        0.243471+0.0313725im      0.0160999+0.208392im      0.0365932+0.0640765im   -0.0495257+0.0835531im    -0.168682+0.104963im       0.169863-0.0115652im    -0.0562412+0.115188im    -0.0504686-0.116716im     -0.0139775-0.168061im     -0.0177262-0.15547im      -0.068588-0.270427im      0.0105577+0.101425im       0.235635+0.039237im      0.0240477-0.118343im      0.098485+0.150904im     -0.0919272+0.200779im      0.124307-0.0348198im       -0.167518-0.0671942im      0.195325+0.0770691im    -0.0452852-0.22636im      -0.154424-0.109427im      -0.144572+0.10472im      0.0236474-0.140586im     0.0423118-0.288193im      0.148896+0.0134197im    -0.034288+0.253036im    -0.0444117-0.109328im
  0.0312806+0.01203im      -0.0417573+0.0752884im     -0.155588+0.11504im        0.056318+0.0816495im     0.186459-0.0399435im     -0.0468415+0.220824im       0.0863468+0.181375im      -0.136071+0.216271im     0.0531725-0.0368949im     -0.05757-0.13322im       0.0377903+0.111042im    -0.00903993+0.0320677im   -0.0726234+0.212596im     -0.0701003-0.320469im       0.110764+0.0202029im     0.204767-0.0864903im     0.0954784+0.0193034im    -0.0648234-0.0583166im     0.0383331+0.216303im      0.014663+0.118124im     -0.0133918-0.255294im     -0.329742+0.120062im        0.0757713-0.05635im      -0.0496856-0.14412im       0.0860317-0.0225344im    -0.063408+0.0488526im     0.0970913+0.0393867im    -0.204105-0.244962im     -0.136523-0.0882404im    0.0217052+0.0699976im    0.0918489+0.106517im    -0.0536348+0.0966803im
 -0.0202291-0.11908im       -0.129172+0.0325688im      0.236664+0.0115482im     -0.246903+0.0026981im     0.290665+0.02516im        0.0386889-0.152856im       0.0106491+0.0908439im      0.014251-0.0590545im   -0.0399223+0.386388im      0.231054+0.0950028im      0.167097-0.0673864im     -0.122257-0.02038im     0.00419912-0.0296266im     -0.110749-0.0320986im      0.106849+0.184655im    -0.0889769-0.0535742im    -0.0854187-0.0616488im     -0.138026+0.10557im       0.0265033+0.173681im     0.0403327+0.0220795im    -0.0821771-0.383111im     0.0564018-0.0640436im       0.0721421-0.133885im      0.0256335+0.0715608im     -0.103673-0.0286264im   0.00633785-0.0170518im    -0.0337084+0.067585im     0.0831319+0.13626im       0.200527-0.0236847im    0.0258907+0.0318759im     0.183727+0.0906309im   -0.0636753-0.0366434im
 0.00287217+0.159154im      0.0467416+0.0105092im     -0.229916-0.0407239im      0.219033+0.138217im      0.223999-0.102163im       0.0179545+0.103778im       0.0239641-0.0284031im     0.0986784-0.0776939im    -0.296534+0.211428im     0.0687195+0.237516im      0.0124537-0.0211339im    0.00372611-0.0877655im     0.120153+0.215866im      0.0112726+0.00739697im     0.162872-0.00745767im    0.129643+0.0444788im     -0.126759-0.028714im      0.0506136-0.0240567im     0.0577885-0.125699im    -0.0970029-0.111322im      0.0860547-0.0785025im    0.0666977+0.0867981im        -0.28503-0.0233054im      0.192185-0.0235392im   -0.00746856+0.0808674im     0.284406+0.0690299im      0.200941-0.00744117im    0.101845-0.0865809im     0.079699+0.0120543im     0.128481-0.0778264im    -0.217664-0.0525791im    -0.129043+0.0320656im
  0.0446643+0.0970561im     -0.188432+0.00767364im     0.219613-0.191221im        0.13815+0.0244572im    -0.145652-0.114793im       -0.102986+0.140211im       -0.269568-0.0136333im    -0.0107309+0.0357559im   -0.0911255-0.0215984im       0.1959+0.00804781im   -0.0529863+0.156664im     -0.0378709-0.163668im      0.215482+0.103421im       0.224047-0.219478im     -0.0705365-0.0592141im    -0.259589+0.0621545im      0.107201+0.132108im      0.0319865-0.0420883im     0.0141087-0.126629im        0.1776-0.0512792im     0.0266857-0.0800555im    0.0143097+0.170741im        0.0737934-0.214637im     0.00568504-0.0413934im     0.0101225+0.0807448im    0.0100551-0.0730619im   -0.00700386+0.070721im    -0.0168489+0.0595296im    -0.106485-0.1211im        0.211689-0.19171im       0.187496+0.0792927im      0.10992-0.133081im
   0.249292+0.00251833im    -0.100452+0.0275416im      0.243118-0.104938im      -0.129242+0.0248144im    -0.159065+0.167208im        0.247566+0.0696488im   -0.000485751-0.0599511im    -0.0491208-0.154213im     -0.111545-0.029348im    0.00421919-0.0832576im     0.0827558-0.125103im      -0.232468+0.162519im      0.060949+0.347424im       0.219158+0.0322943im     0.0767278-0.0238342im   -0.0111783-0.100081im      -0.140537-0.0761389im     0.0394544-0.222772im       0.181262+0.0228469im    -0.160635+0.029833im     -0.0844162+0.0729059im   -0.0568811-0.112449im       -0.0285732+0.0586609im     0.0294584-0.112932im     -0.0129016-0.111523im      0.185869+0.120204im    -0.00182746+0.0978631im   -0.0264731+0.00154482im   -0.192957-0.0743349im    -0.258343+0.0406425im    0.0757579-0.0315644im    -0.048146+0.0445482im
  -0.112318+0.0301596im     0.0877768-0.00206492im    -0.358154+0.240609im       -0.12891-0.139685im       0.20999+0.0309522im       0.148643-0.0459837im     -0.0811221-0.0524692im     -0.116282+0.0300922im    0.0538338+0.00802502im  -0.0731331-0.0460112im     -0.163656-0.127133im      -0.236854-0.14804im      0.0460804+0.350239im       0.112591+0.0170883im     -0.250777-0.01468im      -0.143319+0.0388541im    -0.0379288+0.127304im       0.064032-0.023965im     0.00383021-0.00627205im   0.0937038-0.0962613im      -0.23211-0.0725859im   -0.0348922-0.0373201im      -0.0801628-0.145861im    -0.00897402+0.111169im      -0.051869+0.071579im     -0.123656-0.0693206im    -0.0309843+0.0507872im     0.128323+0.0292198im   -0.0444265+0.132067im     -0.154115-0.0366902im   -0.0306612+0.0374329im     0.232417-0.131094im
   0.150444+0.173642im        0.10017+0.112722im      0.0150795-0.00460088im     0.043702+0.0125044im     0.108254+0.142658im        0.058153+0.0994747im      -0.296037+0.102103im     -0.0369408+0.0443651im    -0.126343-0.0883184im   -0.0479941-0.121987im     -0.0333961+0.0222754im     0.0714412-0.16899im       0.241359-0.055817im      -0.152712+0.397988im      0.0912689+0.0753717im    -0.137497+0.14028im         -0.1113+0.0324269im     -0.026568-0.017249im      0.0240685+0.162557im    -0.0187236+0.25899im     -0.00148769+0.01509im      0.0390877-0.181548im        -0.105674+0.0763346im     -0.108658+0.0386544im     -0.150155-0.0621049im    -0.182848+0.0164995im      0.227529+0.0509056im    -0.138498-0.168895im     0.0983063-0.140666im     0.0953209-0.0111683im     0.097007+0.00679527im    0.127555+0.0553689im
   0.114491-0.0848754im   -0.00177284+0.0826484im      -0.12883-0.197453im     0.00813315-0.0464947im    -0.158644-0.171424im       0.0464411+0.00744249im    -0.0415604+7.57456e-5im   -0.0107582+0.119854im     -0.092017+0.0518988im     -0.11835-0.0366818im     -0.140647-0.00842788im   -0.0465552-0.0833987im    -0.150238+0.115774im      0.0164874+0.00821515im  -0.00392927+0.49725im     -0.0413148-0.0153086im     -0.103149+0.0385747im     -0.148024+0.075891im      0.0133113-0.047554im      0.130812+0.117989im      -0.171378+0.21769im       0.090806+0.000680119im     0.0373865+0.013544im       0.135631-0.0153612im    -0.0457998+0.157173im    -0.0172321-0.00627653im   -0.0878417-0.0524388im   -0.0978532+0.0427985im    0.0248643+0.138567im     0.0336875-0.0579573im    0.0194933+0.339032im     -0.271085+0.245822im
  -0.160855+0.0756055im    -0.0123401+0.087658im      0.0922191-0.01416im       0.0428346+0.0264494im   -0.0684086-0.0209814im       0.100361-0.0104406im     -0.0914855-0.0828248im      -0.40886-0.0235804im     0.207805-0.0131621im    -0.094924+0.36326im      -0.0160553+0.0296603im     -0.181523+0.043563im    -0.0033251+0.0509266im     0.0942487-0.0239027im      0.114473+0.0267773im     0.112153+0.187978im      -0.110468-0.213163im       0.103665+0.158295im      -0.108934-0.175179im      0.115973+0.0397998im     -0.026112-0.143663im     0.0480625+0.0104749im       0.0144297+0.159517im      -0.111107+0.101008im      0.0510125-0.259423im     -0.181403-0.00656379im     0.184891+0.0872508im    -0.156224+0.115918im    -0.0973405+0.0711843im    0.0843558-0.071598im     -0.064467-0.0169717im    -0.134552+0.046654im
  -0.176101+0.154043im     -0.0825895-0.140623im       0.111274-0.0572881im      -0.13856-0.103949im     0.0297944-0.0772585im      0.0227876+0.106595im       -0.183177-0.0225506im      0.257233+0.0566857im    -0.114206+0.0186678im    -0.132184+0.0933349im   -0.00736826-0.118698im     0.00643724+0.21163im     -0.0693848+0.077967im      -0.210807+0.112074im      0.0925618+0.00917706im    0.128033+0.165848im     -0.0524852+0.285132im       0.113124-0.0181552im     -0.120027-0.00153052im    0.220433+0.199201im      0.0034612-0.129572im     0.0793056-0.0456798im        0.138864+0.0314818im    0.00879599-0.0107163im      0.167913+0.0755122im    0.0966887-0.230946im      0.0281667-0.124325im      0.118977-0.0990547im    -0.321479+0.0567458im    -0.111577+0.0796162im    0.0635129-0.0706243im   -0.0933551-0.0801485im
   0.153568-0.102271im      -0.142771+0.208548im      0.0621361+0.102242im       0.200761+0.00129345im  -0.0246871-0.00140116im     0.0219841-0.197668im        0.141181-0.000363105im  -0.0308856+0.116657im    -0.0129449-0.173266im    -0.0507811-0.182858im        0.25725+0.0192956im     0.0750823-0.108643im      0.176745+0.148994im   -0.000798876+0.0984726im       0.15959+0.0146587im    -0.223455-0.046843im        0.12138+0.186413im       0.134377+0.243748im     -0.0269655-0.0312961im     0.070431-0.105918im       0.142058-0.174439im    -0.0322737-0.0988349im       0.0743414+0.0995026im      0.173263+0.255416im      0.0887826-0.00740932im  -0.0503219-0.0708283im   -0.00403352+0.0336085im     0.111362-0.0271316im   -0.0962289+0.0236041im     -0.13741+0.0417888im      -0.2348+0.0378796im    -0.218048-0.0197304im
  -0.235045+0.0409654im    -0.0490038+0.0403151im    0.00914369-0.128119im        0.11711+0.128121im     0.0431661+0.188207im       0.0802839-0.0693504im     -0.0723017+0.00836111im    0.0869897-0.0536375im    0.0170692+0.00685482im   0.0483416+0.0059221im     -0.154105+0.0773671im     -0.173607+0.108252im    0.00219903-0.110433im      0.0276133+0.174948im       0.129614+0.186561im    -0.0383659-0.0753206im       0.19181-0.0259062im    -0.0221086+0.0659339im     -0.156268+0.292552im     -0.107343-0.181838im     -0.0884097-0.0199275im   -0.0907821+0.343958im       -0.0721744+0.216577im    -0.00566181+0.133771im      -0.146892+0.0322776im     0.165237-0.0913027im     -0.119892+0.0349603im   -0.0608227-0.0260288im    -0.267931-0.0800483im   -0.0361032-0.0493837im    -0.140013+0.171002im      0.199887+0.0292163im
  -0.192506+0.0151182im     0.0581284+0.0189204im       0.14347-0.0460119im      0.192632-0.101841im    -0.0766578-0.052016im        0.042853-0.393415im       0.0149711+0.120822im       0.134537+0.0149364im   -0.0772847+0.0352348im    0.0145058-0.180424im       0.111053+0.146535im        0.10411+0.0382194im    -0.055891+0.09913im        0.104313+0.130943im     -0.0549274+0.22452im       0.300036-0.0798576im    -0.0876342-0.00855268im    0.0656203-0.140474im      0.0341444-0.242789im     -0.107332+0.0651575im    0.00527589-0.162921im    -0.0744247+0.00435693im      -0.209274-0.153242im     -0.0933533-0.163776im      0.0545412+0.0267449im    -0.270895-0.0634982im     0.0824395+0.0902793im    0.0631702+0.121676im       -0.1017-0.0428378im    0.0296137+0.0481138im    -0.031466+0.061954im      0.186306+0.0346452im
  0.0836053+0.0775649im    -0.0668023+0.123426im     -0.0843097+0.0617686im    -0.0369412-0.0824031im   -0.0143928+0.200883im       0.0748417+0.0260516im       0.101237-0.340412im      -0.104063-0.111288im    -0.0373063+0.0547219im     0.132326+0.0952775im    -0.0316583-0.0420981im    -0.0384633-0.0270161im   -0.0761221-0.168434im       -0.14394+0.0290391im      0.173933+0.156411im     0.0659523-0.0288293im     0.0719622+0.239792im     -0.0246421-0.0416533im       0.18266-0.107224im      -0.18814-0.0733903im    -0.0045374+0.182673im     -0.209281+0.0805285im        0.145775-0.248165im      0.0424089+0.0495498im     0.0483866-0.0468938im    -0.199376-0.0742935im      0.275736-0.253106im     0.0267964+0.0730756im    -0.109303-0.127404im     0.0519115-0.0185336im    0.0319904+0.0984681im   -0.0440291-0.197956im
  -0.172377-0.0781391im     0.0356512+0.163531im     -0.0279039-0.0344498im     -0.180692-0.280495im     -0.254895-0.23094im     -0.000314102-0.0340771im     -0.0159647+0.101939im      -0.112534-0.0139538im     -0.15423+0.165627im     0.0728653+0.14752im       -0.029647+0.0898235im      0.104899+0.0641932im   -0.0271409+0.0681559im    -0.0593688-0.0105303im    -0.0267109-0.100938im     -0.131633+0.0619726im    -0.0363822+0.203329im     -0.0581925-0.030921im       0.189459+0.270676im    -0.0623833+0.187319im       0.132575+0.0630544im    -0.137688+0.260167im       -0.0550415+0.104435im       0.133903+0.00435574im   -0.0735433-0.128815im     -0.172752+0.0999479im    -0.0345364+0.148003im      0.105385-0.00884081im   0.0247707-0.0562258im   -0.0923365-0.135373im     -0.199142-0.183297im    -0.0118438+0.0329332im
  0.0156036+0.0923079im       0.04091+0.236159im       0.125369+0.0838255im    0.00415516-0.100863im       0.07955+0.257296im       -0.219914-0.0186204im      -0.202077+0.0512864im      0.186401+0.00133007im   0.0311499+0.0283292im   -0.0342738+0.071892im       -0.16105+0.0743961im   -0.00166648+0.0252263im    -0.107355-0.093334im     -0.0478137-0.08012im      -0.0708455+0.0044763im   -0.0257558-0.195618im      -0.248987+0.155273im      0.0046871+0.276398im       0.207167-0.228401im    -0.0147934-0.176147im     -0.0786198-0.0875921im    -0.126986-0.0784566im      -0.0390292+0.0978716im      0.121522-0.176018im     -0.0127086-0.0262312im    0.0236559+0.0151001im     -0.122665+0.0850581im    -0.293755-0.132888im    -0.0125463+0.133241im     -0.110221-0.158397im    -0.0282377-0.128934im    -0.0415847-0.0652589im
  -0.140871+0.133303im     -0.0655547+0.076261im      0.0879144-0.103774im     -0.0967336+0.0553232im     0.130684-0.0984181im      0.0630079+0.0583531im     0.00226817-0.0343174im        0.1409-0.104844im     0.0810755+0.0764052im    0.0218037+0.0399501im      0.298956+0.0322953im     0.0556188-0.261518im      0.129249+0.074731im      0.0184236-0.118859im      -0.170131-0.0798407im     0.197557+0.154865im      -0.128386+0.00519736im   -0.0373243+0.134399im     0.00302341-0.118649im     -0.200532-0.0219345im      0.113696+0.234995im     -0.156969+0.0585465im       0.0376495+0.0952558im    -0.0136615+0.327859im      -0.111148+0.056855im     -0.125825-0.00698331im    -0.156394-0.0977054im   -0.0400975-0.168173im    -0.0788664+0.0496634im       -0.164+0.0328817im     0.221635+0.0988621im    0.0607163+0.209703im
  0.0533368+0.10555im       0.0455264+0.171581im       0.201235-0.00301382im   -0.0340464-0.0150937im     0.165533+0.150342im       -0.152756+0.192907im        0.329045-0.109233im      -0.165639+0.153996im     0.0157153-0.0757085im    0.0712076+0.11196im       0.0889043+0.0416649im    -0.0858974-0.00906394im    0.022098-0.125499im       0.112277+0.102228im     -0.0202764-0.00594976im  0.00527676+0.0219296im     -0.156453+0.0675514im     -0.115494-0.199743im     -0.0406721+0.0931738im     0.274339+0.0234545im     0.0857519+0.0809698im    0.0675089+0.121793im        -0.351476-0.0696423im     0.0848883-0.0672404im      0.138167+0.152716im    -0.0948044-0.292247im      -0.140492+0.0366721im   -0.0160441+0.0726969im     0.015031+0.0179229im     -0.13833+0.0654128im   -0.0431321-0.0155895im    0.0345745+0.131296im
  -0.110355-0.0114173im     -0.386702-0.122714im      -0.109297-0.0831506im    -0.0713996-0.0361192im     0.078559+0.00226638im     0.0423891-0.00280297im     0.0460389-0.292366im       0.125351+0.0177709im   -0.0599742-0.00517089im    0.124028-0.209469im     -0.0872557+0.285854im      -0.184936-0.0903397im    0.0259712-0.19565im      0.00096584-0.0274649im        0.0106-0.093749im     0.0591894-0.080259im      0.0985494-0.00641867im     0.270546+0.0265827im     0.0880428+0.00656215im    0.148851+0.280589im     -0.0266647+0.0286718im    -0.143203-0.074991im        -0.173631+0.101153im    -0.00491228+0.00177144im   -0.0608344-0.0290233im    0.0335161+0.0783702im      0.159774+0.149089im    -0.0402864+0.0835794im      0.11938+0.27204im     -0.0703761+0.00856765im  0.00234148-0.0119876im   -0.0724477+0.0764035im
   0.138678-0.127491im      0.0348488-0.0464373im     -0.043813+0.0858961im      0.159314+0.00519461im    0.106295+0.128071im      -0.0181441-0.167102im        0.027013-0.122295im     -0.0213338+0.0162155im    -0.116535-0.0309408im    0.0760739+0.0528071im     0.0896309+0.0865345im     -0.010504-0.114221im    -0.0449211+0.0166889im     0.0574928+0.151754im      -0.082051+0.0108882im     0.231669+0.0599129im     0.0634752+0.0910144im     -0.113162-0.00958212im    -0.109085-0.0972806im     0.103499+0.0825649im     -0.307009+0.110501im     0.0630665+0.296722im         0.265189+0.101829im    -0.00286693-0.0516146im     0.0262242-0.156235im     0.0597782-0.0621543im    -0.0366902+0.317148im      0.177275-0.224892im     0.0962306-0.111858im    -0.0559022-0.140406im      0.204206-0.215955im     -0.118258+0.0138936im
  -0.100363+0.0277039im      0.091577-0.0788598im       -0.1449+0.0982847im     0.0544319+0.190274im     0.0210234+0.0396327im      -0.204291+0.21044im      -0.00720777+0.0176975im      0.162063+0.0418474im   -0.0900281+0.107743im      0.169608-0.152015im     -0.0130346-0.18247im       0.0392239+0.0395283im     0.218457+0.0651903im      0.066436-0.00786026im    0.0221282+0.224136im    -0.0374656-0.0340587im   0.000918176-0.307365im      0.0686123-0.0436553im     0.0729448-0.0822232im      0.10321+0.127119im      0.0412771+0.0469044im    -0.169138+0.013157im         0.149139+0.179922im       0.105139-0.0361498im    -0.0460901-0.243811im     -0.231129-0.198896im       -0.16534-0.123025im     0.0348861+0.257078im    -0.0354398-0.0604136im    -0.110356-0.107922im    -0.0356969-0.158111im     -0.076183-0.0751484im
  -0.304391+0.00635761im     0.388256-0.199611im       0.161606-0.0667064im      0.332953+0.0559644im   -0.0551444+0.0891398im      0.0801919-0.037866im       -0.109261-0.0529151im     -0.189459-0.170199im    -0.0183933+0.0831509im    0.0462069-0.0490416im    0.00100481+0.198463im     -0.0104373-0.191231im    -0.0381808+0.0263642im     -0.133962-0.108494im     -0.0288732+0.00511924im    -0.09803-0.124254im      0.0342567+0.0759588im    -0.0644366-0.170313im       0.109612+0.156832im       0.16214-0.064504im     -0.0666509+0.00472061im  -0.0416563-0.146092im     -0.000282093+0.043403im       0.152773+0.102502im       0.117666+0.0132326im    0.0350418+0.0573626im      0.055275-0.147029im    -0.0307558-0.00874136im   0.0292352+0.0649822im    -0.179309+0.149673im      0.137548-0.0885173im    -0.164362+0.00167587im
 -0.0811877-0.135764im      -0.118209+0.263928im      0.0193595+0.0173391im    -0.0693828-0.244668im      0.184035-0.0189747im     0.00505564+0.0626395im   -0.000331521+0.20802im      -0.0674179-0.179316im    -0.0153939-0.234035im      0.187034+0.0392548im     -0.180009+0.0675573im     0.0574477-0.222168im      0.075964+0.0398322im     -0.134919-0.0557777im    0.00528118+0.0323405im     0.160281-0.048062im      0.0430718-0.126669im    -0.00221575+0.0656972im     0.0600678-0.0794052im     0.156699+0.00719865im   -0.0740769+0.144061im      0.128306-0.07963im        -0.0162058+0.189466im       0.150468-0.13255im       0.0660985-0.0987677im     0.113626+0.113749im     -0.0381612-0.0868232im     0.203153+0.102145im       -0.2056-0.169568im      0.114189+0.293571im     0.0133613+0.0496793im     0.108819-0.0371015im
   0.133185+0.0591871im     0.0153342+0.157294im     -0.0553907-0.00539473im     0.281748+0.0551968im   -0.0239149-0.0466295im      -0.187502+0.00310474im    -0.0260537-0.0194321im     0.0150555+0.0992313im    -0.114029+0.262541im      0.156842+0.218263im      0.0275775+0.0400155im     -0.208658+0.125211im    -0.0334344-0.0521849im     -0.154112+0.0704232im     -0.105181-0.0433243im    -0.101834-0.00398715im    0.0523807-0.119106im      0.0418099+0.0326372im     0.0616633-0.0379455im    0.0365008+0.161962im     -0.0687618+0.121961im    -0.0857723-0.188504im         0.100517-0.103272im      -0.316774+0.117786im       0.230114+0.0735672im   -0.0215035+0.250449im      -0.196394+0.109101im       0.11392-0.0631079im    -0.150724-0.00313602im    -0.10065+0.172089im      -0.14611+0.0947907im     0.124558+0.0159205im
  0.0939019+0.122656im      0.0472788+0.0403748im     0.0240193+0.0898431im    -0.0167467-0.0703012im    0.0108997-0.122763im       -0.140625+0.119077im       0.0349398-0.0289167im     -0.115365+0.0824712im   -0.0428097+0.0887952im    -0.190602+0.00572953im    -0.183751+0.0795542im     0.0611156+0.0337314im   -0.0546928-0.114342im      -0.011141-0.0768593im     0.0553271+0.118502im     0.0984055-0.0919029im      0.281596+0.11936im     -0.00857572-0.216104im       0.166443-0.195706im     -0.114288-0.0435236im     0.0159089-0.165662im      0.132732-0.201209im       -0.0400572+0.0288085im     0.0173823+0.360892im      -0.261457-0.148718im       0.14145-0.118287im     -0.0770157+0.17254im        0.10164+0.104058im     -0.108302-0.0713656im   -0.0384825-0.0153489im     0.134681-0.108161im     0.0869038+0.24777im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    -0.138114212358385 + 0.023342762863367346im
  -0.03579194767136695 + 0.18815609921077608im
   -0.2673657444454994 + 0.0165468115407552im
  0.009074815533982528 - 0.01996077448792015im
  -0.09305898348889927 + 0.26501970441165323im
   0.19233048776797174 + 0.12375073324798902im
  -0.15405858870632505 + 0.1528473568020851im
   -0.0997096217903587 - 0.07014021715464167im
  -0.04550515344103831 - 0.10015611484134178im
  -0.20955524879229026 - 0.13356250907538658im
   0.05032941569288134 - 0.09696854564664892im
  -0.03018273777690721 - 0.12298000788100484im
 -0.013423581580469251 + 0.034459885860933855im
  -0.03085667747068021 - 0.06987587824574189im
  -0.11307131889410502 + 0.18423097488561319im
   0.00580486158852498 + 0.13534659018904038im
   0.05716979483660918 + 0.17033448878969656im
   0.01946069359153889 - 0.1510214718084559im
   -0.1603548276961369 - 0.022323899456478613im
   0.04499916612227271 - 0.08340369074182485im
  -0.11646283878572061 - 0.126320809374216im
   0.12482918741824929 - 0.006179888210069921im
   0.13391931773814902 - 0.24044050313623638im
  0.005542770825348084 + 0.11200673036441765im
  -0.06455831276822718 - 0.2194646616003316im
  -0.16951179739107883 + 0.07643708024961852im
 -0.016866951329940205 + 0.14546942323413242im
   0.05928339383731063 - 0.0053292709004806454im
  -0.04807384349434602 + 0.10241749592307628im
  -0.05230061097861706 - 0.060330136710393466im
   0.34456973911192157 + 0.0im
  -0.14733320355801555 - 0.09250836715295334im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 29 March 2023 19:14">Wednesday 29 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

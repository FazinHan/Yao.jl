<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0913895-0.199001im      0.0431324+0.215073im       0.172439+0.0228958im     -0.145808-0.0983619im    0.0190999-0.0291068im     0.107135-0.0763375im    -0.0168095+0.0510289im     0.146882+0.116384im      -0.143429+0.00642255im    0.0128066-0.0950696im  -0.0508198+0.0345348im      0.205593+0.0140466im    -0.0347651+0.137202im      0.0196463+0.227571im        0.170064+0.080446im       0.269979+0.0439743im   -0.0130734-0.0124543im    -0.198026-0.0987422im   -0.00332645+0.0323635im   -0.0814633+0.0696821im    -0.0738644+0.0122386im    0.0923211+0.169389im      0.0451637-0.0388553im     0.142546+0.0328229im     0.0196476+0.00131466im  -0.0934411-0.203095im      0.131839+0.0313024im    -0.0868544+0.0710332im    -0.172495+0.230296im      -0.218641-0.0526578im       0.17621-0.0953394im     0.333052-0.179937im
  -0.0293374-0.102862im     -0.0887151-0.0855366im     -0.234721+0.00389649im    0.0992387+0.141658im    0.00624895-0.143666im      0.245779-0.0558642im    0.00489313+0.113668im     0.0642814-0.00937125im    0.0469821+0.0747903im      -0.13759-0.0241191im   0.0177313+0.270847im      -0.109606+0.250073im      -0.162008-0.168723im     -0.0870916+0.0076668im       0.132008-0.256455im      0.0821115-0.113069im      0.120075+0.0401719im    0.0344377-0.0615031im    -0.0596279+0.154341im     -0.156291+0.106069im      0.0533952-0.082178im       0.13082+0.197668im     -0.0149199-0.171904im      0.066651-0.00116053im     0.108184-0.178863im      0.187501-0.00770118im  -0.0907439+0.0486133im     -0.108034+0.012423im     0.0360531+0.0539241im    -0.0542952+0.256243im       0.124977-0.154091im     -0.113824+0.189278im
  -0.0806148+0.055885im     -0.0504076-0.112984im      -0.413525+7.82599e-5im     0.140181-0.103523im     -0.160613+0.00855224im   0.0430698+0.088352im       0.304904-0.12788im      -0.271989+0.0573918im      0.113345-0.0608461im     0.0703069+0.0921147im   0.0726373+0.0449837im     -0.109902-0.172329im    -0.00340315+0.0292181im      0.130703+0.0187921im       0.129001+0.113159im      0.0981128+0.051288im     -0.116341+0.154043im    -0.0832155-0.0291845im      0.195275+0.103523im    -0.0637232+0.0754344im     0.0271003-0.117676im    -0.0435855-0.0286882im   -0.00690449-0.0514841im     0.278098-0.120371im     -0.0998729+0.122027im     0.0695761+0.00257373im   0.0184628-0.307391im      -0.090254-0.104465im     0.0311795+0.0195361im    -0.0852417-0.0833548im     0.0370715-0.0215101im     0.180238-0.0596417im
   -0.016055+0.0178363im      0.243795-0.0353656im     -0.011109-0.109451im      -0.114759+0.0125443im    -0.114852-0.181018im     0.0796855+0.197126im      -0.107071-0.123128im      0.126615+0.149781im     0.00684704+0.131073im       0.094691+0.144236im    -0.156454-0.122031im     -0.0329496+0.0179852im    -0.0479689+0.0844195im     0.0613261-0.120076im       -0.172705-0.033542im      -0.264541+0.066907im    -0.0253282+0.196653im      -0.16043-0.0723692im      0.184884-0.0337087im     0.193305+0.045013im      0.0280689-0.0653286im    0.0510421-0.029778im      -0.118753-0.0616593im      0.29401+0.0930273im       0.11619+0.181358im      0.109296-0.0138883im   -0.0278568+0.351413im     -0.0222721-0.113124im    -0.0109039+0.101105im      0.0990499+0.169536im       0.144881-0.0418817im    0.0356723+0.0265829im
   0.0695055+0.00588938im     0.162259-0.013978im     -0.0644108-0.0379177im      0.120286+0.175607im     -0.197835+0.0459318im    0.0145126-0.0188336im     -0.101848+0.0263216im    -0.153293+0.104679im     -0.0983652+0.238647im      0.0528566+0.0148811im    0.171659-0.181401im      -0.107678+0.00950988im    -0.207406+0.169607im     0.00134882-0.0459986im     -0.0608891-0.153312im      0.0464131+0.180732im     -0.100283-0.0301566im   -0.0253321+0.154186im      0.0335511-0.105976im    -0.0297575-0.165159im     -0.0647667+0.243263im     -0.266831+0.186596im    -0.00534739-0.100229im     0.0368715+0.0697036im    -0.0278191-0.220974im     -0.135557+0.0948597im    -0.139309-0.146104im      0.0149019+0.205574im      -0.26817+0.122095im      0.0471631+0.0470833im    -0.0782414-0.155091im     0.0692474+0.0521511im
   0.0572499+0.199201im    -0.00267346-0.0593448im     -0.114871-0.149156im     0.00178918-0.101646im      0.191116-0.0525392im    0.0861323-0.163515im      -0.152034+0.0120997im    0.0851694-0.0168258im     0.0976315-0.0959372im      0.180708-0.123659im    0.0148692-0.115159im      0.0753249+0.0725433im     -0.174152+0.0256911im      0.284053+0.124081im        0.189289+0.0268396im   -0.00864371+0.185058im      0.228548-0.0226258im     0.118087+0.154798im     -0.0263963+0.0750829im     0.121646+0.110264im     0.00817052+0.0319124im    -0.028427-0.0601233im     -0.112481-0.0279342im   -0.0505453+0.0615508im      -0.37678+0.119856im      0.132043+0.133165im     0.0734515-0.0285335im    -0.0228304+0.166585im     -0.134583+0.00330588im     0.102835+0.0508566im      0.299018+0.0162813im    -0.117041-0.0677119im
 -0.00023431+0.0312356im     0.0778649-0.00989692im    0.0944365-0.00501393im   -0.0500022-0.192644im     -0.234445-0.0719765im    -0.003924+0.254912im     -0.0229262-0.239151im    -0.0068567-0.16265im       0.0536674+0.0602903im     -0.187217-0.086722im   0.00774656-0.0842625im       0.10947+0.0324263im    -0.0554643-0.139382im      0.0271984+0.238936im      -0.0547712-0.257153im     -0.0556048+0.0952329im    0.0526373-0.0461454im   0.00805396+0.076583im      -0.238738+0.0218382im    -0.154067-0.107268im      -0.197563+0.0272264im     0.179641+0.190296im     -0.0181006+0.162163im       0.20605-0.0133514im    -0.0122889+0.163829im      0.104496-0.00961344im   -0.032992-0.137809im      -0.236568+0.101052im     0.0355483+0.0314023im      0.107419-0.184182im      -0.100047+0.106105im     -0.170536-0.0257321im
    0.144155+0.0227647im      0.117514+0.0720656im     0.0059175-0.0366116im     0.0953456+0.0160869im   -0.0214401+0.0850267im    0.0604622+0.0122397im    -0.0535419+0.0461499im   -0.0180545-0.104907im     -0.0231767-0.171286im       0.204463+0.160762im    -0.152727-0.0890082im     0.0766095+0.026846im        0.23944+0.110894im       0.293166+0.179959im        0.225252-0.167338im      -0.188771-0.0783391im  -0.00459464-0.0431977im    0.0237047-0.118996im     -0.0500181-0.21574im      -0.234525-0.0281218im     -0.110906+0.0120543im   -0.0269938-0.122939im     0.00281499+0.104703im     -0.031125+0.0664736im      0.103681-0.295066im      0.179735-0.0532003im    -0.195656-0.104022im      0.0266737-0.163167im      0.161848+0.107677im      0.0965237-0.0059874im      0.109086-0.105382im      0.149002+0.0973966im
    0.102357-0.197079im      0.0790746-0.156684im        0.21719+0.0561777im     0.0370356-0.121489im     -0.113698-0.115666im     -0.097753+0.0141327im       0.12802+0.13832im     -0.0511485+0.0565056im      0.159172-0.105388im     -0.0132968+0.114564im    -0.187378-0.0542087im      0.103486-0.147463im      -0.233814-0.0881225im     0.0761909+0.00197537im     0.0840376+0.133864im     -0.0548574-0.0860611im    0.0217069-0.153516im      0.159492+0.141168im    -0.00507354-0.0192585im      -0.1168-0.166051im       0.145095-0.0826434im    -0.206276+0.0439801im     -0.238428-0.186147im   0.000443606-0.036947im      0.0886556+0.02689im     -0.0733658-0.0629175im   -0.0960421+0.0595277im     -0.205051+0.246577im      0.212118-0.163378im     -0.0578358+0.199256im      0.0584581+0.023579im      0.121429-0.0943618im
   0.0628336+0.0320691im     -0.212409-0.147472im       0.115762-0.171407im       0.151379-0.149059im     -0.156572-0.013202im      0.160848+0.134071im      -0.135867+0.288098im      0.165525+0.120189im       -0.13994-0.0709868im     -0.253044-0.242671im   0.00367612-0.316482im     -0.0733374-0.00880959im    0.0490398-0.162291im      -0.059292+0.0733261im      0.0636533+0.00224769im    -0.058255-0.14328im     -0.0833564+0.0510845im   -0.0797133-0.0463005im      0.129103+0.161217im     0.0807126-0.0540419im     0.0471768-0.0380193im    0.0101742-0.206008im     -0.0136393+0.182585im      0.112688-0.143766im      -0.103788-0.109838im    -0.0567218+0.0303338im    -0.134604-0.0571627im     0.0198215-0.0396577im    -0.113116-0.127095im      0.0314513+0.0279998im     -0.013197-0.184203im     0.0949586-0.0468016im
  -0.0246286-0.0564616im    -0.0505745-0.207677im      -0.049432-0.0111659im      0.019655+0.0701722im    0.0155722+0.170828im    -0.0838238-0.0485167im      0.068852+0.0169564im   -0.0847873+0.209849im     -0.0967766+0.124806im     0.00352809+0.0690162im   -0.172909-0.147609im      0.0300664-0.101365im     -0.0126622+0.0589378im    -0.0709146-0.0017303im       0.177122-0.214635im      0.0913925+0.117145im     -0.080799-0.0269295im    -0.302155+0.0393277im    -0.0578406+0.0672135im     0.179708-0.108214im     0.00833347-0.345126im      0.260547-0.0952361im    -0.0171356-0.0275915im     -0.28985+0.161373im    -0.00548685-0.0250774im    -0.106055+0.0435114im    -0.033274+0.0158818im     -0.197404+0.12586im       0.131126+0.087182im       0.079735-0.187005im       0.129045+0.0587592im   -0.0633474+0.165515im
    0.151629+0.058544im      -0.099182-0.13583im       0.0696988+0.120537im       0.230745-0.0926757im    0.0544045-0.0315864im    -0.177037-0.0379063im    -0.0195527-0.1172im         0.15985+0.0605759im    0.00871093+0.0846984im    -0.0395771+0.356639im    0.0636081+0.00348468im    -0.163327-0.118015im     -0.0926083-0.117675im        0.13735+0.10161im         0.197973-0.00954754im    0.0420192+0.229212im      0.095401+0.0527201im     0.159538-0.125001im      -0.261559+0.0804429im     0.111153-0.00592716im  -0.00579453+0.0266167im    0.0719932-0.0151521im       0.31556+0.0998524im     0.128645-0.0273688im     0.0773251+0.0567948im     -0.25704-0.0467909im    0.0685206+0.118836im        0.13486-0.038018im    0.00792481+0.0728168im     0.0415548+0.158653im     -0.0737494-0.155519im     0.0832865+0.0125129im
   -0.211028-0.0202931im     0.0741799+0.161498im      -0.050351-0.0523721im      0.148389-0.157379im     -0.227589+0.109431im      0.132848-0.0713369im    -0.0882963+0.0729584im    0.0596148+0.108133im      -0.193071+0.0356203im   -0.00149015-0.177514im     0.256909-0.051303im      0.0704638-0.111614im     -0.0120344-0.135365im       0.105998-0.112313im      -0.0726178+0.0122776im    -0.0958842+0.0956139im     0.195729-0.0125787im    0.0721517-0.0340673im    -0.0847599-0.0966968im    -0.176775-0.112083im     -0.0613091-0.370833im    -0.0843235-0.014158im       0.107972-0.222261im   -0.00736052+0.028841im      0.0489446+0.115465im    -0.0283465+0.0465707im     0.046435+0.0178845im      0.332659+0.0310085im     0.221513+0.0921637im    -0.0489105+0.00612965im    0.0668045+0.129677im   -0.00208828+0.0674513im
  0.00469575-0.165316im      0.0917566+0.171103im       0.255165-0.0672831im      0.209171+0.134158im      0.251227-0.0210242im     0.141766+0.0669604im      0.126308+0.0983869im    0.0418372+0.0583768im      0.127044-0.0184542im    -0.0830796+0.0556885im    0.224535+0.0316236im    -0.0681148-0.119206im     -0.0921244+0.126999im      0.0597665-0.25668im         0.143255+0.0349379im      0.075885+0.124827im     0.0327684+0.200545im    -0.0592442-0.0392525im    -0.0325641+0.00409671im   -0.226757-0.163174im      -0.157728+0.0602986im    0.0853041-0.222511im      -0.223154+0.0180046im    0.0129682-0.147261im      -0.129589+0.132994im     0.0110717-0.154356im     -0.107488+0.0557308im     -0.106806-0.0976799im   -0.0618552+0.0634644im     0.0655351-0.0941133im    -0.0550986-0.0145204im    -0.209822+0.0753187im
   0.0334231+0.050453im      0.0489283-0.131018im      0.0335054+0.264781im      0.0111377+0.0508969im   -0.0159769+0.0597911im     0.243276-0.159389im    -0.00849157+0.125389im       0.20395-0.0560134im     0.0593929-0.0318452im      0.162817+0.0795067im   0.0464343+0.0731693im     0.0702769-0.342399im      0.0222534+0.0545321im    -0.0565792-0.131734im       0.0722858+0.0038493im     -0.191684-0.246173im      0.159609-0.0936497im    -0.134254+0.0967799im     0.0513158+0.309939im     -0.054475-0.0382843im   -0.00594988-0.0149387im   -0.0508672+0.182347im       0.152762+0.117779im      0.139762+0.224892im       0.052843+0.0520496im   -0.0257795+0.0673988im    -0.128074-0.0551671im    -0.0415139-0.049387im     -0.211387+0.0288094im      0.128882-0.0920914im    -0.0532286+0.206744im    -0.0169379-0.0354051im
  -0.0394838-0.00225855im     0.158445+0.0846593im     0.0577352+0.0133277im      0.100975-0.0275595im     0.104621-0.147798im     -0.120117-0.204294im      -0.242979+0.0535541im    -0.233424+0.0807344im     0.0223215+0.145681im      -0.121253+0.0570647im  -0.0667972+0.0742im       0.00709199+0.164559im     -0.0416276-0.149311im      0.0736186-0.0414226im       0.197887+0.0139533im      -0.12388-0.0154133im     0.014146+0.274565im     -0.014313+0.0763563im      0.191666+0.197609im    -0.0699857+0.0139364im   -0.00718824+0.00534899im   0.0296551+0.168206im     -0.0716319+0.0909843im   -0.0640285-0.0645356im      0.201529+0.0101574im    0.0499021+0.108725im      0.058277+0.00965623im     0.174884+0.0770761im    0.0987864-0.138317im       0.177924-0.393317im     -0.0294438-0.0688816im     0.158998-0.149495im
  -0.0643705+0.147996im     -0.0187152+0.0622202im    -0.0705963-0.121844im     -0.0710745-0.00531033im    -0.23442+0.0188155im     0.111226+0.0713767im    -0.0336575+0.0181654im   -0.0680505+0.106332im      0.0428831+0.172394im       0.113436-0.0355226im   0.0410247+0.137813im      -0.171775+0.0307587im      0.168381+0.00428534im   -0.0477552+0.0541816im       0.239287+0.140026im      -0.138716+0.0321411im    0.0724726-0.248289im      0.168512-0.0865182im      0.122535+0.217879im     0.0449292-0.223596im       -0.14464+0.227918im      0.159782+0.0337747im    -0.0596968-0.0537089im    -0.249551+0.129984im      -0.161698+0.148529im     0.0108131-0.159062im    -0.0790391+0.194897im      -0.090123-0.01037im       0.146085+0.0353406im    -0.0996854+0.0220752im     -0.205119-0.081891im      0.126716-0.0269971im
    0.056154+0.299663im     -0.0741738-0.0370176im     0.0340079-0.0731018im     0.0122296+0.163695im     0.0904742-0.0701195im    0.0103338-0.00631673im    0.0872036+0.0235042im   -0.0768264+0.0658674im     -0.210553-0.0320246im    -0.0800305+0.103017im    -0.127671+0.135534im       0.151122+0.1177im          0.21651+0.0238454im     -0.098542-0.0226504im     -0.0395006-0.125784im     -0.0403483+0.174579im      0.222384-0.129869im     0.0925257-0.112749im      -0.130626+0.0929976im    -0.046966+0.0324475im     0.0176313-0.0984767im   0.00351972-0.185189im      -0.292002-0.223755im      0.182206-0.13265im         0.11438+0.0490921im    -0.132138+0.155854im     -0.165971-0.0588539im    0.00677282+0.0728861im    -0.214488+0.0804989im   -0.00576549-0.0430308im     -0.130942+0.164741im      0.187039-0.141185im
     0.40825+0.0704619im    -0.0271938-0.0587024im    -0.0389309-0.173165im      0.0202863+0.0634118im   -0.0153739-0.0509429im     0.121678-0.138294im      0.0375532-0.127912im      0.068348+0.0265503im   -0.00601083+0.158767im      0.0375724-0.202954im    0.0473963+0.056916im      0.0480574-0.0930816im     -0.309876+0.230595im      -0.120267-0.0152846im    -0.00256259+0.00343681im    -0.167102-0.303907im    -0.0429458+0.154452im      0.143954-0.261586im      -0.153708-0.180261im     0.0112535+0.0713607im    -0.0732092-0.00529068im   0.0637551-0.0722079im     0.0862996-0.0693397im  -0.00602634-0.0286985im    -0.0148741+0.0551891im   -0.0680746+0.134319im      0.059203-0.00359382im    -0.121956+0.0482433im     0.166057-0.0295716im    -0.0976785-0.22391im       -0.028777-0.0132839im     0.127385-0.0620203im
   -0.131433-0.00266933im    0.0527135-0.00260566im    0.0868649-0.229522im      0.0819908+0.0141921im     0.295898+0.0681348im     0.151905-0.0899664im    -0.0684774-0.128956im    -0.0684156+0.112759im       0.131364+0.0445965im    -0.0141282+0.221997im    0.0516209-0.0256031im   -0.00641117-0.00465557im    0.0495427-0.0866159im    -0.0683989-0.0648964im      -0.096642-0.0271012im     0.0166234-0.0963604im    0.0744776-0.411267im     -0.164379-0.196809im      0.0246056-0.230914im     0.0754319-0.213732im      0.0997825-0.0940857im    0.0416148+0.15571im        0.166343+0.0602852im     0.138875-0.103803im     -0.0962876+0.108018im      0.206907+0.077301im    -0.0189421-0.102877im     -0.0127545+0.113177im   -0.00503004-0.195879im     -0.0209964-0.0174958im    0.00881668-0.212349im     0.0748791-0.0682617im
   0.0390024-0.0963573im     -0.104244+0.137345im    -0.00994077-0.119564im    -0.00883744+0.0590138im   -0.0193123-0.0234888im   0.00200215+0.041837im      -0.167029+0.221147im     0.0335753+0.0711382im     0.0260981+0.0390998im    0.00615165+0.142612im     0.107751+0.0297782im      0.234885+0.143608im        0.12781+0.188583im      -0.130089-0.10427im         0.231484+0.0414694im     0.0337287+0.133072im     -0.223204-0.0707313im     0.109377+0.207552im      0.0325465-0.0482845im       0.1329+0.290244im      -0.229025-0.108905im    -0.0801255+0.0827905im      0.196764+0.0656809im     0.231968-0.0485738im    -0.0421684+0.110591im    -0.0344939+0.115045im     -0.141048-0.033982im      -0.134302+0.0360353im     0.254198-0.130019im       0.032435+0.110805im     -0.0938279+0.145216im    -0.0370699+0.0650755im
  -0.0385065-0.237403im       0.130957-0.0369702im     -0.233937+0.041252im      0.0213207-0.00541494im    0.131853+0.110194im     0.0327459+0.10652im        0.106492-0.108947im      0.218677+0.0359589im     -0.360445+0.0341564im    0.00700575+0.124231im      0.18804-0.147981im     -0.0144151+0.155599im     0.00354729+0.0400533im     0.0807591+0.0385064im      0.0404521+0.191816im     -0.0175616-0.0967591im   -0.0214926-0.17498im       0.264254+0.155669im     -0.0269248+0.0971104im    0.0560582+0.00242376im     0.134602-0.00170929im   0.0401081-0.146778im     -0.0408058-0.0981177im      0.14384+0.0882215im      0.150052-0.133081im      0.114152-0.0392089im    0.0283343+0.0885125im     -0.124179+0.0462167im  -0.00331438-0.0532381im     0.0352943-0.308133im     -0.0839539-0.120595im     -0.156153-0.144935im
   0.0328297-0.0103866im    -0.0977842+0.0702293im    -0.0240564-0.161055im       0.209218+0.0608769im    0.0375074+0.272172im     -0.173023+0.0858821im     -0.115214-0.178593im      0.132287+0.060193im     -0.0746973+0.00856695im     0.104065-0.0771789im   -0.126985+0.112262im       0.244129-0.122267im     -0.0794844-0.00426418im   -0.0101747+0.19256im        0.0915115-0.097818im      -0.108501-0.0656081im    0.0746681-0.0709076im    -0.120429+0.138891im       0.129795+0.0614585im   -0.0396665+0.0748135im      0.156181+0.129109im     -0.105375+0.176484im      -0.151032-0.164253im     0.0514368-0.189694im     0.00898382+0.16632im      -0.165028-0.0887654im   0.00690265+0.0267987im      0.067656-0.231392im    -0.0116338-0.121408im     -0.0822612-0.0898001im      -0.05777-0.14039im      -0.123183+0.307228im
   0.0762749-0.188755im       0.135933+0.15883im       0.0820396+0.0159489im      0.137361+0.116833im    -0.0482823+0.00557681im   0.0732331-0.0326083im      0.193539+0.00425366im  -0.0862316+0.10363im      -0.0529009+0.327741im       0.214445-0.145419im    -0.223512-0.0526397im     -0.143214+0.161571im     -0.0824205+0.0504206im    -0.0143604+0.0259947im     -0.0296146-0.0878815im    -0.0618558-0.0333521im     0.080142-0.138935im      0.102323+0.203046im     -0.0894031+0.099353im     0.0368131+0.0582322im     0.0731667-0.0712425im     0.148014-0.152264im      0.0766284+0.218798im   -0.00208819-0.129528im       0.035424+0.133759im     0.0419743-0.191706im     0.0805861-0.259242im       0.144221-0.118193im    -0.0941388-0.159123im      0.0318259+0.196274im       0.056956+0.17784im      0.0863136-0.0470225im
   0.0437446-0.0718287im     0.0880032+0.201608im       0.141177+0.0142478im    -0.0126897-0.0323292im    -0.323872+0.0215876im    0.0645774-0.174013im      -0.111644-0.177372im     0.0234736+0.111193im       0.219112-0.0165337im     -0.121611+0.0142343im   -0.146123+0.0600198im     -0.127702-0.188037im      0.0861386-0.171294im     0.00348025-0.103054im        0.199386-0.00361887im     0.133021-0.0528286im   -0.0912174-0.125774im     0.0674602+0.10021im       -0.129708-0.113937im     0.0972207+0.262456im      0.0779299-0.0673953im   3.79297e-5-0.202213im     -0.0926482-0.158155im      0.060653+0.0702725im    -0.0702153-0.102145im      0.200622+0.14127im       0.127934+0.0556205im   -0.00272275-0.0179992im    -0.247351+0.0320755im     0.0269487-0.125933im      -0.194545-0.0527687im    0.0162159+0.152832im
    0.175625+0.0675642im      0.107235-0.0340751im     0.0503947-0.0351506im      -0.09934-0.185372im    -0.0863773-0.113902im     0.0140559-0.217939im      0.0565813+0.173259im     0.0280767+0.166421im     -0.0466065+0.0922174im    -0.0162361+0.0940627im   0.0610388+0.175288im       -0.26188+0.152402im       0.264353+0.115385im        0.29751+0.186257im       -0.139993+0.0416935im     0.0946892-0.156333im    -0.0131334+0.00427539im  -0.0462674-0.0542988im   -0.00425325-0.0699578im    0.0598934-0.0981981im     -0.032358-0.109637im    -0.0423066+0.15889im       -0.109484-0.0374505im     0.131551-0.0558935im    -0.0870934-0.0279616im    -0.250199-0.0885074im    0.0345808-0.0102033im    -0.0544693-0.0238974im   -0.0550953-0.19852im     -0.00877595-0.126978im      0.0666346+0.125036im     -0.235264+0.227703im
    0.114504-0.0649357im     0.0439834-0.113563im      0.0159716+0.107548im      0.0194561-0.50071im      0.0698442+0.112806im     0.0931425+0.133962im      -0.068383+0.117192im     -0.182767+0.0211219im     -0.139372+0.142194im      0.0115634+0.165383im    0.0103829+0.236431im       0.102678+0.00884272im      0.10282-0.0121569im     -0.273357-0.108949im       0.0764843-0.022807im        -0.1784-0.0980775im   -0.0959509+0.00262828im   -0.023016+0.0528759im    -0.0266622-0.106398im    -0.0543096+0.0246758im   -0.00272661+0.225066im     0.0834323-0.157922im     -0.0511381-0.113266im   -0.00573851+0.00930251im   -0.0459754+0.091536im    -0.0256226+0.0297241im     0.189505-0.156719im      0.0902503+0.105693im    -0.0805355+0.150459im      0.0819689+0.0997934im      0.197829-0.107947im     -0.119455+0.0249182im
   -0.202163-0.190062im      -0.416559-0.0520699im    -0.0865042-0.044225im     0.00445313+0.140278im    -0.0252752-0.148596im    0.00225876-0.159559im      -0.206525-0.0184871im    -0.017713+0.248122im     -0.0426303+0.032625im      -0.079711+0.162321im   -0.0291111-0.153392im     0.00113195-0.127573im      0.0540449-0.062522im       0.107581-0.0689507im      -0.121901-0.136013im     -0.0838954-0.110558im    -0.0233802-0.0412956im     0.205689-0.00272795im   -0.0127114-0.119002im    -0.0953112-0.0251921im    -0.0915939+0.215564im    0.00678126+0.0505076im    -0.0955875-0.0510936im   -0.0362434+0.0190048im    -0.0149764+0.0409991im     -0.06179-0.0809545im     0.235686-0.106793im      -0.182433-0.24933im    -0.00915652+0.0872971im        0.1246-0.0212301im      0.150871+0.184003im     0.0186639-0.133248im
  -0.0454797+0.0225759im    -0.0755092-0.127861im       0.142023-0.0212444im     0.0639926-0.0562356im    -0.196749-0.113658im      0.142625-0.155506im     -0.0300268-0.19465im       0.257607-0.272726im      -0.208146+0.0577199im    -0.0802494+0.148007im    0.0685921+0.171907im      0.0330754+0.0678837im    -0.0422305+0.0838723im   -0.00112915-0.111826im       0.0567782-0.014296im       0.136485+0.168099im     -0.166774+0.0739674im   -0.0725315+0.129412im     -0.0215213-0.0996333im    0.0827151-0.144532im       0.247956+0.143477im     0.0915713+0.00195816im   -0.0989086-0.0465466im   -0.0990344+0.089789im     -0.0816166+0.0558555im     0.107929-0.0143101im    -0.242886-0.127724im       0.122649-0.169127im      0.105974-0.208835im     -0.0646673-0.0571143im      0.154761+0.12546im       0.166091-0.036973im
   -0.160435+0.0878707im     0.0718765-0.210841im        0.21906+0.277795im       0.100422+0.203865im     -0.132536+0.028622im     0.0489136+0.0996208im     0.0055396+0.185959im    -0.0199637+0.0229413im    -0.0822304+0.0126882im    0.00816396+0.0537501im   0.0833275+0.0579666im    -0.0569028+0.100262im      0.0100829+0.143951im       0.108931+0.207255im      -0.0513571-0.106927im     -0.0378952-0.013796im     -0.168199-0.0643925im   -0.0127624-0.00670398im    -0.091286+0.0148589im    -0.141285+0.132616im      0.0114459-0.0493639im    -0.183438-0.0598598im      0.103613-0.0308761im     -0.20225-0.141207im     -0.0426503+0.335896im      0.172394+0.268549im      0.168378+0.156082im      -0.118655-0.111153im    -0.0559239-0.0504757im     -0.101599-0.0725461im      0.064156-0.181029im    0.00935472-0.0641716im
    0.266536+0.0771447im      0.136218+0.198235im     0.00175181+0.0278478im    -0.0652189+0.0488041im   -0.0099434-0.0302183im     0.210238-0.00515249im    0.0300402-0.153354im     0.0684136+0.0541167im     0.0920802-0.225469im     -0.0720106+0.159831im   0.00405566-0.14103im       0.0728516+0.00862333im      0.17328+0.0345838im     -0.164913-0.112356im       -0.122011-0.183104im      -0.121911+0.140842im     -0.153421+0.0588612im     0.184327+0.146562im      0.0144624+0.285527im    -0.0670934-0.116698im       0.077109-0.19512im      0.0244169+0.17308im       0.0181175-0.0495416im    -0.128952-0.0666687im     -0.171077-0.0997682im    -0.155121-0.0245352im     0.226078-0.0731511im    0.00583439-0.100429im     0.0591192-0.0285365im     -0.152958+0.000428702im     0.12992-0.214208im    -0.0244426-0.0933174im
    0.170602-0.0120275im    0.00369406-0.0810683im    -0.0284724-0.0231322im    -0.0620542+0.164924im    0.00812204-0.0252887im    -0.107425+0.299129im      -0.099965+0.0294307im     0.244347-0.145595im       0.108113+0.211833im      -0.074297+0.0999476im   0.0980028-0.0300249im     -0.150512-0.0729757im      0.158337-0.068128im     -0.0570807+0.0151361im   -0.000956593-0.0221966im     0.0420452-0.0347519im      0.09811-0.0160287im   -0.0160017-0.0424932im      0.151507-0.0964831im    -0.160659+0.276079im      0.0368772-0.163282im    -0.0844056+0.0372543im     0.0507492-0.202926im     -0.177525-0.0191807im     -0.144959+0.0799639im    0.0106058-0.35432im     -0.0203981-0.120242im      0.0793895+0.218579im    -0.0574495-0.0273893im      0.220962-0.135069im       0.100763+0.0449191im     0.151813-0.0655385im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
      0.1261885928979171 + 0.06680111498869384im
    -0.01652277100941752 - 0.10952932605433764im
     0.05091915846933151 + 0.16735054234247795im
   -0.005540234982810765 + 0.07485735128318502im
    0.012466105928365166 + 0.09895862246872311im
     -0.1580910988777077 - 0.12702893657144462im
    0.015577844158387574 - 0.07721975288714171im
    -0.15417596850829624 - 0.1217996357040986im
    -0.10405196112357416 + 0.07768877894861502im
     0.28202104419909546 + 0.0im
     0.19756075571309806 - 0.09916900088269916im
    -0.27447203377611706 + 0.013319097109553682im
      0.0687531577021874 - 0.07933070171463596im
    -0.01387256541205459 + 0.26082062659282595im
    -0.15502809128788075 - 0.10805610773698603im
    0.046027513200296404 - 0.1760372328836672im
    -0.03733741916363511 + 0.2575227414094637im
   -0.051167679250295146 + 0.18152424849095597im
    0.026264082368701633 - 0.10688719112391108im
    -0.12663920593392614 + 0.16281835908492587im
     0.17291553566653617 - 0.06413267757549666im
     0.18780434533568935 - 0.029251845730826037im
     -0.1987147093096036 - 0.014943183365166248im
      0.1287929755333459 + 0.14118376409735786im
    -0.05162579224503572 - 0.13742150458768254im
    -0.12520206577347637 + 0.15479172656421838im
 -0.00021742830464726627 + 0.08592080822999101im
    -0.19465713389036815 + 0.05015330033246586im
    -0.09227211269983195 - 0.047326061516308686im
     0.02868127010647506 - 0.1355320768800328im
    -0.06382787562591753 + 0.03834923560689408im
      0.1326969704242831 - 0.0016367425303735253im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 1 March 2023 19:13">Wednesday 1 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

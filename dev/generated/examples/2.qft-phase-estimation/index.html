<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0721948-0.110536im     -0.150419-0.0470077im   -0.0654343+0.12527im      -0.141795-0.0289838im     0.0403933+0.251224im      0.0119205+0.109093im    -0.169107-0.14357im       -0.0624427-0.075475im       0.155738+0.0830398im     0.230881-0.188835im      0.0387897-0.0555203im     0.0279294-0.0681633im      -0.142516+0.19858im       0.133347-0.098847im      0.0910243+0.297612im     -0.135845-0.130797im     0.0193407-0.0131265im   -0.0752243+0.0535587im   0.00142202+0.0291752im     0.117891-0.296458im      -0.0715329-0.080187im      -0.0497203-0.0291507im    -0.163425-0.125005im      -0.0228383+0.212227im    -0.0995613-0.0132041im    -0.14461+0.121976im       0.169067-0.0409494im    0.0579211+0.173074im    -0.0816815-0.0385117im    -0.221009-0.0944683im      0.0570927-0.159219im       -0.111284-0.0230802im
   0.0791517-0.0478333im    0.0607757+0.244353im     0.0499835-0.0215029im    -0.195114+0.173764im    -0.00655215+0.193674im       0.258725-0.223798im    -0.043928-0.000883665im   -0.0489692-0.046176im      -0.190478+0.167411im     -0.220731+0.131735im     -0.0104882-0.0296147im    -0.0152323-0.111825im       -0.121007-0.00651967im    0.100379+0.033491im     -0.0759544-0.0418816im     0.137911-0.0516443im    -0.160971+0.149059im    -0.0506921+0.0104675im     0.118275+0.0339473im   -0.0303847-0.0566606im     -0.0748308-0.0178837im      -0.111551+0.0442256im   -0.0817377-0.0495409im   -0.000758669-0.00880028im    0.233995+0.12727im     -0.141947-0.0366143im      0.189667+0.179867im     0.0965508-0.0653865im    -0.149955+0.0528892im   -0.0888444+0.119423im        0.241352+0.210418im      -0.0582219+0.263147im
    0.032354-0.203034im    -0.0696734+0.065079im     0.0236539-0.0496319im    -0.265857-0.0533898im     0.0714038+0.00623073im    -0.212686-0.185514im   -0.0590635+0.0234682im     -0.0709815+0.234129im     -0.0595459-0.0739679im    0.0588565-0.0937304im     -0.174029-0.361893im      0.0284848+0.126469im        0.302611-0.085941im       0.04247+0.153691im      0.0743678+0.027084im     0.0887933+0.00428997im   -0.196762+0.00749744im  -0.0490444+0.0169872im    -0.211659+0.00789054im    0.124815-0.121647im       -0.131426+0.0215252im     -0.0317939-0.00379487im   -0.143233-0.049945im      -0.0639394-0.0494075im     0.245059-0.128991im     0.131483-0.178784im      -0.155066+0.0168256im    0.0145308-0.0374335im     0.076611-0.0679705im    0.0317163-0.174504im       0.0733825-0.138223im       0.0447395+0.0141711im
   -0.219051+0.00285824im  0.00477879-0.279553im    0.00496753-0.138927im     0.0116344-0.158867im      0.0897784+0.0966314im     0.0606887+0.0705628im    0.165964-0.0159195im     -0.0915622-0.0804175im     -0.284553-0.0463504im    0.0565393-0.0288729im     0.0167901-0.100348im     -0.0885809+0.117977im      -0.0530767-0.0812886im   -0.0160667-0.196809im     -0.0628738-0.0699595im   0.00182621+0.00063141im   -0.191041-0.128878im    -0.0398057+0.0251264im    0.0434437-0.0126524im     0.202189+0.0837633im      -0.211195+0.121492im        -0.13636-0.0184558im     0.103507+0.32033im         -0.15734+0.0165431im    0.0486215-0.0411843im  -0.0555238+0.123953im     -0.0597197-0.0196256im     0.111534+0.0634667im   0.00389396-0.155694im     -0.242101+0.29934im        0.0683556-0.0776615im       0.180881+0.0561535im
   0.0192597+0.0849377im   -0.0236439+0.0827692im     0.249707+0.154978im    -0.0816492+0.0800922im     0.0868397-0.13036im        0.177236-0.0796436im   0.0948777-0.00453977im      0.352176-0.0123046im     0.0170899+0.0254246im  -0.00407046-0.188244im      0.0722552-0.0559723im     0.0717307-0.0813039im     -0.0107406-0.118782im     0.0353155+0.00507853im    0.0588374+0.212938im     -0.173232-0.0758738im    0.0727824-0.014714im     -0.073026+0.0868675im    0.0790519+0.11189im      0.0638482+0.220897im       -0.098428+0.0137589im   -0.000523478+0.0707672im    0.0312919-0.0998757im     -0.0253912-0.0233271im    0.0398072-0.0563262im  -0.0138856+0.150094im      -0.216672+0.05115im      -0.173891-0.12423im       0.260493-0.143445im     0.0215529+0.180568im        0.336062-0.118848im       -0.177998-0.116052im
   -0.037841+0.0309431im    -0.138681+0.137052im     0.0725375+0.0166771im     0.141835-0.0911524im     0.0420414+0.227615im     -0.0439196-0.0124898im  -0.0367312-0.0734798im      -0.128299-0.00545659im     0.112739+0.0143791im   -0.0538047-0.11198im      0.00237309+0.378737im     -0.0639711+0.214198im       0.0361706-0.230582im     0.0910819+0.00573155im     0.191504-0.0673444im    0.0610351-0.244095im     -0.134075-0.0955744im    -0.209804-0.179458im     -0.188322-0.167397im     0.0636671+0.126169im       0.0906216+0.103436im         0.11227-0.121914im     -0.236101-0.0249435im        0.13536+0.0453316im     0.123509-0.072999im   -0.0406262+0.0297761im     0.0251734+0.128052im    -0.0557974+0.105567im     0.0367631+0.0242041im     0.154251+0.240178im       0.0285813+0.0378852im     -0.0190287-0.0853367im
   -0.129828-0.127593im      0.192759-0.0399436im    0.0542968+0.115554im     -0.209784+0.023661im      0.0810592-0.0369257im     0.0687347-0.119882im     0.120512-0.198773im       -0.126192+0.072665im     -0.0126063-0.269289im     0.0756602-0.0275554im     0.0158722+0.198129im       -0.19355-0.340546im     -0.00694219-0.0178478im     0.039171+0.11711im      -0.0321532+0.179914im     0.0105627-0.112972im    -0.0720957+0.131521im     -0.116279-0.0665671im    0.0488819-0.0119567im    -0.058062-0.005371im        -0.10198+0.126221im      -0.0528193-0.192987im      0.141114+0.189992im      -0.0024074+0.253298im    -0.0571471+0.0617657im    0.141198-0.112823im     -0.0654883-0.115247im     -0.244735+0.0539453im   -0.0618813-0.0468283im      0.20698-0.0376793im      -0.112368+0.09201im      -0.00312006+0.08095im
   -0.179547+0.152111im       0.13918-0.127136im     0.0742792+0.00816325im  -0.0369723-0.107573im     -0.0289896+0.29402im       0.0203688+0.0388974im    0.220189-0.0651245im      0.0040517+0.110206im      0.0190989+0.104356im     -0.152014-0.00944697im  -0.00277342-0.275283im      -0.109641+0.126425im        0.073468-0.233779im     -0.205679-0.0784642im     0.0287994+0.230987im       -0.0638-0.0203611im     0.154966-0.15747im      -0.101993-0.0210327im   0.00696814+0.0305638im    -0.130235+0.0450145im      0.0698543-0.137223im       -0.117694+0.219863im     -0.121427+0.0630952im     -0.0286164+0.0472456im   -0.0562518-0.103449im     0.104849-0.00981438im     0.189608+0.112657im     -0.148229-0.151747im     -0.177647+0.125579im      0.121078-0.0961562im      -0.123803+0.0731902im         -0.169+0.0682558im
    0.147777+0.226388im      0.223929+0.131592im     0.0136983-0.0274691im      -0.2329+0.0107864im     0.0948179-0.0431839im     0.0304048+0.266995im     0.042554-0.00458286im    -0.0489073-0.132699im      -0.116707+0.0356307im    0.0724271+0.210908im       0.098443-0.00685322im    -0.144994+0.0214657im      0.0306843-0.0302755im     0.150474+0.148244im    -0.00341984-0.0464421im    -0.184087+0.10362im       0.117894-0.217032im     -0.172884-0.020434im    -0.0114401-0.206101im     0.0719498-0.158463im      -0.0459981+0.231905im        0.187964-0.124288im     -0.013245-0.062705im       0.0160701+0.159944im      0.064707-0.155091im   -0.0684091+0.0206326im     -0.137849+0.0229916im     0.109378-0.304604im     -0.035076+0.161699im     -0.111174-0.0624298im     -0.0469112-0.0610658im     -0.0391054-0.0244306im
  0.00919016-0.0778617im     0.180716+0.0383496im   0.00473804+0.122168im     0.0993342-0.0939485im   -0.00934045+0.155529im       -0.12808-0.205826im   -0.0326257-0.146449im        0.130433-0.0291964im     -0.255817-0.17885im       0.163192-0.197552im     -0.0266657-0.0210631im     0.0727447+0.0540391im     -0.0456392-0.0282416im    -0.134609-0.0634542im     -0.126089-0.296754im     -0.193151-0.0257462im    0.0293486+0.0286631im     0.247815+0.206988im     -0.114664-0.0888857im   -0.0289538-0.0064489im     0.00694843+0.125868im        0.161323+0.0535776im    -0.168886-0.136193im      -0.0976482+0.269958im     -0.198587+0.102652im     0.101943-0.0912089im     0.0219435+0.0411385im    0.0126799-0.0796446im   -0.0640643+0.146832im    -0.0225841+0.0834731im       0.172117+0.132956im       -0.036358-0.0445109im
    0.309817+0.0386397im    0.0891447-0.121294im    -0.0347835+0.00638089im    0.203094+0.0267239im     -0.114185-0.0380369im       0.22119+0.159973im    0.0896609-0.143098im      0.00589103+0.0153322im     -0.168236-0.114103im    -0.0626749-0.135761im     -0.0524639-0.0926356im    0.00311718+0.0821669im       0.119484+0.0799906im    0.0812713+0.101734im    -0.00164105-0.037055im     0.0983384-0.128541im    0.00866792+0.0597848im    0.0179341-0.00622112im    0.237227+0.226329im     0.0679555-0.0307225im      -0.233712-0.0323209im     -0.0492117-0.0363561im    -0.164101+0.0142795im       0.224451+0.0303059im    0.0174933-0.239803im   -0.0531694-0.173463im      0.0918349-0.203923im     0.0823992+0.101574im     -0.135816+0.178309im      0.207892+0.105039im       0.0472494-0.136211im      -0.0365015-0.180304im
   -0.101676-0.077433im    -0.0126157-0.031191im      0.023969+0.118382im      0.186266+0.0675917im      0.116176-0.147787im      0.0160343-0.156721im    0.0485961-0.0397281im        0.21645-0.132492im      0.0611544-0.123909im      0.112429+0.0894499im     0.0948131+0.0578629im      0.123474+0.143096im       -0.135767-0.049208im     -0.254134-0.0605196im      0.103969+0.220172im      0.235505+0.0147618im    0.0828287-0.0478235im    0.0526949-0.147597im     0.0417328+0.0727538im     0.274123-0.212903im       0.0426423+0.166167im       -0.136368-0.117561im    -0.0934984+0.0354613im       0.166897+0.0608473im     0.108351-0.0913635im    0.104498-0.152517im      0.0392067+0.0231291im     0.244741-0.224472im     0.0991891+0.0118283im    -0.084959-0.0473959im     -0.0669957+0.176318im      -0.0617203+0.135075im
   0.0836896-0.294541im    -0.0631505-0.172972im     -0.293623+0.149855im    -0.0870642-0.00857678im    0.0146017-0.123245im      -0.167921-0.105193im    -0.286095-0.0860657im       -0.01024+0.030333im    -0.00301681-0.0834082im   -0.0808348+0.14349im        0.280311-0.0533152im     -0.153032-0.0451791im      -0.104627-0.152861im     0.0199984+0.0941951im     0.0914766-0.00698326im  -0.0397057+0.0769385im   -0.0166496-0.178676im    -0.0693718-0.0202137im     0.109937+0.239619im     -0.139492+0.100398im       0.0277647-0.00532149im      0.181241+0.206885im    -0.0102328+0.0409851im     -0.0640691+0.0558294im      0.11191-0.0431715im  -0.0558165-0.0564202im     0.0867663+0.059649im     0.0448418-0.0936017im   -0.0436858-0.0621595im   -0.0317641+0.291587im       -0.118823-0.0289341im      -0.133069-0.14719im
 -0.00542316+0.0771196im   -0.0168048+0.00170946im   -0.101811+0.0317236im    0.0854931-0.16294im       0.0867957+0.050936im      0.0634328-0.154697im   -0.0550381+0.165585im     -0.00454345-0.200588im      0.0349491+0.10455im       0.199566-0.157971im      0.0266297+0.131135im      0.0288405-0.0591462im       0.213934+0.0455021im   -0.0364277-0.0501556im     0.0118354-0.119074im      0.158133-0.0454682im    0.0066072-0.155525im     0.0198867+0.222672im     -0.015936+0.245028im     -0.104497+0.0445607im      -0.158213+0.0211051im       0.115018+0.0405554im     0.305287+0.1609im          0.125127+0.188153im      0.222791-0.135453im    -0.117633+0.0647881im   -0.00575475+0.291274im    -0.0471392+0.0155719im   -0.0654752+0.0775158im    0.0732399-0.285218im    -0.000851722-0.0402658im     -0.0982721+0.0890382im
    0.011602+0.0834354im    -0.108175+0.040492im     0.0275608+0.238685im      0.283239-0.0684121im     0.0460998-0.14472im        -0.15108+0.169629im    0.0436338-0.0910423im      -0.232981+0.180812im     -0.0637566-0.0869068im    -0.210247+0.193625im      0.0970463+0.09469im       0.0193778-0.150641im        0.102498-0.079737im     0.0283937-0.184823im     -0.0752819+0.164884im      0.117899+0.146741im     -0.129596+0.0442631im   -0.0152885+0.261847im     0.0510935-0.120114im      0.116503-0.218939im       -0.169056-0.105082im       0.0619861+0.201041im    -0.0992655-0.00523709im     0.0593481+0.0872217im   -0.0732815+0.057983im   -0.0452246-0.0432696im    -0.0941194+0.220047im     -0.136441-0.0112503im     0.122081+0.0852393im   -0.0334957-0.015049im        0.136441-0.0471734im      0.0349032+0.0705199im
  -0.0273598+0.0174996im    0.0978426+0.0970901im   -0.0174678-0.0839572im   -0.0618477-0.137456im      0.0346247+0.0593806im    -0.0350439-0.0899477im  -0.0315839+0.164907im      -0.0313003-0.100298im      0.0180116-0.0570711im    0.0644552-0.141203im       0.104319-0.033279im       0.170493-0.00300328im    0.00412213-0.100959im      0.202346+0.125307im        0.21812+0.193551im      0.154369+0.381688im      0.111761+0.196175im     0.0264581+0.0583522im    0.0596627-0.293029im    -0.0105244+0.127249im      -0.0644228-0.050811im        -0.16436-0.0283454im     0.140396+0.105638im      -0.0891542+0.0515913im    -0.133972-0.0756187im  -0.0599669-0.196196im       0.221052+0.118886im     0.0835227+0.0671923im      0.10404+0.196215im     0.0126169+0.156341im      0.00696797+0.00373408im  -0.000987711-0.235315im
  -0.0841824-0.113547im      0.115763-0.0935528im   -0.0331048-0.11713im      -0.134783-0.257586im       -0.12131-0.310314im      0.0552837-0.0148315im  0.00340991-0.0133341im      -0.157295+0.0300918im     0.0164825+0.041864im    -0.0623955-0.0448627im      -0.19713+0.121802im     -0.0330026+0.228133im       0.0484631+0.00493384im   0.0985435-0.0177237im      0.106682+0.0272076im      0.08723+0.109074im      0.169486+0.183119im     -0.162614+0.026759im      0.134494+0.102425im     0.0390135+0.000690684im    0.0762715-0.0160113im       0.222795+0.0396983im     -0.11995+0.0822908im      0.0956803+0.112331im    -0.0731414+0.0559549im    0.188031+0.282436im      0.0634856-0.0113165im    0.0820329-0.0680421im     -0.08333-0.122956im    -0.0714839-0.123309im        0.329718+0.208828im      -0.0415464-0.065852im
  -0.0639946-0.0577608im   -0.0380476-0.00412656im   -0.111543-0.198048im     -0.290506-0.0137084im      0.225724+0.0664994im   -0.00824419+0.0707035im   0.0580413-0.12392im         0.229847+0.0495578im     0.0996583-0.161869im    -0.0518295+0.0325602im     0.0997843+0.0472707im    -0.0978341-0.0608468im       0.180194+0.286406im    -0.0466507-0.0722229im    0.00664807+0.00905248im    0.198691-0.0082321im   -0.0338166-0.0839888im     0.290519+0.0749043im     0.135812-0.106266im      0.120247+0.0425003im       0.194265-0.0111354im      0.0406399+0.00948724im   -0.191417+0.073623im       0.0626809-0.143319im     -0.110959-0.16846im     -0.239577+0.0555106im     -0.130362+0.174337im     -0.115901-0.0183602im    -0.159465+0.0027375im     0.083184+0.0366154im      0.0888117+0.153312im       0.0589662-0.110719im
   -0.198151+0.187108im    -0.0249736-0.0154991im    -0.229901-0.20939im     -0.0295835+0.126311im     -0.0129284+0.0721897im     0.0537442-0.154936im     0.147612+0.115376im       -0.136171+0.0963169im    -0.0506768+0.0561244im        0.133+0.0168709im     0.0724282-0.0193099im     0.0013616-0.00195842im    -0.0192717-0.013288im     0.0696567+0.0313065im    -0.0526814-0.0596142im    -0.222266+0.0178816im      0.10967-0.0498607im     0.138913-0.0873193im     0.183104+0.0321264im   -0.0420818-0.304682im       -0.175604-0.0645im           0.18457+0.0221072im    -0.129084-0.0121037im       0.113941-0.0340933im    0.0517426-0.0678056im   0.0505446-0.0894139im    0.00179368+0.0750361im   -0.0526928+0.193776im      0.397847-0.172699im      0.116115+0.0818599im     -0.0388806+0.253675im       -0.105446-0.0650896im
   0.0803854+0.0537509im    0.0444688-0.0547234im      0.23337+0.182486im     -0.141568-0.13203im        0.178601-0.0701034im    -0.0185584-0.129678im   -0.0194833+0.112454im         0.02013-0.193283im      0.0305396-0.1557im       0.0666002+0.132064im       -0.33669+0.0484576im     -0.164392+0.0762816im    -0.00746087-0.0163371im     0.181402-0.147571im       -0.27031+0.0952343im   -0.0167756-0.142292im     0.0906263-0.178354im    -0.0381772+0.144624im    -0.0392735-0.0402763im   -0.0462391-0.16336im         0.095554-0.214962im       0.0166077+0.0586643im       0.1131-0.0135657im       0.123845-0.203467im    -0.0305054+0.0313149im   0.0602215-0.219017im      0.0852748+0.0756619im       0.1766+0.106181im    -0.0635847-0.103768im     0.0556907+0.177778im      -0.0296574+0.0105928im     -0.0191626-0.139309im
  -0.0700754-0.122071im     -0.155855+0.0480595im     0.203508-0.182992im     0.0999077+0.118964im       0.241104+0.0180046im      0.190076+0.0904384im   -0.145113-0.220363im       -0.185489+0.113998im      0.0118005-0.25352im        0.15783-0.0858178im     0.0635621-0.095505im       0.234402+0.0516121im     -0.0287928-0.182558im      0.148292-0.0315822im     -0.216717-0.106762im     0.0429822+0.067742im      0.296888+0.0148939im    0.0477627-0.210027im     0.0801061-0.0949165im   -0.0405941+0.0698566im     -0.0163124-0.0878472im        0.11528+0.131457im      0.123379-0.0772771im      0.0957217+0.0309141im    0.0737246-0.032436im   -0.0488963+0.0143981im     0.0532628+0.070796im    -0.0556576-0.143059im     -0.158084-0.161696im    0.00758958-0.0543484im     -0.0214014-0.0862114im      0.0717739+0.105372im
  -0.0861961+0.06539im       0.143882+0.00814181im   0.0226161+0.0364182im   -0.0752147-0.0418585im     0.0623659-0.086868im     -0.0589238+0.0904699im  -0.0548035-0.119279im       0.0576512-0.237912im     -0.0764607+0.255086im      0.120994+0.086844im       0.239921-0.0195762im      0.319023-0.0276908im       0.245891-0.0478468im     0.208733-0.142591im     -0.0148012+0.10257im       0.114231-0.0495488im    -0.086417+0.0714506im    0.0254958+0.00955706im  -0.0681986-0.0090982im   -0.0759344+0.0954776im    -0.00890445+0.121705im        0.105376+0.221007im     -0.104598-0.0755242im      0.0416152-0.10166im      0.0228015-0.0682655im    0.228544-0.0839833im     -0.113125-0.243539im    -0.0407941+0.253825im     -0.163267-0.0421515im    -0.047155+0.103181im       -0.117583+0.162029im      -0.0816596+0.156054im
   0.0696464-0.156876im     -0.129362+0.0521907im     0.154565+0.0816803im    0.0409067+0.169587im      0.0388108+0.163655im      0.0363197-0.123122im    0.0977324+0.012973im      -0.0824926-0.149634im      -0.107106+0.171864im     -0.182832-0.0556596im      0.150431+0.000854346im    -0.15738+0.00305686im    -0.0747204+0.0360868im    -0.184659+0.00488844im  -0.00716548-0.014013im     0.0829037+0.100179im       0.10075+0.160552im     -0.033754+0.0178943im    -0.267423-0.0478964im    0.0538042-0.0790566im      -0.144004-0.179533im        0.291224-0.0508783im     0.105862+0.152389im       0.0701451-0.0886588im    -0.115453-0.28588im     0.0380881-0.0683789im    -0.0914683-0.162523im     -0.111575-0.0336155im    -0.122358-0.126318im     -0.213977-0.0680556im     -0.0110654+0.12285im       -0.0170255-0.262647im
   0.0867354+0.0693201im    0.0338386+0.0871796im   -0.0235823+0.0886678im   -0.0953278-0.0460914im     -0.104345+0.0969453im     -0.048333-0.0899088im   0.0276441+0.201255im      -0.0717937+0.0669515im     0.0606305-0.143396im      0.261933+0.104048im     -0.0598142+0.0627109im    -0.0385843-0.00593481im    -0.0711677-0.0530511im   -0.0574091-0.145703im       0.018673-0.0587274im    -0.107468+0.25126im     -0.0584276+0.0822854im   -0.0062911-0.351122im    -0.0555982+0.174159im      0.205335-0.0318191im     -0.0567944+0.217805im      -0.0943655+0.285201im     0.0295918+0.0456689im       0.238869-0.196678im    -0.0911342+0.0584897im   -0.104561+0.00659314im   -0.0707156-0.03345im      -0.235521+0.0623305im    -0.223788+0.126196im    -0.0633314+0.0184644im       0.136032-0.0728309im      -0.138387-0.0536555im
  -0.0468265-0.220437im     -0.156566+0.201371im     -0.373074-0.0457796im    -0.043471-0.0481762im      0.053142-0.0287901im     -0.010234+0.0962746im    0.293057-0.0326152im      0.0675035-0.207609im     -0.0903185+0.0521334im     0.153017-0.0304561im    0.00150145-0.0569699im     -0.127318+0.0245423im     -0.0350188-0.129728im    -0.0376848+0.0701885im     0.0394381+0.0760753im   -0.0907711-0.00717367im    0.120462+0.116436im     -0.120027+0.181329im     -0.105951+0.00811598im   -0.028992+0.135086im       -0.108207-0.109527im      0.00790117-0.0104963im   -0.0694556-0.0702223im       0.360766-0.128992im      -0.14166+0.207875im   -0.0242417-0.0590919im    -0.0394116+0.040989im     0.0441378-0.0986393im   -0.0281788-0.00360162im    0.109121+0.0778333im     -0.0343838-0.126138im        0.195154+0.23095im
   0.0278532-0.108282im     0.0336453+0.108862im    -0.0411536-0.0503734im     0.185086-0.0281905im     0.0315797-0.16206im     -0.00735747+0.0396559im    0.278529-0.0626825im     -0.0414103+0.207369im      0.0223294+0.10529im      0.0605175-0.139966im     -0.0360963-0.073974im     -0.0358251-0.0505958im      -0.164179+0.18188im       0.221677+0.0721665im     0.0846211+0.0638388im    -0.169121-0.191003im      -0.13418-0.0070008im     0.203286-0.0520843im   -0.0437653-0.173518im     0.0986345+0.089025im        0.193179-0.0844271im       0.110717+0.142209im      0.124592+0.280809im       0.0665624-0.0261652im     0.194929+0.051545im     0.114673-0.121897im      -0.029989+0.105812im     0.0865029-0.0349276im   -0.0956661+0.128641im     -0.199181+0.00563641im    -0.0373519-0.0240108im      -0.314507+0.00433655im
    0.129792-0.0300334im    -0.348009-0.125548im     0.0141488+0.0449537im   -0.0302741-0.0971846im      0.243146-0.0715544im     0.0310525+0.0931211im   0.0899992+0.143118im       0.0358618-0.0676391im    -0.0959564+0.0667097im   -0.0446162-0.00256698im    0.0687974+0.0128563im    -0.0978035-0.000597297im   -0.0515646+0.197629im      0.208142-0.222963im       0.116234-0.126705im    -0.0416034-0.0721311im     0.164529+0.0817748im   -0.0241673-0.175502im     0.0201686+0.104892im    -0.0820129+0.0179337im      -0.105567+0.194794im       -0.053933-0.0631126im    -0.121129-0.0272066im      -0.268121-0.0635884im   -0.0252775+0.0330011im    0.301466-0.215589im       0.160977+0.182388im     -0.217359-0.0987865im    0.0122649+0.128163im     0.0202178-0.0906335im      0.0446569+0.0336024im      0.0926132+0.00355549im
   -0.224618+0.129177im      0.110679-0.044474im    -0.0299142+0.0256817im    -0.052458-0.12375im       0.0489583-0.108315im       0.178258-0.208908im     0.125796+0.0207696im       0.049662-0.0915827im      0.161665-0.031873im    -0.0935201-0.0103283im      0.166078-0.0596007im    -0.0642206+0.233561im       -0.246165+0.00955722im   0.0930114-0.0823335im    -0.0468473-0.0844487im     0.171175-0.0269675im    -0.280995+0.116896im    0.00811044-0.187346im       0.04872-0.0255094im    -0.259732-0.0329774im     -0.0393507-0.137889im        0.117202+0.0635208im    -0.121633-0.144247im      -0.0131228+0.137049im    -0.0773276+0.0577979im   -0.116746-0.154869im      -0.248745-0.0104777im    0.0345348-0.0313375im  -0.00877227+0.0681525im   -0.0460061-0.16087im       -0.0245123-0.304442im       0.0657112-0.086052im
   -0.117082-0.220333im     0.0590254-0.00986052im    0.038933+0.0498092im    -0.139172+0.0662101im    -0.0949425-0.0942949im     0.0172221+0.202603im   -0.0458489-0.0901526im     -0.0626701-0.0441732im     0.0526884+0.0147307im  -0.00947318+0.0257445im    -0.0831569+0.0594689im     0.0401374-0.076984im       -0.226603+0.192315im     -0.211861+0.0574058im     -0.100442-0.11777im      0.0185624+0.024545im     0.0082744-0.140494im     -0.067728-0.108926im     -0.122483-0.162012im     -0.192378+0.137351im       -0.242264+0.0254273im      -0.205554+0.209091im    -0.0265339-0.0552439im       0.117849-0.013349im    -0.0299393-0.317895im     0.220383+0.0390761im    -0.0768996+0.258894im      0.180789+0.194175im      0.132658+0.115544im     0.0592071-0.0239366im        0.13945+0.0135353im     -0.0355272-0.00939746im
   0.0692306+0.0624567im     0.230195+0.00254115im   -0.241668+0.0856685im    0.0109401-0.0832157im      0.227387-0.00922868im     0.142553+0.139502im    -0.273547+0.152286im       -0.197462+0.0380786im     -0.112842+0.0316159im    0.0428744-0.055887im      -0.103591+0.121405im      -0.103891+0.167615im       -0.024345+0.055162im     -0.305945+0.00822377im    0.0557994+0.0166162im    0.0314094-0.114935im     0.0931593+0.198408im      0.032926+0.0496673im     0.123311-0.153721im      0.076502+0.137138im       0.0441212-0.0787433im     -0.0763149-0.00740856im  -0.0250633-0.124302im       -0.114861-0.0739056im    0.0177327-0.0954826im  -0.0246361-0.227127im      -0.098828-0.00655157im   -0.177319-0.0116879im    0.0477888-0.232385im     -0.107107+0.0336232im     -0.0211618-0.0996409im      -0.247878+0.173129im
 0.000326045-0.139262im     0.0680814+0.0336426im    -0.146943+0.11124im      0.0312134+0.0276501im    -0.0101962+0.201197im       0.139311+0.0464606im    0.123558+0.143857im        -0.14147-0.0884462im      -0.19248-0.282953im     -0.247894+0.196396im     -0.0707388-0.0945794im      0.282527+0.117693im      -0.0241705+0.124937im     0.0227976-0.0656561im      0.188549+0.297108im     -0.134184-0.050451im      0.035867-0.0618397im     0.102633-0.0531778im    -0.107824+0.099042im     -0.142778+0.0234196im        0.24591+0.163478im        0.178165-0.0280453im     0.186351-0.0723303im      0.0181961+0.0756054im    0.0600537-0.0808265im  -0.0228048+0.00437148im   -0.0846604+0.0427468im   -0.0109911+0.155331im     0.0369721-0.0352602im    0.0465619-0.0418394im       0.144863-0.0425001im       0.152362+0.0014358im
   0.0940912-0.229398im      0.337486-0.0495932im    0.0477581-0.0461553im      0.02603+0.109379im      0.0866983+0.0971243im    -0.0903857+0.145352im   -0.0552365+0.119058im        0.125855+0.05947im        0.113211+0.167386im    -0.0578682-0.0676993im      0.065388-0.0529211im      0.162626+0.0695194im      0.0986226+0.0691102im   -0.0999486-0.132392im       0.108716-0.0341098im   -0.0759378-0.140691im     -0.169775-0.0868316im    -0.184307-0.121678im      0.208541-0.103344im      0.100679-0.0650683im      -0.208782-0.0153521im      0.0827563+0.0352991im     0.189057-0.0358803im       0.167544+0.0378075im   -0.0798139+0.318363im    0.0401964-0.12849im       0.0436223+0.170651im    -0.0429642-0.0838955im   -0.0369151-0.146084im     0.0387029-0.0322056im      -0.024813+0.0951473im       0.186254-0.217015im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.06612570763445598 - 0.06246500572924563im
 -0.0008175048165938553 - 0.18987744022549854im
    0.10727387791091543 - 0.21326292497916863im
  -0.011026869433785327 - 0.09397708378301586im
    0.14187604295387687 + 0.04294212117618174im
   0.012329730575774666 - 0.09599644278055008im
    0.11979425334372554 + 0.15627805924475172im
   -0.05687915357744528 - 0.06107562102587647im
    0.05666887997399415 - 0.015679295087452038im
     0.1500304553897507 - 0.06286775954355066im
    0.24591961568318862 - 0.06967632088894468im
    0.07889015343674309 + 0.07741596259954758im
  0.0006746927687877134 - 0.07166714430391388im
   -0.21266821094419244 - 0.11141651837768153im
   0.010809549954416138 + 0.021482083798235498im
    0.14304349359008578 - 0.028451877071055332im
    0.13674694920313427 - 0.10332321261108374im
    0.02533205822190144 + 0.08701503282743042im
    0.16731276985990587 - 0.15673297361715804im
    0.14126714228489862 - 0.27766123992157116im
    0.07770473865146858 + 0.13378788768364894im
  -0.009808514640824195 + 0.08152174314126037im
  0.0029616016064180897 + 0.1107314067947564im
   -0.14084281827037173 - 0.08836818056003im
    -0.1907176082812693 + 0.039235365703057856im
    0.11435934616753342 - 0.1851212411201697im
   -0.08406057522791725 + 0.049934830657901684im
   -0.12480686651085246 - 0.024912195655137498im
    0.05342054639067271 - 0.02646193932478263im
   -0.11108093079999895 + 0.039236431385208624im
   -0.28772075671534003 - 0.06883560763170957im
    0.38313139064315127 + 0.0im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 29 January 2023 07:54">Sunday 29 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

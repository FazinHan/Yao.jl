<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0526475-0.19411im       0.0765588+0.0897586im    -0.0538845+0.0707745im       -0.130828+0.198356im     -0.145461-0.0963187im    -0.0356614-0.111534im    0.0452163+0.0600341im   -0.0235168+0.361507im    -0.0547979+0.0517995im     0.0486376+0.16809im      -0.0911523+0.277475im     -0.0417805+0.130727im    -0.0944152+0.257844im      0.145689+0.125109im     0.0136844-0.0829094im     -0.105041-0.108121im     0.0321915-0.059504im        0.14965+0.051405im      -0.122747-0.00122205im     0.104096+0.0157213im       0.14845+0.0732804im      -0.205374+0.0173981im   -0.0236463-0.281621im      -0.141022+0.177765im      0.0134783-0.0131405im    0.0543673+0.074243im    0.0294265-0.163861im     -0.0657335-0.123495im    -0.0686352+0.171467im    -0.0147563-0.0499479im     0.0839547+0.165418im      -0.166619+0.0748293im
  -0.184624+0.0270684im    -0.0320672+0.158236im       0.169594-0.195852im        0.0904481+0.118057im    0.00157633+0.0861984im     -0.112861-0.115236im     0.106947-0.0578746im   0.00777636-0.0146401im    0.0137252-0.185136im      -0.219679-0.255793im     -0.0444612+0.237242im       0.223391+0.158546im    -0.0428501+0.113713im     -0.108208+0.0287886im    -0.268246+0.0239773im     0.0929541-0.0976094im    0.0102834+0.0881663im     -0.148915-0.00923757im    -0.113559+0.144622im      0.0174058+0.0610837im    -0.0174564-0.00271517im     0.0414149-0.206997im       0.11336-0.104008im     -0.0544196-0.00330976im     0.209394+0.0120728im    -0.253138-0.0518063im  -0.0598493+0.228537im      -0.240671+0.048837im     0.0818119+0.0655367im    -0.024447-0.0360871im    -0.0795995+0.00167252im   -0.0133031-0.127003im
 -0.0767919-0.142565im    -0.00302587-0.0865126im   0.000879457-0.200289im         0.306773+0.232645im     0.0255286-0.149042im      0.0852314-0.0792156im   0.0371362-0.208052im    -0.0242438+0.0541391im    -0.175347-0.0713004im   -0.00555911-0.123582im      0.0687807-0.0768629im     0.0180593-0.0884896im   -0.0220049+0.178409im    -0.0608729-0.0160612im     0.146613+0.0484493im      0.368533-0.00900747im  -0.0759965+0.0957878im   -0.00336401+0.11991im        0.128581+0.0118859im     -0.171683-0.0982707im      0.255066-0.137007im      -0.0452965-0.0292896im    0.0419383-0.0398147im    -0.0211744-0.128142im     -0.0753556-0.193164im       0.21369-0.12519im    -0.0292684-0.0051488im     0.0981832-0.279684im     -0.117987-0.0756503im   -0.0652672+0.114459im      0.0706997-0.0138604im   -0.00514978+0.0024488im
  -0.171579-0.256476im     -0.0163246-0.151741im      0.0435451+0.0614895im       0.0855025-0.147248im    -0.0454194+0.157163im      0.0050651-0.0103385im    0.141046+0.169562im      0.108622+0.177903im      -0.05217+0.0119984im     -0.167173+0.0208495im    -0.0301295+0.0498823im     -0.134676+0.0816887im    0.0926404-0.150797im     0.0872579+0.047278im      0.170038+0.0658004im      0.100123+0.140468im    -0.0272464-0.0318423im      0.259999+0.0587796im    -0.0464518-0.11173im       0.0771131-0.077651im     -0.0649628-0.162642im      -0.0762192-0.189551im      0.127729+0.0253523im      0.152563-0.111766im        0.14605-0.0481459im   -0.0148374+0.0801924im   0.0890654+0.0219075im     -0.149179+0.128553im     -0.147465-0.24399im      -0.279871-0.252994im      0.0293571-0.186318im    -0.00921356-0.0536433im
 -0.0534227-0.127955im      -0.182704+0.0650432im     -0.126796+0.00171304im    -0.00764972-0.133652im    -0.0254803+0.0676953im     0.0642207+0.13874im     0.0693345-0.254129im      -0.15474+0.105872im    -0.0348627+0.253212im       0.273901-0.0200086im      0.106088-0.157263im     -0.0950539-0.0576362im    0.0824945+0.266575im     0.0741811-0.114997im     -0.111937+0.136039im       0.236663+0.0234889im   0.00658954-0.0280819im    -0.0548711+0.0527335im     -0.225748+0.0681055im    -0.0445085-0.0812406im     -0.171048+0.153366im        0.122199+0.00882165im  -0.0898585-0.0258623im      0.130299+0.0141465im      0.104898+0.0234939im    -0.228522+0.0558274im    0.053476+0.184196im      0.0689625-0.00505146im   -0.141768+0.111614im     0.0462537-0.18327im      -0.0121591-0.0524226im     -0.227849+0.0815488im
   0.179947+0.056222im     -0.0105559-0.0283805im     0.0481545+0.171257im        0.0961228-0.0413961im    0.0964811-0.180001im     -0.0115014-0.21532im     -0.197481+0.087893im     0.0578803+0.0164258im     0.108564-0.0085921im     -0.230583+0.00638912im    -0.137012+0.117251im      0.0420383-0.0572308im     0.114898-0.091923im       0.15342-0.0978926im     -0.21217+0.0248089im       0.18902+0.0064157im    0.0546543+0.016248im      0.0554135-0.137836im     -0.0555758-0.144419im      -0.113924-0.0288669im    -0.0613611+0.185256im       -0.143257+0.139188im    -0.0668512+0.13117im       0.0713927+0.180908im       0.167144-0.142673im    -0.0730997+0.0925514im   -0.212441+0.135042im      0.0989159-0.194265im    -0.0589831-0.154093im    -0.0769342+0.142592im       0.129123-0.0824075im     -0.304135+0.0223336im
   0.305288+0.0268881im     0.0700477-0.00415296im    0.0557961+0.000500107im    -0.0268051+0.0128219im    0.0374039+0.0470446im    -0.0777533-0.0689176im  -0.0172219-0.363188im    -0.0291822+0.0256553im    0.0342649-0.0199592im    -0.0775295+0.106852im      0.0132873+0.327156im     -0.0878476+0.0898904im    0.0121906+0.100694im       0.28358-0.130959im      0.186274-0.146664im     -0.0554605-0.0548359im     0.131143+0.0539249im    -0.0797278+0.192496im     0.00680972+0.0777313im     0.0734079+0.181276im     -0.0484212+0.0658873im       0.100136-0.0026077im    -0.246851+0.162717im     0.00308674-0.165971im       0.124993+0.0748846im    0.0739738-0.247511im    0.0991479+0.046496im      0.0128899-0.0231571im   -0.0683834-0.105975im     -0.156566-0.0366333im     -0.121812-0.154649im       0.127133-0.00113013im
 -0.0374944-0.142143im     -0.0990592-0.136468im     -0.0412939+0.14156im       -0.00314572+0.133957im      0.105363+0.0366184im     -0.049241-0.0746246im  -0.0568186+0.141922im     -0.111513-0.272791im     -0.113267+0.0286356im    -0.0250801+0.134847im      0.0155833-0.118832im        0.18685+0.0897514im    0.0330377-0.0164663im   -0.0625327+0.23604im       0.069608+0.0660919im   -0.00663153-0.143098im      0.116338+0.356892im     -0.0354222+0.0369908im    -0.0375634+0.0790789im       0.14564+0.0944173im     0.0370379-0.0161137im        0.22543+0.0899878im   0.00165085+0.102614im      -0.022624+0.116609im      0.0367018-0.042586im     -0.038143-0.167488im   -0.0752153-0.020054im       0.138289+0.0582036im   -0.0271246+0.176472im     -0.375142-0.18293im        0.125208+0.072685im       -0.10372+0.183147im
   0.151258-0.0256152im     -0.140532+0.164216im    -0.00363781+0.0709625im        0.131113+0.172292im       0.16273+0.0498972im     0.0890647+0.0423115im   0.0465741+0.0109984im    -0.091863-0.0015832im     0.108154-0.249505im     -0.0331635+0.0527062im   -0.00335818-0.153005im      0.0633937+0.0913507im     0.165884-0.0682785im    -0.161458-0.0288103im   -0.0250197-0.0135263im     -0.121426+0.0218584im     0.122553-0.158946im      0.0948975+0.268265im     -0.0218185-0.0367866im     -0.102256-0.194264im      -0.113461+0.136159im      -0.0906176+0.0390282im   -0.0506031-0.241097im      0.0212477-0.106794im     -0.0949793+0.158878im      0.111745-0.219123im    -0.118632+0.0519817im     -0.252222+0.178983im     -0.168547-0.102993im     -0.017291+0.0675689im    0.00758606+0.0442618im     -0.140807+0.285991im
   0.198638+0.168492im      0.0854425-0.2086im         0.259291-0.107811im         0.114381-0.0172217im     0.139258+0.00165516im    -0.106758-0.254665im   0.00817281+0.234189im      -0.16054+0.131028im      0.186613+0.0431316im      0.126137-0.107572im        0.14357-0.08233im      -0.0427683-0.0531192im   -0.0730881+0.151936im     -0.139946-0.0463288im     0.142053+0.0533242im      0.126201-0.0446753im     0.176978-0.0143244im     0.0978342-0.00913931im    0.0309173+0.0110993im     0.0570029+0.0539425im     -0.130263-0.0410498im      -0.244562-0.00786812im   -0.147573-0.045935im      0.0893955+0.0697737im    -0.0582497-0.048162im    -0.0235942+0.0772928im   -0.151698+0.0513045im      0.014477+0.0719531im    -0.142044+0.231706im    -0.0132999-0.212568im      -0.181985+0.0775507im      0.202244-0.0454371im
 -0.0333657-0.185641im       0.134289-0.145979im        0.13688+0.237465im         0.040851-0.178139im    0.00538051-0.00834194im    -0.127051-0.0978406im   0.0868094-0.23986im    -0.00197375-0.00433063im  -0.0396362-0.10559im       -0.172238-0.124289im      0.0467417-0.326274im     0.00999985-0.154175im     -0.165057-0.00216181im   -0.112406-0.0342827im     -0.08287-0.0141739im     -0.156758+0.0760681im     0.172686-0.124572im       -0.10285-0.0290745im     -0.157026+0.111344im     -0.0835929+0.00680995im   -0.0129084+0.0420186im     -0.0259909-0.0884371im   -0.0547876-0.0490005im     -0.138039+0.284271im      0.0888637-0.0202565im     0.217083-0.0630666im    0.146166-0.214174im     -0.0752793-0.0743511im    0.0687055+0.089892im    -0.0502047-0.018302im      -0.109949-0.243681im       -0.11701-0.0401963im
  -0.150847+0.0741251im      0.163197+0.0361615im     -0.116428-0.0270619im       0.0371966-0.177008im      0.184139-0.03169im       0.0296857-0.102851im    0.0991179+0.15996im      0.0995643+0.131561im    -0.0859956+0.00817001im     0.145438+0.140313im     -0.0815097+0.101407im      0.0534639-0.121449im      0.099308+0.0291187im    -0.192853-0.255556im    -0.0659361+0.22143im      -0.0959789-0.0225458im    0.0591502-0.104794im      -0.154141+0.0813664im    -0.0435274+0.0721492im    -0.0323103+0.250232im     -0.0345712-0.0135714im      0.0230659-0.106019im     0.0854252+0.0385507im      0.195612-0.12833im        0.131283+0.252758im      0.140398-0.184213im   -0.0798491-0.155039im      0.0982725-0.0849293im    -0.118541+0.0695601im    -0.136806+0.101116im       0.182112+0.142193im      -0.101055-0.207096im
  0.0622782-0.071123im     -0.0311901+0.0149227im      0.163094-0.214366im        -0.203105-0.0814388im     0.198102+0.15421im        0.108209-0.163257im   -0.0677178+0.0360919im    -0.139393+0.11642im      -0.187917-0.0248952im     0.0246045-0.0963687im     0.0472162+0.0215638im      -0.10244+0.115732im     0.0589843-0.282232im      0.090233-0.101903im    -0.0831916+0.055126im       0.227125+0.0088102im     0.120406-0.0421309im    -0.0670552-0.174613im       0.127315+0.0245566im      0.212947-0.0397715im    -0.0485458-0.218473im      -0.0411038+0.0557813im    -0.117517-0.133696im     -0.0256486+0.0490332im     -0.023805+0.0261801im    0.0326643-0.220851im     0.304324-0.023484im     0.00634279-0.00925515im     0.19081+0.0474892im     0.114178+0.048196im       0.206155+0.0367263im     -0.159806+0.145096im
 -0.0787283+0.253788im       -0.10571-0.0247621im     0.0489481+0.0659845im        0.164882-0.0630374im   -0.0028725-0.093695im      0.0958766+0.352531im   -0.0415097+0.0906472im   0.00231413+0.0726586im     0.101824-0.130327im       0.085377-0.0974899im     -0.213826+0.0615497im    -0.0146292-0.0289729im    -0.159065+0.0216204im    -0.114034-0.0841596im    -0.196128+0.0303708im     0.0562247-0.132169im    -0.0495918-0.0450186im     0.0347373+0.211021im      -0.106167+0.00348842im     0.355764-0.0561317im   -0.00471621-0.0954495im      0.0360599+0.259832im     -0.107577-0.00330512im    -0.133741+0.148873im       0.112758-0.188722im      0.101588-0.0925917im    0.225912-0.0008937im     0.0372678-0.0141572im     -0.15864-0.0723018im   -0.0937213-0.0552266im      0.104173-0.0679977im      0.139375-0.0620201im
 -0.0026646+0.201555im       0.145447-0.395745im      -0.183269+0.00648833im      -0.106648+0.212977im     -0.217009-0.0524197im      0.112109+0.0587967im   0.0202024+0.127695im    -0.0578782+0.0535338im    -0.159651-0.05968im       0.0326912-0.0567772im     -0.113605-0.0360282im      0.254551-0.110376im     0.0104389+0.00135997im  -0.0319025-0.0831236im    0.0101952-0.231353im       0.184887-0.0753892im    0.0774845+0.0121525im      0.168759-0.128677im      -0.125811+0.0731481im     0.0238978+0.0439934im     0.0153353+0.268543im    -0.000624061-0.184881im    -0.0742586+0.0651761im      0.213745-0.0433803im    -0.0906816+0.067394im    0.00407345-0.135609im     0.226299+0.0491895im     -0.129814+0.10571im       0.055154-0.040181im     0.0510383+0.0424831im    -0.0353807-0.0643571im     -0.100905+0.0132384im
 -0.0760029+0.27721im       -0.101426-0.0160288im     -0.162902+0.107405im        0.0322301+0.0525941im   -0.0532636+0.0635126im     -0.208215-0.237376im    -0.042917-0.0152019im    -0.207612+0.120959im    -0.0285147-0.464747im       0.106953-0.00119181im     0.121392-0.0601126im     -0.162318+0.0535102im     0.140274+0.144332im    0.00777685-0.0121388im     0.116487+0.0415062im     0.0108358+0.0683643im    -0.240431-0.0872421im    -0.0952333-0.157715im      0.0175259-0.22528im        0.038607+0.107956im      0.0286874-0.0305906im       0.183269+0.0122041im    0.0663121-0.0713814im     0.0035425+0.117852im      0.0490894+0.0310214im    -0.176738+0.0527193im    0.121348-0.142226im      0.0651285+0.0212833im   -0.0525148-0.0858746im    -0.139403+0.111063im     -0.0843544-0.0674892im    -0.0133643+0.0934605im
    0.11178-0.0846274im     0.0544579-0.00539351im    -0.213129+0.0646694im      -0.0574285+0.0332462im   -0.0175678+0.000186201im   -0.077933-0.205485im    -0.202642+0.20292im       0.158561-0.192787im      0.111761+0.0260391im     0.0068895+0.0224532im   -0.00245582-0.12124im      -0.0783407+0.0225785im   -0.0394737+0.173381im      0.177902+0.249149im     -0.156687-0.00764923im     0.132825-0.0984322im   -0.0723314-0.287567im     -0.0746889+0.0346463im     -0.112743+0.165835im      0.0734596-0.177074im     -0.0451897-0.220182im        0.113442-0.229098im    -0.0773346-0.0914423im     0.0782138-0.0895684im      0.185336-0.0337499im     0.214893-0.0539846im   0.0600272+0.142031im      0.0829979+0.119871im     -0.101896+0.0470874im    0.0552784+0.207984im     -0.0185106-0.00229806im     0.111484-0.0222254im
  0.0646945+0.0719953im    -0.0653689+0.0816825im     -0.184835+0.0292392im       -0.198723+0.085126im       0.34278-0.0556191im     -0.125811-0.0339645im    0.216668-0.204973im    5.08322e-5-0.00517736im   0.0510855+0.0981738im     -0.168379+0.0281857im     -0.134764-0.0493022im     0.0707399-0.137439im     0.0960742+0.0610709im   -0.0082635-0.211194im     -0.105789+0.0373635im     -0.085396+0.00917025im  -0.0504452+0.0125692im      0.335317-0.146744im     -0.0174945-0.223277im       0.148582+0.0210476im      0.206694-0.184235im         0.14168-0.13957im       0.102128-0.0025121im      0.104099+0.101478im     0.00289912-0.176987im      0.121052-0.115284im   -0.0379257+0.108815im     -0.0211531+0.00656402im  -0.0415208+0.0974305im      0.14506-0.15471im      -0.0847277+0.0426021im     0.0940547+0.0606188im
 -0.0356063-0.106389im      0.0766002-0.0622582im      0.177222+0.115349im       -0.0919224+0.0299758im    0.0552155+0.0270053im      0.111395-0.0574681im   -0.133349-0.0642186im    0.0823065+0.249413im    -0.0188435-0.0670265im     0.0725627-0.174541im     -0.0346972-0.150691im      0.0930173-0.126335im     -0.220046+0.213001im      0.118136+0.0546729im   -0.0563197+0.0291408im     -0.294081-0.0472682im   -0.0104429+0.14618im       -0.108258-0.0583056im     0.0681146-0.24163im     -0.00626579+0.135374im      -0.150651-0.0824327im      0.0693203+0.078913im    -0.0174591+0.0662656im       0.10056-0.327653im     -0.0426987-0.308121im    -0.0415709-0.0180644im   0.0188129+0.0774209im     -0.112936+0.228025im    -0.0802511-0.0414117im    0.0292246+0.114184im       0.133901+0.108397im      -0.134649+0.0144904im
 -0.0508634+0.0907066im    -0.0195647-0.204503im       -0.21969+0.0542774im       0.0756688-0.129448im      0.158924+0.244979im       0.134608+0.0868952im  -0.0161613+0.0794266im    0.0372038+0.28167im       0.124657-0.132957im      -0.239943+0.174717im       0.105058+0.0119504im     -0.148723+0.0678479im    -0.287547-0.0474962im   -0.0367613-0.0721508im    0.0759378-0.120109im     -0.0837647+0.104314im     -0.103327+0.0411487im     -0.124128+0.0373294im     -0.115833+0.138994im     -0.0953577-0.101167im      0.0815727+0.00632226im     0.0194416-0.189044im    -0.0832112+0.054961im     -0.0658256+0.0235371im     -0.100664-0.110382im     -0.130814-0.122383im    -0.124964+0.247987im      0.0966704-0.159793im      0.113678+0.137982im      0.042067-0.0023039im      0.118343+0.108529im      0.0200948+0.145085im
 -0.0182323-0.00152946im  -0.00478907+0.123832im       0.118459+0.158462im       -0.0992501-0.269242im      -0.12594-0.191043im     0.00258849+0.20424im     -0.031742-0.0115917im    0.0517152+0.102579im     0.0765813-0.199471im     -0.0914394-0.0652482im       0.19335+0.0419646im      0.208777-0.0789666im   -0.0752179+0.154005im       0.13859-0.030095im     0.0647446+0.0125808im       0.25058-0.186553im    -0.0258217-0.0289863im    -0.0307305-0.0485907im      0.159603-0.0800166im      0.150948-0.044928im      0.0379822-0.0517947im     -0.0832702-0.209904im      0.134934+0.11191im      -0.0742092+0.000474872im  -0.0662996+0.271045im      0.110584-0.106137im    -0.226087-0.0415719im       0.18257+0.183318im     0.0401518+0.0209157im    0.0463119-0.135422im      0.0401843-0.0365607im    -0.0808798+0.222984im
   0.270148+0.0950369im     -0.148082+0.0325206im    -0.0884137-0.115909im     -0.000101091+0.00990179im   -0.134144-0.187972im     -0.0115412-0.0691429im   -0.046339+0.0910439im    0.0204273+0.148925im     -0.044101+0.157052im      0.0909387-0.0669619im     0.0190338-0.145244im     -0.0282884-0.0558758im   -0.0984222-0.0968402im       0.2486-0.258836im     0.0434683+0.148341im     -0.0260423+0.0653219im    -0.191314+0.0815327im     0.0145961+0.0320076im    -0.0823111+0.239872im      -0.150876+0.0944685im      0.010469-0.00255536im    0.00442105+0.00560017im     0.26813-0.094577im      -0.223961+0.140368im      0.0273732-0.0840175im    0.0514795-0.160767im   -0.0842498+0.0377587im     -0.191827+0.273531im      0.151157-0.0322024im    -0.253882+0.00857855im    0.0472775+0.00953199im    0.0419337-0.025154im
 -0.0721591-0.141024im      -0.118565+0.002074im     -0.0490436+0.0685163im      -0.0811082+0.0560766im     0.148063+0.00415984im    0.0206925-0.021106im   -0.0225839+0.0217984im   -0.0361796+0.083122im    -0.0420453-0.0702741im    -0.0248567-0.09446im       0.0732058+0.29568im       0.0357826-0.395648im      0.132442-0.0219569im    -0.106178+0.0690523im     0.132052-0.320744im      0.0710617+0.0308461im   -0.0858463-0.024459im     -0.0289359+0.0222709im     0.0393359+0.257304im       -0.10965+0.0863896im     -0.425481-0.0447292im       0.122098+0.110439im      0.179695+0.0124689im   -0.00117308+0.183325im      0.0873725-0.101158im      0.145176+0.082992im   0.00465358-0.0140457im    -0.0177088+0.0179514im   -0.0589968-0.043031im      0.124693-0.0466499im     0.0450865+0.103453im       0.118497+0.124573im
 -0.0604853+0.107694im      0.0846895+0.275185im    -0.00789453-0.0640712im      -0.0228099+0.0452618im   -0.0464288-0.0509234im    -0.0180999-0.0558461im    0.079971+0.0582093im    -0.162883-0.0308104im    0.0360007-0.00611513im   -0.0132093+0.0529595im    -0.0110604-0.0352977im     -0.224083+0.0183528im    0.0551977+0.0346956im   -0.0880452-0.0289751im    0.0626147-0.336328im      0.0352723+0.0213678im    0.0961939+0.0955052im     -0.152553+0.146556im      -0.117545-0.035534im      -0.134865-0.120071im       0.206093-0.140582im       -0.186422+0.0401352im    0.0650591+0.35205im        0.149888+0.0694842im      0.126529-0.154619im     0.0087386-0.0338617im   0.0402842-0.0792682im   -0.00733704+0.357426im    0.00555036+0.171479im     0.0922896-0.00816932im     0.190887-0.146232im      -0.141804-0.0644687im
  0.0823155+0.0263533im     -0.177202-0.0377825im      0.156029-0.221011im        -0.186904+0.00451906im   0.0144392-0.0542911im    -0.0596581+0.194447im   -0.0426051+0.143181im    -0.0122972+0.197406im      0.169105+0.0710421im      0.111522+0.090303im      0.0764441+0.0170724im      0.136702+0.00100095im    0.213992-0.0105859im    -0.154925+0.191012im     -0.078129-0.0872333im      -0.13649-0.0215409im    -0.021515+0.00986614im   -0.0491461-0.11735im       0.0287874-0.00615533im    -0.295923+0.141119im        0.12655-0.102404im        0.113672-0.265195im     -0.241563-0.109265im      -0.158546+0.0470769im     0.0237651-0.106756im     0.0397433-0.0729405im   0.0136688-0.00244682im     0.144982-0.0177195im    -0.148596-0.164407im    -0.0243882-0.0733687im     0.0618207-0.277364im      -0.115334-0.0728905im
 -0.0454497+0.0502517im      0.104298-0.0596102im     0.0135535+0.0117424im       0.0461395+0.0269108im   -0.0069365+0.0341972im    -0.0722569-0.041173im    0.0851588-0.107699im   -0.00509905-0.0533437im    -0.235573+0.115516im       0.241291-0.145056im     -0.0674889+0.146289im      -0.226332+0.183051im    -0.0492709+0.00870637im   -0.175131+0.0252227im   -0.0684765+0.0535333im     -0.143211-0.153352im     0.0127892-0.119171im    -0.00260837-0.0775703im     0.0985513-0.0675522im    -0.0474524-0.0741584im     -0.101822+0.0290859im     -0.0469733-0.242232im    0.00323923+0.310045im      -0.177151+0.268095im      -0.127749-0.00123621im    0.192335+0.0232536im  -0.0350991+0.305133im      0.0449078+0.105912im    -0.0689732-0.223681im      -0.11326+0.0338355im   -0.00903939+0.165669im     -0.0846997+0.157999im
  0.0272326-0.0174014im     0.0666256-0.30186im      -0.0519481-0.0324546im       -0.181489+0.156644im    -0.0714007-0.00663489im    -0.056698+0.187646im    0.0733021-0.155714im    -0.0209462+0.141512im      0.107663-0.11631im       -0.110141+0.0891053im    -0.0779847-0.0322728im     -0.187488+0.0422099im    0.0683556-0.0317499im    0.0301509+0.00454468im   -0.182031+0.239842im       0.122483-0.00488196im    0.190103+0.215038im      0.0225814-0.0179033im      0.202865+0.0388518im     -0.140425-0.0692914im    -0.0924224-0.0831149im      0.0622577+0.011503im      0.044076+0.0957673im      -0.12343+0.0595921im       0.14628+0.19323im     -0.0142379+0.16341im    -0.0640997-0.0751665im     -0.137554+0.105568im     -0.233161+0.206058im     0.0495851+0.229387im       0.183634-0.015642im       0.188194+0.021742im
  0.0543166+0.103482im       0.111577+0.238721im      -0.147749-0.0649051im        0.115851-0.0510365im    -0.049308+0.149574im      -0.146827+0.068893im    -0.087217+0.132953im     0.0732897+0.128258im    -0.0622953+0.00583932im    0.0710378+0.0924344im     -0.158697-0.093766im      0.0545445+0.0281772im   -0.0239345+0.166821im    -0.0412814+0.0927507im    0.0545048+0.00870608im   -0.0159449+0.229756im      0.194222+0.111814im      -0.056068-0.368857im       0.278611+0.123324im      0.0627052-0.179448im     -0.0761635+0.172649im      -0.0357569+0.0822977im     0.170215+0.075363im      -0.106576-0.1103im         0.204366-0.096013im      0.125885-0.187663im    0.0430115+0.0303246im    -0.0907642-0.157779im      -0.10075-0.00216498im   0.0548494-0.161764im     -0.0899487-0.108176im     0.00320335+0.0962365im
 -0.0604204-0.0481489im    -0.0299378-0.0736954im    -0.0937992-0.134039im       -0.0798827-0.199909im     0.0327209+0.0757954im     -0.144536-0.1385im     -0.0548113-0.185551im      0.146474-0.0370307im     0.135431-0.283247im       0.321034-0.0560962im     -0.060589+0.00653729im  -0.00650834-0.0680562im      0.02954-0.153318im      0.139786+0.128963im     0.0289664+0.0648833im    -0.0259509-0.142117im      0.221939+0.19208im       0.0550555+0.0327708im     -0.224146+0.109798im     0.00398517-0.135054im       0.135148+0.156539im       -0.107988-0.0534503im     0.099174-0.0495446im     0.0744137+0.0882195im    -0.0608261-0.13258im     -0.0906071-0.125874im    -0.104326-0.128391im      0.0606959+0.0253356im   -0.0662938-0.27331im         0.1926-0.0950744im      0.126193+0.12053im          0.1302-0.0666714im
  0.0330232-0.00258038im   -0.0150026-0.157566im     -0.0157166-0.129281im         0.104303-0.167492im     -0.203534-0.249042im        0.23559-0.185124im     0.109772-0.16499im     -0.0618387-0.0905306im   0.00299097-0.039909im     -0.0380722+0.108476im      -0.166206-0.114099im       0.159858+0.235527im      0.138495-0.0636845im    0.0414121-0.155651im     -0.016223-0.203064im      -0.167586+0.04169im     -0.0690235-0.128118im      -0.244876-0.0614783im      0.204382+0.13731im        0.187261-0.00540322im   -0.0501317-0.0322815im      0.0352464-0.115555im    0.00682278-0.102014im       0.066188+0.0241982im     0.0269303-0.170053im    -0.0398509+0.176119im   -0.0929074-0.0322358im   -0.00174732+0.00531469im   -0.231656+0.0421661im    0.0540253-0.1748im         0.153873+0.057466im      0.0475377+0.110154im
   0.090582-0.102526im        0.20963+0.025618im      0.0851487-0.0421594im       0.0598166+0.123873im      0.247215+0.262748im      0.0206203+0.0287587im  -0.0652828-0.111919im    -0.0694148+0.0532561im    0.0283609+0.016776im      0.0557296+0.150887im      -0.131804-0.0977886im     0.0391613-0.0940852im    0.0543748+0.0118602im    0.0306004+0.082337im      0.083021-0.0114716im     0.0436364-0.213079im     -0.319384-0.128453im     -0.0597378-0.101989im    -0.00850307+0.133916im       0.251174+0.0328562im     0.0268851+0.115439im      -0.0601564+0.0286815im     0.156258+0.052535im     -0.0522697+0.105116im      -0.259692+0.0854397im   -0.0625248+0.0565756im   -0.138314+0.0691813im     -0.107964+0.0430898im    -0.100764+0.0313313im   -0.0070153+0.0568117im      0.193475-0.372246im     -0.0252465-0.197574im
   -0.20437+0.0744646im    -0.0356655+0.0230395im     0.0256135+0.270813im        -0.163392+0.103058im     -0.100094-0.102608im      0.0509714-0.20714im      0.102727-0.0116095im   -0.0172275+0.320835im    -0.0149925+0.109553im      -0.120832+0.050692im       0.103761-0.103893im       0.135855+0.0686371im     0.192603-0.150407im    0.00184237+0.087956im     0.0877259+0.124248im      0.0326627+0.0502678im     0.103192-0.0468391im     -0.168609+0.0737741im     0.0158376+0.148787im       0.110161-0.120694im      0.0930477-0.0346339im      0.0676398+0.228366im     -0.018081+0.111628im      -0.107463+0.0435845im     -0.128008+0.0157642im   0.00226702-0.140774im    -0.029024+0.239266im      0.0812666+0.06168im      -0.134348-0.136964im      0.149071+0.0261036im     -0.222747+0.0655102im     0.0279478-0.288633im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 -0.021604162870061488 - 0.019658892996779892im
   0.07939454389015264 + 0.1879714280672369im
 -0.036475431746516976 + 0.17429894941531873im
    0.3173503289369083 + 0.0im
  -0.06728149383508514 + 0.07166095100334136im
    0.2588480131473144 - 0.07003626526249457im
  -0.23869327600108523 + 0.03100839086078762im
  -0.07116829675182898 - 0.20943792769589775im
   0.20322552153166665 - 0.0632738048831023im
    0.1272084211995721 + 0.21093685437975235im
  0.017645277707322396 - 0.08297237708275769im
   0.10322274406048752 - 0.10873612054906767im
   0.10491022728042128 - 0.14166253570780007im
  0.014473607093057724 + 0.09789655287586849im
   0.10687585422938954 + 0.09062357521427467im
   0.03419975016296653 - 0.12434380003036066im
   0.15411381393049844 - 0.08346037405192318im
   -0.0320265438320989 - 0.1297778256302535im
  -0.05317331030293426 - 0.14010387109310726im
   0.09870460708730644 + 0.1269183095093479im
   0.04252213795806898 + 0.02150420788031949im
   0.02391429698937595 + 0.11754834810417313im
   0.18609349303575862 + 0.046198387143150554im
  -0.09761953287176046 - 0.11783003629128139im
   0.04109383815777628 - 0.022155781549459602im
 -0.043523573004883236 - 0.012739235461322386im
   -0.1297961753290606 - 0.10236545833654849im
 -0.039690825718812425 + 0.1055541516500487im
   0.14513453441190133 + 0.1536238091916358im
   0.15844593637083662 + 0.1374153225999492im
  -0.28237201470769197 - 0.06616794020023202im
    0.1018960646431549 + 0.15069207371226098im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 27 March 2023 16:01">Monday 27 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.276814-0.154794im    -0.0247666+0.0135703im      0.081999-0.0925711im      0.148366+0.128113im      -0.0600745+0.128575im     -0.0406593+0.122408im     -0.192318-0.16873im        -0.26635-0.00930976im     0.100809-0.120362im     0.0809095-0.196048im    0.0784012-0.0558455im     -0.198815-0.111484im    -0.0198552-0.0629605im      0.135241-0.0143144im       0.22307+0.1192im       -0.0111062+0.121612im     -0.0888952-0.110351im       0.103978+0.0545082im     0.0106244+0.145113im        0.110057+0.0049067im    -0.0116953-0.00744083im    -0.15645-0.0617304im     0.0209383+0.14811im      0.160998+0.0633664im     -0.126771-0.0258871im       0.126494+0.0167774im    0.0779752+0.286123im     -0.146873-0.188961im       0.195094-0.0323551im     -0.135512+0.0222856im      0.172097+0.0396981im      -0.135493-0.0729386im
 -0.0231834-0.103906im      0.220109-0.240878im      0.0780783-0.063369im     -0.0698096+0.112156im      -0.0335443-0.223635im       0.227863+0.0728046im     0.128945+0.0166673im      0.308325-0.229418im      0.0698948-0.00175348im   -0.028136-0.176781im    0.0919527-0.127787im       0.192277+0.0686803im   -0.0674603-0.151401im     -0.0396935-0.0195614im      0.156641+0.101344im     -0.0555379+0.277947im     -0.0978627+0.191118im     -0.0325723+0.0995518im      0.143339+0.0467547im       -0.04414-0.0812739im     -0.077927+0.102494im    -0.0474617+0.118155im       0.159223-0.066228im    0.0205578-0.164462im     0.00111928+0.0822349im         0.1852-0.0486977im    0.0115165+0.0437633im     0.208306-0.0558802im    -0.0533956+0.0842343im    -0.0124991-0.00563173im    0.0256854+0.0722892im      -0.180364-0.121584im
  -0.010832-0.165869im     0.0401096-0.0126563im      0.255871+0.184157im      -0.136883+0.140918im     -0.00289862-0.0918194im     -0.188566+0.0295884im   -0.0130079-0.0361647im    -0.0710967+0.0822424im     -0.101034+0.0492696im    0.0949884+0.02009im      0.151857+0.0706889im    -0.0983217-0.088513im      0.159211-0.222309im     -0.0493749-0.127622im        0.06225-0.0251265im      0.142414+0.0387546im      0.224754+0.248859im      -0.243207+0.171144im       0.247689+0.0285431im      -0.170234-0.0782199im       0.14672+0.142269im      0.142002-0.140508im      -0.129562+0.1064im        0.14062+0.0488174im    -0.0641281-0.148106im       0.0374711-0.0640313im     0.113473-0.0610616im    -0.162348-0.03684im       -0.130634+0.0411996im      0.100673+0.0925254im     -0.160292-0.0277581im      0.0193576+0.129594im
 -0.0447414+0.0460343im    0.0664597+0.100352im      0.0116114+0.284163im      0.0170618+0.0265175im      0.0683115+0.065694im      0.0894319-0.0209703im    0.0404647+0.0703851im     -0.034681-0.0338025im     -0.131337+0.0623727im    -0.139641-0.138192im    0.0381833-0.14957im        0.169076+0.0129211im   -0.0266899+0.0763032im      0.154803+0.270006im     0.00119393-0.06687im       -0.116595-0.0226534im    -0.0262972-0.0117115im     0.0739585+0.106139im     0.00858823+0.160503im       -0.115051-0.160912im      0.0909431-0.107593im     -0.119601-0.0742757im    -0.0707108+0.12874im     -0.111168-0.0543145im    -0.0372903-0.0399565im     -0.0168471-0.105992im      0.176606+0.164456im     0.0286579+0.0778997im    -0.0122888+0.373956im      -0.346812+0.160266im    -0.00855501+0.0182677im       0.230217+0.24654im
   0.219675+0.0899614im    0.0625296-0.0545975im    -0.0911667+0.0768621im    -0.0396167-0.108778im        0.105409-0.0772946im     0.0597991-0.0335871im   -0.0853147+0.00791975im  -0.00870234+0.0292497im     -0.313973+0.101935im      0.152286-0.261578im    -0.149922-0.00842736im    -0.120335-0.157643im    -0.0859411+0.0764304im     -0.253032-0.0247324im     0.0434772-0.010025im      -0.161938-0.109211im     -0.0519137-0.0938359im      0.106858+0.0422631im      0.108056-0.166299im       -0.145578+0.216057im      0.0641685+0.0943446im     0.221099-0.058825im       0.249425+0.0749206im   0.0932888+0.0414134im      0.247329+0.0876931im      0.0436469-0.00275731im  -0.0365375-0.0626617im   -0.0417056-0.152388im     -0.0517209+0.153296im      -0.136604+0.157195im     -0.0556295-0.177955im      -0.0644859-0.116724im
 -0.0200694+0.100308im    -0.0911796+0.183984im      -0.117525-0.0608359im     0.0386641-0.0533636im     -0.0621897-0.00829508im    0.0506884-0.122378im    0.00771822-0.076484im      -0.118962-0.185179im     -0.0489537+0.0653355im    0.0532326-0.0640332im    0.230092-0.0731038im    0.00218926-0.104273im    -0.0985096-0.0472063im    -0.0562923-0.120469im     -0.0796394+0.0759536im     -0.134432+0.160403im      -0.374731-0.159832im       0.127818+0.061868im       0.164106-0.0459897im     -0.0456997-0.139409im     -0.0761072-0.125425im      0.150286+0.0516325im     -0.200263-0.0232117im    0.072653-0.0297125im     -0.234389-0.0604251im      0.0241759-0.142958im     -0.182808-0.0909225im    -0.109654+0.189597im      -0.128302+0.0161726im      0.269378+0.282124im     -0.0583159+0.0333016im     -0.0466025+0.07922im
  -0.123717+0.0412586im    0.0967758+0.0287066im    -0.0985425-0.00806573im   0.00177725-0.270735im      -0.0794011-0.0808019im     0.0255412+0.116496im      0.351758-0.206272im      -0.216918+0.164737im     -0.0210749+0.0777322im    -0.101804+0.0428607im    0.115221-0.125288im      0.0830304+0.259554im   0.000532179+0.145701im       0.127209-0.098337im     -0.0571488+0.0505715im     -0.215181+0.179345im       0.208383-0.00653394im    0.0282555+0.065559im     -0.0107779-0.0742543im     -0.0113186-0.0122672im      0.025796+0.0835068im     0.215253-0.00906602im    0.0213221+0.188197im     0.163154-0.0145785im      0.132562-0.192901im     -0.00940458-0.00908657im   0.0293236-0.0449685im    -0.130267+0.00589627im     0.118059+0.0246302im    -0.0348342-0.108528im       0.247556+0.038634im        -0.18019-0.00699643im
   0.116222-0.249354im     -0.216763+0.100219im       0.134652-0.0363322im     -0.120075-0.0526373im     -0.0107332+0.416486im      0.0191482-0.19712im       0.194643-0.0868769im       0.16568-0.0711639im     -0.218295+0.0088769im   -0.0535475+0.138258im   -0.0101524+0.0641801im    -0.0916262+0.0715704im    0.0314608-0.189801im     -0.0632009+0.0738432im     -0.117308+0.0612778im     -0.166195+0.0556075im     0.0162404+0.0996676im    -0.0230153+0.170908im      -0.123252-0.0568374im      0.0503756+0.0536823im    -0.0301182+0.0576653im   -0.0579248+0.0845463im      0.230156+0.126924im   -0.0575637+0.126695im     -0.0872156+0.148497im        0.133967-0.0719455im   -0.0712651-0.0372916im    0.0654166-0.0217345im   -0.00750462+0.0523031im     0.0974651+0.0167763im      0.261758-0.10289im        0.0197964+0.186344im
 -0.0714375+0.101028im       0.13471-0.105448im      0.0584864+0.0806745im     0.0476941-0.00073311im     0.0186135+0.176751im      -0.156904-0.0209498im     0.104742-0.114582im      0.0169057-0.028237im       0.124299+0.0120121im   0.00291542-0.259512im     0.182078-0.00491729im    -0.283695+0.0449947im    0.0984922+0.10746im       0.0474609-0.14784im       -0.205487+0.0427126im    -0.0544795+0.152333im     -0.0705635-0.0700831im    0.00121212-0.110827im        0.17688-0.000909317im     0.110936+0.167218im       0.254355-0.119058im    0.00766668+0.0750489im     0.0477986-0.029531im    -0.409554-0.0320828im    -0.0916246+0.0277969im     -0.0185783-0.0933842im     0.191419-0.0844977im    0.0477796-0.143273im      -0.238214-0.0329956im    -0.0565486-0.197126im     -0.0372284-0.104114im    -0.000905643-0.00456874im
   0.148666+0.080059im    -0.0182278-0.00460137im   -0.0388035-0.197802im      -0.112564-0.182888im       -0.177715+0.201717im      0.0155262+0.0154029im    0.0837496+0.0178553im    -0.0492786+0.0437672im      0.161197-0.168262im      0.336348-0.184989im   -0.0363299+0.172992im      0.0193671+0.0257305im     0.116056+0.208561im        0.20679+0.06521im       0.0856313+0.0197627im      0.100111+0.0783963im      0.145852+0.133206im    -4.33752e-5-0.0205373im    -0.0703517-0.0212585im     -0.0214755-0.128209im       0.146278-0.057594im     -0.036016+0.0790929im      0.159616-0.196715im     0.263802-0.00928406im   -0.0168381+0.127398im      -0.0632529-0.0861808im    0.0774343-0.153929im     0.0387472+0.115681im       -0.13383+0.274615im      0.0657395+0.135597im      -0.092418+0.0978449im       0.059648+0.00878777im
 -0.0371666+0.0767175im    -0.102972+0.189667im    -0.00960231-0.080951im    -0.00747379-0.271098im         0.16639-0.198662im       0.235131+0.0903214im    -0.135917-0.118708im      0.0789182-0.0609706im   -0.00275615+0.0523016im   -0.0778114+0.139402im      0.18821-0.00963596im     -0.36765-0.147315im   -0.00717669+0.0315831im      0.120485-0.0473583im     -0.025313+0.0193097im      0.160101-0.018246im       0.128673+0.186174im      -0.034433-0.146489im     -0.0116094-0.126069im      -0.0517552+0.0407262im   -0.00756342-0.155643im    -0.0758642-0.0740141im      0.039695-0.0770022im   0.0480637-0.122885im    -0.00475614-0.172388im        0.303477+0.0263955im   -0.0977129+0.0576984im     0.192043-0.118966im      -0.131169+0.0728686im     -0.102775+0.066333im       0.164614+0.0387581im       0.128342+0.0616299im
  0.0154045+0.0114586im   -0.0715426-0.144849im      -0.162645-0.0300219im    -0.0811468-0.0371229im     -0.0552217-0.00296574im    -0.211331+0.0176048im    -0.338823+0.124672im       0.157468-0.129996im     -0.0661288+0.228806im     0.0105915+0.072625im    0.0143258+0.181029im       0.118693+0.0799414im    0.0249353+0.0626704im    -0.0286664-0.275581im      0.0119949+0.0231772im     -0.126954+0.0985545im      0.151397+0.130113im       0.149596-0.202955im       0.171987-0.0102382im       0.110665+0.0846021im      0.228184+0.0597206im    -0.103987+0.242068im      -0.137723+0.205046im    0.0388325+0.0074277im    -0.0598984+0.0693261im     -0.0130012+0.00616006im   -0.159817+0.0953628im   -0.0624054+0.0949326im     0.0983839+0.14072im       -0.126666+0.0127616im      0.128751+0.158191im       0.0198467+0.103905im
  0.0120329+0.0311881im     -0.19433+0.102776im      -0.078028+0.00796212im    0.0440343+0.000389207im    0.0158882-0.196302im     -0.0952204+0.1238im        0.200722-0.0384573im      0.127809-0.038216im      0.0712622-0.0773764im    0.0456425-0.0913037im   -0.133425-0.0551994im     -0.133456-0.194876im     0.0826549-0.304336im     -0.0345108-0.0561446im     0.0438881-0.0721315im    0.00983238+0.0171646im    -0.0225669+0.0491612im      0.207745-0.213346im      -0.228535+0.0069808im       0.149788-0.0945307im   -0.00995456+0.241023im    -0.0414969+0.0541585im     -0.107626+0.125841im   -0.0726201-0.0335519im    -0.0448109-0.122151im       0.0321605-0.140451im      0.138874-0.185285im    -0.0760663+0.213127im      0.0849239+0.299809im     -0.0395617-0.121363im    -0.00843237-0.24795im       0.00170576-0.144597im
 -0.0550877+0.219033im    -0.0336162-0.0865028im     -0.130718-0.202263im     -0.0756612+0.0533656im     -0.0153604+0.143001im      0.0174905-0.0179871im   -0.0566648+0.138571im     -0.0620866+0.0651963im     -0.110586+0.252769im     -0.181882+0.0928886im   0.0828786+0.0880063im     -0.040394-0.0275843im   -0.0424029-0.0677859im      0.250174-0.128239im       0.292631-0.111007im     -0.0779767+0.107584im       0.025161-0.203807im       -0.12351-0.0237443im     -0.124761-0.0437984im      0.0341729-0.239353im     -0.0153086+0.0640219im     0.011173-0.203239im      0.0520245+0.183408im    -0.114037+0.0657149im     0.0112946+0.123704im        0.179068+0.135365im      0.111316-0.0246685im     0.139956-0.130303im     -0.0604839+0.139695im       0.165484-0.0481048im     -0.253685-0.0768815im      -0.119218+0.00152551im
  -0.229083+0.205173im      0.109477+0.192657im       0.104668+0.0387559im    -0.0343172+0.040738im      -0.0439924+0.0524242im   -0.00560185-0.161773im    -0.0446223-0.263526im       0.172124+0.0844627im      0.071807-0.104841im    -0.0665619+0.0494993im  -0.0636943+0.0867064im    -0.0849683-0.0611267im     0.125897+0.0412762im     -0.294634+0.0450814im      0.253549-0.318068im     -0.0975327-0.000244307im   0.0362015+0.0300875im     0.0890765+0.0537075im     0.0721521+0.131338im        0.282295+0.020728im     -0.0691552-0.221011im       0.13027+0.106288im    -0.00369569+0.114847im     0.114339+0.071063im       0.146816+0.0281816im      0.0719541-0.126152im      0.123003+0.113462im      0.055221-0.0153096im    0.00459204+0.0616252im     0.0848892+0.0270534im    -0.0223051+0.230412im      -0.0530985-0.057428im
  -0.121787+0.00379018im   -0.251231+0.0931279im      0.106674+0.146856im      0.0933308-0.120312im      -0.0972729+0.0877736im     0.0573458+0.147682im     -0.079023-0.0998957im      0.103921-0.126608im       0.139973+0.0734031im    0.0514941-0.0731578im    0.110629+0.237046im      0.0805345+0.340735im      0.205086+0.161498im     -0.0857828+0.00246784im     0.113502-0.00483345im    0.0656641-0.177074im      -0.171525+0.0771657im      0.272973+0.104184im      0.0697454-0.0935501im      -0.166804-0.180267im     -0.0266826+0.177451im     0.0344001-0.13395im      -0.0433512+0.0898404im  -0.0748965-0.080489im     -0.0382106+0.0124624im     0.00604915+0.0540803im    0.0125014-0.0458595im    0.0628913-0.272826im       0.129728-0.0410351im     0.0475658+0.0301303im    -0.0256862-0.128642im       0.0875398-0.154948im
 -0.0775451+0.0416215im     0.286085+0.0268553im    -0.0701306+0.247195im       0.139216+0.0274977im      0.0625042+0.220931im       0.104615-0.033976im     -0.061434+0.0796336im   -0.00779618-0.102852im      0.0298391-0.118761im     -0.166843-0.0477827im   -0.106727+0.231494im     -0.0687163-0.049216im    -0.0868977+0.12352im       -0.162136+0.0622373im     0.0503159+0.0882411im     0.0387585+0.314601im       0.193675-0.0966326im    -0.0160764+0.0633192im     -0.127953-0.152338im       -0.114431+0.00744651im    -0.120086+0.136396im    -0.0861126+0.140403im      -0.110159-0.0114834im   0.0859223+0.0341517im     -0.169428-0.106854im        0.265519+0.136133im    -0.0507365-0.202156im     -0.216784+0.0157093im    -0.0173578+0.013187im     -0.0132143-0.0679924im    -0.0337106+0.00753482im      0.175471-0.122656im
    0.18485-0.128904im     0.0843472-0.162308im       0.134248+0.0515001im     -0.031377+0.0673526im     -0.0587147+0.222502im       0.103845+0.0839259im     0.121349-0.060398im     -0.0316214+0.0849636im   0.000555498+0.0325922im    0.0686706+0.154581im    -0.103526-0.107365im     -0.0573196+0.0896214im    -0.122067-0.122444im     0.00590628-0.147781im       -0.16867-0.0414528im    -0.0337679-0.0685023im       0.12764+0.0459314im      0.378506-0.219128im     -0.0764262-0.0467764im      0.0211898-0.230415im     -0.0522541-0.0643198im     0.281673+0.0817506im    -0.0888734-0.066429im   -0.0606413-0.143034im      0.0642507+0.000908785im     0.207739+0.0511825im   -0.0464279+0.216221im    -0.0641801-0.044153im      -0.109429-0.0462032im    -0.0669953+0.0778298im      -0.28039+0.136145im        0.110733-0.0405029im
  -0.061953-0.206044im     -0.035131+0.149818im     -0.0966866+0.0586918im    -0.0247673+0.0607376im      -0.158818-0.0725827im     -0.107473-0.128551im     -0.113776+0.165686im       0.126685+0.0778im        0.0181945-0.495706im    -0.0901104+0.141392im     0.148533-0.0706505im     0.0108624+0.0138174im   -0.0340102+0.0400645im      0.182733-0.0473684im   -0.00644606+0.0940577im    -0.0271955+0.128496im     -0.0460345-0.169724im       0.125635+0.00240026im     0.164752-0.171497im       0.0971881+0.0560011im      0.116379+0.215469im      0.151998-0.193753im       0.170064+0.011134im   -0.0442889+0.126172im       0.156536-0.0855648im      0.0636309-0.0992542im   -0.0735997+0.0276772im      0.14407+0.0255924im       0.03218+0.0590656im    -0.0439919+0.01212im       -0.115143+0.106436im        0.181341-0.0707936im
  -0.146027+0.0223125im   -0.0485758-0.0568609im      0.199568+0.0779221im     0.0655897-0.0254965im      0.0606646+0.0552269im      0.181093-0.147874im     -0.178429+0.037873im        -0.1989+0.125072im    -0.00362297+0.0301239im    0.0663333-0.203586im   -0.0742873+0.0867753im      0.146651-0.113239im    -0.0467143+0.00689264im    0.0691834-0.187683im      -0.218993+0.0712178im      0.061306-0.107979im     -0.0506756+0.0828189im     -0.132549+0.116382im    -0.00109832-0.0872643im       0.256507-0.238716im      -0.053163+0.0124537im    -0.139029+0.167407im       0.225505+0.169528im    -0.048493-0.0703725im      0.150954-0.291919im     -0.00278526-0.176257im     -0.231776+0.0680804im   0.00949259-0.010506im      0.0303734+0.118097im      0.0955932-0.15952im      -0.0734571-0.0140719im    -0.00442878-0.0784857im
 -0.0998864-0.0249611im    0.0492098-0.036189im      -0.147724-0.0694431im   -3.91742e-5-0.350584im       -0.195316+0.0580737im     0.0198881-0.252966im    -0.0240664+0.1323im       -0.0843808-0.0295913im    -0.0356682+0.169914im     0.0860237-0.0591403im    -0.10472+0.0786435im     0.0129058+0.0440203im       0.1104-0.425774im     -0.0303405+0.0906019im    -0.0167557+0.200479im       0.184796+0.0445307im     -0.120017-0.00296853im    0.0480897+0.0584945im      0.129241+0.112938im      -0.0455988+0.0618825im     0.0279829-0.21375im      0.0882664-0.107476im     -0.0452256-0.0108392im   0.0320912+0.0181511im      0.113064-0.0345287im       0.197212+0.00308254im    0.180113-0.0433225im   0.00545674+0.0595917im      0.181511-0.0805165im     -0.149988-0.222724im     -0.0529421+0.107152im        0.135529-0.0693889im
    0.21371+0.0800848im    0.0650807+0.220514im      0.0993412+0.0378814im       0.12512-0.10398im       -0.0403643+0.121039im     -0.0885221+0.0507698im   -0.0506511+0.0102129im      0.170125-0.310007im      0.0727689+0.099455im     -0.325847-0.0287334im  -0.0673766-0.0626169im      0.111103-0.0277772im   -0.0589669+0.0320779im     0.0647041-0.240815im     -0.0521723+0.248962im       0.175236-0.212164im      0.0190364-0.0916462im    -0.0666831+0.0564697im     -0.127747+0.135289im        0.120413+0.128517im    -0.00264354+0.148148im      0.133423-0.0381435im     0.0802218+0.070703im     0.196008-0.190258im       0.112379-0.00600196im    -0.0645857-0.0742896im     0.248328-0.0166075im   -0.0386856+0.0253948im     -0.165416-0.0226027im     0.0777712+0.0221824im    -0.0545474+0.117543im      -0.0255441+0.0663433im
   0.069715+0.0122741im    -0.144122+0.172977im     -0.0178145+0.109723im      0.0504361+0.357556im       -0.131244-0.132519im    -0.00681942+0.01436im      0.0778031+0.0329472im    -0.0638227+0.0193691im     -0.167985+0.0800537im    -0.113035+0.0709888im   -0.159394+0.0808138im     0.0683048+0.0315263im     0.142969+0.135421im       0.143318+0.06636im       0.0845246+0.148917im    -0.00905246-0.105612im      0.0677521-0.00226197im    0.0811385-0.20453im        0.269193+0.0942024im      -0.082259-0.0369079im     -0.102627-0.263329im     0.0636735-0.00242355im      0.25176-0.0409524im   0.0745481-0.0658693im     -0.157645+0.0739289im        0.18734-0.139545im     -0.102034-0.146099im     -0.132905+0.00583396im    -0.120904+0.03961im      0.00659865-0.306677im      0.0605486-0.0254753im     -0.0658173-0.0772376im
  -0.262082+0.071938im    -0.0131255-0.0804215im    -0.0323123+0.134954im     -0.0874032+0.0267879im     -0.0075748-0.0114265im    -0.0559122+0.00175113im  -0.0765825-0.0436497im     0.0266266+0.0759726im      0.109796-0.0833154im   -0.0414122+0.121376im    0.0199678-0.0365046im     -0.103195-0.221275im    0.00852559+0.0244388im   -0.00351726+0.0493556im     -0.291534+0.263293im      -0.169898-0.0926039im    -0.0402639+0.0642065im    -0.0765773+0.0489696im    -0.0481451-0.0813344im       0.072258-0.182881im      0.0973516+0.00312898im  -0.0508751-0.127306im     -0.0713368-0.0645549im    0.152265-0.245429im      0.0411663+0.487784im        0.134115-0.0500122im    0.0685175-0.0846566im    -0.170662-0.113061im       0.228741+0.0493523im    -0.0549653+0.0659545im   -0.00960159+0.00877468im     -0.154371-0.00875668im
  0.0882644-0.0934288im      0.20654+0.246712im     -0.0528251-0.249929im     -0.0310998+0.282761im      -0.0851682+0.0624751im    0.00628737+0.00935339im  -0.0236136-0.0271759im    -0.0419873+0.236444im    -0.00363267+0.172005im    -0.0283871+0.105023im    0.0847166+0.0353154im     0.0722699-0.0175351im     0.078638+0.0921134im     -0.141345+0.17194im        -0.13867+0.183098im       0.266799-0.0583976im     -0.095127-0.030341im      0.0862288+2.34885e-5im    0.0117495-0.147822im      -0.0408752-0.0357155im      0.133931+0.0709675im   -0.0849148+0.237686im      -0.182395+0.0790465im  -0.0945616+0.0347441im      0.180471-0.117098im        0.130131-0.0170673im     0.125332-0.149948im      0.194829-0.0249489im    0.00213662+0.0880841im    -0.0844914+0.148186im      0.0487329-0.010579im       -0.240046-0.0254592im
  0.0279783+0.0850142im    0.0697819+0.0595922im     -0.023857-0.0671509im    -0.0161023-0.0912673im      -0.132616-0.0997077im     -0.282618+0.365187im    -0.0959335-0.137576im      -0.034297+0.124955im       -0.12561-0.0492372im    -0.019508-0.0664328im  -0.0493767+0.138438im       0.209783-0.0211118im    -0.135805-0.0501064im     0.0397303+0.0543139im     0.0139582-0.0820058im     0.0120964-0.0404743im      -0.15426+0.072668im      -0.180121+0.110234im      -0.127825-0.00568718im   -0.00569831+0.0680106im     0.0304568+0.0138777im     0.167437+0.116454im        0.11824-0.166072im    -0.356532-0.0499668im    -0.0411778+0.0278658im       0.334652-0.0742453im   0.00196456+0.0747379im    -0.166196-0.0152705im     0.0980339+0.0449037im      0.149898+0.0710396im      0.110627+0.103474im        0.190018+0.0277759im
    0.14592-0.011079im     -0.173099+0.0185521im     0.0135281+0.214786im       0.131979-0.0943261im     -0.0184167+0.0136947im     0.0224945-0.11343im      -0.140697-0.110354im     0.00196753+0.140453im      -0.124835+0.234118im         0.112-0.05193im      0.205174-0.383885im      0.0457109-0.0465037im   0.00205561+0.0205367im    -0.0440969+0.184764im       0.193389+0.0427846im    -0.0900593-0.0218765im      0.158979-0.0457918im    -0.0844311-0.0820961im       0.03677-0.00234096im      0.220486-0.129725im      0.0458489+0.240072im    -0.0181043+0.163028im     0.00304184-0.194765im   -0.0495191-0.00971833im   -0.0544954+0.0464485im      0.0243673+0.0413863im    0.0747826-0.269527im     0.0907058-0.0138927im     0.0433241-0.148093im      0.0509582-0.0589476im   -0.00569431+0.246123im        0.135594-0.0906938im
 -0.0485448+0.113287im     -0.122335-0.0876025im     0.0311545-0.0388264im     0.0331386+0.234129im      -0.0572308-0.0192114im     0.0996446+0.0608802im    -0.149808+0.0377431im     -0.259272+0.131932im      0.0170287-0.0172143im    -0.142112+0.0242762im   -0.060629+0.0943313im   0.000634893+0.109392im     0.0763086-0.213416im     -0.0489539-0.058342im     -0.0204011-0.0129161im     -0.260199+0.118571im       -0.18183+0.0622291im     -0.043465-0.0283551im     -0.271032+0.0233475im     -0.0909337+0.149016im       0.118498+0.0695578im     0.124275+0.0938783im    -0.0598672-0.0484793im    0.265377-0.11925im      -0.0231786-0.0301702im      -0.106418-0.220988im     0.0506719-0.130695im       0.26646-0.17301im        -0.17728-0.0767675im     -0.127565+0.00179823im    0.0968644+0.0526505im       0.257997-0.0156486im
 -0.0169592+0.159841im     0.0610301+0.171228im        0.18914-8.33383e-5im    -0.155596+0.192971im        0.155636-0.0818802im      0.343351-0.0752045im     0.106566+0.134788im       0.025174+0.0237472im   -0.00969789+0.0146225im     0.196003-0.098452im   -0.0534783+0.138147im     -0.0420497+0.0721266im    -0.111516-0.0176514im      0.163027-0.0903508im     0.0798664+0.019398im       0.125867-0.0129879im     -0.159652+0.0186777im     0.0466615-0.0447424im     0.0237412-0.126801im        0.237715+0.0927955im     0.0585183+0.15871im       0.255333-0.0393739im    -0.0669098-0.0314473im  -0.0559799+0.039194im      -0.115329+0.0940076im     -0.0437664+0.172422im     0.0678313-0.098461im     -0.140565-0.0463373im      0.192035-0.000407194im  -0.0706806-0.0863454im      0.157164+0.181926im       0.0287252+0.30969im
   0.112623+0.163531im    0.00978602-0.0998586im      0.229844+0.0748007im     0.0263566-0.130434im      -0.0584043+0.0384073im     0.0255498+0.00195584im   0.0822455+0.0237839im     0.0868471+0.170831im      0.0592061-0.0985405im    -0.109793+0.038691im    0.0585156+0.0463785im     0.0775361+0.0582333im    -0.260088-0.0890848im    -0.0896006+0.053095im       0.070953+0.0923715im    -0.0434588-0.102317im     -0.0673399-0.182667im     -0.0288743-0.251201im       0.237384+0.0208248im     -0.0567122-0.012078im       0.167017+0.00762977im   -0.135604+0.0853997im     -0.196335-0.188012im     0.234291+0.1084im         0.117817-0.0509924im      0.0925654-0.0183199im    0.0239781+0.131711im     0.0417356-0.104793im      0.0691321+0.176926im       0.274074-0.155234im       0.107253-0.287776im       0.0738925+0.153019im
   0.169258-0.10918im     -0.0161051+0.0261488im     0.0188918+0.322606im        0.11933-0.00466943im     0.0845166-0.180436im     -0.0249894-0.17764im      -0.206281-0.0960646im       -0.0285-0.0325812im     0.0287086-0.0713944im     0.106249+0.116799im    0.0513762+0.169643im       0.110136+0.0977974im    -0.197678-0.0971981im      0.133001-0.107784im      0.0367804-0.0339714im    -0.0922654-0.0134185im     0.0277547+0.0504376im     0.0920807+0.157973im       -0.21563-0.245801im      -0.0760017-0.0116295im      0.144967-0.313406im     0.0461666+0.0478896im     -0.018889-0.0610659im  -0.0469675+0.0202723im    -0.0337028+0.0186038im    -0.00433172+0.121415im      0.297821-0.0280339im     0.139076+0.155704im     -0.0475453+0.0659531im     0.0786567-0.0906714im     0.0726953-0.0415799im      -0.274679-0.0923705im
  -0.143291-0.167664im     0.0546228-0.094452im      0.0248444+0.0769972im      -0.20269+0.0240934im      -0.299623-0.0683022im     0.0731698-0.0484586im   -0.0598276-0.152061im      0.0732625-0.0187778im    -0.0197542+0.0924955im   -0.0524938+0.0526429im    0.262649+0.0711004im     -0.133591-0.117425im    -0.0825751-0.0435642im     0.0585426+0.0380512im      0.065208-0.0103064im      0.118515-0.0549308im     -0.205614-0.122263im    -0.00567216-0.139954im      -0.163231+0.0244172im      -0.160616-0.09656im      -0.0644951-0.00622646im  -0.0097001+0.194614im       0.163665+0.0754893im   0.0134002+0.0527136im      0.191099+0.0530303im      -0.286522+0.192525im     0.0287353-0.00670811im   -0.318274-0.0167395im     -0.200575+0.116833im     -0.0332061-0.081837im       0.156469+0.0764715im       0.154031-0.0895831im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.1245949268563999 - 0.0030362213184709002im
 -0.039958508572983026 + 0.06888766653465478im
   -0.1564012781031956 + 0.07957436276570286im
   0.16819937556756592 + 0.0186046834983847im
  -0.05500304242541868 + 0.08273968037116801im
   0.06285143023573052 - 0.034003537217510836im
     0.101182799245685 + 0.1646576467151585im
 -0.011215062079767356 - 0.11671102120680688im
   0.07117468897080152 - 0.07925330634997574im
  -0.06797282720612248 + 0.2662273804456818im
   0.10384134895872804 - 0.09591715119225752im
     0.166259341268555 - 0.12966134680878774im
   0.14593461727329907 - 0.1601795215832055im
  -0.10671875601628189 - 0.11313879858106131im
    0.0446552937993472 + 0.2353086034886599im
  0.027339476251806678 + 0.26608088034861027im
  -0.00834604519135744 - 0.12936154477935052im
  0.045884905423742635 - 0.24197248271282376im
   0.06454922714116884 - 0.20768480068310327im
 -0.006676815092850069 - 0.08137474932017986im
   0.08185536043521627 - 0.035474558475263096im
   0.05671181338224926 + 0.10063338905806558im
   0.12549478719726934 + 0.11528131655959044im
    0.4268677556363432 + 0.0im
  -0.11160551386815606 - 0.09946809105682967im
  -0.07258945666194959 + 0.015622623403956917im
     0.117801769477812 + 0.036689033562596486im
 -0.060970691752814575 + 0.15846828142859953im
  -0.15684193935683488 - 0.07373141695748256im
    0.1438279322823684 + 0.018848079234099643im
   0.07892262414361702 - 0.08420688057730365im
 0.0063716074646899025 + 0.030763896206352722im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 04:02">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.266346-0.0595161im    0.153834+0.266774im       0.0947937+0.027822im     -0.0731062-0.0136083im    0.0528548-0.0484819im   -0.0360023-0.103026im    -0.0618222-0.228727im      -0.104396+0.172723im    -0.0213558+0.0637038im     0.0588767-0.0411934im       0.215345+0.157128im      0.0697745-0.225004im    -0.0569073+0.0720724im      0.246816-0.0651656im      0.030656+0.0211028im   -0.0508666+0.231027im    -0.0971349-0.189116im      0.155415+0.0540656im      0.129379+0.0945896im   0.0653285-0.187712im      0.194655+0.0640569im      0.04018+0.0151606im     -0.17638+0.215354im       0.0413328+0.0416054im    -0.0641528+0.035171im      -0.094553+0.257029im     -0.110795-0.101087im    -0.00216264+0.120555im     -0.142301+0.0358688im    -0.0140748+0.0663579im  -0.0533244+0.00785852im    -0.114688-0.111692im
 -0.00358946+0.328564im     0.029761-0.0106915im      0.0361529-0.183844im       0.120329-0.00583891im  -0.0423685+0.0518605im   -0.0142681-0.24475im      0.0979362+0.165702im     -0.0671136+0.00222957im   0.0864743+0.221258im      -0.219138+0.311945im       0.0858252+0.0720129im   -0.00826696+0.0734085im   -0.0857732+0.109644im       0.180076+0.100164im      0.0217559-0.0656574im    -0.160372+0.112752im     0.0320731+0.189022im    -0.0330266+0.0791704im    -0.0699873-0.0827795im  0.00910951-0.0846668im   -0.0743494-0.0696614im    -0.188614-0.0292026im   -0.0380934+0.0522577im      -0.154287+0.0199363im     -0.152234+0.0301195im    0.00271559-0.182791im      0.034654+0.17886im        0.117169+0.138034im     -0.229106-0.1731im        0.0172655+0.0855035im   0.0937736+0.128828im     -0.0943596-0.155862im
    0.136812+0.214385im    -0.140004+0.0466971im      0.0444896+0.112456im      0.0506812-0.0399403im     0.100041-0.0780116im     0.405257+0.0399572im    0.0966403+0.149184im      -0.175436-0.0498222im   0.00867584+0.219592im      0.0394656-0.0553633im     -0.0247473-0.106325im     -0.0165306-0.135264im    -0.0865811-0.0628027im     0.0565186-0.0104619im    -0.0454833-0.0338864im    0.0646536+0.0888598im   -0.0281779-0.123198im      0.018671+0.178194im       0.188876+0.0991382im   0.0243438-0.0907868im     0.148802+0.0450255im   -0.0390269+0.203938im      0.303792-0.182936im        0.182371+0.162868im       0.114449-0.136844im      0.0712808-0.1365im        -0.22554-0.0180683im    -0.0588185-0.0625952im   -0.0306708+0.100273im       0.136917+0.148028im    0.0273337-0.00489904im    -0.112944+0.0013853im
  0.00610607-0.113044im     0.159966-0.065216im       -0.139893+0.0521839im     -0.209767+0.205523im    -0.0196819-0.161467im      -0.11718+0.162125im      0.124773-0.0853947im     -0.102335-0.232589im    -0.0731853-0.0103949im      0.233437+0.00637754im      0.176969-0.0967702im     0.0265982-0.0150568im    -0.151432+0.076468im     -0.0690125-0.0670364im     -0.057153-0.052965im    -0.0644421-0.00470703im  0.00127221+0.188964im     -0.125797+0.0480695im      0.404906-0.223222im     0.171611-0.0705327im   -0.0718412-0.097734im      -0.14474-0.0110818im   -0.0385242-0.0283291im     0.00156582+0.0625054im     0.0316928-0.130704im      -0.105943-0.0398007im   -0.0756121+0.234545im      -0.122015+0.0156576im   -0.0164615-0.0287207im    -0.0888455-0.124607im     0.180852-0.00977211im  -0.00860465-0.191901im
   0.0796395-0.0631345im   -0.301814-0.048434im       0.0265563+0.11356im      -0.0347757-0.0321923im    -0.169824-0.0157759im   -0.0766247+0.0664653im  -0.00174589+0.0950594im    -0.0359929+0.178202im     0.0863473+0.170365im       0.100882+0.0887618im       0.231416-0.148598im      0.0379852-0.0928094im     0.172286+0.0477035im     -0.177213+0.0868416im      0.208782+0.0015543im    -0.129558+0.0473232im    -0.279025-0.114148im      0.200371-0.00942183im     0.110328-0.0844354im    0.130417+0.117251im     -0.153236+0.176452im     -0.020981+0.0104304im   -0.0683935+0.1357im         -0.110629-0.285999im      0.0324344-0.122613im      0.0288877-0.0471085im     0.086161+0.00200071im  -0.00674514-0.0581037im    0.0680985+0.0959458im      0.156818+0.198886im     0.078252+0.197092im       0.111199-0.0799055im
   0.0742353-0.172754im     0.289583+0.089897im       -0.062092-0.0590884im       0.25108-0.047457im     0.0839342+0.226479im    -0.0425676+0.121936im     0.0308146-0.0529246im    0.00817348-0.0430083im    -0.231635+0.137602im      0.0660468+0.165045im      -0.0297836+0.0306969im    -0.0868384+0.0841167im     0.103991-0.0782597im     -0.222605+0.128926im      -0.041207+0.193719im    -0.0582186-0.0749548im    -0.108432+0.085418im     0.0628399+0.0474405im    -0.0473549+0.119899im      0.32913-0.246558im      0.077946+0.0775911im    0.0471616+0.0759345im    0.0529962+0.0944248im       0.154073-0.0811798im    -0.0818224+0.0867278im   -0.00654831-0.149385im    -0.0608758+0.222897im      0.0883057+0.153713im     0.0818917+0.15675im       0.0542397+0.0527694im  -0.0710602+0.0366815im    -0.0863492+0.148406im
   0.0408543+0.0425375im  -0.0271044-0.0965im        -0.0339608-0.173693im     -0.0790981-0.106135im     -0.336695+0.0142159im    -0.115841-0.0102515im   -0.0155641-0.10261im        0.149862+0.111088im     -0.239303+0.18061im       0.0671027-0.0329901im      -0.218537+0.0530281im     -0.173001+0.0549729im   -0.0961875+0.26467im       -0.104395-0.0665354im      0.148308+0.052196im     -0.214766+0.105891im     0.0450887-0.127748im      -0.17632+0.132631im       0.118402+0.0836914im  -0.0457547-0.107545im      0.115981-0.117504im     0.0539302+0.0195147im   0.00908675-0.0322147im       -0.21757+0.157283im     0.00751177+0.0709255im    -0.0233326-0.0545638im    0.0521031-0.164022im      -0.255442+0.0387091im     0.178125+0.00505908im     0.172438+0.0873866im   0.0931105-0.101883im     -0.0779339+0.0678618im
   0.0646679-0.0866322im   0.0619416+0.100625im        0.196092+0.0302038im     0.0309693-0.160785im    -0.0813301-0.045223im     -0.269495-0.0915027im    0.0648983+0.25447im      -0.0425902-0.0394708im    0.0126372-0.12876im       0.0173657-0.120862im     -0.00952743+0.0318201im      0.101502-0.178853im    -0.0209132+0.0459669im     0.0718083-0.0748992im     0.0827992+0.198656im      0.137422-0.00485356im   0.0927877+0.110177im     -0.050883+0.10101im       -0.068862-0.127864im   -0.0361688-0.19797im      -0.137845+0.120079im      -0.22618-0.120691im     0.0566512+0.0120768im    -0.00536104+0.0959652im      0.251048-0.078562im     -0.0726885-0.0287543im    -0.163433-0.0297483im      0.190831+0.198411im       0.30356-0.0675187im     0.0825292+0.24082im     -0.066222-0.14712im        0.138811-0.0149369im
   0.0712707-0.015366im    0.0432452+0.116406im        0.171828-0.260806im       0.211741+0.0979346im     0.170235-0.060676im     0.0783234+0.0151865im     0.118652+0.0866274im    -0.0317748-0.170916im    -0.0584211+0.148042im      0.0918893-0.0672031im      0.0025481-0.0441104im     0.0763071+0.36934im     -0.0661249+0.108129im     -0.0834917-0.182097im       0.046309+0.162786im    -0.0681155+0.12764im      -0.071525-0.0536565im     0.195193+0.0323611im    -0.0504426-0.205508im    -0.165581+0.228587im      0.242756+0.0891074im   -0.0220112-0.0450274im    0.0241179+0.110589im       -0.148323-0.00102538im    0.0747721+0.0818556im     -0.158281+0.0661109im   -0.0695829-0.031654im      0.0117021-0.149415im      0.141935+0.118079im      -0.129987-0.0679313im  -0.0806515+0.0279551im     0.0514004-0.192053im
    0.170885-0.0224652im  -0.0445401+0.133999im      -0.0939792+0.123078im      -0.239895+0.0244355im    -0.034629-0.15165im      0.0250171-0.0994989im    -0.187486+0.244142im      0.0974825+0.166693im     -0.104647-0.073672im     -0.0460964-0.00276578im     -0.157818+0.00387508im    -0.126004+0.0251289im    0.0119512+0.032067im     -0.0719858+0.250236im     -0.0374945+0.170029im     -0.024507+0.332468im      0.125621-0.113893im    -0.0239262-0.0487519im    -0.0556762-0.0379432im    0.165124-0.0402936im     0.111537-0.232156im     -0.204014+0.180381im     0.0503433+0.203387im       0.0721687-0.0322403im     0.0835799-0.0172998im     -0.085413+0.0411339im    0.0412653+0.144366im       0.144635-0.17848im     -0.0246889-0.0162243im    -0.0790585-0.199202im     -0.13891+0.0240801im     0.0885191-0.0959811im
    0.215482+0.0433275im  -0.0839755+0.0853999im       0.161357+0.0191337im     -0.204096-0.178277im     0.0993501+0.0518712im    0.0553995+0.24266im      0.0586106+0.0363403im    -0.0841201-0.121872im    -0.0641701+0.0670714im     0.0421781-0.198147im        0.121448+0.318364im     -0.0515381+0.0243929im    0.0049611+0.115897im       0.135383-0.0825059im     -0.159016-0.0623091im   -0.0984032-0.0491495im    0.0190923+0.0867899im    0.0166851-0.136713im      -0.158005-0.0672171im   0.0966444+0.0347809im    0.0183608-0.235142im     0.0142228+0.237506im     -0.074003-0.0202287im     -0.0521056-0.0940136im     -0.136482+0.154688im       0.279967+0.183797im     0.0660935+0.086496im       0.066895+0.0853888im     0.126066+0.0818398im      0.052773+0.158937im     0.204247-0.044582im       0.128438-0.0410131im
   0.0764869+0.0147309im    0.153136-0.0397879im   -0.000948279-0.0543855im   -0.00025668+0.0447771im      0.16196+0.24978im     -0.0848491-0.036947im    -0.0634709-0.0424515im     -0.290021+0.282655im     0.0455091+0.0230352im      0.249852+0.0324961im     -0.0464133-0.0567523im     -0.123317-0.0519143im     0.164393-0.175377im       0.131239+0.127519im      -0.124887-0.0807331im    0.0512138-0.0119903im     0.063305-0.179236im     -0.182334+0.103101im       0.022814-0.0738016im   -0.111266+0.0886561im   -0.0417277-0.0801985im   -0.0519939+0.0650898im    -0.165502-0.0679089im      -0.287714+0.0797372im     0.0214625-0.00931709im      0.14868-0.065501im     -0.174609+0.0882922im     -0.100057-0.0464694im     0.263737-0.0062281im      -0.14446+0.0279147im   -0.165468+0.219345im     0.00244118-0.069241im
    0.248125-0.177559im   -0.0208049-0.100194im       -0.241382-0.052644im       0.173817+0.073811im    -0.0725223-0.0315077im     0.113575+0.109575im     -0.131866+0.0047824im     -0.164817-0.192769im       0.13041-0.311909im     -0.0727118-0.0226161im      -0.146352+0.06854im       -0.129428+0.12329im       -0.13834+0.0317055im     0.0317758+0.0463379im      0.034918+0.14812im      0.0148637+0.078684im     -0.151245-0.103845im     0.0667577-0.133481im      0.0994913+0.0721909im   -0.112005-0.22687im     -0.0323886+0.0384417im    0.0270995+0.00677609im   -0.131387-0.00275751im     -0.317908-0.0049911im     0.0135415-0.0981056im      0.116858+0.158062im     -0.187545+0.00354876im      0.11357+0.0488456im      -0.2262-0.0405079im      0.134076+0.149792im    0.0102593+0.0657664im    -0.0372745-0.0335791im
  -0.0190529+0.0388018im   0.0155498+0.0649462im       0.201885-0.11382im       0.0675704-0.0783954im     0.144368-0.165693im     -0.147931+0.0531549im    -0.178716+0.140268im     -0.0701857+0.108901im     0.0548102-0.100311im      0.0977983+0.0548328im       0.012177+0.0643945im    -0.0505604+0.0409631im    0.0294019+0.0319072im     -0.280626+0.216989im       0.194689-0.163907im    -0.0492569-0.151252im     -0.129277+0.120081im     -0.203088+0.18759im      -0.0339169-0.125199im   0.00434287-0.0748484im  0.000181934-0.065413im      0.311459+0.216395im     -0.104288-0.120029im       0.0861593+0.0428297im      0.187179+0.112207im     -0.0543705+0.0593129im    -0.127585-0.164578im       0.112307-0.0846978im    -0.234146-0.00820558im   -0.0518645+0.0139117im    0.113168-0.0882958im    -0.0711121-0.150112im
   0.0752148-0.062163im      0.19156-0.18224im        0.0665074-0.0959896im     -0.337534-0.0736071im   -0.0204961+0.118286im      0.257617-0.0551368im   -0.0361466+0.281832im    -0.00961967-0.0462552im    -0.124774-0.077918im    -0.00101814+0.2943im         0.0581728+0.00123653im    0.0736746-0.096566im     0.0689805-0.226408im     -0.0173428-0.0237777im   -0.00091935+0.0633264im   -0.0179008-0.15743im      -0.100961-0.187846im      0.118216-0.0708665im    -0.0172246-0.285281im    0.0251296+0.0279731im     0.152977+0.0379874im   -0.0064224-0.0165003im   -0.0189887-0.0439916im      -0.112091+0.0980178im      0.131457+0.0438603im     -0.123756+0.135817im      0.197741-0.0329859im     -0.133754+0.189718im    -0.0972864-0.0486047im     0.0119641+0.0560512im  0.00860204-0.137508im      -0.149478+0.0879318im
    0.160678+0.0330479im   0.0364195-0.132086im        0.191815-0.0133926im     -0.114587-0.0613022im     0.144078-0.0499991im     0.108981-0.0467485im      0.15304-0.118556im        0.15941+0.0568706im   -0.0158235+0.156835im     -0.0285687-0.128215im       -0.107333+0.0876862im    -0.0726095-0.0344108im     0.336468+0.130902im    -0.00669838+0.0693185im     0.0080916+0.150876im      -0.13676+0.0852718im   -0.0797032-0.00105696im    -0.32987-0.314057im      0.0701407+0.0143513im  -0.0491053+0.0107441im    -0.152559+0.30556im     -0.0361078-0.157407im    -0.0139456-0.0424282im       0.048712+0.0734242im    0.00441963-0.100505im     -0.0968005+0.14068im      -0.158597+0.100373im      0.0833884-0.0215646im    -0.133609+0.0397328im     -0.197136+0.0183516im   0.0909302+0.0343204im     -0.133757+0.0584676im
   0.0210555-0.064645im     0.114819+0.161362im      -0.0360825-0.166528im      0.0205006-0.0473079im    0.0155564-0.0233057im      0.14515+0.0950125im    -0.083327+0.0491044im   -0.00267978-0.010384im     0.0279186-0.00239733im     0.162415-0.0840406im     -0.0385592+0.127119im       0.113875-0.26283im      0.0627088+0.0253563im    -0.0875793-0.0483316im     -0.187155+0.0883405im   -0.0562052-0.00828045im   -0.294987+0.190907im     -0.155164+0.110595im    -0.00186015+0.0416229im   -0.276114+0.0722264im    -0.122256-0.189618im     -0.150833+0.0948398im     0.100209+0.162157im      -0.0838909-0.130401im      -0.232977-0.173665im      -0.206075-0.170564im      0.123579-0.131617im     -0.0905306-0.0909167im    -0.167786-0.0457173im    -0.0112202+0.111153im    -0.169634-0.0636238im     0.0734298+0.132567im
  -0.0106017-0.0415296im   -0.176177+0.00231486im    -0.0358187+0.0351892im     -0.172769-0.313895im      0.055992+0.216312im    -0.0936525+0.0162076im     0.152678-0.0572368im       0.02146+0.106773im     -0.075375+0.227425im      -0.147602-0.115621im      -0.0260047-0.165904im      0.0275269+0.14674im      -0.152965-0.275532im      -0.207578-0.0940657im    -0.0680198+0.172954im      0.293622-0.00783784im   0.0902657+0.0655858im   -0.0342079+0.0729372im     0.0868007-0.0652438im  0.00210607-0.0772022im   -0.0101646-0.187837im     0.0130997-0.119157im     -0.117529+0.0552324im       -0.12465-0.0999107im    -0.0999214-0.109631im     0.00435034+0.0352804im   -0.0971529-0.123527im      0.0857391-0.0211497im    -0.248785+0.098818im      -0.116969+0.102791im     -0.01969-0.0820888im     -0.112593-0.152927im
    0.316246-0.0161894im   -0.104002-0.034965im       -0.198902-0.0955892im    -0.0535408+0.144248im      0.127566+0.128173im    -0.0920743-0.154854im      -0.25348-0.122906im     -0.0273632+0.0225505im    -0.258637+0.114729im      -0.129131-0.232038im        0.112074-0.00692745im    0.0708952-0.153046im     0.0307805+0.182502im       0.229849+0.114122im      0.0546407+0.0148094im     0.140204-0.32191im     -0.0635508+0.112376im     0.0288757+0.0591339im     -0.107361+0.0214104im  -0.0382171-0.0471509im     0.185153+0.0849241im   -0.0299087-0.0239321im     0.117988+0.000519467im   -0.0667469-0.138953im       0.172292-0.0436818im      -0.11598-0.0895283im    0.0396044-0.0550842im    -0.0248751+0.0374057im   -0.0535843+0.0699236im   -0.00130157-0.138617im     0.121162+0.0428516im     -0.065656-0.162837im
   0.0417105-0.0215407im    0.222176+0.0698327im     -0.0888722+0.206763im     -0.0627917-0.0220819im   -0.0977394+0.0705219im    -0.101588+0.0325422im   -0.0823437-0.0992696im      0.136732+0.0526453im   -0.0404641-0.0382373im    -0.0347221+0.0628295im       0.196345-0.157785im        0.18742+0.23016im      -0.180097-0.00837552im    0.0953897+0.20724im        -0.13677+0.186513im     -0.196665+0.13619im     -0.0559105+0.0575859im    -0.124227-0.0878454im    -0.0416961-0.101837im    -0.222759+0.221227im      0.103399+0.085856im    -0.0294643+0.197479im     0.0233182-0.232321im        0.167753-0.131567im    -0.00814438-0.0822446im     0.0995938-0.0364754im   -0.0935107-0.224121im      0.0811338+0.0650208im    0.0840829-0.108072im      0.0699721+0.151853im    0.0391362+0.0311976im     -0.184715-0.00676974im
  -0.0631425-0.183511im   -0.0669158+0.080441im        0.199408+0.0286223im     0.0151655+0.0036532im     0.067018-0.192542im    0.00167401+0.0538623im   -0.0759836+0.00281887im   0.00948926-0.0854067im   -0.0559796+0.0850518im      0.246373+0.0270047im      0.0589298+0.0826207im     -0.259383-0.0201646im    0.0688017+0.0457626im     -0.101436+0.128854im   -0.000455969+0.122966im      0.219372+0.0802379im     0.147191+0.122939im      0.181471-0.0375448im    -0.0968677+0.104992im    -0.120973+0.0821093im    0.0294145-0.0468817im    -0.321092-0.192563im     -0.152522-0.175382im       0.0228004-0.0472741im      0.124236+0.104451im       0.182025-0.131584im     0.0779236-0.0752454im     -0.202975+0.0854432im    -0.172176-0.0870649im       0.10323-0.023445im    0.0391586+0.141861im      -0.281206+0.0250716im
   0.0781787-0.27261im      0.068689-0.136732im       0.0600158-0.0138928im      0.148791-0.153133im     -0.144178+0.132967im      0.222088+0.0730002im    0.0532965-0.128275im       0.194547+0.0840575im    0.0959743-0.0680294im    -0.0654866-0.0286407im       0.108692-0.0330839im     -0.042213-0.146581im     -0.163775-0.0842886im     0.0710413-0.0711089im      0.191353-0.138288im     -0.168441+0.0419685im    -0.105937-0.153787im    -0.0391691+0.0756355im     -0.210347-0.0836573im  -0.0287959-0.0609825im    -0.114243-0.165501im     -0.308315-0.0307331im    0.0329539-0.0619019im       0.106135-0.0844468im     0.0764076+0.239793im    -0.00977193-0.11027im      -0.230702-0.011241im     -0.0390826-0.0230677im   -0.0626324+0.161661im      -0.157739-0.168709im    0.0986224-0.012884im      0.0554875-0.139154im
   0.0925022+0.0599672im  -0.0635315+0.0223108im      -0.181697+0.0424147im      0.103734+0.0965793im    0.0636863+0.125715im      0.141291-0.060362im    -0.0143212+0.114607im      0.0842475+0.0734513im    0.0236438+0.0493168im     0.0833564+0.128964im        0.148656+0.178366im     -0.0534424-0.0567295im    -0.104084-0.046581im      -0.127748-0.11837im        0.136176-0.00763913im    0.073949-0.0150096im     0.307471+0.121932im    -0.0705854-0.230629im     -0.0665754-0.0794874im   -0.132397-0.111036im     0.0409282+0.0967083im    0.0736673+0.111705im     -0.186442+0.296718im        0.150966-0.158787im      0.0101118-0.0414575im    -0.0912516+0.0190361im    -0.266288-0.0209393im     -0.331956-0.120908im      0.113672-0.195051im     -0.0168336+0.114505im     0.132043-0.0676521im    0.00950643+0.0621612im
   0.0650217-0.037011im    0.0252346+0.0586906im    -0.00455158+0.0311641im     -0.138439+0.170721im      0.127203+0.043943im     0.0592697-0.0989937im    0.0965755+0.0847275im     0.0373635+0.0927257im    -0.129124-0.26879im      -0.0111627-0.222155im       -0.033322+0.103021im       0.195248+0.0762822im    0.0936169-0.00812886im    -0.207512-0.186729im       0.179367-0.317407im     -0.130289+0.138009im      0.182951+0.014111im      0.072362+0.0981604im      0.111416-0.0180786im  0.00880914-0.107511im     0.0643297-0.0188892im   -0.0480968-0.033252im     0.0937095-0.086385im       -0.110349-0.201297im     -0.0811081+0.0494109im    0.00213245-0.150268im   -0.00729434-0.0957342im      0.174739+0.113809im   -0.00520471-0.0139623im      -0.11085+0.125938im    0.0134755+0.283529im      -0.218336+0.206486im
    0.224279+0.0779718im    0.240465+0.005411im       0.0486157+0.076734im     -0.0168221+0.0570504im     0.102523-0.0140636im    0.0578579+0.131399im     -0.056038+0.104742im      -0.253197+0.0670427im   -0.0720767+0.0324725im     -0.131487+0.020132im     -0.00793104-0.070645im      -0.123998+0.0674029im    -0.226876-0.0337749im    -0.0853789+0.0419587im      0.168139-0.231901im      0.182232+0.178654im     -0.121353-0.02585im      -0.134719+0.0368275im    -0.0793934+0.26883im     -0.030614+0.124652im     -0.121583+0.0320534im   -0.0933645-0.218749im     -0.150715+0.0434192im       0.130466-0.0233893im     -0.158554-0.0953814im     -0.212881+0.143225im      0.204483-0.0970395im     0.0224682+0.115772im       0.21057+0.0931338im     0.0566517-0.0243127im    0.165689-0.0760582im    -0.0334779-0.03623im
  -0.0497824-0.079853im   -0.0460724-0.172096im          0.1053+0.166035im      -0.165607+0.0436006im    -0.254025+0.117459im     -0.101607+0.0605694im     0.133661+0.0810297im     -0.253888-0.0890856im     0.298741-0.0274652im     -0.106462-0.0653144im      0.0879573+0.162974im      -0.164169-0.0550144im   -0.0953355+0.0913789im      -0.10248+0.0800263im     -0.226972+0.0642842im   0.00429492-0.0454666im   -0.0992176+0.0119223im   -0.0539229+0.04462im       -0.109692+0.0989455im  -0.0244654+0.0511397im     0.315094+0.0100585im     0.125716-0.106576im     0.0880495+0.195957im      0.00429133+0.0364316im     0.0563908+0.128605im      -0.198913-0.180543im    -0.0789962-0.020103im      0.0705063-0.106583im     0.0656737-0.0267297im     -0.177781+0.0166685im   0.0932723+0.162969im      -0.167822+0.105666im
   -0.165289+0.0356832im  -0.0793221-0.0082856im      -0.229154-0.0904654im     -0.188578+0.0555107im     0.058522-0.115924im     -0.148518-0.026597im     0.0802697+0.210565im      -0.173239-0.0166845im   -0.0846814-0.0508563im     0.0533899-0.0418165im      -0.145649-0.171418im      0.0424436+0.0372304im     0.216747-0.0204142im     0.0481097+0.050912im      0.0344953+0.110421im    0.00349053+0.00162703im   -0.171522-0.161412im     0.0884581-0.0261603im    -0.0736218+0.0968631im    -0.16986-0.0955688im   0.00613703+0.0425302im   -0.0744881-0.0334001im     0.024352-0.0856111im       0.145104-0.136556im      -0.337306+0.342872im      0.0107714-0.0981733im    -0.232974+0.0392295im    -0.0920984+0.0271011im    0.0236385-0.0738167im    -0.0756312+0.053009im     0.234749-0.225421im      0.0454311-0.0980453im
   0.0458511+0.06259im    -0.0441859-0.153091im       0.0267792-0.0241496im     0.0737949-0.149784im      0.334728-0.0759011im    -0.245052+0.0767177im     0.216637-0.0656763im     -0.133112-0.0699845im   -0.0346064-0.160596im      -0.294186+0.000154295im     0.023931+0.0752066im     -0.124425-0.109956im     -0.034668-0.0117038im     0.0798203+0.133423im       0.106425+0.0545262im   -0.0712844+0.206478im    -0.0841172-0.0233843im    0.0854373-0.010583im       0.119001-0.201779im    0.0378293+0.0262439im   -0.0526616+0.0244467im   0.00138016+0.142241im     0.0600909+0.171807im      -0.0293992-0.101943im      0.0261507-0.077053im       0.159614-0.169999im     0.0481466-0.191101im      -0.242113+0.0344234im     0.059801+0.00366786im   -0.0601195-0.218657im    -0.102077-0.172371im      -0.130801+0.187171im
   0.0336903-0.179922im     0.210177-0.0727713im      0.0904779+0.0932673im    -0.0944551-0.00734146im   0.0450784+0.042838im    -0.0674661-0.138541im    -0.0621269-0.148485im      -0.163205-0.10828im     -0.0299657+0.0645926im    -0.0515731-0.0259695im      -0.298044-0.0913425im     -0.144045+0.172951im      0.123884-0.00716945im     0.164129-0.0355131im    0.00501833-0.249177im    -0.0951488-0.018409im     0.0638761+0.0479661im    0.0899734-0.12905im       0.0263773-0.128528im     0.057563+0.0807065im      -0.0337-0.0883513im  -0.00882996-0.0601154im     0.083679+0.229488im         0.22475-0.00586624im     0.117225+0.0350679im    -0.0517441-0.150719im       -0.0154-0.146557im     -0.0960794-0.145032im     -0.198078-0.0121861im      0.181475+0.380768im   -0.0445359+0.009538im       0.154551-0.106352im
  0.00811277-0.17696im    -0.0978961-0.0673037im      0.0765015-0.292982im      0.0722203+0.0999184im   -0.0403418+0.123447im    -0.0523782+0.045513im     -0.142826+0.0331908im     0.0289727+0.0646665im    0.0074913+0.0155107im      0.105289+0.0306945im     -0.0517523+0.166429im      -0.016385-0.229323im     -0.192399-0.0648176im     0.0093278+0.151925im       0.074426-0.0102294im    0.0371456+0.120669im      0.198296-0.0619951im     0.111051-0.243001im       0.264985+0.0223757im  -0.0376403+0.275668im    0.00266445-0.0134119im     0.173548-0.0442359im     0.200221-0.0393334im      0.0999004+0.0201223im     -0.131555-0.0426324im     0.0402122-0.184104im      0.052977+0.0858544im      0.222428+0.12397im      0.0235218+0.0538326im     -0.169824+0.145407im    0.0403524-0.216524im     -0.0520052-0.191358im
    0.212806+0.0104141im   -0.157061-0.165681im        0.281283-0.00223415im    0.0259484+0.00166917im  -0.0754114+0.00525366im    -0.16461-0.0583511im    -0.177052+0.056815im    -0.00661701-0.0824767im   -0.0733145-0.0147366im    0.00533776-0.185989im        0.284409-0.122413im       0.134469+0.111163im    -0.0658529-0.130941im     0.00111501+0.0619241im     0.0329589-0.111473im    -0.0753376-0.0169139im   -0.0449821+0.0597104im    0.0690209-0.203903im      0.0393466+0.145578im    0.0304295-0.148004im    -0.0473473-0.0351352im   -0.0650549+0.0815727im   -0.0551832-0.0600462im      0.0143263+0.226829im      -0.257482+0.146865im      -0.174352+0.0038087im   -0.0666837+0.108691im      -0.171319-0.135309im    -0.0029392-0.0643532im      0.036661+0.035526im    -0.390574-0.0495398im     -0.130678+0.0502631im
   0.0581687-0.0109893im  -0.0865182+0.201884im       0.0225456-0.0462437im   -0.00867115-0.0967986im    -0.147519+0.00734834im  -0.0273466-0.139982im     -0.154812-0.110867im      -0.223071-0.122375im     -0.163918+0.120575im       0.141603-0.00157464im    -0.0484615+0.0243262im    -0.0761971+0.00769285im   -0.120302-0.24445im       0.0785714-0.0763521im     0.0476676+0.0173268im    -0.110364-0.0226294im   -0.0403423-0.0305212im    0.0353727+0.0914425im    -0.0132798-0.0897269im   0.0325677+0.122545im     -0.312325+0.0247643im    0.0426317-0.068576im      0.241485+0.108889im      -0.0158041-0.102101im      0.0377113+0.0770683im     0.0153258+0.204476im     -0.110362+0.0499167im      0.162129-0.181616im     0.0361634-0.285347im     0.00557435-0.180471im     0.169131+0.00456204im     -0.24908+0.264376im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.06192446183562856 - 0.14111691000067733im
 -0.013848671204148046 + 0.054283579759903736im
 -0.034925238501007615 + 0.08621961558097813im
    0.2730116962724369 + 0.08181834123791588im
   0.05991574914534753 + 0.2703111077107695im
   0.10309494256015173 + 0.044471283144793275im
   0.30660289185649986 + 0.0im
  0.037879466256070374 - 0.004288123340938265im
   -0.0502471804260695 + 0.20136825529608843im
   0.02856043904795853 - 0.07116663046161462im
   0.12033998132231773 - 0.06362761984276416im
   -0.2645791318692227 + 0.06396946545956124im
 -0.012621140071110398 + 0.08076433006759318im
  -0.09456828764335577 - 0.03262213813387227im
  0.008446174259106688 - 0.06345306076320248im
 -0.027390546651994266 + 0.051558691226397946im
  -0.22404752093026886 + 0.06234816250266867im
     0.086680256171664 - 0.15079900631854654im
   0.05855955046206462 - 0.10662488308508308im
    0.1354788924530867 - 0.2596308700540774im
  -0.08358764921807282 - 0.030611593671876373im
  -0.06697662312015203 + 0.06536934498001366im
 -0.022279554795571668 - 0.07296740100286572im
  -0.24624797769217538 - 0.0758399919734233im
   0.06934392531474143 + 0.13403379468703974im
   -0.1678532172164706 + 0.06488207002467136im
  0.001887600885172508 - 0.11233646995092211im
 -0.028520748207000853 + 0.12000874032401243im
    0.1488544551205773 - 0.16591607360423938im
 -0.039282587433765156 - 0.08709582963439001im
   0.22628682035016218 - 0.19165272545009507im
    0.1698290938863071 - 0.01871391489410365im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 2 July 2024 03:06">Tuesday 2 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0392859+0.0195168im    0.127615+0.151644im       0.230619-0.01786im      0.000414875+0.0286851im     -0.169457-0.0120304im    0.0212222+0.029878im    -0.0532721-0.0237236im    0.0093979-0.0857022im     0.050391-0.00923744im  0.000609837+0.170919im       0.251573+0.00987621im    -0.0874831-0.0791659im     0.0577841-0.0452029im     0.0856255-0.133449im       0.139791+0.404327im      0.0278407-0.101379im    0.0679792+0.0271186im      -0.131404+0.0740814im    -0.124706-0.133449im      0.0924486+0.196566im      0.123612-0.175123im    -0.0969579+0.0327954im     -0.201591+0.0122382im       0.0320814+0.142656im      -0.148129+0.0794066im     0.0904626+0.158936im      0.0144432+0.126341im       0.290183+0.0625727im   -0.0334792-0.0484134im      0.160532+0.200364im      -0.055419-0.0648901im    -0.244518+0.000974376im
 -0.0874666+0.163574im    0.0313809-0.277244im      0.0716341+0.230033im        0.011942-0.151953im     0.00884229+0.00823602im     0.11925+0.0264073im   0.00295879-0.20007im     -0.0715418+0.0206292im   -0.0159739+0.0131078im     0.0178731-0.0202694im      0.205611+0.142603im       -0.169228-0.0245282im        0.1347+0.0177197im     0.0342255+0.140813im       0.059213-0.090399im      -0.203702-0.0496403im    0.111585-0.136047im        0.272339+0.158932im     -0.192827+0.133575im      0.0439475+0.247369im     -0.109627+0.0716689im    -0.156478+0.0926001im     0.0109914-0.0818872im       0.0356201-0.180167im      -0.180674-0.132524im        0.09193+0.136431im       0.118418-0.232453im     -0.0346792+0.175487im     0.0496183+0.114118im     -0.0431437-0.0429994im      0.109901-0.0979875im   0.00616166-0.0131833im
 -0.0533858+0.162523im   -0.0272418+0.112446im      -0.126714-0.0718922im       0.228084-0.0433779im    -0.0111911+0.0410455im     -0.28778+0.0548141im     0.160957-0.0894771im   -0.0627108+0.0711999im     0.100313-0.157578im     -0.0305438-0.00132829im     0.176388-0.209691im      -0.0674391+0.112646im      -0.175062-0.0385625im    -0.0197159+0.0303032im     -0.102936-0.00584633im   -0.0198048-0.134198im     -0.21504+0.0977269im       0.091476-0.0181772im    0.0965092+0.0197832im    -0.0558977+0.184298im     -0.158448-0.157245im      0.112855-0.174445im      -0.144658-0.0281485im        0.188991-0.0612071im     -0.214792+0.0127495im    -0.0440639+0.0982763im     0.0459428+0.0541841im      0.177271+0.0496988im    0.0232552-0.166821im      -0.114257-0.157971im      -0.135589-0.0348497im     0.323482-0.0901483im
  -0.126875+0.0944781im  -0.0776181+0.0269448im     -0.127623+0.101341im       -0.122563+0.0535331im     -0.295423+0.19288im     -0.0311361+0.0986388im    -0.110194+0.0883557im    -0.193045-0.0724786im     0.134004-0.0821773im      0.312559+0.245332im    -0.00157738-0.126341im         0.15277+0.0751529im     0.0453056+0.0448616im    -0.0555343+0.213715im       0.122396-0.0519292im      0.138093-0.118548im   -0.0505196+0.01029im         0.153173+0.0231417im   -0.0971692+0.0271094im    0.00567555-0.0381868im     0.363162+0.196065im   -0.00443116+0.0685165im       0.16583+0.0984366im       0.0140207-0.107856im    -0.00828412+0.0839496im     -0.155289+0.106151im    -0.00378195+0.191822im     0.00300894+0.0429726im    0.0774827-0.0300378im     -0.111924+0.13476im       0.0518554-0.0483115im    0.0819525-0.045703im
 -0.0553459-0.131932im    0.0584099+0.101785im    -0.00120637-0.0389325im         0.1237-0.134074im      -0.184741-0.215656im       0.11423-0.176997im     -0.151762-0.0930781im    0.0204994+0.147074im     0.0137229-0.0620263im     -0.109811-0.0982808im    -0.0716329-0.097539im      -0.0506833+0.164852im       0.300208+0.102151im      0.0673521+0.0488854im       0.11517+0.0605917im    -0.0517909-0.174034im    0.0629844-0.000241305im     0.134994+0.0881364im     0.136265-0.100693im       0.128179-0.108401im       0.12593-0.0789367im     0.139698+0.0579258im     0.0993461+0.00807869im   -0.000597424+0.269262im       0.271325+0.0956361im    -0.0494902+0.148922im      0.0721737-0.18928im       0.0922719+0.202365im    -0.0460055-0.0969182im    -0.0370431-0.193736im       0.107738+0.0504394im     0.166694-0.142055im
  0.0447785+0.0420347im  -0.0858017+0.0817534im      0.088562-0.0420095im       0.155889-0.0688503im    -0.0378891+0.0536515im    0.0762459-0.204179im      0.189675+0.0386925im    0.0312935-0.0704448im     -0.16078-0.0309454im   -0.00979008-0.0653379im     0.0668504-0.0174727im     -0.0187481+0.0809533im     0.0391861+0.00340434im     0.065554-0.0946293im      0.120413-0.0280996im     0.0656153+0.0398702im    0.209901+0.268002im        0.139881+0.120831im     -0.114291+0.0379878im     0.0338775-0.23597im    -0.00742611+0.147951im      0.245129+0.0242359im     -0.261772-0.000712313im     0.0376103-0.179837im       0.019718-0.120625im      0.0277772-0.0623095im     0.0136782+0.215212im      -0.111399+0.214167im    -0.0336991+0.284649im       0.087055+0.203666im      -0.194591+0.0488343im     0.126937-0.226324im
   0.018508-0.0882687im  -0.0633638-0.216461im      0.0288631-0.0579617im     0.00997857+0.13181im       -0.202376-0.10215im      -0.172012-0.166879im      0.201936+0.0335561im    0.0033184+0.341824im    -0.0195967+0.165481im      0.0632362+0.0289308im      0.170911-0.131543im       0.0341244-0.203379im     -0.0595875-0.00210551im    -0.251046-0.132683im      -0.144018-0.0164503im    -0.0860856-0.0133471im   0.0620394+0.0748344im      0.0327593+0.20452im     -0.0452246+0.114223im      -0.047421-0.0530256im     0.126708+0.0274876im     -0.20824-0.055987im     -0.0226198-0.0795297im      -0.0253023+0.0595945im      0.185639+0.164742im       0.232642+0.00808164im    0.0841016-0.0365468im    -0.0978445-0.0312557im    0.0569388-0.146234im      -0.241323+0.10397im       -0.114515-0.00200684im  -0.0863863-0.146534im
   0.111412-0.0295748im    0.147261+0.0394192im      -0.17897-0.139552im       0.0420881-0.0707553im     0.0400972+0.0122816im     0.362848-0.0167136im     0.185833+0.13507im      -0.151822+0.134089im      0.110024-0.276397im     -0.0377518+0.219934im      0.0181464+0.0268165im      -0.118851+0.0830254im    -0.0571245-0.0145812im      0.170542+0.0495541im     -0.106539+0.0612815im     -0.151848-0.0079881im    0.126705+0.0128067im       0.019922-0.0405755im    0.0157609+0.227133im      -0.229328-0.0423807im   -0.0515853+0.137687im    -0.0447458+0.105104im      -0.124853-0.0628402im        0.192952+0.00922234im     0.133983+0.0402748im     -0.145569-0.212414im     -0.0578691-0.0132331im      0.100322+0.0228937im     0.153731-0.210912im     -0.0277192+0.0415725im      0.107367-0.0670952im    -0.201785-0.0267462im
   0.146474-0.0261595im    0.200308-0.027231im     -0.0538176+0.28284im        -0.246083+0.133241im      -0.093247-0.178995im    -0.0166656+0.0492138im    0.0273998-0.0138309im  -0.00612742+0.0373977im   -0.0369809-0.228324im      -0.238488-0.042963im      0.0285987-0.0276709im        0.12472-0.0250511im     -0.126819-0.101504im     -0.0312698+0.183094im      0.0885356-0.016222im      -0.136568+0.0639537im   -0.130405-0.11635im        0.0166207+0.150422im     0.0431396-0.22444im       0.0119295-0.175474im     0.0392728-0.214328im      0.023945+0.114039im     -0.0535856+0.0747515im      -0.0394758-0.234692im     -0.0123412+0.0146989im      0.149523-0.214031im      0.0488068+0.138765im    -0.00443203+0.295693im      0.135606-0.109821im     0.00661609+0.00422682im   -0.0681249+0.142462im     0.0336105+0.106246im
  -0.206169+0.24181im    -0.0165702-0.148042im      -0.216581-0.118778im      -0.0822745+0.00715528im    0.0034618-0.120253im     -0.104281+0.0290609im   0.00170648+0.154848im   -0.00558346-0.0905216im   -0.0620596-0.156097im       0.159352+0.112871im     -0.0587492+0.0701606im      0.0326547-0.0495726im    -0.0469813+0.0555632im     0.0618341-0.0612199im      0.087111+0.093107im       0.263561+0.106476im     0.297384+0.0593676im      0.0592018+0.0265648im     0.159406-0.0381552im      0.210339+0.0790011im    -0.140909-0.305941im     0.0212502-0.0693076im    -0.0800952-0.0866069im       -0.263255-0.0159072im      0.116574+0.0592703im    -0.0348215-0.165236im      0.0606693-0.174598im      0.0265731+0.10075im       0.206449+0.0590721im     -0.111858+0.00779721im   0.00598974-0.191919im    -0.0149572-0.0174457im
  -0.188936+0.0384306im   0.0301163+0.190114im      -0.231331+0.104945im        -0.20208+0.0276383im     0.0653409-0.129339im     -0.025008+0.0872064im    -0.161221-0.0230213im   -0.0449928+0.0777843im   -0.0969055+0.117062im      0.0537675+0.0369857im     0.0226207+0.00719249im    -0.0489291-0.10659im        0.111708-0.0147607im     -0.108585-0.106043im     -0.0567029+0.0233164im     -0.119167-0.260505im   -0.0915576+0.0311472im     -0.0271015+0.0456806im    0.0128995+0.23065im       0.0252016-0.0363257im   -0.0494858+0.206826im      0.309092-0.0426296im     -0.124026-0.1924im          -0.118302+0.0233694im     -0.018805-0.0467822im      0.157247-0.267059im       0.212981+0.0510486im       0.22069+0.00894352im   -0.255164+0.010318im     -0.0193889+0.128086im       0.112352-0.0355951im     0.025282+0.153987im
 -0.0100039-0.189409im     0.104896+0.0982853im     0.0303679+0.0294958im      -0.131685-0.110579im      0.0391682-0.0288826im    0.0443924+0.296357im    -0.0494733+0.0342277im    0.0651098-0.0182495im   -0.0885903+0.0356625im     0.0808868-0.0634335im    -0.0499053+0.0654189im     -0.0942198+0.18205im       0.0285579-0.20085im       -0.191264-0.0381652im   -0.00985256-0.110276im      0.0135498+0.190816im     0.142876-0.0593269im       0.177461+0.28928im      -0.120208-0.00941605im     -0.17411+0.195468im     0.0260356-0.0843443im     0.263533+0.0917887im    -0.0613438-0.144934im        -0.163505+0.128929im     -0.0808128+0.105977im     -0.0631035+0.0476219im     -0.157592+0.0728456im     -0.117488-0.163166im     0.0608211-0.265884im      0.0383974+0.0184078im     -0.133807-0.0697603im    0.0698768-0.201785im
   0.133893+0.0337718im  -0.0294637-0.374276im      0.0493843-0.1379im          0.123622+0.122404im     -0.0237339+0.163032im     0.0563188+0.20367im      -0.122838-0.0423418im    -0.240407+0.0247098im   -0.0208185+0.041713im     -0.0537797+0.0575968im    -0.0977553+0.0525214im      -0.189727+0.0410613im      0.115279-0.0633628im     0.0911944-0.185728im      0.0461918-0.0577975im     0.0969923-0.154315im    0.0223514-0.0343953im     -0.0804582+0.153335im      0.311458-0.108901im      0.0158185+0.135776im      0.215869+0.0320694im     0.135349-0.224456im     -0.0638387-0.005657im        0.0433697-0.147486im    0.000220782-0.122996im       0.146751-0.127595im      -0.194337+0.0161706im    -0.0525609+0.0825702im   -0.0861016-0.123793im     -0.0313691+0.0158824im     0.0773393+0.221636im    -0.0110412-0.0307629im
  -0.161742+0.193427im    0.0473101+0.0847718im     0.0210683+0.17378im         0.171255+0.0411036im     -0.020845+0.00748166im    0.167834+0.0721796im       0.1099+0.102082im    -0.0791956-0.0811169im    -0.064966+0.292587im      -0.145308+0.0434306im     -0.158756-0.209536im      -0.0500822+0.148642im      -0.180585+0.124095im       -0.15592-0.20372im       0.0168273-0.0525414im    -0.0526881+0.024817im    -0.180735+0.0144477im    -0.00113018+0.0942739im     0.170217+0.068856im     -0.0253679-0.0889988im   -0.0183538-0.13981im      0.0790381+0.240251im      -0.131409+0.0541437im       -0.116007-0.0839345im     0.0479777-0.0713601im    0.00481158+0.297044im     -0.0563807+0.0314806im     0.0301947+0.021516im      0.126201+0.0520445im     -0.144887-0.0180472im      0.226544-0.0490945im    -0.256299+0.0123894im
 -0.0759775+0.0974781im    0.113446-0.0140216im    0.00697871-0.184455im      -0.0762616+0.0752123im      0.157355+0.0219212im    0.0293271+0.0878066im    0.0540009-0.0181957im   -0.0115565-0.195258im     -0.161974-0.0140764im   -0.00856179+0.103686im       0.241807+0.15753im        0.0107707+0.125081im       0.101879-0.176338im      -0.155269-0.00975793im   -0.0565094-0.0705286im     -0.082677-0.0298974im    0.105811+0.284829im        0.206445-0.170048im      0.210543-0.0956117im     -0.157707-0.145587im     0.0531235+0.0091385im    -0.253759+0.168839im    -0.00621313-0.0112565im       -0.121534+0.0352785im     0.0667357+0.0536363im  -0.000480824+0.201578im     0.00704464-0.0670727im     0.0843688+0.0416554im     -0.15955-0.0667468im     -0.080011+0.0604665im    -0.0901411+0.252505im      0.138413+0.255257im
  -0.114972-0.0957461im   0.0570574+0.0139327im      0.353979+0.104474im       0.0160605-0.053467im       0.133651-0.192404im    -0.0880168-0.0514495im   -0.0447618+0.0509983im    0.0625305+0.206032im     -0.252505-0.0586183im     0.0949715+0.188346im      -0.134498-0.148831im      -0.0603572+0.130643im      -0.178603-0.160558im     -0.0410538+0.204018im       0.165104-0.00205703im      0.16418-0.363061im    0.0349728+0.0978839im      0.0470673-0.125705im      0.131222-0.0105981im    0.00727708+0.0476703im   -0.0620324+0.0912811im    -0.148658+0.00746399im   0.00536567-0.163215im        0.0480701+0.0757446im    -0.0470426-0.191226im      0.0782522-0.076448im     -0.0504056+0.0795388im     -0.125671-0.074171im      0.217374-0.00347426im    0.0786271+0.0226666im     0.0769831+0.00706731im  -0.0150868+0.0182095im
  -0.149658+0.121835im   -0.0866829-0.0165127im     0.0329839-0.00901378im      0.160932-0.279208im      0.0504647-0.0912019im   0.00368461+0.140258im      0.109023+0.246761im    -0.0278033+0.150414im     -0.114126-0.0652281im    0.00242594-0.101259im      0.0509863+0.0468199im     -0.0465178-0.221702im    -0.00584803-0.0439027im   -0.00860461+0.135447im       0.222769+0.182276im       0.175292+0.0757032im   -0.104186-0.0713772im      0.0375109-0.110048im      -0.10099-0.0972197im     -0.265485-0.148646im      0.215742+0.129806im     0.0626341-0.0052805im     -0.150393+0.184986im        -0.108069-0.0658217im    -0.0845282+0.108106im       0.170424-0.0307786im    -0.0619904-0.144802im     -0.0248051-0.00529753im   -0.222881-0.0820274im    -0.0393808-0.270264im     0.00270339-0.0644474im   -0.0852541+0.035934im
  -0.104219-0.214189im   -0.0737272+0.120678im       0.178379-0.00406568im     -0.252668+0.0286691im    -0.0509226+0.143845im    -0.0108649+0.218133im      0.285694-0.0364511im    -0.209112+0.13042im       0.116631+0.0125417im     0.0115515+0.0727512im    -0.0890105-0.0824125im   -0.000621033+0.130075im     -0.0551878-0.136767im       0.175643-0.25516im       0.0682132+0.225077im      -0.048483+0.0768727im   0.0941854-0.173113im       0.0160274-0.0776106im    0.0897296-0.0384429im    -0.0195762-0.125406im     -0.127637+0.0186266im  -0.00197052-0.0318681im     0.0587094+0.104276im       0.00719163+0.0946123im     -0.115086-0.0502043im     0.0395805+0.0420133im      0.230132-0.154824im      -0.241146+0.136057im     -0.104239+0.0609012im     -0.143023+0.0971729im     0.0646309-0.091519im      0.188757+0.0539009im
  -0.126426-0.121284im     0.279753+0.0617907im     -0.144073+0.0430376im       0.308211-0.0993602im     -0.215281-0.198998im     -0.116598+0.0871905im     0.154768+0.0698533im    -0.110687+0.128496im     0.0317418+0.0306669im    -0.0207841+0.157587im      0.0143901+0.18987im        -0.146719+0.0468012im    -0.0287673+0.155618im        0.12319-0.0701976im    -0.0298281-0.162551im     -0.0466671+0.100354im   -0.0477635-0.173873im        0.113995-0.231767im     0.0268809+0.0643389im      0.176949-0.0570205im    0.0702964-0.0736788im   -0.0602075-0.0153943im      0.198023-0.0906971im       -0.151305-0.0341322im    -0.0998488+0.0284169im      0.130058-0.0203083im     -0.177269+0.0721238im    -0.0219742-0.0801093im   -0.0864993+0.0995525im      0.191229+0.221044im      -0.117743+0.0799686im    0.0622449+0.0122867im
   0.277908-0.151718im    0.0562418+0.145963im     -0.0194797+0.0106644im     -0.0264178-0.053618im     -0.0508429+0.105328im    -0.0391464-0.0531888im   -0.0866962-0.147026im     0.0224949-0.154639im     -0.117936-0.0934517im     0.0929979+0.043123im       0.156881-0.0093097im    -0.00223729-0.0986485im      -0.19404+0.289296im     -0.0015058-0.04822im       0.0456015-0.129382im      0.0768441-0.0399604im  -0.0218792-0.0694612im       0.235002-0.0242426im    0.0688642-0.133956im     -0.0920664-0.136263im      0.111176-0.0913024im    0.0753212-0.132177im      -0.225851-0.297154im         0.135173+0.053934im      -0.101184+0.205701im      0.0401066+0.0159226im    -0.0352513-0.186447im      -0.198894-0.0697845im   -0.0205617+0.113109im      -0.105683+0.0389854im      0.283953-0.0538331im    -0.062252+0.136793im
 -0.0253413-0.0659135im   0.0921315-0.125332im      -0.190783+0.0105636im      0.0279186+0.112722im      0.0198464+0.356165im     0.0555265-0.206946im     0.0434615+0.151538im     0.0525007+0.00252499im   -0.195184+0.0750441im     -0.303366+0.0543235im    -0.0541642-0.0608781im      0.0269165-0.0211189im      0.165306+0.126461im       -0.14591+0.130427im       0.070262+0.191308im     -0.0383688-0.164759im     0.111219-0.0538951im      -0.028294-0.0898966im    0.0941009+0.0368077im     0.0215355+0.0235744im  -0.00288887-0.0664891im    0.0324739+0.174574im      0.0916712-0.0549085im      -0.0566023+0.136242im      -0.471883+0.128234im     -0.0385186-0.135173im     -0.0202675+0.0101405im     -0.109888-0.0227119im   -0.0242513+0.000677566im   -0.121313-0.0226299im      -0.12834-0.0344775im    0.0242267-0.105754im
   0.215027-0.119023im   0.00164626-0.171493im       -0.14039-0.0771813im       -0.10968+0.226205im      0.0874559-0.149385im     -0.191439+0.128049im    -0.0569481-0.102771im    -0.0457951+0.246049im      0.159392+0.00153553im     0.128742+0.0688786im    -0.0254456+0.151822im       0.0834333+0.160887im      0.0662324+0.125388im      0.0508147+0.099177im       0.222917+0.0957585im    -0.0488643-0.0227371im   -0.112009+0.173811im       0.0352009-0.0685339im    -0.108155+0.233393im     -0.0777414-0.121894im    -0.0346794-0.155875im     0.0491251+0.0820647im     -0.230801+0.0299005im       -0.128795+0.119761im      -0.108711-0.199206im     -0.0788156+0.163877im      -0.131818+0.0155338im    -0.0379754+0.0219296im   -0.0775629+0.181574im     -0.0643602-0.145189im     -0.0286699+0.0667963im    -0.155316-0.105243im
  -0.202733+0.0240249im   -0.119276-0.144803im      -0.116158-0.0584039im      -0.105984+0.0338681im     0.0429113+0.0306206im     0.109914-0.0915375im   -0.0409415-0.0879652im    0.0226801-0.00274839im    0.041341-0.0909498im     -0.100836-0.138154im      -0.218218-0.0847618im       -0.26635+0.0160478im    -0.0809879+0.144858im       0.129293+0.0613631im      0.146487+0.0872392im     -0.129794+0.161917im    0.0432099-0.115694im       0.0311177-0.0318573im    -0.114968-0.0988946im     -0.103698-0.0751069im    0.0818115+0.118479im     -0.114918-0.224733im      -0.159499-0.223184im        -0.134274+0.154385im    -0.00609761-0.0106528im      0.133801+0.20433im        0.050384+0.302148im       0.145389-0.139865im      0.207529+0.0119824im     -0.114437+0.0540031im    -0.0667675+0.131482im      0.139554+0.149356im
  -0.046703+0.126816im      0.21851-0.120748im     -0.0152391-0.000128686im   -0.0201444-0.0192663im      0.145801+0.0852613im    -0.223497-0.0011472im   -0.0871239+0.01623im      0.0296083+0.184849im      0.087984-0.130957im     -0.0965982-0.0828281im     -0.105267-0.0224299im      0.0267101-0.129584im      -0.100885-0.0402544im      0.252283-0.201377im      -0.246501-0.089069im      0.0947455-0.122537im   -0.0191306-0.0348227im       0.292011+0.194468im     0.0133468-0.181104im    -0.00754155+0.0756365im    0.0354227+0.180948im    -0.0215007+0.308287im     -0.0830366+0.208893im       0.00595004+0.269981im      0.0023362+0.0967137im    -0.0631293-0.0295052im    -0.0240531+0.140604im      0.0181756-0.0358792im   -0.0427022+0.241851im     -0.0130403+0.0178606im    0.00945068-0.0378113im   -0.0411871+0.0398104im
 -0.0120903-0.0130136im  -0.0289396+0.116439im       0.134978+0.0934863im       0.116634-0.0631957im    -0.0445282+0.24249im      0.0416484+0.0430511im    -0.294184-0.0156724im    0.0703249+0.229941im     0.0273318+0.0642995im    -0.0932737+0.182103im      0.0554957+0.304754im         0.07058+0.0716129im     -0.257543+0.0583251im    -0.0212253+0.072041im     -0.0918563+0.0525812im     0.0285438-0.140863im     0.245968-0.227988im       -0.165352+0.0245194im   -0.0159832+0.13331im      -0.0228982-0.0431162im    0.0039669-0.0844015im     0.070012+0.057663im      -0.162624+0.0525332im      -0.0495551-0.146071im       0.229559+0.0559117im    0.00186816+0.0620886im     0.0109834-0.0230993im     0.0465567-0.0606351im    0.0289075+0.109411im      -0.183671-0.102124im      -0.247716+0.0616249im     0.189732+0.134937im
 -0.0100467+0.0212388im    0.137023-0.0701742im     -0.179565+0.0219145im        0.19568-0.1404im       0.00708311+0.168131im     -0.114734-0.0369156im    -0.243899-0.0863733im   -0.0912445+0.00890601im  -0.0941556+0.179605im     -0.0425941-0.244616im       0.199425+0.0749868im      0.0562311+0.197443im      -0.274688-0.147384im       0.154085-0.00880343im     0.172662+0.202954im     -0.0921806+0.0449095im   -0.132017+0.227833im      -0.0222944-0.00749073im   -0.118896+0.025235im    -0.00323101-0.0209671im   0.00994837+0.0793484im    0.0456551-0.0945054im        0.1602+0.0501723im       -0.106344+0.150461im      0.0872569-0.0211324im    -0.0489849-0.0993037im     0.0264358-0.0774906im     -0.187207+0.116662im      0.162943-0.174531im     -0.0410611+0.221988im      0.0254444-0.062287im     -0.084624+0.11833im
 -0.0287187-0.0111864im   -0.150204-0.21525im      -0.0135404-0.175799im      -0.0538423-0.202112im      -0.121785-0.182334im     0.0832144+0.0368524im  -0.00875592-0.0233411im   -0.0748018-0.00566143im   -0.119071+0.0197742im     -0.135414-0.103936im      -0.149106+0.0104454im       0.241668-0.00723452im    0.0204748-0.0820574im     0.0663455+0.110448im     -0.0952361+0.149887im       0.104226-0.17222im     -0.165951-0.0734651im      0.0317332+0.215413im      0.058884+0.193253im      -0.177573-0.112834im    -0.0633918-0.188666im    -0.0206725-0.00657394im   -0.0393681+0.00537408im      0.0957485-0.101291im     -0.0976442+0.148987im      -0.110963+0.131783im     -0.0296067-0.144934im      0.0710266-0.173516im     0.0258526+0.111253im       0.172601+0.404826im    -0.00109529+0.0333866im     0.115247+0.0794598im
 -0.0952832+0.0667652im   0.0863576+0.101296im      0.0668983+0.017622im       0.0124042-0.104036im      0.0529559-0.1127im        0.180736-0.0589818im    -0.168168-0.215295im     -0.145514+0.120591im      0.112274+0.25243im       0.0980955-0.0466333im    -0.0129641+0.0139951im       0.041835-0.3773im          0.10954-0.0593708im     0.0386306-0.154803im       0.132771+0.0642461im     0.0644783+0.116738im    0.0117149+0.0615492im       0.199078-0.141731im     0.0471303-0.00574997im     0.046679-0.0879676im  -0.00972064-0.211233im    -0.0475183+0.105151im     -0.0331084-0.00340293im       0.205791-0.100136im      -0.119532-0.0898564im     -0.223831-0.182594im     -0.0134308+0.159805im     -0.0585926-0.158537im      0.103205-0.140838im      -0.244903-0.00568889im   -0.0636994+0.168565im     0.0786385-0.0360333im
  0.0964827+0.2142im     -0.0102575+0.132901im     -0.0302982-0.0957416im     -0.0987616+0.0428099im   -0.00365798-0.0268556im   -0.0470936+0.0150978im     -0.23489+0.103324im    -0.0754247+0.215554im     -0.336017+0.157746im       0.176463+0.0691106im   -0.00273695-0.0173432im      -0.240054+0.0821891im     0.0150139+0.125582im      0.0519092+0.135244im      -0.153662+0.0948517im     0.0283912+0.282648im    0.0418268-0.0486747im      0.0301172+0.181415im      0.122923+0.00680689im    -0.148178-0.121im        -0.140639-0.0714696im   -0.0570058-0.0836001im      0.261377+0.0378331im        0.276648+0.0515984im    -0.0931307+0.0530275im     0.0493332+0.0665825im     0.0240859+0.157829im     0.00703638+0.207789im    -0.0761289+0.0925578im     0.0625532-0.063893im     -0.0608452-0.0123067im   -0.0864597+0.0314478im
   0.302531+0.0561387im    0.142125-0.0656429im  -0.000900246-0.144543im        0.179904-0.0474225im   0.000487725+0.00653609im  -0.0166663+0.134235im    -0.0180905-0.0955937im     0.154262-0.0920547im   -0.0993016+0.022481im     -0.0791388+0.0747263im     -0.081696+0.00723428im     0.0968921-0.195908im      0.0349396-0.202511im     -0.0916441+0.0071355im      0.172342+0.0402133im    -0.0101189+0.0781597im  -0.0488367-0.214721im       0.0344425-0.0541686im     0.140443+0.256274im      0.0230552-0.0169228im   -0.0129282+0.0601572im    -0.172964-0.0291982im    -0.0297725-0.0434346im       -0.106269+0.0666005im      0.144698+0.0060513im    -0.0269744+0.0708631im      0.077797+0.357997im     -0.0173786+0.155181im     -0.087704+0.00584444im   -0.0314995-0.0193543im      0.185049-0.350288im      0.231387-0.0593884im
 -0.0679824-0.0120556im   -0.108367+0.0206554im      0.259764-0.0978645im     -0.0543489-0.0127302im    -0.0599068+0.0109061im    -0.209412+0.0589409im    0.0566957+0.0399969im    -0.335551+0.0504542im   -0.0635497-0.128426im      -0.160582-0.294154im       0.167288+0.205921im       0.0699162+0.087765im       0.022433+0.224186im      -0.185786+0.0794119im      0.204585+0.00986279im     -0.12259+0.0842438im  0.00318777-0.0568212im     0.00599166-0.0660892im     0.209868-0.0580191im      -0.04893+0.185421im    -0.0709796+0.0630628im    0.0421725+0.118769im      0.0709058-0.106757im        0.0513093-0.0237455im       0.16859+0.0558203im     -0.141911-0.142065im      0.0691137+0.1961im         0.137501-0.148737im    -0.0169734+0.137631im     -0.0822398+0.064957im      0.0874461-0.0411527im    -0.128874-0.10855im
 -0.0581692-0.153371im    0.0904864-0.018423im     -0.0438593+0.0171451im      -0.197357-0.00444154im      0.10539+0.172357im     -0.055906+0.0217239im     0.238717-0.0287981im    0.0971889+0.128761im    -0.0527871+0.150527im    -0.00606341-0.128644im      0.0540838+0.268592im        -0.16852-0.0617707im    -0.0967983+0.00313972im   -0.0188804+0.194487im     -0.0221715-0.000352005im    0.177004+0.0754241im   0.0513277+0.147014im      -0.0515222+0.0603876im    0.0529651+0.074023im       0.332262-0.152079im     0.0786536+0.0152849im    0.0425424+0.0101547im    -0.0540525+0.191692im         0.167456-0.00970152im   -0.0382562+0.0367964im     0.0659677+0.0932781im     -0.142593+0.00257835im     0.268561-0.0466171im     0.114022-0.110827im      0.0170232+0.0511926im      0.370214-0.0228992im     0.173577-0.0763813im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.0763617757840299 - 0.03932826306447537im
  0.015079581364597992 - 0.2777594776638438im
  -0.13226610523653082 - 0.10352208830884939im
  -0.07368318970288741 + 0.17867983652058855im
    0.0592180118249341 - 0.0736243294078437im
 -0.007544205942553643 + 0.007977115381296487im
     -0.19396841099469 - 0.15507374490690307im
   0.04856644201421067 - 0.13801601233920616im
   0.37090853980218497 + 0.0im
  0.054629897487809734 + 0.06075616800296928im
  -0.14410467845322475 + 0.020813135342806342im
  0.008120578401424876 + 0.062439446426143665im
  -0.18966882679475836 - 0.05521668604331464im
   -0.1487925766710065 + 0.004494251866325515im
 -0.041688542746914865 - 0.21676410211186734im
   0.14985043862802241 + 0.03816191656869426im
   0.10611463606615483 + 0.02493952987085197im
    0.0976062002765437 + 0.08008885811781749im
   0.09362006075043673 + 0.1446306564077871im
   0.21222870318985407 + 0.11823378140622137im
   0.18563773617976348 + 0.08940459018993478im
   0.15617104585651026 + 0.003385518584541078im
   0.08910793791964372 - 0.04215903955606808im
  -0.09795513501406387 + 0.09619481221176067im
  -0.14851923477788043 + 0.14637632722006494im
  -0.06145505736743727 + 0.05144220492180742im
 -0.042272532093748164 - 0.021408756721489203im
   -0.2557634717154213 + 0.2622799453528034im
 -0.015266077066820349 - 0.08255243475099361im
  0.016809335049940918 - 0.19508728275580633im
 -0.009999139141314584 - 0.0934877782060529im
 -0.017793181280933643 + 0.0383038647063104im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 03:58">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

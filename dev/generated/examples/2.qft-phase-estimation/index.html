<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.188507-0.21757im        0.0675409+0.0530179im    -0.265988-0.131807im     -0.0497918-0.0160101im        0.17971-0.154441im     0.178227+0.0161865im    -0.0623093-0.0253243im     -0.116728-0.329894im      0.0107796-0.0691283im    0.272053+0.0251688im   -0.0278475+0.0194728im    0.0969538+0.203339im     -0.110734+0.100716im       0.215971-0.0244492im    -0.0796102+0.223396im      0.0516965-0.0882243im      0.141908+0.158135im     -0.121695-0.0264188im    -0.0244313-0.096679im      0.0590313-0.248566im      -0.0628534-0.208698im      0.0937608+0.0489175im   -0.0195255+0.0381311im    0.0699689-0.065916im      -0.153949+0.0266909im    0.0223333+0.0552903im     0.0496134+0.0289984im    0.0766849+0.0300698im   -0.000585293-0.0705839im     0.0819657+0.00778064im   -0.0337053-0.0608004im     0.0167109-0.274581im
   0.0765572-0.0405293im      -0.148382-0.278305im     -0.028738-0.0267703im     0.0217925+0.0031273im     -0.0517941+0.0670664im   -0.127658-0.151542im       0.109192-0.0357975im   -0.00238917-0.0761189im     0.0271387+0.0915508im  0.00727384+0.0332497im    0.0968296-0.175935im     -0.155517+0.134019im     0.0476565-0.0921476im    -0.0959725+0.139511im       0.245932+0.16606im      0.00471945-0.145323im      -0.201366+0.170638im    -0.0817068-0.128084im      -0.033345+0.189563im       -0.15045+0.00785915im      0.112598+0.074583im      0.0245984-0.0197851im    0.0920967+0.0260609im   -0.0462349+0.00112889im    -0.180988+0.0794807im     -0.25431+0.0129832im      0.107914+0.257446im      0.121051-0.115678im        0.137171+0.0159767im      0.210675-0.143639im       0.122674+0.241681im      -0.155046-0.0983716im
  -0.0625795-0.0510138im    -0.00541436-0.0645129im   -0.0979563-0.267528im      0.0853176-0.0349705im     -0.0266693+0.0834872im   -0.092645+0.00167718im   -0.0216357+0.191881im      0.0122628-0.234762im     -0.0146076+0.0462897im   -0.072557+0.0899483im   -0.0535928+0.197212im     0.0872652+0.0956288im  -0.00646853-0.252337im      -0.045229-0.0412731im     0.0729715-0.0578952im         0.012-0.133359im       0.162382-0.219544im      0.149807+0.0751343im     -0.142944-0.157003im      0.0834961+0.125169im     -0.00694698+0.146996im     -0.0092167+0.0801934im     0.138656+0.141691im      0.196979-0.359808im      -0.128013-0.0595691im   -0.0733715+0.0799307im     -0.101557+0.111248im     0.0625696-0.167195im       0.0412299-0.0343474im     -0.243339+0.0986375im      0.107636-0.0268851im     -0.172776+0.127022im
    0.131242-0.136311im       -0.364476+0.020964im     -0.061323+0.02678im        0.224288-0.061948im       -0.428572-0.0431933im   0.0333698+0.121647im      0.0796514-0.0510881im    -0.0296293-0.165312im      0.0973217+0.0676167im  -0.0936543+0.0885266im   -0.0361939+0.0451024im    -0.100709-0.0309522im    0.0540547+0.100939im     -0.0591344-0.0466006im     -0.107221+0.0387949im   -0.00047941+0.186087im      0.0722871-0.0315302im    -0.246667+0.0453322im    -0.0930433-0.00973054im   -0.0497124-0.0270644im   -0.000149734+0.0322767im  -0.000342141+0.111532im     0.0279543-0.326464im    0.00203439-0.0255309im    -0.0735924-0.213956im      0.099237+0.0385037im     0.0308907-0.0898953im    0.0377287-0.134357im      0.00614641-0.0292602im     -0.109961+0.00200715im    -0.260496+0.209832im      0.0589091+0.0149036im
  -0.0184575-0.12344im       -0.0901364-0.0788512im   -0.0220073-0.187058im       0.229578+0.00168289im  -0.000821142-0.340035im     0.133503+0.00626097im   0.00802418+0.130481im      -0.123641+0.177801im       0.161681-0.152582im     0.014754+0.00861201im   -0.160857+0.0194755im     0.150281-0.125063im      0.104097+0.0872665im      0.114676-0.0388692im     0.0401402+0.0316385im      -0.01081+0.00618345im    -0.112796+0.0349257im   -0.0593941+0.103782im      0.0317887+0.120579im       0.354558+0.01823im         0.139492+0.182581im      0.0695869-0.0458236im  -0.00301858+0.0855863im    0.0864418+0.155186im      0.0694781+0.0272227im    0.0323549-0.185332im    -0.00445515+0.295029im     -0.157112-0.0178886im      0.0160187+0.0779739im     -0.113622+0.0205847im      0.213885+0.173784im       0.130896-0.0102595im
 -0.00493137+0.16196im        0.0802439-0.219797im     -0.108898-0.210072im      0.0331737-0.118631im      -0.0500443+0.031013im    -0.133565-0.425904im     -0.0941693-0.140637im      -0.133365+0.122133im       0.186346-0.0416068im  -0.0442837+0.0570233im   -0.0926704+0.0689326im   -0.0162893+0.104685im      -0.19295+0.0319534im   -0.00955181-0.1822im        -0.181832+0.105115im      0.0331827-0.0726008im     -0.139935-0.0611093im   -0.0368955-0.0067404im      0.196588-0.0182791im     -0.183229+0.0404146im      0.0190897-0.0446912im      0.111942-0.0884328im    -0.112776-0.176526im    -0.0297064-0.192139im       0.186231-0.0473757im     0.147266+0.0847616im    -0.0740604-0.0249995im    0.0848426+0.00949704im    0.00272403-0.110432im      -0.137838-0.162226im       0.125161+0.00400541im     0.197315-0.0299097im
   -0.143966+0.0207718im      -0.224249+0.0812661im   -0.0576793+0.283551im      -0.097227+0.01282im         0.137321-0.193967im    0.0281115+0.119342im      -0.093678-0.391051im      0.0695972-0.0298132im     0.0339355-0.107947im    0.0414629-0.00664638im    0.179335+0.0225875im   -0.0117302-0.0231345im   -0.0769935-0.21343im       0.0815974-0.0676127im   -0.00416216-0.00309648im     0.108832-0.109652im     -0.0950307+0.136619im     0.0755446-0.0825872im     0.0210227-0.0624465im    -0.0479338-0.0196993im        0.03912+0.226658im      0.0699875-0.117989im      0.130136-0.0899136im      0.26328-0.087862im      0.0254887+0.0490753im    0.0122093-0.262437im      -0.255105+0.018577im      0.074311-0.0481111im      0.0730475-0.245172im      -0.111441-0.0137435im    -0.0720785+0.0537928im     0.0362686+0.0362915im
   -0.128472-0.101966im       -0.165549-0.0885877im   -0.0331933-0.0341002im     0.0053758-0.0505672im     -0.0131548-0.143935im     0.166621-0.0145746im     0.0284084-0.23371im        0.256146-0.192475im     -0.0248624-0.0989069im    -0.22769+0.0264833im    -0.154737+0.0796241im     0.190876+0.195552im     -0.215782+0.0164482im     0.0705758+0.0553853im      0.151472+0.0547427im     0.0447193+0.0197814im   -0.00441246-0.185626im      0.217266+0.192453im      0.0810181+0.0671814im      -0.25296+0.0529408im     -0.0388252-0.0376638im     -0.139689+0.0885602im     0.024297+0.0717969im    -0.264606+0.142599im       0.164032-0.0602706im    -0.165662+0.0256975im      -0.08212+0.0563104im    -0.128224+0.0219609im     -0.0707526+0.0731362im      0.111508+0.163575im     -0.0113086+0.028774im      0.0879846-0.0907678im
   -0.180185+0.00518969im   -0.00397175-0.0373817im   -0.0211399-0.11159im       0.0428572+0.0858772im      0.0761249+0.0935202im    0.133678+0.172293im      -0.100814+0.101986im       0.115681-0.0375517im     0.0302066-0.214564im   -0.0849673-0.204893im      0.203396-0.0687369im     0.122627+0.0810624im    0.0213813-0.0655038im    -0.0627896-0.0464056im     0.0681141+0.0769427im     -0.110891-0.0592799im    -0.0484239-0.0792327im    0.0254553-0.178597im     -0.0633191-0.236599im     -0.0363373-0.0478872im      0.0256827+0.110435im      -0.115853+0.217714im     -0.247253-0.256599im   -0.00504082-0.0500732im      0.156684+0.0957985im     0.142066-0.0408684im      0.280619-0.0345078im    0.0312583+0.0223858im       0.375811+0.15763im      -0.0226957-0.0836066im     0.0405255+0.098312im      0.0655696-0.106375im
  -0.0397929+0.0234304im     -0.0101529-0.141638im     -0.166935+0.0875679im      0.155483+0.356719im        -0.12833+0.14947im    -0.0145104-0.040286im       0.142936+0.00285503im  -0.00461568-0.0149768im     0.0211721+0.13599im     0.0687039-0.242714im      0.211783+0.00323695im   0.0509139-0.095547im     -0.113852-0.0565182im      0.128213-0.0144185im    -0.0379551-0.0962035im       -0.1565+0.0582753im     0.0582258+0.168733im     0.0627924+0.117978im    -0.00252208+0.0330459im     0.0854183+0.109577im       -0.160581+0.0531617im      -0.16236-0.0318833im    -0.134656+0.0150662im     0.139563-0.0215473im    -0.0974953-0.0620366im    -0.115148+0.224179im      -0.195564-0.0853971im    -0.106827+0.0381303im    -0.00568087-0.112317im      0.0682521+0.114812im        0.20304+0.0954696im      0.296157-0.225054im
   -0.161599-0.0720917im      0.0506704-0.0154892im     0.134477+0.0287233im      0.179048+0.0398341im       0.130981-0.0901017im  -0.0130032-0.185269im     -0.0894329-0.11636im        0.133846-0.126749im       0.128308-0.128379im    0.0841517+0.181236im      0.177243-0.130679im    -0.0595341+0.0128699im    0.0873676+0.136589im     -0.0448732+0.00558939im    0.0357759+0.0247122im    -0.0496808-0.120273im      -0.047237+0.119018im    0.00124815+0.111089im      -0.131684+0.0392905im     0.0499126-0.0686767im      0.0922955+0.191138im      0.0798716-0.235984im     0.0935929+0.0884672im   -0.0606201-0.00816913im     0.003099-0.0674007im      0.04632+0.323814im       0.142754-0.367272im      0.102781+0.0140203im     -0.0376248+0.235846im      -0.182376+0.269664im    -0.00714076+0.0507096im    -0.0135954+0.0110184im
  -0.0575716+0.184435im    -0.000877787-0.202756im     -0.066621-0.0331273im    -0.0773176-0.00778194im    0.00686138+0.147008im    0.0217533+0.162883im      -0.154037-0.195737im     -0.0227348+0.138095im     -0.0351264+0.163901im    0.0418728+0.025926im      0.110211-0.0807497im     0.225107-0.374526im      -0.10341+0.0658627im      0.131284+0.225315im       0.054956+0.0922725im      0.133697-0.0459421im      0.240153-0.0122995im   -0.0899883+0.164859im       0.189024+0.0929668im     0.0158225-0.0844673im       0.155864-0.167233im       0.124931+0.129547im      0.024353+0.0917056im     0.041441-0.158476im      0.0949039-0.129054im    0.00804233+0.0168619im      0.010751+0.0449453im    0.0971666-0.104764im        0.115559+0.226651im     -0.0693443+0.0648087im    -0.0894182+0.15687im      -0.0683124-0.00975133im
   0.0319342-0.146598im        0.185154-0.0969925im   -0.0094388-0.0461777im      0.173278+0.0369082im    -0.00143723-0.0873006im    0.120844+0.112493im     -0.0676648-0.279096im      -0.069379-0.00364827im    0.0929451+0.0795583im    0.189129+0.0180791im     0.158561+0.148999im    -0.0761719-0.083152im      0.279083-0.24518im      -0.0166872-0.0958115im    -0.0201682-0.0806163im    -0.0144536-0.0237586im    -0.0963096+0.0453545im   -0.0811658-0.196754im      0.0853617-0.0317131im     -0.114343-0.0304146im      0.0493178-0.127882im      -0.165087+0.161253im     -0.154007+0.0370736im    -0.254339+0.0805906im      0.105857-0.244201im     0.0176273+0.0852628im    -0.0978847+0.0781567im    -0.128958-0.0684483im     -0.0807194-0.0733345im     -0.108332+0.0604777im      0.176951-0.0776877im     -0.283279+0.0648018im
    -0.11071-0.0240287im      -0.124396-0.0947469im    0.0894592-0.0609847im     -0.106264+0.169335im       -0.184059+0.117452im    -0.100072-0.00617655im   -0.0731036-0.0308939im    -0.0192605+0.217512im      -0.155464+0.0163602im   0.0342277+0.204013im    -0.0513051-0.0647717im    -0.106981+0.262607im     0.0280475-0.0820878im      0.294152-0.280842im       0.136114+0.0670018im    0.00651382-0.0498251im      0.105699+0.021775im      0.105064-0.168284im     -0.0487092+0.141817im       0.212867-0.115211im      -0.0215597+0.0434473im      0.118292+0.0816609im    -0.152115+0.159224im    -0.0910476+0.00253783im     0.095314+0.00488232im   0.0874614+0.136318im     0.00739177+0.0528301im    -0.165343+0.0833092im       0.119933-0.166632im     -0.0298758+0.117537im      -0.319596+0.0519635im    -0.0186969-0.000199814im
    0.169226-0.0651451im      -0.164148+0.14898im      0.0371004-0.0535646im    -0.0451396+0.0755859im      0.0229631+0.064304im    0.0701628-0.349995im    -0.00412123-0.137802im       -0.12808+0.239505im      0.0221365-0.0262552im    0.147203-0.191458im     -0.107038-0.101488im       0.10263+0.0927746im     0.110047-0.0767835im     -0.135123+0.272863im     -0.0354129-0.268672im       0.155766-0.119953im      0.0944997-0.0405029im    0.0178363-0.0521627im     -0.112138-0.0769949im      0.131419+0.0243076im       -0.12625+0.0610952im    -0.0640481+0.168261im      0.212996-0.0747374im    -0.158379-0.00945596im      0.13884-0.11311im     -0.0302309-0.0482735im     0.0344462+0.0433834im     0.189343+0.0332768im       0.102762-0.0648282im    -0.0526526+0.216165im      -0.051537-0.00295238im    0.0366263-0.190054im
  -0.0142537+0.095943im       -0.147714+0.0849189im   -0.0973585+0.14221im        0.192307+0.105141im      0.00947863+0.156847im    -0.136181-0.061801im     -0.0924444+0.165314im      -0.160862-0.142948im    -0.00453986+0.0453693im  2.95245e-6+0.126156im     0.0316824-0.0540669im    -0.139307+0.0635134im    0.0704341+0.0298495im     0.0561087+0.0968132im    -0.0379532+0.119723im     -0.0658486-0.26151im        -0.13106-0.0955738im    -0.121693+0.0198002im     0.0987368+0.017809im      -0.061345-0.272298im       -0.124593-0.0186658im     -0.100429+0.27362im      0.0591094+0.0840161im     0.184041+0.12761im        0.371314+0.149022im    -0.0994954-0.154767im      -0.094606-0.0652008im   -0.0837841-0.140407im       -0.155826+0.124138im     -0.0483031+0.104114im      0.0449751-0.11203im        0.084278+0.0540135im
    0.135478+0.186866im        0.259565-0.129416im     -0.304063+0.153293im     -0.0331451-0.129656im      -0.0987986+0.0828727im   0.0574775+0.0574336im     -0.158989-0.0737908im     0.0215215-0.175406im      0.0184642-0.0135572im  0.00479745-0.198309im     -0.134374-0.110585im    -0.0519188+0.148748im      0.173319+0.0502979im    -0.0389785+0.226171im       0.144541-0.0671634im    -0.0798277-0.0267343im      0.122425-0.163843im     0.0984507-0.120241im        0.11452+0.0726536im     0.0815259-0.125058im       0.0840876+0.312791im       0.133708-0.091276im   -0.00866054-0.0774443im  -0.00625205+0.126895im      -0.060297-0.10997im     -0.0732479+0.041484im      0.0101046+0.00979293im   -0.208556+0.101054im      -0.0911014-0.0486079im     -0.236538-0.115603im      -0.087942+0.00111864im    0.0752373-0.0275364im
   -0.018927-0.156381im      -0.0921511+0.0375593im    0.0265598+0.158182im      0.0798739-0.273512im      -0.0302471+0.0342185im    0.253265-0.0977555im      0.145729+0.0445896im       0.20822+0.136897im     -0.0875637+0.09547im      0.068614-0.0298882im   0.00722067-0.0540323im     0.102288+0.0692549im   -0.0669046+0.04775im       0.0447726+0.0186381im     0.0186845+0.0469019im    -0.0944678-0.213736im      0.0422738-0.149801im    -0.0263156-0.444609im      0.0726714+0.160883im       0.110422+0.152675im      -0.0933244-0.138748im     -0.0521326-0.190339im     -0.117629+0.0606657im     0.171686-0.0519713im   -0.00232876-0.146328im     0.0622951+0.0287306im    -0.0895203-0.0535817im    0.0257335-0.303931im      -0.0107931+0.187807im     -0.0284532-0.0567389im     0.0159053-0.0947179im     0.0744006-0.0172383im
   0.0357408-0.0661499im        0.08631-0.0479281im    -0.141243+0.0404632im     -0.114234-0.135423im        -0.10227+0.108983im    0.0819205+0.00342916im   -0.0871631-0.0704162im    -0.0298128+0.205im          0.112815+0.0976498im   -0.126812+0.125068im     0.0980012-0.0944241im     0.131763+0.14796im      0.0939087+0.0901542im     0.0856944-0.109629im      -0.119534+0.110498im     -0.0273825+0.0796034im     0.0977073-0.00517596im  -0.0677933-0.0341199im     -0.154758-0.425607im       0.119834+0.0133259im       0.235172+0.0993462im     -0.123048-0.0157954im     0.256885+0.15529im     -0.0626937+0.0819313im      0.104267-0.00122511im   -0.181445+0.00434647im   -0.0874231-0.208487im    -0.0699753-0.149085im       0.0147385-0.0543104im      0.272886-0.109263im        0.13245+0.0894805im     0.0629975+0.0896029im
   -0.095484-0.0326351im      0.0423342-0.132182im      0.166758+0.0694756im     0.0710338+0.206459im       -0.241089+0.0939132im     0.18324+0.0953634im     0.0373374+0.013527im      0.0563666+0.0560412im      -0.29314-0.034922im     0.150258+0.222325im     -0.165492-0.143172im       0.14768+0.0393635im   -0.0657104-0.0178547im   -0.00354756+0.271718im      -0.186184+0.198021im     -0.0406303+0.0504793im     -0.176373+0.0242701im    0.0328274+0.0354846im       0.15635-0.207937im     -0.0468859-0.0957101im      -0.187045+0.167208im       0.107258-0.0863461im     0.167702-0.0837877im   -0.0859017-0.0639304im    -0.0888382-0.00946194im    0.197956-0.0096528im     0.0175497+0.0420006im   -0.0475259-0.029987im      -0.0016259-0.100285im     -0.0439088-0.0230781im      0.225111-0.116193im      -0.121069-0.0185885im
  -0.0214189-0.142857im        0.125809-0.0100576im   -0.0235559-0.0173867im      0.213703-0.0760859im      -0.139316+0.107219im   -0.0368938+0.120662im     -0.0204051+0.12126im        0.105228+0.0303792im     0.0903885-0.0859156im  -0.0309877+0.0425143im     0.180463-0.102266im      0.135497+0.0575338im    0.0466911+0.224302im       0.194564-0.0112892im     0.0376935-0.0442895im      0.077335-0.222301im     -0.0458769-0.0584679im    -0.189166+0.00948894im       0.1164+0.160204im      0.0036102+0.191549im      -0.0147822-0.0764917im    -0.0469881+0.0147945im     0.147479-0.130719im     -0.121502-0.0890217im    -0.0694161+0.0644174im    -0.179288-0.158119im      -0.198284-0.0703517im     0.113263+0.441741im        0.174296-0.164734im     -0.0661332+0.0424018im    -0.0246906-0.14802im      -0.0858945+0.0735734im
   -0.115986+0.171904im      -0.0374596+0.00317722im  0.00808648+0.0119015im     0.0699967+0.113805im       -0.151334-0.0346328im   0.0161109+0.109033im      0.0608028-0.0316328im    -0.0450388-0.0713562im      0.331919+0.0704001im  0.00590529+0.0298992im   -0.0660179-0.134606im      0.173228+0.0577739im     0.187874-0.0929567im     -0.012784+0.0944376im     -0.135398-0.100956im       0.141363-0.298808im       -0.12682-0.110502im    -0.0013743+0.193808im      -0.110902-0.0613266im    -0.0426452+0.0315337im      0.0721933-0.0818094im    -0.0743489-0.282355im     -0.205031+0.154979im      0.091704-0.0711039im    0.00236262-0.101527im     0.0731379-0.0180903im      0.190661+0.0927672im   -0.0805976-0.037527im      0.00490337-0.0962058im      0.247268-0.0863699im     -0.250498-0.217268im    -0.00307704-0.0930599im
   -0.232378+0.151391im      -0.0639552+0.0395887im   -0.0710942-0.0255337im    -0.0832698+0.034491im      0.00301657+0.0361133im  -0.0284236-0.00614065im     0.101789+0.233393im      0.0470585-0.112583im      0.0511091-0.184954im     0.217928-0.254945im     0.0744622-0.126501im    -0.0681135+0.0821137im    0.0664625-0.0528766im      0.260603-0.0506413im     -0.194193+0.0937839im      0.288405+0.328541im      -0.120843-0.0952948im   -0.0411632-0.0990895im      0.110423+0.0497594im   -0.00718901+0.235893im       0.0825787-0.0356714im     0.0341408-0.0186706im     0.185713+0.0487535im   -0.0590967-0.0225648im      0.140034-0.0803601im    -0.110735+0.0257im        0.0823262-0.0356463im   -0.0198809-0.141126im       -0.166596+0.00859505im    -0.112239+0.0042685im       -0.0488+0.0828049im     -0.174487-0.143675im
  -0.0193229+0.0510278im     -0.0478038-0.0936451im   -0.0854262+0.14721im        0.151091-0.0180865im       0.144701-0.121896im    0.0836981-0.0262728im     -0.350705+0.115595im      0.0327159+0.085938im     -0.0914793+0.0880762im    0.022316+0.115474im    -0.0661316+0.185766im     0.0259064+0.0961791im     0.114807-0.191207im     -0.0449899+0.0170047im      0.166808-0.0222224im      0.186879+0.18124im       -0.139174+0.0288028im   -0.0874908+0.100748im       0.169193+0.1384im         0.257661+0.0243578im      -0.128402+0.0998186im    -0.0848336+0.0713123im   -0.0603847-0.123965im    -0.0988254-0.312335im     -0.0579736-0.0290617im    -0.101271-0.00612246im     0.071458-0.244736im     0.0411912-0.0406597im     -0.0599268+0.0469017im      0.286675-0.120138im     -0.0570219-0.0797246im     0.0687383-0.0347858im
   -0.292401-0.157481im       0.0273738-0.132707im      0.134348+0.0873575im    -0.0115303-0.148025im        0.111437+0.0529944im  -0.0765961+0.158742im     -0.0773985+0.0362729im     -0.248173-0.0349599im     0.0161182+0.217238im    0.0543934-0.117123im     -0.111725+0.00746136im   -0.160304+0.109384im     -0.308235+0.169569im     -0.0733183+0.0120346im    -0.0456078-0.00152091im    0.0333031+0.00357265im    -0.134964-0.0330533im     0.133615+0.0851985im    -0.0901357+0.0371871im      0.201179-0.177875im      -0.0367916-0.0612832im     -0.253228-0.0840798im    0.0173793-0.0159769im    0.0307669+0.105736im      0.0576217-0.35567im      -0.110913-0.082963im      0.0915369-0.035494im      0.100822+0.0457399im       0.147656-0.13283im       -0.119713-0.0781616im     0.0553835+0.0631547im    -0.0837164-0.0225791im
    0.219457-0.12761im        -0.160958-0.159328im      0.329852-0.19556im      -0.0259045-0.0153296im    -0.00358941+0.106235im   -0.0904464-0.0376585im    -0.0569313-0.109219im     -0.0873744-0.189581im     -0.0997479-0.0431757im  -0.0775574-0.179182im      0.332048-0.0951686im     0.251285+0.0436114im      0.16679+0.0238841im    0.00603993-0.120737im     -0.0530309-0.0521347im    -0.0582503+0.0802373im    -0.0366811-0.0515008im     0.220807+0.0551544im     0.0552416+0.115329im       0.100495-0.151468im      -0.0557492-0.0928877im      0.228928-0.0612519im    0.0254627-0.0349229im   0.00305485-0.054624im    -0.00755841-0.103865im    -0.0959768-0.239302im      0.0812444-0.131016im     -0.113909-0.113122im       -0.124197-0.0335552im      0.022706-0.104737im      0.0616349-0.12704im       0.0828132+0.066093im
  -0.0751868-0.0447715im     -0.0251961-0.185943im     0.0723574+0.19239im        -0.01381-0.128067im       -0.024114-0.142303im    -0.222656+0.0808021im      0.031272-0.0841781im     0.0738657-0.0946723im    -0.0107299+0.148293im     0.226536-0.0177172im    -0.328257-0.113723im     0.0749352-0.0999511im     0.113882+0.024942im     -0.0704292-0.157785im      -0.297639-0.0155136im      0.105632-0.153872im      0.0834239+0.0259386im    0.0939268-0.147091im     -0.0710692-0.0247588im    -0.0718523+0.144797im      -0.0214136+0.0171226im      0.104902+0.287534im     -0.100681+0.0641673im   -0.0461643-0.123744im      -0.102173+0.151662im     -0.160896-0.109621im       0.156314-0.158438im     -0.118149+0.119038im       0.0148125+0.079913im     -0.0194061+0.0890769im      0.147943+0.113931im       0.163905+0.00760655im
   0.0214336-0.123023im       0.0265972+0.00707418im  -0.0758962-0.0187839im   -0.00817283+0.249578im       0.0478722+0.109027im      0.17184+0.00835723im   -0.0392509-0.0430017im    -0.0269746+0.0822729im     -0.149133+0.0321672im    0.059576-0.0624254im   -0.0850656+0.0305561im    -0.103881+0.0680277im    -0.058922+0.1072im         -0.17421-0.26886im       -0.139382-0.086338im     -0.0848196-0.117002im      -0.112494-0.0234939im    0.0133738+0.206803im       0.172581+0.126836im      -0.071967+0.143903im         0.40113+0.0908261im     0.0241429+0.160571im      0.103709+0.0424157im  -0.00599946+0.0961446im     -0.208329+0.0383506im   -0.0424052-0.0684058im    -0.0324612-0.0785805im    -0.010666-0.24991im         0.162376+0.0986759im     -0.102968-0.0631891im     -0.168641-0.25611im       0.0123197-0.171891im
   0.0259924-0.132733im       -0.117837-0.0364314im   -0.0147157-0.057846im       -0.21004-0.15048im         0.173358-0.0357824im    0.122103-0.0297493im    0.00779992+0.192603im      0.0194932-0.0336343im     -0.207127+0.174368im    -0.104466-0.0214901im     0.174791+0.0338684im   -0.0712282-0.0721131im     0.161656+0.00444665im   -0.0519208+0.0561465im     -0.180636+0.165335im        0.02174-0.268729im       0.124189+0.0984781im   -0.0178182+0.133954im      0.0847401+0.169827im     -0.0921604+0.169873im       0.0815824+0.197554im      -0.157506+0.0313948im       0.1114-0.0429656im    0.0414765-0.0576994im      0.183609-0.110385im      0.268886+0.120014im       0.139087+0.0182879im    -0.217069+0.173705im       -0.106481-0.240756im      0.0596209-0.0113392im     0.0156363+0.0837157im     0.0180557-0.0373439im
   -0.175385+0.190611im      -0.0992937-0.0635436im     0.137627+0.00921907im     0.220689+0.0287643im       0.244566-0.0739488im  -0.0929696-0.0474347im       0.15034-0.0848956im     -0.185665+0.0631585im     -0.263241-0.208802im    0.0654842+0.161322im      0.145108+0.167256im    -0.0802236+0.0346054im    0.0700151-0.0287676im     0.0311655+0.0784832im    -0.0818598+0.0311987im    -0.0231818-0.0803442im       0.34765-0.294197im     -0.200996-0.0199306im     0.0396518-0.134114im      -0.028737+0.0225629im      0.0297576-0.0264746im    -0.0513503-0.0980601im   0.00306593-0.0321289im    -0.100015+0.136229im      -0.222401-0.0778916im    -0.186912-0.0175907im     0.0545809+0.0423091im   -0.0842028+0.0354995im      0.0347542-0.0417752im   -0.00917204-0.165294im     -0.0299397+0.0338437im      0.157345-0.0707994im
       0.165+0.155328im       0.0906885+0.129304im     0.0314625+0.18874im      0.00387284+0.00077099im      0.018317-0.0275771im  0.00519594-0.0830809im    -0.0393924+0.101034im     -0.0243803-0.0528724im      0.202843+0.173953im    -0.047799+0.171135im     0.0713822-0.0103752im     0.238631+0.0193296im   0.00930787-0.222447im     -0.0205951-0.162202im      -0.154385+0.298116im    -0.00613233+0.166065im       0.212369+0.0189371im      0.09443+0.0151396im     0.0936944+0.240447im      -0.040229+0.0127602im      -0.122277+0.0936191im     -0.127135-0.0932068im    0.0326613-0.0401977im   -0.0799984+0.231887im      -0.026185+0.00577526im  -0.0957045-0.0487286im       0.18453+0.092499im      0.103577-0.0958869im       0.322582-0.0604667im     -0.163342+0.144993im      0.0485577-0.120244im      0.0146836+0.0118802im
    -0.10391+0.115263im        0.172671-0.18989im      0.0769495-0.0927889im    -0.0266303-0.170085im      -0.0114165+0.050672im    0.0603281+0.127282im      0.0067025+0.0560962im    -0.0382945+0.0306622im       0.10142+0.0895858im   -0.159049+0.187016im     0.0195262+0.0165273im   -0.0508497-0.0143617im   -0.0685271-0.149113im      0.0512229-0.107294im       0.128211-0.22879im      -0.0191901-0.129984im      0.0618616+0.139328im    -0.0655587-0.0289366im    -0.0738295-0.021403im     0.00649108+0.0776874im      -0.165329-0.0808133im     0.0951246-0.0335586im     0.218807-0.222811im    -0.0125041+0.146356im     -0.0193918+0.113317im     0.0785506-0.209118im      0.0739239-0.107816im     -0.124195-0.160328im       -0.174104+0.0127574im    -0.0604281+0.141846im    -0.00408941+0.0226386im    -0.0407334-0.497318im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  0.061599178569385016 - 0.008668721192857663im
    0.0849145135251186 + 0.10192179492111551im
   0.14505890661741222 + 0.044555486203921184im
   0.24056196493012533 - 0.07561129532261938im
  0.061477427372697804 + 0.23509013316258776im
   0.21704470374338589 - 0.054528383632521035im
  -0.19491131245856155 + 0.22940700349915782im
  -0.08385529874294628 + 0.10060596208586173im
   0.07457006116490902 + 0.07224978215410709im
  0.019904601200225993 - 0.11519200302977153im
  0.011529012845322121 + 0.2100781413544516im
  0.007224236485360821 + 0.0377047533015908im
    0.0876738126553725 + 0.10847014719274083im
   0.10912542938946138 - 0.08302381062157413im
   0.21503318995797605 + 0.011543429811338272im
 -0.036533923369812975 + 0.07205474364423128im
  -0.12553070589578874 + 0.18732445436067055im
   0.16702593904462357 + 0.1804241606249399im
   -0.0942739426441533 - 0.09683584008991192im
 -0.050852671175493025 - 0.05601102685078083im
   0.10513530796667221 + 0.007168457799279985im
  -0.18991945094048635 + 0.210305689912905im
   0.13588356952281017 - 0.02907288563688198im
    0.3100300025378339 + 0.0im
   0.10095475754249666 + 0.06501386215073023im
   -0.1389229251847047 + 0.10819574297090603im
   0.12135131400314192 - 0.09651398263330846im
   0.06835495526350503 - 0.02044499138408818im
    -0.061072376115563 - 0.1503433685591561im
  -0.18451278861642118 + 0.0778070206919907im
  -0.10087748824681501 + 0.036431877110979095im
   0.11394859924691148 + 0.07800912016720035im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 04:06">Sunday 21 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

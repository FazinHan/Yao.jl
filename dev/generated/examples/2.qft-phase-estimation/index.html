<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.27037-0.0648617im     -0.013794+0.0205848im    -0.0614401+0.122659im      0.0620026-0.0299704im     0.0380831-0.0446347im   -0.0652491+0.0847995im   -0.0629846+0.145638im     0.0110607+0.170125im    0.0277629+0.120505im       -0.090376-0.0593903im     0.216616+0.0293025im   -0.0970271-0.111916im      0.325036-0.000158806im  0.000924783+0.00649069im  0.00772074-0.0665075im     0.125585+0.123391im     -0.273824-0.141265im     -0.145722-0.0496053im   -0.0147783+0.106746im      0.181626+0.0961067im    0.0100724+0.0438498im    0.00448418+0.273489im     -0.0936761+0.0218581im    -0.224321-0.196261im     -0.0236965+0.0655103im     0.212912-0.030691im    -0.00778029-0.012607im     0.0476128+0.134551im     0.0282598+0.111111im      -0.123471+0.263791im     -0.201691+0.125884im      0.0678895+0.115223im
 -0.0336906+0.251915im       0.256968-0.194287im        0.18412-0.021883im      0.0068242+0.140459im      -0.101726+0.0839391im     0.048829+0.0630045im    0.0213195+0.0684136im     0.176752-0.10367im      0.123176+0.138312im      -0.0580487+0.0328484im   0.00134436+0.0884135im   -0.0118097+0.0488771im    0.0232849-0.0923765im       0.147542-0.0344562im   -0.0320938-0.113926im     0.0845921+0.124347im    -0.0128512+0.0711438im     0.224954+0.0460766im    0.0886454+0.1086im      -0.0637431-0.0679407im     0.224806+0.241898im      -0.104192+0.0423769im     0.0375681-0.0865603im   -0.0155883+0.0954893im     -0.184748-0.0370916im     0.280585+0.119143im      0.0982345+0.132451im     -0.022105-0.147212im      0.229286+0.221135im     -0.0113697-0.048577im     -0.121153-0.175539im       0.110252-0.152295im
 -0.0749644-0.067326im       0.214303-0.148999im       0.159295-0.0355985im     -0.102921+0.133233im     -0.0130443+0.0149174im    -0.325615+0.0182514im   -0.0146839+0.17555im      0.0211092-0.113729im   -0.0361131-0.114188im       0.0399727-0.105081im     -0.166957-0.131577im      0.131167-0.136278im    -0.0261909+0.166431im       -0.041712+0.0383692im    -0.100931-0.13258im       0.059934-0.0613335im    -0.126476-0.151841im     0.0304674-0.0856285im    -0.227012-0.0147143im    -0.250845+0.103345im     -0.107088-0.0963647im     -0.123293+0.122389im     -0.0893057+0.0514507im    0.0751919-0.091082im      0.0452061-0.171765im    -0.0270762-0.144956im     -0.0703703+0.210383im       0.17811-0.0958418im    0.0907958-0.096191im       0.159239+0.0855473im   -0.0245372+0.261433im       0.125998-0.119682im
  0.0122687-0.0823892im     0.0366525-0.156157im      -0.122971-0.0810967im      0.102438-0.209017im      -0.120433-0.177105im     -0.359874-0.043666im    -0.0355713-0.0624432im    0.0227739+0.0658743im    0.282982-0.00537087im     0.0594438-0.131376im    -0.0535538+0.0492311im     0.229743-0.157198im     -0.140194-0.0135478im       0.143757-0.0569332im    -0.144439+0.215066im      0.110239-0.145072im      0.102468-0.025976im    -0.0830888+0.314986im     0.0690329-0.105928im      0.142949+0.0757646im    0.0334817-0.0463229im    -0.0737187+0.0958857im      0.199908-0.18045im      -0.171155-0.0277931im    -0.0453822-0.0630645im    0.0548749+0.0820263im      0.108319-0.076724im    -0.0277168+0.0437529im   -0.0104157-0.0323194im    -0.0238982-0.0541811im    0.0791929-0.0601106im      0.212739+0.0239632im
  -0.128844-0.0354893im     0.0459662-0.217244im     -0.0374054-0.165808im      -0.219755-0.0994854im    -0.0468118-0.087223im    -0.0167004-0.0387848im     -0.16031+0.12524im     -0.0567215-0.177479im    0.0176469-0.152517im      -0.0419667+0.220448im       -0.1214+0.177694im      0.215627+0.14525im      0.0222325-0.178598im       -0.158573+0.214143im      0.146817-0.094388im     -0.147086+0.154698im    -0.0752784-0.0255213im   -0.0733578+0.0119349im   -0.0610427+0.0421428im    0.0738611-0.00698561im   -0.170812+0.121642im      0.0402452-0.0273191im      0.148176-0.0389292im    -0.249112-0.0626235im    -0.0654537+0.147131im     0.0880856-0.0644518im     -0.122937+0.0593241im    -0.216985+0.179508im     0.0399701-0.204806im       0.103089+0.0721045im    -0.127076-0.105754im     -0.0982371-0.00574954im
   0.114037+0.0428859im      0.126034-0.126199im      -0.193032-0.0838106im     -0.320204+0.164167im       0.128845+0.0415392im     0.127315-0.0506958im    0.0770704-0.0134832im     0.107668+0.249417im    0.0754236-0.13975im        -0.133198-0.21893im       0.145244-0.142226im      0.025123+0.0156694im    0.0809995-0.0196755im      -0.216406-0.0111424im     -0.13578+0.17945im      0.0771692+0.00244392im    0.003631+0.0202526im    0.0207211-0.0798112im   0.00456839-0.0597875im   -0.0547992+0.0111876im   -0.0739245+0.0492411im   0.000632441+0.123909im       0.276071+0.0470015im    0.0912099+0.149242im       0.190877-0.108325im    -0.0310438-0.121544im      0.0735033+0.152149im     -0.278025+0.00741013im   -0.222651+0.111088im      0.0596769+0.0188037im   -0.0932503-0.148923im      0.0630931-0.0474932im
 -0.0418343-0.114744im      0.0451587-0.13011im       0.0139138-0.228103im    -0.00729639-0.151578im       0.184541-0.0619936im     0.141674-0.00579456im    0.040295-0.0554632im     0.154378+0.153587im   -0.0857528-0.141658im        0.246877+0.11391im      -0.106579+0.0458601im    0.0275727+0.0431057im     0.273087+0.170526im       0.0406515-0.220095im    -0.0125302-0.114121im    -0.0469096+0.075799im      0.035289+0.048699im     -0.138492+0.00860352im   -0.106297+0.0996475im    -0.157022-0.053541im      0.265046-0.0866774im       0.18817+0.00608858im    0.0711463-0.239058im    -0.0901453+0.126285im     -0.0914069-0.16199im      0.0226782+0.131151im      -0.210363+0.0429442im    0.0137435+0.0827426im    -0.150382+0.0548101im     -0.175218-0.078207im   -0.00531648+0.203597im      0.0325506-0.0830815im
  0.0236879-0.143604im     -0.0176433-0.0983545im    -0.0368712+0.118518im       0.111184-0.217596im      0.0217419+0.0166138im     0.241736+0.0992796im   -0.0330223+0.0215867im    0.0880928-0.0719929im    0.190388+0.108859im      -0.0319954-0.0111047im   -0.0792598+0.083799im    -0.0499838-0.273847im     0.0584438-0.162097im       -0.197625+0.153413im     -0.117118-0.00586651im  0.00628847-0.0323651im   -0.0410416+0.108964im      0.221454+0.0449866im    -0.154709-0.176701im     -0.120881+0.118215im      0.163938+0.0524308im     -0.113969-0.0249117im       0.15278+0.206769im      0.232723-0.0264216im     -0.068266+0.0487664im    0.0373372+0.253042im     -0.0774148+0.081711im      0.180099+0.189236im     -0.186257-0.167756im      0.0704981-0.0387073im    -0.132366+0.0677669im    -0.0349844+0.066639im
  -0.189835+0.0462815im    -0.0641679-0.116002im     -0.0992627-0.029699im        0.33153-0.0892016im      0.276156+0.155146im      -0.11315+0.0393492im     -0.17041-0.0938755im     0.201038+0.137569im    0.0360108-0.252237im       0.0065646+0.106406im    -0.0498931+0.166902im      0.070491+0.0371201im     -0.14945+0.103056im      -0.0565192-0.0048301im   -0.0285832-0.00928932im   -0.105947+0.216175im     0.0187166+0.114646im    -0.0122778+0.110562im    -0.0606327+0.0179803im     0.131208-0.068196im     0.0680549-0.0335089im    -0.0320473+0.0800838im     -0.170974+0.244143im     0.0642448-0.0278944im      0.211378+0.0537162im    0.0396696-0.0894462im      0.143683+0.139542im     0.0572019-0.00552681im  -0.0185438+0.268284im       0.162951+0.17729im      0.0202602-0.06428im      -0.0342669+0.0223538im
 -0.0529544-0.0513931im     -0.165151+0.0880841im     0.0026433+0.0959516im     0.0166245+0.254335im      0.0866932-0.151975im      0.153789+0.171814im      0.122526-0.0526078im     0.253598-0.0484512im    0.335132+0.0619276im       0.203104-0.200655im    -0.0404721+0.0919495im    0.0677516+0.00525792im  -0.0317317+0.0547593im      0.0325669-0.10425im      0.0851902-0.193941im      0.015529-0.0233811im     0.209695-0.0164594im    0.0851833-0.112573im      -0.21672-0.0985388im   0.00752119-0.0456065im    -0.159662+0.0655734im    -0.0919487-0.0748316im      0.100318-0.0327415im    -0.325656-0.104239im         0.1112+0.104176im      -0.11599+0.0471502im        0.1389+0.0743664im   -0.0876879-0.0147116im    0.0799744-0.00511814im   -0.0903895+0.145887im     0.0071926+0.127508im      -0.136879-0.0756688im
 -0.0532227+0.187225im       0.107659-0.165881im      0.0278921+0.282221im      0.0697026-0.0917296im     0.0144753+0.0172804im     0.114603+0.145958im      0.173365+0.0981317im   -0.0805533-0.240901im    -0.112122-0.0588101im   -0.000544028+0.222446im       0.10339-0.239577im      0.256552+0.0409498im   -0.0225313-0.021427im      -0.0743735-0.167502im      -0.11635+0.107148im     0.0718576-0.0829311im    -0.187919+0.0196026im     -0.11329+0.0557377im    -0.229189-0.107784im     0.0150923-0.0178121im   -0.0153833+0.00510228im  0.000946473-0.24849im      -0.0430854-0.0266991im   -0.0568513-0.149354im       0.164514+0.00548331im    0.156275+0.031939im       0.129953+0.00332818im  -0.0882561-0.00765944im   -0.189669+0.0757778im     -0.267566+0.0474491im     0.125983-0.0195577im     0.0417797+0.0124387im
  0.0523741+0.0737834im     0.0296861+0.12483im       0.0271713-0.054272im      0.0837313+0.0995905im     -0.149114-0.0293786im     0.161179-0.0386987im    -0.161852+0.0327167im     0.134464+0.153461im    -0.324909+0.10025im        -0.217608+0.105005im    -0.0140363+0.136617im      0.147984-0.0321827im   -0.0821291+0.135402im       -0.164156-0.0638792im    -0.162406-0.104089im    -0.0757186-0.308036im    0.00576553+0.207207im      0.100364+0.00946006im    0.100149-0.148415im     0.0133862-0.137189im    -0.0538492-0.231465im      -0.167182+0.086286im      0.0539047-0.148607im     -0.242182-0.101162im     -0.0905542+0.0424032im     0.158794-0.0175265im     0.0378526+0.0789176im   -0.0399567-0.0602088im    -0.120885+0.0258321im      0.172814-0.053798im    -0.0494594+0.16395im        -0.05274+0.0839847im
   0.199414+0.0891435im    -0.0846802-0.13194im      -0.0461961+0.185515im     -0.0444674-0.0109884im      0.182903-0.054805im     -0.108405+0.0587476im    -0.157933-0.179306im      0.108957-0.0539424im    0.118771-0.0966273im      0.0256558-0.00402817im   -0.108947-0.017392im    -0.0798363-0.011538im      0.139935+0.0476314im       0.155573+0.182166im    -0.0556236-0.0813197im    -0.138781+0.069244im     -0.348035+0.0692512im    0.0178727-0.082118im      0.207363-0.182588im    -0.0113944-0.0802015im   -0.0611305+0.0268643im     -0.280962-0.15369im        0.138282-0.160608im     0.0257995+0.164203im      0.0258569-0.0466311im    0.0934736-0.169088im      -0.141572-0.0717049im    0.0017513-0.173598im    0.00655575-0.00950102im   -0.0596275-0.0663441im     0.243667+0.0938783im     -0.149246+0.142242im
   -0.01384+0.237612im      0.0284578+0.0587738im       -0.1187-0.180897im       0.158992-0.0455572im     -0.157941-0.267946im      0.142811-0.0691017im    -0.126811+0.167932im     -0.158281+0.0653149im    0.166282-0.126731im       0.0853153+0.102489im    -0.0863632-0.137608im     -0.199849+0.147532im      0.162505-0.00954912im        0.2145-0.0175341im    0.0734718+0.091367im    -0.0684688-0.0800852im    -0.201656-0.100998im      0.144463+0.157204im     0.0157818-0.134561im     -0.288583+0.0926502im    -0.051548-0.0610014im    -0.0618252-0.0553313im    -0.0237508+0.0305094im   -0.0698157-0.00352612im  -0.00186364+0.132596im     -0.191287-0.0667314im      0.186849+0.0384553im    0.0261972+0.0720657im    -0.109625+0.195964im        0.10869+0.0640131im    -0.128922+0.0495948im   -0.00851896-0.0972252im
 -0.0293507-0.258112im       0.135051+0.000940342im    0.184055+0.0922005im     -0.154201+0.145351im      0.0685395-0.163333im     -0.104851-0.0223069im   -0.0869169-0.0486532im    -0.216249-0.0192541im  -0.0132808+0.0235913im     -0.0318131+0.0437498im     0.125729+0.0989735im    -0.142347-0.0447174im     0.138235+0.091019im       -0.164746-0.134548im     0.0416551-0.117396im     -0.216309+0.124289im    -0.0125483+0.132988im    -0.0868344+0.282794im     0.0519381-0.109262im     0.0245285+0.147714im     0.0802347-0.0796322im    -0.0401941-0.066553im      0.0372722-0.0200984im    0.0244461+0.0861078im      0.276237+0.0128062im    0.0984455+0.0515819im      0.396468-0.0288769im    0.0592137-0.0213923im    0.0839425-0.073168im     -0.0410245-0.189928im     -0.135649+0.0191585im     -0.117883-0.14313im
 -0.0813417-0.112437im     -0.0658811-0.135811im     -0.0503979-0.0199506im     0.0732429+0.0123397im      0.114132+0.242944im      0.156875-0.204284im     -0.230147-0.103119im     0.0535901-0.0339116im  -0.0752692-0.00837506im      0.141208-0.0555753im   -0.0677416-0.0681889im     -0.13646+0.0308318im    0.0653166+0.148227im      -0.0802581+0.00698253im    -0.15202-0.0977194im     0.321689-0.0956429im    -0.156155+0.0877003im    0.0986372+0.114417im    -0.0601194+0.052694im    -0.0107185+0.104061im     -0.275011+0.155155im      0.0960212-0.0432073im    -0.0423057-0.255359im    -0.0767208-0.0775681im      0.107165+0.204643im    -0.0831233+0.0267845im     0.0243121-0.128296im      0.120207-0.142065im     0.0687031-0.107977im     -0.0180086-0.0875718im    -0.148738-0.222221im       0.191659+0.0262508im
  0.0990786-0.0893295im     -0.146666-0.0761812im     -0.193811-0.123645im      -0.149376-0.0508976im     -0.198665-0.118064im    -0.0824405-0.169102im    -0.0787096-0.00143187im   0.0928273+0.0919237im    0.138739+0.013218im        -0.12848+0.251098im     0.0246517+0.0313234im    -0.138271-0.249999im     -0.140555-0.0891768im     -0.0844882+0.00120817im  -0.0377408-0.262043im     0.0910905+0.0245816im    -0.148013-0.00453357im   -0.107453-0.161227im     -0.139578+0.0557159im    -0.098089-0.233894im      0.117467-0.0281274im    -0.0435159-0.141003im      -0.211011+0.117001im    -0.0554737-0.0801119im     0.0371316-0.161887im     -0.149014+0.163426im       0.141799-0.0797406im    -0.151081-0.246965im    -0.0419079+0.0205978im    -0.0837376-0.0387167im    0.0389187-0.0925076im     0.0651494-0.0824352im
 0.00227638-0.123354im       0.103794+0.0772322im     0.0140767-0.0863906im     0.0739644-0.200078im      -0.231961+0.0666721im   -0.0412795+0.0408766im   -0.0499201-0.150341im     0.0637812-0.285448im    0.0414871+0.0195716im       0.122056-0.027864im      0.149294-0.246302im     0.0433443-0.0985793im    0.0703773+0.145225im       0.0364657+0.00637621im   0.0683052-0.137666im     0.0337953+0.175708im     0.0303467+0.226592im      0.107769-0.185268im      0.292085+0.0565015im      0.23877+0.133726im    -0.0613764+0.0042053im    -0.0655577-0.0711893im    -0.0560319-0.109327im     0.0389806-0.14226im       0.0299996-0.118485im     -0.110079-0.0248076im     0.0145166+0.112156im     -0.159814+0.0846928im      -0.2793+0.0902892im      0.130771+0.0466904im   -0.0903435+0.0483328im    -0.0354685-0.212741im
  -0.281239-0.0556333im    -0.0672092-0.0637021im     0.0453943+0.216069im      -0.196473-0.0500174im   -0.00586645+0.0520573im       0.2374-0.0604032im    0.0229825+0.10913im       0.125186+0.148739im     0.112919+0.016945im      -0.0489739+0.0609838im    -0.135461-0.0394682im     0.191973+0.0265889im   0.00412993+0.140574im        0.076277+0.0289313im   -0.0176605+0.125326im    -0.0873232+0.106122im    -0.0791387-0.0498912im    0.0637726-0.167173im      0.388392-0.00256106im   -0.125453+0.174361im      0.097983-0.101186im    -0.00274921+0.121457im      -0.213482-0.0110243im     -0.15098-0.0356646im   -0.00237737-0.193194im    -0.0797742+0.0554889im      0.243458-0.0223403im    0.0788216+0.0695805im    0.0335615-0.226132im       -0.06878+0.0977881im    0.0475395-0.119001im      0.0474817+0.153251im
  -0.116058+0.00901622im  -0.00563231+0.0320548im       -0.1255-0.0472224im     0.0700185+0.0796193im      0.125998-0.0776887im     0.123071+0.076374im    -0.0313946+0.361788im    -0.0273653+0.0947132im    0.182101-0.0517259im     -0.0504155+0.128499im    -0.0508455-0.131465im      0.033284-0.220818im      0.061664-0.00840442im     0.0713549-0.230144im    -0.0362678-0.161781im     -0.147931-0.122944im     0.0948588+0.0880327im    -0.130172-0.147448im     0.0376069+0.250416im      0.247407+0.065275im     -0.216039-0.125431im      -0.175731-0.207797im      0.0987962-0.047683im      0.250249+0.103626im     -0.0371417-0.0014262im    0.0836858-0.0556067im    -0.0571374-0.055288im     0.0590217+0.0860598im     0.163099+0.0106889im     0.0453301-0.0669999im    -0.069527-0.103348im       0.178092+0.0675793im
  0.0931367+0.103199im       0.166719-0.164558im      -0.143807-0.00487981im    -0.149108+0.110814im      -0.196331-0.185868im      0.111635+0.221509im    -0.0622481-0.0578154im      0.12308-0.109642im    0.0185633+0.134613im        0.160811-0.0298117im    -0.130487+0.10702im       -0.18435+0.238026im    -0.0560189+0.216446im       -0.142553+0.0712915im   -0.0280007+0.00243159im  -0.0302481-0.114002im     0.0733283-0.0516196im    -0.166504-0.0733534im   -0.0752196-0.0292083im     0.229581+0.13824im       0.318189+0.00828796im   -0.0128646-0.0838553im     -0.161601+0.0339095im    0.0192525-0.0217441im      0.123944+0.0215813im   -0.0253687-0.168418im      -0.056244-0.146534im     0.0847855+0.070145im    -0.0504807+0.000753088im    0.180767-0.0363259im    0.0165005-0.0543536im      0.217826+0.149177im
    0.19061+0.0303928im     0.0200789-0.00207841im   -0.0727812+0.0176887im     0.0731137-0.0219837im      0.122253+0.0835933im    0.0700297-0.0375746im     0.128976+0.243698im     -0.178375-0.0816617im    0.198035+0.0425663im      -0.162107-0.0616698im   -0.0110439+0.230685im     -0.184945+0.0435341im    -0.232916+0.125537im      -0.0939169-0.051401im    -0.0558669-0.0204194im    0.0280651+0.166533im     0.0271541+0.0782103im    0.0144091+0.153321im     0.0475808-0.140024im    -0.0727085+0.124464im     -0.125806-0.045374im       0.236618-0.239605im     -0.0722261-0.215973im     -0.105789-0.0710315im     -0.022957-0.416699im     0.0296155-0.00892189im    -0.170659+0.0639948im   0.00203799-0.0188522im    0.0145121+0.0767939im      0.134165+0.132851im    -0.0256538-0.00813992im   -0.0756904+0.0674232im
   0.036243-0.135892im      -0.160007+0.0393693im    0.00177836-0.361915im      0.0481946+0.0662384im      0.169975-0.00342584im  -0.0822135+0.124351im     0.0711563+0.0519462im    0.0313729-0.254882im    -0.148282+0.0107664im     -0.0384044-0.00662119im     0.05209-0.100187im    -0.0834837+0.145612im     -0.208665-0.0989034im      -0.212439-0.0949425im   -0.0338867+0.079511im     -0.112957+0.0883189im    -0.173201-0.106628im       0.12724-0.120582im      0.128809-0.0800941im    0.0580582+0.0361545im    0.0126023-0.0271213im     -0.234733+0.0105224im      0.104036+0.0748663im    -0.256715+0.125406im    -0.00956873-0.0675792im    -0.119802+0.127308im    0.000381631+0.0430532im      0.24816+0.0934973im   0.00787517+0.125505im      -0.220223-0.0725404im   -0.0490753-0.0662665im      0.220532+0.0643591im
 -0.0671235+0.207396im     -0.0564879-0.0639288im     0.0678312+0.0909206im     -0.137799+0.00446152im     0.126261+0.0625818im    -0.120665-0.041422im     0.0490673-0.0895908im   -0.0673834-0.0961957im    0.105812+0.207721im      -0.0622417+0.206782im     -0.050402+0.040825im     -0.141524+0.101772im     0.0509884+0.0187201im     -0.0612927-0.164835im    -0.0246627+0.0675659im     0.101911+0.0783027im    -0.096186-0.0570997im     0.145854+0.0756553im   -0.0628115+0.13266im       0.166092-0.114445im    -0.0278525-0.236266im      -0.115854+0.156674im     0.00958061-0.198336im      0.126246+0.101382im      0.0891053+0.094231im     -0.252009+0.304624im    -0.00167297+0.0652945im    -0.245488+0.120769im     0.0260506-0.0645028im      0.195199+0.118152im     0.0356961+0.245358im       0.111198+0.129991im
 -0.0966527-0.186806im       -0.15964-0.13829im      -0.0145407+0.0811039im    -0.0577459-0.0102356im   -0.00152032-0.091337im      0.192068-0.00450702im  -0.0739335-0.101048im    -0.0762782-0.0917527im   0.0166437+0.0933415im     -0.0114434+0.199553im     0.0153134+0.128648im     0.0965885+0.024797im     -0.143563-0.0203276im      0.0248655-0.234953im      0.091587-0.150598im      0.107307-0.122351im     0.0303422-0.273948im     0.0189174+0.122963im      0.192844-0.0203941im   -0.0579428+0.221142im     -0.168015+0.243918im     -0.0418369+0.223268im    -0.00509842+0.176655im      0.115319+0.0873156im     0.0443687-0.100997im     0.0956852-0.105466im      -0.153425-0.0921246im    -0.127976-0.120823im     -0.113249+0.2707im        0.0189657-0.0863119im    0.0144892+0.226235im       0.045571+0.00793954im
  0.0954952+0.0149383im     0.0072105+0.360382im     -0.0943554-0.340185im       -0.20846+0.0716356im     0.0921757+0.16543im       0.178077+0.00118987im   0.0616728+0.109448im      0.197742-0.136142im      0.11545-0.0796688im      -0.107396+0.102222im    -0.0683606-0.0689578im      0.14172-0.0920494im    0.0585613+0.0879173im      0.0414922+0.120065im      0.109727+0.132866im      0.151054+0.0286193im    -0.066244+0.024765im     -0.038647+0.370786im    -0.0518997+0.034811im     0.0821752+0.115181im      0.129196+0.070908im      -0.193361+0.0503553im     -0.159666-0.0196258im    0.0567142-0.136662im       0.120344+0.0128147im    0.0674878-0.00304424im   -0.0394635-0.0564215im   -0.0301949-0.0264631im     0.101336-0.0412963im     -0.038305-0.122998im      0.157771+0.124437im      -0.119617-0.0105973im
 -0.0824851+0.0119792im      0.119883-0.0530882im     -0.119904-0.111723im     -0.0400528+0.0755975im     -0.101809+0.133118im      0.101152-0.0276908im    -0.205812-0.15537im     -0.0394855-0.0556721im  -0.0139139-0.0514743im      0.0783103-0.123319im       0.14288+0.153887im    -0.0489226-0.0688451im   -0.0378285-0.0113946im      0.0532338-0.162742im      0.154347+0.300872im     -0.105587+0.0258771im   -0.0780945+0.209108im    -0.0616783-0.0312685im   -0.0010682+0.0455854im   -0.0755489-0.165872im     -0.103002+0.192894im     -0.0092074-0.184984im      0.0299042+0.126074im     0.0632003-0.104855im      -0.121771-0.144016im      0.020856-0.0312795im      0.157484+0.0126209im   -0.0370025+0.0185143im     0.139827-0.12556im       -0.106416+0.0956388im   -0.0777019+0.409327im       0.226531+0.225466im
   0.147921-0.170478im     -0.0887637-0.0428912im    0.00225941-0.0483852im    -0.0562979+0.172262im      -0.193414-0.0371477im    -0.127736-0.076187im    -0.0735227+0.117528im    -0.0185317-0.0797855im   0.0293216+0.00306452im    -0.0795705+0.257658im     -0.104848+0.0651743im    0.0872663+0.0188012im     0.209077+0.247552im      -0.0244603-0.203568im     -0.146356+0.27012im       0.107052+0.0705595im     0.154124-0.0223054im     0.122501-0.0872495im      0.10071+0.0824148im   0.00837883-0.128653im     0.0400677+0.185816im      0.0677572-0.129118im        0.22779+0.0639454im    0.0691673-0.0345275im      0.075883+0.124768im     -0.017048+0.0467663im    -0.0367614-0.00833187im     0.28975-0.102307im    -0.0781567+0.0346489im     0.0159629+0.291738im      0.108027-0.0541754im     -0.188676+0.0188633im
  0.0362048+0.0540507im    -0.0595445+0.052283im     -0.0163198+0.0397933im      0.126975+0.0201083im     -0.133955+0.0499625im     0.101889-0.00477011im   -0.180195-0.12787im     0.00551643+0.151121im    -0.176923+0.0176321im     -0.0227642+0.188529im     -0.131502-0.00391619im   -0.192135-0.078229im     0.0307714-0.098936im         0.13142-0.00691444im  -0.0220729+0.163441im      0.180418+0.136588im      0.135462-0.164791im    0.00234751-0.102272im    -0.0565616-0.138163im      0.116627+0.178532im    -0.0450893-0.0510624im    -0.0702992-0.13993im       0.0529501+0.0726067im    -0.162395+0.123121im        0.26401-0.169068im      0.186048-0.00032922im   -0.0996211+0.293387im    -0.0749564+0.123651im      0.180736-0.212759im      -0.029349-0.0323245im     0.109502+0.0212007im      0.120045-0.274041im
  0.0356592-0.159447im     -0.0570998+0.152833im      -0.138689+0.0814741im     -0.034416+0.130488im       0.146103-0.0392797im    0.0543799-0.0442625im   -0.0943094-0.0336269im   -0.0417754-0.013606im   -0.0509389+0.127012im        0.130414-0.0818096im    -0.123096-0.19091im      0.0986622-0.00236067im  -0.0854273-0.117577im        0.112586-0.212985im     -0.243906+0.138798im     -0.211537+0.326253im     -0.124393-0.182106im      0.144955-0.00418305im   -0.176409+0.0352144im    0.0526537-0.0793149im     0.103496+0.035802im      0.0561822-0.0456232im    -0.0594194-0.0244062im   -0.0588724-0.117258im      -0.191863+0.00104558im     0.19974-0.0438412im     0.0447661-0.165719im    -0.0978317-0.0838172im    -0.121306-0.0622863im      0.360294-0.117603im    -0.0464127-0.0041497im     0.0295562-0.101654im
  -0.242451+0.0830579im      -0.18938+0.137486im      -0.168246-0.0536382im    -0.0498995-0.0883024im    -0.0670699+0.0887173im    -0.163736-0.0361928im     0.228545-0.273005im    -0.0254843-0.0647006im   0.0779784+0.190001im       -0.267469+0.018785im    -0.0156228+0.123531im     0.0210527+0.148264im      0.252819-0.00350175im     0.0643689-0.167996im    -0.0556188-0.139478im    0.00312453-0.0177837im   -0.0555007+0.133913im     0.0117617-0.051123im     -0.137886-0.0313309im     -0.20498-0.0379481im   0.00294469+0.0294607im    -0.0816754+0.0125672im     0.0828066-0.00762466im  0.00949977-0.153381im      0.0953641-0.141209im      0.112151-0.307689im    -0.00881874-0.0879414im     0.150658+0.260188im    0.00802679-0.0126008im     0.0490394-0.066704im    -0.0225626-0.128016im      0.0917236-0.049875im
   0.115818-0.131406im       0.125169+0.255846im      0.0847446+0.0282342im    -0.0157821-0.0579906im     0.0677401+0.15325im     0.00197365+0.128599im     0.0211279+0.044391im    -0.0742952+0.0221645im  -0.0590027-0.102878im      -0.0233617+0.0242972im    -0.272389+0.333875im     0.0859204+0.0105476im    0.0592343-0.0875922im     -0.0274937+0.192561im     -0.165987-0.138662im     0.0787373+0.0151846im    0.0197451-0.153372im      0.136005-0.0429586im     0.092387+0.0144444im   0.00527472-0.0173587im    0.0200989-0.0377839im     0.0513288-0.188901im      0.0884159-0.0540892im     0.114992+0.025064im     -0.0461584+0.0741832im   -0.0938416-0.157249im       0.280132-0.171559im     -0.157972+0.0731449im   -0.0910923+0.12399im       -0.155993+0.136885im     0.0616834+0.115636im       0.339058-0.128995im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 0.0014801491367947145 + 0.23466861187397345im
 -0.007109058809465583 + 0.09603075363134161im
  -0.12195935957028085 - 0.14795755837646343im
    0.1671376132948874 - 0.034421187910747705im
  -0.07751705472461755 + 0.06626450776433368im
   -0.1591758424141764 - 0.08825275524579138im
  -0.05769942297250037 - 0.13409911544732261im
   0.03052256461199738 + 0.11395300057971im
 -0.051031606856192055 - 0.2122568127268726im
 -0.057621187935752716 - 0.0892036433222512im
    0.4123973759354787 + 0.0im
   -0.1366690885107985 - 0.013940801732114835im
   0.04006092452522953 + 0.22514549352688135im
  0.012237158756140194 - 0.14467337727584187im
   -0.1652864822375916 + 0.051285361591996426im
   -0.0525687484485047 - 0.15660331263744348im
  -0.15275800109385684 + 0.14040275391530893im
    0.0325300446210981 + 0.2221121744932011im
    0.2614027320804294 - 0.003396754443936695im
  0.021673799103382012 - 0.04333509624027032im
    0.0429125876281424 - 0.12486037136308763im
  -0.03855654840771826 + 0.06730936575284077im
   0.08541446695753004 + 0.1251539140095021im
  0.006367986534294759 + 0.06261560831953203im
  -0.08770270342335798 + 0.09716238677240246im
  0.041340128284755376 - 0.2083214426225813im
  -0.03374974736234144 + 0.002379522683896616im
  -0.21706837075180574 - 0.0003855261226659648im
  0.027946002370337404 + 0.01762561311847282im
   0.03300237300504116 + 0.12936885524584749im
   0.06614919382688952 - 0.13839378045947962im
  -0.19277150807079796 - 0.08896776453236213im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.20 on <span class="colophon-date" title="Tuesday 12 July 2022 17:55">Tuesday 12 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

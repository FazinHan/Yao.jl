<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.100791-0.145828im     -0.150798+0.242837im     -0.00478365+0.0317648im   -0.0597278+0.0375705im     0.0194014-0.127422im      0.0221597+0.262364im       0.137476+0.161011im       0.0183402-0.165545im      0.112089+0.00787913im   -0.0235029+0.229245im     -0.0911587+0.00477931im   0.0360205-0.00818949im     0.0130679+0.0282893im       0.15997+0.213958im      -0.0509829-0.231793im    0.00373508+0.095186im      0.133419-0.156326im   -0.0162241+0.0355172im    0.0308818-0.137291im       0.11467-0.194367im       -0.126107-0.0248843im       0.100388-0.117564im      0.0278582-0.00432826im   -0.0896116+0.0791989im      0.134451-0.0905086im     -0.159598-0.00527331im     0.132477+0.0628503im     -0.233426-0.244676im       0.204318-0.00572729im   -0.205545-0.0438273im     -0.144638-0.210399im       0.0107991+0.0171163im
  -0.0480772-0.121749im     -0.101332-0.000298822im      0.03513-0.133886im     0.0194443-0.18096im      -0.0487429-0.000334954im  -0.0819513-0.177364im      0.0310756+0.274826im        0.141613-0.066836im      0.210728+0.110928im      -0.141647-0.0941317im    -0.0583559-0.0162571im    0.0117086+0.0167409im       -0.14775-0.10402im      -0.0993405-0.141259im        -0.14877-0.169528im     0.0612603+0.110958im    -0.0305683-0.109349im     0.185716-0.205586im    -0.0140201+0.0433788im     0.126849+0.0999267im       0.103912-0.0113736im      -0.133029-0.136099im     -0.0589148-0.0772319im    -0.0797599+0.125557im      0.0221816+0.130007im      -0.298148-0.0673004im     -0.180911-0.214084im     -0.0404239+0.196456im     -0.0582766+0.0250312im    0.0938602-0.0104037im     -0.220454+0.0392228im      -0.224735+0.141118im
    -0.17233-0.138655im      0.058797+0.0693468im      -0.406243-0.28872im     -0.0873016+0.090003im      -0.116903-0.0707723im     -0.022561-0.0440108im   0.000327276+0.0752946im      0.0412154+0.15253im      -0.197683+0.157144im       0.126543+0.0546956im     0.0327524-0.0415924im    -0.156461+0.0521351im      0.0845806-0.114255im     -0.0955682-0.0101595im       0.232852+0.0375385im    0.0765846+0.0217447im      0.13003+0.0536321im  -0.0349399-0.164423im     -0.034693-0.0856432im     0.105125+0.113275im       0.0478813+0.0929893im     -0.0864192+0.111471im      -0.057057-0.0114142im      0.127329+0.03137im      0.00144168-0.0834775im     0.0408759-0.0874029im     0.0696802+0.162311im      -0.138188-0.0936435im     0.0956338-0.114208im     -0.110795+0.205762im      0.0629211+0.0186218im      -0.213168+0.298295im
   -0.141341-0.01777im      -0.309602-0.169894im        0.273984-0.00308655im  -0.0989923-0.0059274im    -0.0340314-0.0524437im     0.0283482-0.134396im     -0.0354619-0.0466924im    -0.00269379-0.122319im      0.101357-0.0454508im      0.301072+0.191134im      -0.164353-0.00650019im  -0.0987272+0.0778498im       0.162548+0.0503733im     0.0011811-0.128373im      -0.0268911-0.216138im     -0.259205-0.0838705im     0.127022+0.0709065im   0.0680879+0.0547897im     0.182399+0.0830022im   -0.0500928+0.0151981im       0.197851-0.0797948im      -0.178703+0.195179im       0.103681+0.0359339im      0.159506+0.0580612im    -0.0866626-0.181497im     -0.0705288+0.0800161im    -0.0387605+0.0372681im     -0.140907+0.0526761im     0.0886563+0.034512im     0.0837836+0.00697283im     0.183305-0.0692441im      0.0477547+0.131071im
      0.2019-0.0103106im   -0.0615515+0.0668775im     -0.0720347-0.0916412im    0.0703986+0.107541im      -0.266581-0.0563624im      0.060066+0.159427im       -0.21669+0.181732im      -0.0147299+0.187859im    -0.0959778+0.0325566im    -0.0689614+0.254146im     -0.0913963-0.0553122im    0.0791838+0.0544447im      0.0434137+0.0806959im     -0.259535+0.148992im        0.020982+0.109031im     -0.149379+0.107703im      -0.14088+0.099722im     0.172225+0.0128547im   -0.0362718+0.267498im     -0.101087-0.140581im       0.0367263-0.00534544im       -0.1133+0.0481478im    -0.0744253+0.0110721im     -0.095016+0.101159im    -0.00769381+0.193063im     -0.0131427+0.095159im     0.00966031-0.0774869im    -0.0975854+0.0805093im      0.105894-0.00117908im    0.164119+0.185801im      -0.078185+0.0262689im       0.324779-3.56644e-5im
    0.190852-0.153517im    0.00886269+0.0687487im       0.135636-0.0195705im    0.0252877+0.00542105im    -0.150894-0.0504429im    -0.0631008-0.192005im     -0.0851658+0.0521634im      0.0284581-0.225266im    -0.0531878-0.215979im       0.026645+0.0500248im    -0.0246866-0.125498im      0.119702+0.0946941im      -0.111723-0.0746625im      0.170999+0.201197im       0.0367146-0.0807258im     0.129468+0.00840319im  0.00992286-0.0150667im   -0.214262+0.16715im     -0.0837496-0.160613im    -0.0728822+0.0601778im     -0.0669353+0.0183076im      -0.292306+0.250165im     -0.0387418-0.317944im       -0.10599-0.148677im       0.173774+0.123051im       0.180801-0.0803187im   -0.00474404-0.00399607im  -0.00728642+0.0614113im     -0.171103+0.0688432im     0.079146+0.161639im      0.0594597-0.00935412im    -0.0308715+0.138695im
   0.0616207-0.0457332im     0.164736+0.16032im       -0.0539589+0.035753im     -0.116424-0.161402im       0.015027+0.204223im     -0.0962284+0.122095im      -0.389266-0.12961im         0.173463-0.00692981im  0.00575237-0.062282im       0.211199-0.0196412im     -0.183481+0.127691im     0.0867855+0.160041im       -0.111282-0.177571im      -0.073793-0.0799759im     -0.0698563-0.0853327im    -0.078175-0.0671972im    0.0410846+0.06513im    -0.0988069+0.0387346im     0.088258-0.107763im    -0.0807508-0.134267im        0.254948-0.0162994im    -0.00707476-0.102936im      -0.201183+0.0512651im     -0.274183+0.141905im     -0.0775318-0.0277463im    -0.0131375+0.0489618im     -0.100908+0.180238im     -0.0590465-0.158033im      -0.103356-0.0425127im   -0.0866497-0.0174477im      -0.01699+0.186097im      -0.0770842-0.0723409im
   0.0411106+0.0322072im     0.139412+0.00979009im    -0.0103548-0.203362im      -0.17425+0.00197333im    0.0515155+0.161288im       0.160134-0.067136im      0.0680303+0.0321016im     -0.0554262-0.152879im      0.177514-0.085366im     -0.0743225+0.00770617im      0.21485-0.202144im    -0.0390469+0.059893im        0.169337-0.116262im      0.0123769+0.124451im      -0.0257286+0.0999731im   -0.0221258+0.233617im     -0.113412-0.0748939im   0.0254299+0.116083im      0.204409+0.0474808im    -0.170118-0.0430986im        0.11497+0.0675471im        0.11769-0.00108286im    -0.108084+0.126427im     -0.0782496-0.315235im     -0.0980726-0.0834144im     -0.289374-0.129798im       0.115477+0.0574045im    -0.0780924-0.119387im      0.0383354+0.179374im      0.194832+0.0516953im      0.094179+0.194355im      -0.0310729+0.0816404im
   -0.175176-0.0885762im  -0.00768096+0.0328146im      0.0340323-0.0700218im    0.0184986-0.0204881im     -0.225463+0.100504im       0.248567+0.0241688im      0.183291-0.0547786im      -0.142146-0.0392844im    -0.226028-0.0611641im    -0.0388547+0.0332821im     0.0691298+0.0288406im    -0.222874-0.0413059im      -0.283623-0.116324im      -0.215311+0.0319597im      0.0370053-0.112319im     0.0261164-0.104024im      0.137774-0.214972im    0.0146371+0.0800662im    0.0701325+0.0153771im  -0.00533487-0.250626im      -0.0762117-0.0184089im     -0.0532452-0.0708385im    -0.0199808+0.104129im     -0.0710192-0.00245698im    -0.133734+0.215011im      0.0218607-0.0207301im     -0.250275-0.0630258im    -0.0292002-0.147266im      -0.131134+0.00564018im    0.132418-0.0472363im      0.269552-0.207922im      -0.0625449-0.0974956im
    0.103882-0.137341im       0.15704+0.0435463im       0.269686-0.103052im     0.0757474-0.119048im      0.0745482+0.1207im        -0.112968+0.104668im       0.182131-0.0227887im      -0.006547+0.17741im      0.0420111-0.114398im      -0.132211-0.196858im      -0.287385-0.0833487im    -0.169857+0.0692547im      0.0925773-0.0384356im     -0.023399-0.0648222im   -0.000132832-0.127922im      0.113716+0.0386429im   -0.0223576+0.0963102im   0.0163944-0.0623428im   -0.0601395+0.0122858im    -0.062307-0.0102483im       0.102563+0.0239575im        0.10738+0.194111im       0.241799+0.265821im       0.113003+0.026613im         0.1436+0.216688im     -0.0912322+0.0577609im     0.0947173+0.0791376im    -0.0267289-0.135249im      -0.182789-0.0565705im   -0.0907844+0.306746im        0.02262-0.0763412im      0.0832241+0.0365917im
   -0.134629+0.0112484im       0.2082+0.0981499im      0.0135387+0.0608449im    0.0528721-0.26614im         0.18221-0.226969im      -0.089446-0.188928im     -0.0177759+0.156035im       0.0236857+0.0297681im    -0.264893+0.162574im     -0.0429198+0.103665im      -0.158791-0.163434im    -0.0693507-0.0899789im     -0.0732778-0.140916im       0.164991+0.0354186im      -0.127904-0.031055im     -0.107012+0.216103im    -0.0112092-0.139339im   -0.0617851-0.00972058im   0.0790178+0.202181im    -0.0554875+0.0153717im     -0.0813744-0.172745im      0.00201779-0.0757908im      0.144322+0.0147384im   -0.00962302-0.0863017im     -0.159603-0.114822im       0.167178-0.0514887im     -0.236312+0.0759396im   -0.00815834-0.0759916im     0.0151815+0.0687115im    -0.114602+0.0487859im     0.0105471+0.130689im         0.25997+0.083083im
   -0.128705+0.319127im       0.14742+0.0760212im       0.172345+0.0344203im   -0.0189604+0.37811im      -0.0455295+0.198781im      0.0209817+0.0345819im     -0.119327+0.0908093im     -0.0145173-0.0498966im    -0.238416-0.0573624im     -0.117328-0.0185042im    -0.0943671+0.0134532im    -0.222137-0.0389189im       0.107772-0.0713361im      0.206832+0.111406im       -0.136207-0.149495im      0.139791+0.00336792im   0.0339235+0.153938im    -0.016221-0.148539im      0.163236+0.0655406im     0.251293-0.0594333im       0.103174+0.0409381im      -0.129789-0.0978514im     0.0200844-0.110254im     -0.0128602+0.15581im      -0.0749972+0.00863079im   0.00630228-0.0507288im      0.105977+0.0161166im      0.123873+0.0358513im     0.0723737+0.236496im     0.0664324+0.087152im     -0.0922132-0.0116176im     -0.0729631-0.0284872im
    -0.10268+0.0256748im   0.00723047-0.000582231im      0.17894+0.00213205im   0.0115549-0.0658245im      0.159785-0.068583im       0.183342-0.0115942im    -0.0819392-0.049922im        0.116767-0.00297436im  -0.0869199-0.0356243im     0.0142755+0.0411809im       0.04799+0.0630356im     0.141694-0.100991im       -0.303005-0.315307im     -0.0662107+0.0312992im       0.170427-0.108707im    -0.0765608+0.0147654im    -0.280574+0.0351027im    0.175806-0.137291im    -0.0984244-0.213393im      0.115339-0.0818352im    -0.00373132+0.150376im       -0.124985+0.0806708im    -0.0627696+0.0553773im      0.149357-0.137332im       0.132076-0.116912im      -0.179191-0.031585im      0.0488589+0.194044im       0.208572+0.0520561im       0.24889-0.0642924im    0.0352373+0.124983im     0.00455173-0.0766666im       0.157629-0.112182im
   0.0858943+0.0414064im     0.183504-0.0145811im     -0.0535054+0.0767031im     0.163135+0.183879im     -0.0290434-0.0519774im      0.187658-0.15038im         0.17922+0.0489446im    -8.02873e-5+0.106634im     0.0129807-0.0818005im     0.0378963-0.0667771im     0.0603157-0.011934im      0.149873-0.00840272im      0.085583-0.0262849im     -0.269936-0.254871im       0.0810798-0.146295im     0.0723437+0.0575508im    -0.153302+0.0423345im  -0.0830065+0.0808766im    0.0424888+0.198937im       0.09464-0.000936673im   -0.0197259-0.360545im      -0.0730721+0.175641im     0.00263594-0.208644im      -0.141068+0.0456978im     0.0852922-0.220707im      -0.154388+0.0223889im    -0.0657005+0.217663im     -0.0990331-0.14461im      -0.0834367+0.0972773im    -0.106834-0.0309896im    -0.0978532-0.101963im      -0.0649248-0.149248im
    0.121181+0.0210119im  -0.00133557+0.336772im       0.0208121+0.058731im      0.132774-0.0784717im    -0.0690121-0.0167968im     0.0431107-0.0364025im      0.253535-0.234324im        0.154167-0.128321im     -0.112311+0.12664im       0.0379192-0.137572im     -0.0740805+0.0203397im   -0.0329638+0.0380402im      -0.133834+0.146152im       -0.14838-0.0260065im     -0.0971784+0.0270124im   -0.0472746+0.170569im    -0.0659264+0.13737im     0.0143268+0.0648761im   -0.0619008+0.0437426im    0.0400829+0.168813im          0.2763-0.0207849im     -0.0430812-0.197194im        -0.1335-0.0437925im     0.0780892-0.0121007im      0.142212-0.00954326im    0.0979994-0.0297773im      0.158592-0.156931im     -0.0777955+0.0189198im      0.237399+0.218684im    -0.0865691-0.00250839im     0.330259+0.000908337im  -0.00480443+0.0216511im
  -0.0379871+0.138499im   -0.00293689+0.0160208im      -0.204576-0.0556853im      0.18334-0.218029im     -0.0523692+0.148562im      -0.113055+0.0603414im     0.0116279-0.000970633im    -0.135335-0.354258im     0.0302577-0.142069im      -0.111945+0.0467436im      0.238304-0.00104947im   -0.021277-0.0020697im     -0.0130674-0.0669389im      0.103617-0.18056im        0.0438263-0.151796im     -0.215942-0.171237im    -0.0843915-0.0220787im    0.114901-0.125389im      0.140697+0.156782im      0.097512+0.18762im       -0.0508823-0.0694248im     -0.0908848+0.0458139im     0.0965824+0.0894133im     -0.133207-0.0101116im       0.10825+0.185849im       0.219793+0.0242175im       0.17119+0.1113im        -0.174565-0.032706im       0.138803-0.118406im    -0.0190543+0.131485im     -0.0353526+0.083897im      0.00768147-0.140073im
    0.101953-0.0446493im   -0.0612953-0.0875985im      0.0552313+0.123902im    -0.0266331+0.0292484im   -0.00305879-0.0735095im    -0.0221388+0.0524488im     0.0347653-0.023461im        0.203956+0.0414223im    -0.150328-0.0699117im     0.0565293+0.304239im      0.0576869+0.0321402im      0.10381+0.0176749im       0.101814+0.0745953im     0.0518349+0.0112059im      -0.147906-4.08222e-5im    0.152473-0.00742218im   -0.310087-0.304799im   -0.0135497-0.162754im    -0.0393582-0.0169796im     0.130956+0.0232578im       0.250607-0.172952im        0.237171+0.179476im      -0.077769+0.208934im     -0.0312321-0.0896806im     -0.181023+0.0996822im      0.182774-0.049992im     -0.0574411-0.013285im      0.0230011+0.065813im      0.0575623+0.0149199im     0.019695+0.154566im      0.0390948-0.085956im       -0.315314-0.0402064im
    0.148802+0.0698287im    -0.113315+0.0483492im     -0.0111926+0.0632781im    0.0102477+0.0206675im     0.0220177+0.0429052im     0.0954209-0.0564907im     0.0730523+0.0381329im        -0.2025+0.00686165im    0.125317+0.131321im      0.0968872+0.0774483im     -0.207847+0.00792591im   -0.151148-0.242806im     -0.00895751-0.0817482im      -0.20153+0.0368031im     -0.0644171+0.138063im    -0.0361134-0.15187im       0.162424-0.113446im    -0.131967-0.022612im    -0.0726439-0.191547im    -0.0218788+0.324079im       0.0191146-0.0760157im      -0.131224-0.123057im     -0.0705822+0.253345im      -0.174339-0.115643im      0.0510997-0.15377im       0.0930332+0.0327884im     0.0087979+0.0944285im     0.0894033-0.0220133im    -0.0290781+0.180196im      0.176418+0.266745im      -0.259236-0.0579383im      0.0143971-0.0711184im
  -0.0257474-0.106388im       0.17818+0.117312im        0.048683-0.0246656im   -0.0449491+0.0653705im     0.0154197+0.30773im       -0.306564-0.111467im       0.050578+0.0463343im       0.089613+0.144128im      0.137313-0.0275212im   -0.00552255+0.39122im        0.174253+0.0997922im    0.0121418-0.124794im       -0.100944-0.0929696im    0.00926227-0.175968im       0.0807567+0.00386789im   -0.234887+0.107142im     0.0323531+0.0290467im   -0.243133+0.0572268im   -0.0928498+0.0826149im    -0.125916+0.0326034im     -0.0995268+0.000317633im    0.0191666-0.112231im      0.0594769-0.0711449im     0.0316677+0.0380374im     -0.132198+0.0282088im    -0.0913842+0.0926651im      0.160537-0.0867912im      0.154091+0.105408im      0.0358815+0.0783493im   -0.0494095+0.0912734im     0.0876796-0.288545im      -0.0591111+0.00246599im
    0.140044+0.164756im     0.0989517+0.162647im      -0.0845176-0.120195im    -0.0215016-0.00378518im    0.0384339-0.262785im     0.00695774-0.0660695im      0.067637-0.153112im       0.0335966-0.0562355im    0.0868956-0.0413456im     -0.122636+0.186616im      0.0749032+0.0796372im   -0.0457253-0.0619335im      0.0698076+0.00704095im  -0.00642307-0.16066im         0.180061-0.307466im      0.122521+0.148434im      0.131164+0.104446im     0.144274+0.172725im    -0.0365874-0.129751im     -0.123508-0.14058im         0.056273-0.0476379im      0.0614591-0.0463568im     -0.027931+0.212999im      0.0500269+0.193602im     -0.0119324+0.0439014im       0.21084-0.159984im     -0.0138387+0.188597im       0.102355+0.263446im       -0.11149+0.0506767im     0.207803-0.121631im      -0.113811+0.0236675im      0.0272609+0.107032im
  -0.0523267+0.0489314im   -0.0939963+0.269015im       0.0212543-0.0640056im    -0.106134-0.0523778im      0.234012+0.0190533im      0.110042-0.043351im     -0.0848945-0.0311075im       0.186963+0.0853375im   -0.0267163+0.162246im       0.104898-0.00940058im   -0.0260351-0.180571im      0.108571-0.000415007im     0.121159+0.104701im     0.00962146-0.151658im       -0.068235-0.00237651im    0.194014-0.130059im      0.200021-0.225476im     0.114649+0.0558227im    -0.031337+0.221126im     0.0810415-0.12846im        -0.272674-0.0186962im      -0.139824+0.0492244im     0.0126125+0.0304138im     -0.194003-0.0448138im      0.108666+0.094282im     -0.0671988+0.199319im       0.242893+0.0869269im      0.181742+0.119668im     0.00472067-0.0293181im    0.0888433+0.0842603im      0.226219+0.0979084im     -0.0961662-0.0472963im
   -0.309308+0.0247346im   -0.0915356-0.0408857im      0.0384257+0.0589955im   0.00772932+0.0336182im    -0.0391571+0.226322im       0.140684+0.0328707im    -0.0543096+0.0116433im      0.0940334+0.0280468im      0.16577-0.0225794im     -0.186809+0.144014im      -0.241744-0.0130317im    -0.113396+0.1085im         0.0362741+0.0381083im    -0.0597737-0.157803im      -0.0101859-0.0457131im    0.0418737+0.203944im      -0.15479+0.0626864im    0.133476-0.074767im     -0.165994-0.192618im     -0.157369+0.00188956im     -0.257688-0.248643im      -0.0702605+0.0575816im     -0.168761-0.0246453im    -0.0470452-0.0759272im   -0.00104484-0.0545642im      0.277879-0.0971808im      0.156913-0.157456im      0.0587797-0.257953im     0.00866173-0.0536193im   -0.0106649-0.100114im      0.0115251+0.108381im      -0.0102343+0.0956234im
   -0.101788-0.0308462im   -0.0417569-0.0228051im       -0.02524+0.202921im     -0.177045-0.0642576im      0.144106-0.237107im      0.0652222-0.152766im      0.0648272-0.0821432im     -0.0435555+0.159814im      0.136271-0.145504im       0.088764-0.047725im       0.173395+0.110071im     -0.253271-0.0262914im     -0.0274599-0.169121im       0.123825+0.0698424im     -0.0653688+0.144795im    -0.0465995-0.0441852im     0.178582+0.101234im    0.0821863-0.171968im    -0.0217247+0.148928im     -0.137431-0.117585im        0.126238-0.191776im       0.0895587+0.118654im      -0.285355-0.159524im      -0.149431+0.0869186im      0.163666+0.282017im    -0.00905339-0.110935im        0.10657-0.038716im      0.0287757-0.0515403im     0.0847069+0.0712422im   -0.0760462+0.116818im     -0.0696512-0.0830662im      0.0793399+0.0119854im
   -0.253926+0.062421im    -0.0890713+0.0616216im      0.0124882+0.00650865im    0.386543-0.158567im      0.0226836-0.0859952im     -0.163253-0.0514109im     -0.204062+0.237715im       -0.120691+0.158688im      0.120806-0.17994im       0.0125412+0.0383318im      0.107669+0.0804538im    -0.157392-0.0265442im      0.0836591+0.130843im      -0.118363+0.0963846im     -0.0863639+0.0125958im     0.257608-0.0239417im     -0.12142-0.0844945im  -0.0790171+0.153739im     0.0777542-0.100186im    -0.0838876-0.0521972im       0.167212-0.00157227im     0.0660492-0.210028im      0.0207665-0.0944026im    -0.0325536+0.0610593im      0.169688-0.157743im     -0.0394016-0.0779533im     0.0616818+0.117833im      0.0321847+0.0164609im     0.0487367-0.152697im      0.117602+0.102485im       0.232051-0.0540229im    -0.00230465-0.0254853im
 -0.00717512-0.040612im     -0.144495+0.133977im       -0.146231+0.0984969im    0.0361049-0.157343im      0.0561106+0.07051im        0.113111+0.0859786im     -0.129859-0.0818417im       0.210619-0.187607im     -0.137087-0.146782im      -0.159615-0.0740307im     -0.102656-0.120656im     -0.149902-0.223806im      0.00387608+0.13017im      -0.0468913-0.18019im         0.119527+0.193436im      0.121209-0.00343513im   0.0325358-0.0975181im   -0.228297-0.0663307im    0.0113444-0.0546823im    -0.232572+0.00727408im     0.0527191+0.0148508im      -0.033945+0.244229im       0.147709-0.128451im      0.0579746+0.15949im       -0.236076+0.0283384im     -0.217458-0.180475im      0.0375765+0.022541im     -0.0579835+0.0628287im      0.177549+0.0536789im    0.0753959-0.0494365im     -0.146564-0.0875376im      0.0733851-0.0772249im
  -0.0354894-0.219112im     0.0823944-0.0072908im       0.217848+0.0231266im   -0.0335577+0.135035im       0.160672-0.0231894im     -0.162929-0.00148879im     0.192532-0.00367463im     0.0318122+0.104179im     -0.240934-0.0181002im    -0.0771803-0.0521538im     0.0410652+0.150633im     0.0994276-0.0891406im       0.172631+0.195889im       -0.16841-0.0115036im      0.0447855-0.152978im    -0.0853658-0.121979im     0.0247007-0.0858185im  -0.0937505-0.240271im      0.153671-0.0616664im    -0.117694+0.0272942im      0.0607982+0.0459242im      -0.214649-0.151416im      -0.141058-0.0314912im     -0.190505-0.212997im     -0.0521007+0.08593im       0.0115058-0.172175im       0.165428+0.0743944im     -0.118321+0.0312008im    0.00446316-0.203027im      0.112288-0.193976im     -0.0671727+0.0732092im       0.169918+0.09669im
  -0.0370763+0.167im         0.346241+0.0369028im      0.0695339-0.0871734im     0.160509-0.0846666im     -0.135339-0.118035im       0.228344+0.104581im      -0.141705-0.0284942im       0.103372+0.205061im       0.18295-0.166517im      0.0765271+0.0846961im     -0.113261-0.0778812im    0.0430495-0.265801im      -0.0582389+0.209754im        0.11199-0.00864749im      -0.04548-0.0061354im    -0.195959-0.0775157im     0.130375-0.001682im   -0.0268422-0.109722im     0.0458237-0.156438im      0.190254+0.204513im       -0.101356-0.0444662im       0.139161+0.0380278im    -0.0884429-0.076754im      0.0552939-0.121282im      0.0101062+0.218273im      -0.123391+0.0416338im    -0.0571883+0.0572308im     -0.152588+0.000185504im   0.0105591+0.0399306im    0.0999941-0.125577im       0.111016+0.00390462im    -0.0333767+0.169315im
   0.0583588+0.0224435im    0.0147791+0.0544039im      0.0428778+0.00994867im  -0.0722763+0.196001im       0.105872+0.0680346im     -0.300812+0.0288674im    -0.0798736-0.0177503im      0.0797602-0.0410366im    0.0727651+0.0539102im   -0.00470408+0.0372017im    -0.0313783-0.205007im     -0.197598-0.262534im       0.0195424-0.227381im      -0.057882-0.00221117im    -0.0778437+0.116031im     0.0395679-0.056393im     -0.034882-0.0225514im    0.102549-6.28818e-5im    -0.25191+0.0671817im    0.0351446-0.140135im       0.0320508-0.0852038im     -0.0462877-0.000317201im  -0.0783559-0.0563376im      0.249805-0.132647im       0.172849-0.00902301im    0.0799787-0.0109937im    -0.0931883+0.0940412im     -0.446054+0.0497468im    -0.0596663-0.0764232im     0.146909-0.203803im      0.0712085+0.0164911im     -0.0571162-0.218507im
  -0.0168554-0.0439366im    -0.108678+0.0167125im      -0.205747-0.0303942im    0.0888374+0.119391im      0.0741312-0.0402968im    0.00627801-0.214655im     0.00999054-0.12212im        0.0502343-0.0669893im   -0.0795503-0.165412im     -0.0661458+0.13817im       -0.274631+0.101941im     0.0812146-0.0569167im      -0.106387+0.0441183im       0.10817+0.0345534im      -0.112013+0.225186im     -0.124364+0.0610304im   -0.0263461-0.0167675im   0.0997376+0.209452im      0.196709+0.124655im      0.185621+0.0317325im      0.0420204-0.0554567im      -0.115038-0.096125im      -0.105389+0.101547im       0.221245-0.00682967im  -0.00469012+0.0915014im     -0.171712-0.189993im       0.216695+0.0524752im     0.0950113-0.123989im      -0.346448-0.246397im    -0.0208633+0.0176036im    -0.0725383-0.0568879im     -0.0348039-0.0460989im
   0.0663434+0.175425im   -0.00240452+0.0347895im     -0.0148475-0.139479im     -0.189353+0.102186im     -0.0209079+0.16427im      -0.0257073-0.0678926im     0.0789577+0.0814307im       0.177035+0.1346im       0.0038294-0.0455274im     0.0234009+0.0205672im   -0.00059041+0.036363im    -0.0775138-0.239508im        -0.19523+0.096143im     -0.0643113+0.0640191im      0.0679158-0.0406734im    0.0166213-0.252683im    -0.0112909-0.0311659im    0.157113+0.249124im      0.196266-0.120607im    -0.0352711-0.0717834im       0.089822-0.179167im       0.0686983+0.0949496im      0.212171-0.0259708im     -0.106461-0.10684im        0.113266-0.0754897im     0.0199806-0.185524im     -0.0668129-0.272049im    -0.00643868+0.12534im        0.099164-0.122348im     -0.311604+0.113339im     -0.0469362+0.220011im       0.0664612+0.0434471im
    0.230003+0.0197937im    -0.167125+0.00849331im     -0.203008+0.0656309im    -0.113763-0.00451176im    0.0123539-0.0119817im     0.0280114+0.134036im       -0.12666-0.0662204im     -0.0201281+0.214841im    -0.0554784+0.0103329im    -0.0898247-0.16724im      0.00842285+0.298967im     -0.138817-0.216154im       0.0203833-0.0966658im      0.195802-0.0306792im      -0.159028-0.322806im      0.049747+0.0592123im    -0.224802+0.0394117im     -0.1408+0.118607im       0.10705+0.164762im     -0.174887+0.150151im        -0.19068-0.000384081im    -0.149989+0.0368331im     -0.103117+0.0835117im     0.0819844-0.115529im      0.0705257-0.0126163im     -0.097703+0.0871771im     -0.123327-0.0602299im   -0.00994185-0.0565549im     0.0950947-0.0705459im    0.0994348-0.000575877im    0.114415-0.0483481im        -0.1055+0.156581im
  -0.0338284+0.237988im     0.0325982-0.0878242im       0.134926+0.214026im     0.0649299+0.00347021im     -0.17932+0.0416555im    -0.0641695+0.104425im       0.136426-0.0914856im      0.0303072-0.0708215im    -0.147494+0.0191243im    -0.0975019+0.0598115im    -0.0537113+0.146885im      0.113665-0.124821im       0.0347384-0.17607im      -0.0406184+0.0579713im     -0.0437012+0.190298im    -0.0664892+0.228584im      0.235082-0.0787762im     0.18182+0.0766868im    -0.131341+0.0875092im    -0.170102+0.0671742im      0.0969143+0.0757435im       0.027158+0.0977788im      0.197423-0.0883657im     -0.220557+0.0140593im      0.148537-0.0416843im    -0.0991547+0.0471718im     -0.045752+0.161874im      0.0639047-0.0512875im      0.090745-0.2758im       0.0717847-0.0418517im    0.00881986+0.0478437im      -0.245717+0.241991im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.05107553893396807 - 0.07234178456533152im
  -0.14492839990678297 + 0.1807859537822652im
  -0.05484992978185329 + 0.022995088924958388im
   0.12183567108531804 + 0.02723284762161955im
  -0.20273451170141643 + 0.11034342349950642im
   0.17213305226958328 + 0.15752257742329523im
    0.1068741906644304 - 0.25785488272166673im
   0.06772158798181968 - 0.12565172492106255im
    0.1772199488298415 + 0.13927216925011107im
  -0.06212482059361049 - 0.15392263712769766im
   0.07374264526945744 - 0.08537640357944466im
  -0.14351007416600156 - 0.014225720751868159im
  -0.21133471873073253 - 0.15048479203333537im
    0.0841659121975583 - 0.09858554987682054im
    0.1474416576738006 - 0.08037692225643125im
    0.0772379666233345 - 0.13430694019973846im
    0.3321526364188465 + 0.0im
   -0.1266650898311406 + 0.03126589062436028im
 -0.056110508363145066 - 0.030899622559841064im
    0.2035029070629006 + 0.06355068112193059im
   0.14646660896293343 - 0.1481036575772211im
 0.0005210818330137413 - 0.07865296639280177im
 -0.034346879844595016 + 0.09719061635563425im
    0.1021170010009791 + 0.04504101763182643im
  0.028689726340933155 - 0.0710364689067058im
   0.14188825296387483 - 0.23641183504143765im
  -0.21358835416037333 + 0.19493053220976467im
  0.017260009185482574 - 0.08189734225398465im
  -0.05545607668544584 - 0.04677974293286814im
   0.13770409729371924 + 0.02695886627032075im
   -0.0735872296860045 - 0.11027423004100755im
 -0.023229474748358216 + 0.0023372275290072663im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 1 March 2023 19:10">Wednesday 1 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0380198-0.309272im      0.221594-0.0805552im     0.194836+0.154267im    0.000935971-0.0813603im    0.0676273-0.00682627im   -0.123234-0.0208002im     0.227835+0.0521866im     -0.148665-0.0811005im    0.0614164+0.203172im     -0.055273-0.152336im        0.106095-0.12435im      0.00494699-0.0340303im     -0.0301473+0.0706537im     0.0309503+0.0293199im    -0.127418+0.0255473im     -0.110309+0.0199713im      -0.12356-0.0123969im    0.0455344+0.120574im       -0.0199232+0.104044im      0.0891332-0.0914365im     0.158267-0.0660768im     -0.143552+0.0317018im      -0.181363-0.0137588im     0.0424691+0.0462047im    -0.220501+0.0848918im    0.0819814+0.0381742im   -0.0369104-0.0772127im       0.321098-0.220072im      -0.165608-0.0704293im      0.061658-0.209764im       0.108909-0.172993im     -0.149146-0.155892im
 -0.0483637+0.154251im      0.135944-0.0457909im    0.0372726+0.152434im      0.0469321-0.0746993im     0.238872-0.226452im     0.0446581+0.115804im    -0.0454829+0.0583519im    0.00811274-0.0139523im   -0.0921121-0.0630051im    -0.170129+0.0649002im     -0.0622959+0.0712861im    -0.0876393-0.109133im      -0.0547079+0.0666418im     0.0237008-0.158585im      0.194093-0.0834584im    -0.0414552-0.116865im      -0.357716-0.0675496im    -0.124203+0.16323im          0.150414-0.0969739im     -0.144206-0.205494im     -0.159155-0.0600076im    -0.0593149-0.196553im        0.108008+0.0875783im    -0.0774265-0.017447im      -0.12479-0.300447im    -0.0776468-0.110309im     0.0962612+0.0600386im     -0.0138772-0.11008im       -0.124803+0.0310696im    -0.0822346-0.198237im       0.108802+0.11358im      0.0477348+0.137406im
    0.01658+0.0259771im     0.136858+0.0353776im    0.0993088-0.246735im     -0.0252146+0.0525245im    0.0550082-0.0210481im     0.129502+0.0294656im     0.110561+0.204837im       0.122957-0.221123im      0.019679+0.0669079im    -0.115357-0.194175im      -0.0354194-0.0448569im     -0.132548-0.0560925im       0.135001-0.0200955im     0.0183859+0.0997943im     0.190603-0.0401958im     0.0544172-0.0144696im     -0.035762-0.175595im      0.155766-0.00630526im       0.129332+0.232842im       0.285174+0.105125im    -0.0518598+0.0211497im    -0.0690377-0.0750401im       0.203592-0.236052im       0.140275-0.0584286im    -0.071836+0.0495867im     0.248148-0.0295852im    0.0936383+0.0515767im     -0.0228848-0.0875154im    -0.0059732+0.165239im      -0.253005+0.235684im     -0.0117524+0.148457im     0.0394064-0.0434833im
   0.153302+0.0802029im     -0.16793-0.00559625im   0.0250658+0.0123111im      0.105497-0.342092im      0.235223+0.162603im    -0.0155339+0.154361im    -0.0487735+0.0516524im     0.0508402+0.153033im      0.119676-0.0293638im     0.254809-0.0715942im      0.0150321-0.000742756im   -0.154537+0.122841im         0.12141+0.0831814im     -0.125484-0.0881695im   -0.0823299+0.00619336im   -0.0628014+0.211694im      -0.154153+0.00228873im  -0.0709724-0.0902953im       0.0196358-0.0818986im    -0.0403746-0.0813862im    -0.115894+0.0215608im    -0.0556768-0.160423im       -0.278327-0.0915791im      0.073919+0.0675399im   -0.0924949+0.1481im        0.044686-0.016699im     -0.138874+0.138545im        0.054068-0.0959974im   -0.00551993+0.113253im      0.0530679+0.141221im      -0.170222+0.309531im    0.00500962-0.12685im
 -0.0175737+0.0248936im    -0.166351+0.146337im     -0.109614-0.00735377im   -0.0192913+0.381229im   -0.00442706-0.13642im     0.00187161-0.0971475im   -0.0599597-0.191138im       -0.13713-0.133461im    -0.0280182-0.138251im      0.112582-0.0790005im       0.126938-0.140798im       0.109241-0.00807758im      0.206632+0.0164063im      0.121627-0.15985im      0.0175634-0.046896im     0.00877783-0.0558083im    -0.0522127+0.0801012im   -0.0927514+0.130205im        -0.123273-0.0579331im      0.300142+0.0525322im    -0.199473+0.00173747im   -0.0883708-0.148705im       -0.188432+0.0961534im       0.04349-0.00317447im  -0.0858403+0.0537289im    0.0271469+0.0633805im    -0.157047-0.252152im       -0.103631-0.146503im       -0.24991-0.0441442im    -0.0422088-0.02874im      -0.0259379+0.162738im      0.129664-0.0522373im
 -0.0219431-0.334336im     0.0704754-0.11381im       0.118534-0.207462im       0.123503+0.0260969im    0.0774403-0.0290522im   -0.0958069-0.0821844im    -0.125084-0.0250961im    0.00728819-0.0768551im     0.131015-0.142457im    -0.0661262+0.0301902im      0.0737139+0.0744638im     -0.168718-0.120342im       -0.172914+0.0868433im      0.012076-0.0425497im    -0.137279+0.165514im      0.0262739+0.164302im      0.0226573-0.00712028im  -0.0294532-0.0204206im        -0.18658-0.167611im       0.110739+0.0170372im    -0.135943-0.17082im       0.0382912-0.0958985im       0.100322-0.072129im      0.0128946+0.120181im     -0.117625-0.0505457im      0.22124+0.0248175im    0.0247635-0.00108604im      -0.26049+0.155328im       0.166811+0.17557im         0.25181-0.172234im       0.181724+0.057041im      0.172395-0.00355796im
  0.0554354+0.00158022im    0.167384-0.270732im    -0.0760541+0.0692194im        -0.156-0.134752im      -0.10317-0.151711im     0.0798182+0.113824im     -0.237546-0.214064im     -0.0635628-0.0880055im    -0.188369+0.113928im      0.184031-0.0024891im     -0.0743732-0.120416im     -0.0193822-0.092688im        0.118777-0.20325im      -0.0399457-0.00706402im    0.151052-0.0635217im    -0.0512515+0.0758305im     -0.035154-0.145951im       0.04539-0.111608im       -0.0957413+0.0794529im     0.0358122-0.0940539im   -0.0483565-0.0708788im      -0.20582+0.116805im         0.12929-0.14634im      -0.0322592-0.0322192im    0.0723461+0.0676596im    0.0506358+0.242028im     0.0593001-0.000433978im     -0.10235-0.123357im       0.146325-0.199241im       0.225601-0.187592im      -0.204466+0.111902im     0.0409298-0.0478621im
  0.0645485+0.135741im     -0.097983-0.0658841im     0.119627-0.0618661im    0.00273946-0.149462im     0.0149459+0.112157im     -0.134482+0.0638229im    0.0652045-0.206723im       0.277681-0.0265112im   -0.0176948-0.163796im     0.0186828-0.0657649im      0.0163609-0.101891im      -0.140667+0.120081im       -0.001647-0.289918im      0.0133339-0.00844198im  -0.0895238-0.014326im       0.253251-0.0589086im   -0.00767377-0.24961im        0.22729-0.135574im     -0.000490791-0.0922833im    -0.0282757-0.0667732im     0.101328-0.120794im     -0.0326865-0.0611682im      0.0450944-0.0591442im    -0.0955503-0.0171202im   -0.0400811-0.00524546im   -0.144464+0.094706im     -0.189207-0.226775im      -0.0346988+0.0238279im     -0.174889-0.0930693im     -0.154492-0.0759438im      0.373417-0.048997im     0.0547111-0.0378337im
  0.0896039+0.125353im    -0.0118796-0.0977438im     -0.10915+0.00720817im    0.0369318+0.11451im      0.0686189-0.201078im      0.119055-0.102206im     -0.159999-0.00241364im    0.0085599-0.089056im      0.125762-0.253667im    -0.0167987+0.0646729im      -0.118795+0.211307im      0.0735807-0.158974im       0.0127465+0.185977im       0.183974+0.0949534im   -0.0795411+0.201802im       0.136143+0.281266im      0.0832475-0.0608282im    0.0833133-0.0665023im       0.0828196+0.0789823im     -0.166934-0.127534im      0.183851+0.19658im       -0.180678+0.0283287im     0.00569844+0.000443536im   -0.137123-0.110497im      -0.23964+0.0637959im     0.191658+0.130762im     -0.159474+0.0643932im       0.169437+0.0140531im     -0.114535-0.143736im    -0.00703105+0.0974781im     0.0200281-0.0119053im   -0.0223056+0.0775868im
  0.0858592-0.00144094im   0.0180614-0.225127im     -0.322607+0.00578921im     0.022051-0.0604229im    0.0743044+0.0817973im    0.0335015-0.264481im      0.142543+0.196494im       0.216445+0.0228439im    0.0621677-0.209088im    -0.0513197-0.190653im        0.179124-0.0607989im     -0.183361-0.109178im       -0.143239-0.0732332im     0.0585256+0.0236401im    -0.070002-0.145462im      0.0458921-0.08873im       0.0857661+0.179269im    -0.0601721+0.189051im       -0.0655418-0.0691654im     0.0674064-0.108972im    -0.0809913+0.0332523im     -0.156631+0.00269045im     0.0387148-0.113963im      0.0301933+0.0210158im     0.200854+0.0161555im   -0.0815819+0.181548im     -0.143895+0.146348im       -0.017539-0.115907im     -0.0196705+0.0230917im    -0.0870227-0.12378im       -0.217699-0.149078im    -0.0187586+0.16653im
  0.0508584-0.0109958im   -0.0713955+0.0375447im    -0.117178-0.104002im     -0.0267124-0.0771228im    0.0464802-0.0181559im     0.143816+0.131979im     -0.071064+0.118835im      0.0611947-0.0314698im   -0.0211311+0.195287im     -0.322117-0.0893645im       0.112362-0.194905im      0.0273005-0.104912im         0.12418+0.306009im       0.136195-0.0650614im   -0.0625392-0.204352im    -0.00182446-0.00123382im     0.172994-0.0453755im     0.163617-0.150881im        -0.230814-0.0715811im      -0.21158-0.0656614im    -0.196261-0.00581639im     0.148705+0.0734241im       0.120559-0.0473254im     -0.166406-0.116243im      0.076765+0.109473im    -0.0734531-0.0742737im   -0.0545724-0.162192im        0.134634+0.0128328im     -0.201495+0.109321im       0.220839-0.0366793im     0.0154781+0.104294im    -0.0342964-0.0225602im
  0.0328528-0.0120758im    0.0468981-0.0974954im   -0.0682493-0.00198026im    -0.023672+0.0614209im    -0.216667+0.103985im     0.0499684-0.107837im     -0.032106-0.162619im       0.127615-0.0773177im    0.0943791+0.114096im    0.00446483-0.103778im       -0.130581-0.241534im      0.0668354-0.209439im       0.0402065+0.123037im      0.0211754-0.205482im      -0.18465+0.157255im       0.235572-0.0890716im     -0.131132+0.0569544im     0.076267+0.0123444im        0.112166-0.18317im      -0.0348705-0.132481im     -0.129869+0.0636077im     0.0943208-0.168835im       0.0750604+0.079896im      0.0362162+0.270344im    -0.0030619+0.0790966im   -0.0601063+0.00164811im    0.287628+0.251177im       0.0920827+0.0300969im     0.0457354-0.193569im     -0.0964606+0.126069im      0.0255966+0.0181585im   -0.0376427-0.223729im
  -0.282118+0.100202im     -0.158386+0.219113im      0.120468-0.0239847im    -0.0317341-0.116563im   -0.00319482+0.0830461im   -0.0202474-0.25245im      -0.204227-0.0582136im     0.0560265-0.0472627im   0.00948347+0.280895im     -0.238032+0.00137656im      0.144443+0.19903im      -0.0287478+0.0756445im       -0.11023-0.214944im       0.255617-0.151559im     0.0421304-0.0668422im       0.12452+0.102579im       0.104659+0.0493133im    0.0258261+0.000419211im    -0.0730608+0.115329im     -0.0651002-0.0382399im   -0.0209415+0.0450996im     -0.142054-0.0792459im      0.0145825-0.0443842im      0.139293+0.102379im     -0.190947-0.0807796im    -0.109842-0.02275im     -0.0610819+0.121765im      0.00112278-0.27697im        0.117282-0.0844698im      0.133834+0.0563925im    -0.0559363-0.0273592im    0.0632292-0.0661366im
  0.0692976+0.0182248im    0.0165318-0.121557im    -0.0102726-0.084369im    -0.00208082+0.0599578im     0.377344-0.0679362im    0.0912729-0.0770444im   -0.0443104-0.061466im       0.215936-0.00308409im  -0.0420952+0.144813im    -0.0371669+0.126111im       0.0306068+0.173742im     -0.0819329-0.104046im      0.00169405-0.165508im       -0.08674-0.413257im    -0.0422978-0.0283939im     -0.134544-0.00951113im    0.0366046+0.0142259im     0.107678+0.132442im        -0.121398+0.114414im      0.0647097+0.0732694im    0.0611361-0.125951im     -0.0309019+0.0887651im      -0.118721+0.200813im      -0.205917+0.106096im      0.146533+0.133782im      0.186764-0.15224im      0.0333591-0.145944im        0.120351+0.156735im       0.115164-0.138763im      -0.148427+0.0980042im     -0.045278-0.00986527im  -0.0906967-0.0466185im
  0.0581497+0.021178im     0.0621725-0.0913579im    -0.161466+0.251586im     -0.0541506+0.0463288im   -0.0701434+0.182997im     -0.135199+0.128863im     -0.128632-0.119262im        0.16386-0.254197im      0.034942-0.115083im    -0.0589462+0.118026im     -0.00733507+0.265803im       0.112711+0.0266694im   -0.000620405-0.00317091im    0.0163088+0.143376im     -0.135051-0.184873im       0.074765+0.0439862im    0.00341608+0.0418175im   -0.0334928+0.206017im         0.192475+0.174945im      -0.121222+0.00897334im   -0.135762-0.132948im      0.0538359-0.0245891im       0.109376+0.0916142im      0.183301-0.00836431im   0.0585263+0.220376im      0.055329-0.0800061im   -0.0134247-0.171925im        0.115796-0.0733017im      0.100004+0.275565im     0.00106095-0.112731im     0.00832189+0.0514085im    0.0724329-0.243422im
 -0.0606901-0.00328627im   -0.132179+0.0955006im    -0.113296+0.175597im     -0.0447605+0.0986919im    0.0381816-0.045012im     0.0727478+0.098717im    -0.0189258-0.12796im        0.170645+0.103331im      0.285652+0.164378im    -0.0130169-0.0502757im     -0.0105843-0.0982176im     -0.206079-0.00658971im    -0.0453464+0.0229471im     -0.118684+0.170537im      0.161451+0.142852im     -0.0849678-0.209122im      0.0899791-0.223991im     -0.145266+0.290443im        0.0740424-0.240078im     -0.0129893+0.0609977im    -0.015582+0.112315im     -0.0421882+0.166091im        0.101193-0.0663706im     -0.217659-0.0260495im    -0.154123+0.113553im      0.118469-0.132244im     -0.166485+0.0088729im     -0.0742153-0.119081im       0.120381-0.0508634im      0.105687+0.0550148im     0.0250125-0.112328im     0.0823151-0.17286im
  -0.153373+0.132452im      0.130144-0.102636im    -0.0746655+0.0014197im   -0.00341822+0.0940334im   -0.0931551+0.00553791im    0.261394-0.089765im    -0.0436447-0.0166152im    -0.0970776+0.0136485im   -0.0737913-0.126435im    -0.0650799-0.0242017im      0.0948232-0.0164537im    -0.0737484-0.00934914im     -0.032499-0.0640616im    -0.0884444-0.0329677im    -0.162967+0.010155im     -0.0898491+0.107638im      0.0830132-0.357972im     -0.180874+0.0158685im       -0.197656-0.240524im     -0.0607979+0.0765849im     0.012039-0.234801im     -0.0524164+0.276546im      -0.0848544+0.0460749im      0.301841-0.0717321im    -0.138015-0.100626im     -0.137911-0.00510972im   0.0479711+0.0785298im        0.16402-0.00317024im   0.00654223+0.138485im      -0.167336+0.111338im      0.0573324+0.128243im     -0.164232-0.11929im
 -0.0538115-0.0950036im   -0.0138212+0.0358127im     0.129085+0.251397im       0.259098+0.0282453im    0.0634194-0.145446im     0.0541069+0.135782im     0.0555738+0.0477185im      0.225283-0.12107im      0.0862726-0.0151547im    0.0542295+0.0129065im    -0.00600697-0.0578513im     0.0551948+0.0329269im     0.00349014-0.134806im      0.0593307-0.0383029im     -0.18097-0.128299im      0.0964222-0.0932148im   -0.00919754+0.143831im     -0.326998-0.341622im        -0.189944-0.037662im       0.112779-0.129484im     0.0737861+0.0443678im      0.116553+0.0796556im       0.224599+0.0125733im      0.074873-0.157166im     -0.233461+0.182334im     0.0284187-0.12252im      0.0709294-0.041734im      -0.0205335-0.013745im      0.0949522-0.122187im      -0.131662-0.00993107im    -0.153686+0.012969im    -0.0266993+0.12791im
   -0.13772+0.176201im     0.0393046+0.262099im    -0.0612764-0.0764078im     0.0188316-0.18892im     -0.0867286-0.0929869im    -0.166164-0.0707727im   -0.0855566-0.118654im     -0.0653687-0.19766im      0.0321339+0.0906435im    0.0664562-0.0734139im      -0.187984-0.0969559im     -0.232288-0.0746703im      -0.132763+0.0204169im     0.0972952-0.0090265im   -0.0320039-0.0431724im    0.00981505+0.00120249im    -0.112713+0.18498im      0.0606702+0.0126465im        0.103231-0.257631im       0.100662+0.227438im     0.0549254+0.0180834im     0.0141387+0.13473im       -0.0134744+0.0372366im    -0.0292386-0.0878086im    0.0647805+0.0903354im     0.114226+0.0916399im   -0.0720982-0.056717im        0.350362+0.0726064im      0.172339+0.0999127im    -0.0622481-0.183866im      0.0247663+0.189689im    -0.0606466+0.2394im
   0.225335-0.00852763im   0.0985944+0.193051im     0.0973088+0.0861564im     -0.223177+0.151588im       -0.1308+0.0380346im     0.055505-0.179576im    -0.0136495+0.0815618im      0.203215+0.0800742im    -0.095941+0.0735133im    0.0684397+0.0495417im     -0.0122607-0.107528im      -0.108914+0.024068im        -0.11802+0.196334im       0.118545-0.046957im      0.124228+0.301409im     -0.0159955+0.0674193im    -0.0522535+0.0121494im   -0.0261137-0.104232im        0.0113666+0.0116371im    -0.0428058-0.333409im     0.0944122-0.11216im       -0.150512+0.000216807im  -0.00595434-0.0567561im     0.0769408+0.0469898im    0.0532903-0.00413197im   -0.125799-0.144688im     -0.119542-0.351584im      -0.0575497+0.0176919im      0.208057+0.161511im      -0.101082-0.0463268im     -0.128934+0.0907301im    -0.079543+0.0325181im
 -0.0570136+0.117469im     -0.165593-0.0455771im    0.0174919+0.00711444im     0.173853-0.0345699im   -0.0574227+0.194546im      0.192375+0.108188im    -0.0362654+0.316697im     0.00663484-0.273825im     0.0697582-0.00479378im  -0.0259996+0.0711907im     -0.0983038-0.372435im      0.0893189+0.112594im       0.0166664-0.0111262im    -0.0314747-0.0750625im    0.0350982-0.025606im       0.040119+0.293871im     -0.0395666+0.0325251im    -0.059532+0.108739im        0.0531057-0.0930952im   -0.00297197+0.0215498im     0.182588-0.161582im      -0.211927-0.00454727im    -0.0147975+0.214304im     -0.0682083+0.00100424im    0.106151-0.144818im      0.121015+0.00727177im   0.0851492-0.135172im      -0.0184451-0.0696269im     0.0793564-0.0137409im     0.0954739+0.0383716im   -0.00722799-0.215035im      0.229106+0.00172749im
 -0.0548407+0.0573018im     0.106986-0.0854599im   -0.0945836-0.0105941im    0.00208464-0.0145481im    -0.244967-0.0313017im    0.0827465+0.14046im       0.205525+0.0968729im      0.156784+0.0693587im   -0.0912978-0.0597808im   -0.0898682+0.286531im       0.0383287-0.114577im       0.028295+0.0140479im      -0.186936-0.174455im      0.0674443+0.0201663im     0.112966+0.12125im      -0.0353758-0.0922216im    0.00515981+0.250356im     0.0711414+0.0056523im       -0.103306-0.0494672im    -0.0944702+0.129958im     0.0225313-0.0816835im     0.0878211-0.21934im       -0.0102931+0.0136308im      0.081971-0.0198915im   -0.0617593-0.0936852im      0.33468-0.0121219im    -0.265706+0.0273245im      0.0201701-0.0680869im    -0.0755117-0.146469im       0.136383+0.0580045im    0.00761605+0.259412im     -0.222735-0.165856im
  0.0139079-0.282349im    -0.0549416+0.0910897im     -0.13578-0.0784613im    -0.0656375+0.0637774im     0.081927-0.0595587im   -0.0445268+0.0852968im    -0.255037+0.101907im       0.137393+0.0537041im     -0.16272-0.0613167im    0.0163532+0.131216im       -0.248813-0.141544im      0.0970606-0.235963im       -0.075452-0.106325im      -0.177195-0.0386955im   -0.0189804-0.0591546im      0.101014+0.0770512im     0.0625986+0.0751236im     0.155665+0.178835im        0.0206438-0.0464144im      0.038281+0.0222802im     0.175286-0.0913523im      0.179835-0.0301449im      -0.233873-0.319354im      0.0834217-0.188307im     -0.159754-0.00229543im   -0.205641-0.171751im    0.00993528+0.0620251im      0.0485376-0.183534im     0.00235408-0.00869601im    -0.043848-0.0043378im   -0.00873572-0.0339314im    0.0939059+0.057687im
  0.0602353+0.0285576im   0.00615233-0.0300203im    -0.215126-0.102584im     0.00730626-0.062856im     -0.199858+0.0743353im   -0.0592547+0.244107im     0.0383672-0.0702434im     0.0428785-0.209479im      0.170272+0.0729878im    0.0814835-0.24493im         0.120255+0.156602im      -0.054036-0.118336im        0.107627-0.0326142im     0.0653608-0.100816im     -0.155076+0.210223im      0.0056043-0.0363729im     -0.248147+0.0775825im    0.0864079+0.0914737im       -0.189108+0.185485im     -0.0475738+0.106975im      0.169578+0.0259445im    -0.0343874+0.115933im      -0.0333373+0.0399075im    -0.0912755-0.17277im      -0.122665-0.323773im     -0.151363-0.232244im    -0.0303014+0.0115473im      -0.184811+0.049274im    -0.00127238+0.0692865im     0.0276604-0.0198466im      -0.15188+0.0136838im   -0.0603981+0.0106716im
   0.112929-0.241225im     -0.129512+0.00242095im   0.0538426-0.174169im      -0.169318-0.301102im     -0.124887+0.0779023im    0.0176742-0.0866934im    -0.095801+0.0833996im    0.00997189-0.0861805im    0.0711349-0.201725im      0.110047+0.198031im    -0.000628607-0.0445022im     -0.162841-0.22164im        0.0168173+0.0275566im      0.193902+0.00122864im    0.127408-0.181122im      -0.215191-0.169785im      0.0336063-0.105243im    -0.0585272-0.0263573im       0.0389274+0.0734323im     0.0800575-0.132397im    0.00302083+0.16589im        0.162448+0.110906im      -0.0243812+0.406965im      0.0700843-0.0959957im    -0.112715-0.0885341im   -0.0247913+0.0584187im   -0.0348484-0.0289005im    0.000479967-0.0710376im     0.0609769-0.0696619im    -0.0722553+0.0811179im     0.0535385-0.00318407im   0.0369133-0.137967im
   0.174509+0.0963267im   -0.0858305+0.0312895im    0.0452269-0.14252im      -0.0704195+0.0942866im    0.0219358+0.160951im     -0.208812+0.0125199im    0.0887869-0.0281781im    -0.0388544-0.195205im     -0.178052+0.159345im     -0.303525+0.196174im        0.103262+0.0504568im     -0.091507-0.209189im        0.104745-0.106954im      -0.159213+0.318621im     0.0351705+0.0813134im    -0.0749287+0.272127im      -0.050774+0.0260017im    -0.199339-0.0586438im      -0.0714939-0.196081im       0.101495-0.0649018im    0.0488081+0.0573494im    -0.0323885-0.065922im       0.0209178+0.0954588im    -0.0992445-0.0337698im    0.0310009+0.120012im     -0.106791-0.0943374im   -0.0460097+0.181708im      -0.0322032+0.0565604im    -0.0997638-0.143918im      -0.146653-0.152322im      -0.103404+0.0607516im    0.0178994-0.0788202im
  -0.101313+0.00568885im    0.105142+0.0331308im    0.0415005+0.0290628im    -0.0826792-0.0252674im   -0.0693693+0.0775361im     -0.09778+0.217307im      0.128505+0.157422im       0.173753-0.140527im    -0.0889827-0.0668678im    0.0765472+0.0676838im     -0.0464396+0.115416im      0.0720516-0.0162368im     0.00122638-0.18615im       0.0856797-0.184983im     0.0834428+0.186706im    -0.00767283+0.231609im       0.119164+0.00539922im  -0.0654143+0.0714263im       0.0805463-0.126464im       0.158981-0.0978364im    -0.368082+0.250081im      0.0891749+0.336596im      -0.0903348-0.111262im       -0.13429+0.200455im    -0.0767198-0.0379479im   -0.0530773+0.0883007im    0.0881364-0.0957596im      0.0409592-0.0249942im     -0.160086+0.0866043im     0.0933111+0.0637286im     0.0258573-0.0698815im    -0.134078+0.0871621im
 0.00407204-0.0981004im     0.120935+0.328044im     -0.281437-0.0884884im      0.284088-0.171857im     0.0479005+0.145483im       0.27147-0.0871033im  -0.00310491-0.159621im      0.0855502-0.0536028im    -0.132653+0.0744808im    0.0396403+0.0674015im       0.165108+0.0727763im     0.0301285+0.0500415im       0.111585+0.0867267im     -0.076776+0.0989607im   -0.0721792+0.116045im      -0.155689+0.0468176im    -0.0492042+0.0531489im    0.0562838-0.0202302im        0.131782-0.00111542im    -0.140582-0.0760918im   -0.0445392-0.0377613im      0.113948+0.157049im      -0.0276989-0.0698024im      0.101107+0.0515873im      0.01494-0.0091108im     0.194717+0.0751522im    0.0928626-0.0845321im      -0.211239-0.193315im     -0.0630021-0.21125im       -0.179469-0.138571im        0.14565-0.0385022im     0.019633+0.0915411im
  -0.076467-0.174095im      0.114357-0.042053im     -0.085861+0.0150875im    -0.0401725-0.055016im    -0.0122914+0.179358im    -0.0126469+0.128227im    -0.0152734+0.0908098im      -0.06603+0.120956im     -0.104338-0.0258354im    -0.129599+0.0491262im     -0.0643114-0.0422118im     0.0730726-0.0465198im      -0.128369+0.00455798im    0.0815327+0.105766im     -0.187222-0.0121625im     0.0153819-0.0814305im     -0.182526-0.216325im     0.0646323+0.0417156im      -0.0316292+0.0181613im    -0.0151493+0.205348im    -0.0473019+0.162713im      -0.272191+0.0388434im      0.0422565+0.137304im      0.0962911+0.291645im    -0.0598233+0.212494im    -0.0826431-0.175177im     -0.124216-0.137681im      -0.0646804+0.0290194im   -0.00499442-0.195457im     0.00864556+0.151458im      -0.051106+0.184365im      0.173901+0.370132im
  -0.076034+0.300157im    -0.0672245-0.132308im    -0.0578454-0.131242im     -0.0255243+0.114892im      0.227346-0.01886im      -0.173444-0.0618563im   -0.0294687+0.200326im     -0.0432741-0.107561im    -0.0284777+0.0358484im     0.220885-0.0675754im     0.00646515-0.156929im       0.145759-0.114406im        0.134471-0.152635im       0.147099+0.263629im    -0.0716311+0.0928767im     -0.234122-0.220449im      0.0898915+0.100099im     0.0406895-0.0310805im      -0.0550246+0.0509531im     -0.173912-0.158324im     0.0605215-0.120922im       0.106031+0.0903658im     -0.0161627-0.0153592im    -0.0112825+0.314396im     -0.160388+0.0334569im   0.00621517-0.0920752im    0.0314157+0.0337864im      -0.015546-0.089627im       0.149728+0.0895263im     0.0427615-0.029454im       0.175796+0.0981601im    0.0338737+0.0611877im
  0.0964863+0.111999im     0.0650485+0.154593im      0.209814+0.0481857im      -0.16508+0.113262im    -0.0601569+0.0332476im     0.137847+0.101762im    -0.0247046-0.021621im    -0.00301002-0.00077175im   0.0221307+0.00488232im   0.0100426+0.0973654im      0.0382403-0.0431326im     -0.329871-0.0389515im       0.273039-0.116519im    -0.00163838+0.0718609im    -0.213471-0.0308375im     0.0849204-0.104322im      0.0393478+0.0464014im    0.0671332+0.139124im        0.0564078+0.0676706im    -0.0521228-0.167477im     -0.192775-0.165303im      0.0320847+0.00325337im     -0.141077+0.0207733im      0.239467-0.0775214im   -0.0403401-0.0315397im     0.168161-0.0599612im   -0.0523169+0.139855im       0.0808477+0.22991im      -0.0630037-0.118667im        0.23367+0.0308405im    -0.0608071-0.215389im     0.0785687+0.292243im
 -0.0610658+0.141134im      0.229061+0.0618555im     0.144351-0.0175351im     0.0519601+0.1454im        0.116913+0.0700137im   -0.0104108+0.0344386im   -0.0211834-0.179014im      0.0343968+0.0660321im    -0.159985-0.252898im     0.0166704-0.104467im       0.0211294-0.200112im      -0.304488-0.195605im       -0.165143+0.105167im     -0.0360311+0.125639im    -0.0408515-0.153411im      0.0783094+0.110947im      -0.028257+0.19576im      -0.137055-0.177302im      -0.00621107+0.234902im      -0.127998+0.193323im    -0.0605542+0.147971im    -0.00439727+0.129274im       -0.107934-0.0180038im     -0.136589+0.0908366im     0.057533-0.132198im    -0.0181744-0.136722im     0.0662159-0.0920565im    -0.00587025-0.17689im       0.0249272-0.0720373im     0.0833362+0.112241im     0.00371822-0.0825429im    0.0507061-0.218317im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.2239888704329351 + 0.056058064716432765im
   0.16433540771486166 - 0.07309821458479913im
    0.0506174901357658 - 0.09325769996947357im
   0.07893053728773668 - 0.17866016907478494im
  -0.07368913935420816 - 0.05726586304887258im
  0.024883136338939987 - 0.0676297468895904im
    0.0947144864892484 + 0.026089401432259282im
   0.15295488248323225 + 0.02911333435797538im
   0.10012054005776416 - 0.015590502959127263im
  -0.11505278695250903 + 0.03322030091657278im
  -0.19263345488692243 + 0.11897267045262751im
  0.027224283802550472 - 0.06862513361953312im
   0.18230994750925025 + 0.09092024599287142im
    0.3114983928474543 - 0.027708165582294633im
   0.14574757648095255 + 0.06297272374255328im
   -0.1852599973016324 + 0.01702850524385093im
   0.40630660844679445 + 0.0im
   0.03809567925013222 + 0.10768663491673436im
  -0.02354262873867255 + 0.03233360427441062im
  -0.23201576288103187 + 0.23125591138122176im
   0.15487022747218068 + 0.10146642520705534im
  0.025213252918481213 + 0.03832819370747007im
  -0.17182254415318052 - 0.03142999638599138im
 -0.055755415104167164 - 0.15814362819795824im
   0.05489195943859207 - 0.02665509747832427im
  -0.02319765315272686 - 0.0874041517701585im
  -0.05656489164453288 + 0.06115409330512582im
  0.029949709067405163 + 0.027251397808119207im
   0.17348919102460902 - 0.1303553467622424im
  -0.09448626164198147 + 0.25581145548643147im
   -0.0915506148771235 + 0.022082437959152528im
  0.005088841477603387 - 0.06163644512397626im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 21 October 2022 21:47">Friday 21 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0830572+0.0143286im     -0.264662-0.0762432im       0.143586-0.0193778im     0.0514528+0.20471im       0.0844834-0.0731835im    -0.0740296+0.290139im      0.307549-0.115748im      -0.0679885-0.0442873im    -0.0614538-0.0291191im     0.0248758-0.143633im      -0.256454+0.125883im     0.0198106-0.0253158im     -0.10516-0.13936im       0.0700112-0.182269im     -0.0594896-0.136075im       0.148602+0.0312156im       0.152338+0.260344im       0.115966-0.0795725im   -0.0500722+0.00674682im    0.0744519+0.0378181im    0.0191224-0.0242361im     0.150891-0.00204442im   -0.0817801+0.0642782im    -0.208996-0.174195im     -0.0731527-0.0209461im      0.107803-0.123938im     0.0801515+0.0648578im     0.172591-0.157376im    -0.0506289-0.0977305im     0.0343764-0.0426742im      0.157491+0.0942305im        0.191239-0.018445im
   -0.104329-0.0228356im     0.0285991-0.117387im        0.178415-0.0936429im     -0.135619-0.0141844im      0.162828-0.0457084im     -0.164423+0.0209128im     0.101496-0.142866im       0.0727079+0.0469589im     -0.108929-0.105965im     -0.0869029+0.0475711im      0.144009-0.0590351im    -0.168684+0.0452346im    0.0213791-0.176585im        0.16443-0.210601im      -0.275672+0.25339im      -0.0999459-0.0199108im   -0.000614673-0.0423986im     -0.170137+0.00287638im  -0.0887337+0.0635823im      0.155769+0.0238963im    0.0204751+0.156047im       0.01059+0.208449im     -0.0718152+0.0149012im     0.209871+0.22685im      -0.0779868+0.205121im      0.0443028+0.0107346im    0.0465146-0.0644411im    0.0129765+0.173612im     -0.313813+0.0408687im      -0.05045-0.195912im     -0.0291513-0.000728488im      0.016644-0.11613im
    0.113251+0.109666im       0.161392-0.0507464im       0.158786-0.0805916im     0.0588574+0.290748im       0.187038+0.0621578im      0.161565+0.111235im     0.0406321+0.235953im       -0.122377-0.00519759im    -0.164257-0.281212im    -0.00524105-0.0295514im    -0.0048434-0.0132086im    -0.147061+0.0759374im    0.0207207+0.0208326im    -0.0858952+0.240047im       0.275166-0.014199im     -0.0236229-0.108319im       -0.201279-0.175222im     -0.0775661-0.123229im     -0.137379+0.00716153im    0.0402183-0.0181301im    0.0561113+0.00448335im   0.0970118-0.0562972im    -0.0608796-0.0327072im   -0.0609698+0.0938258im     -0.162665+0.100891im      -0.143455-0.203481im     0.0835871+0.0478359im     0.166915-0.0243712im    -0.128783+0.141472im       0.180626+0.123027im     -0.0505512-0.128563im        0.0465199-0.0157043im
    0.203122+0.0413137im     0.0314649+0.0106325im      -0.137316+0.0893063im      -0.21212-0.0132085im     -0.023664-0.0495412im      0.207977+0.0889651im    -0.103006-0.0192149im      0.0912945+0.242149im     -0.0540023-0.166923im     -0.0857081-0.161095im      0.0289244-0.0501815im    -0.261361-0.230199im    -0.0387717-0.0748365im     0.0283825-0.0993776im     0.0778983+0.080059im     -0.0300069-0.193236im     -0.00218738+0.241178im      -0.251837+0.225562im     0.0593919+0.0872987im     0.0258684-0.145891im     -0.139444-0.125136im    -0.0245121+0.129058im    -0.00329643+0.128333im    0.00241845-0.275698im     -0.0653096+0.0192293im     -0.134576+0.0247675im    -0.071437+0.152266im     -0.112731-0.130145im    -0.0511931-0.179767im      0.0260959+0.0178247im     -0.113526+0.0268386im        0.068793+0.0925293im
  -0.0623629+0.0310414im    -0.0847153-0.181126im      0.00629481-0.165013im      -0.140579+0.0511428im    0.00279661-0.0448725im     0.0895067-0.254994im    -0.0518014+0.0547227im      -0.131701+0.0999346im    -0.0992986-0.148737im      0.0216932+0.141378im      -0.141342+0.0432931im   -0.0440136+0.070357im     0.0775212-0.0559722im    -0.0690986-0.0356326im     -0.155679+0.173786im       0.122073-0.191361im       0.0927681-0.00810013im     0.130055+0.0203765im    -0.169782-0.026215im     -0.0340172+0.0726962im     0.143653+0.156999im     0.0522627-0.166154im      -0.376025+0.08558im     -0.0500763-0.0157816im    -0.0349629-0.108909im     -0.0692378+0.0161846im    0.0500545+0.01928im      -0.296786-0.0245578im     0.262256+0.0576275im     -0.174527-0.0258465im    -0.0664739-0.0416045im       0.0852767+0.28235im
   -0.100131-0.0555435im     0.0281172-0.207902im      -0.0599119+0.0137929im    -0.0767244+0.274217im       0.147283-0.134816im     -0.0101673+0.0557166im    -0.324288-0.0764133im      0.0242681+0.217843im      0.0135849+0.232622im    0.000764989-0.161212im         0.1259-0.0156883im    0.0948644+0.215808im      0.052337-0.126875im      -0.287975+0.0831366im     -0.205093-0.0838985im    -0.0434404-0.0481141im     -0.0629649+0.00292734im   0.00469933-0.201731im    0.00461367+0.0245923im     -0.149365+0.0736343im    -0.119725-0.171749im    -0.0484062+0.163031im      -0.170767-0.0958011im   -0.0183758-0.0262397im    -0.0316297-0.0721713im     0.0649656+0.172248im      0.164955-0.0542953im      0.11543-0.153684im      -0.10213-0.113396im      0.0206665+0.0842458im    -0.0612204-0.003093im        -0.117226+0.0356524im
  -0.0988879-0.109934im       0.127529-0.122566im       0.0646625+0.228339im      0.0585246-0.169194im     -0.0857017-0.215928im     0.00438109+0.195671im      0.051417-0.0209837im     0.00971018-0.01136im       -0.067602-0.0853292im      0.077351+0.176105im     -0.0455478+0.247828im      0.114315-0.0894246im    -0.014446-0.148385im      -0.238953+0.00882113im    0.0859633-0.0693872im      0.151172+0.209998im       -0.229085-0.109969im      -0.101185+0.0984642im    -0.142561+0.119309im      0.0733845-0.108265im     -0.222809-0.0259558im   -0.0121839-0.10198im      -0.0580505-0.0456163im    0.0435064+0.0188037im   -0.00845055-0.0175796im    -0.0135581+0.252958im      0.106445+0.0906073im    -0.206178+0.0727386im    -0.144565+0.0870119im     -0.140738+0.115252im       0.100494-0.0425775im        0.246028+0.0173475im
    0.116181-0.0459472im     -0.137021-0.0953698im       0.204053-0.112464im     -0.0559065-0.0267596im   -0.00582743+0.223804im      -0.136981-0.0579856im    0.0045106+0.0419561im     -0.0653687+0.132927im      0.0632422+0.126044im     -0.0483672-0.00286964im     0.202225-0.0501177im   -0.0554543-0.0650398im    -0.276295+0.13654im        0.134545+0.0461927im     0.0274125+0.0774866im     0.0114627+0.0966445im     -0.0717429-0.0806958im     0.0049592-0.247043im     0.0287599+0.349282im      -0.015262+0.0920238im   -0.0431291-0.0922294im   -0.0187666-0.0312727im      0.074126-0.223491im     -0.124913-0.13524im      -0.0318901+0.0816607im     -0.116339-0.00592683im   0.0692814+0.237857im     -0.141387-0.113246im    -0.0416232+0.169785im      -0.268215+0.0260182im     0.0597026+0.241515im        0.0337873+0.105361im
 -0.00164139-0.143759im      -0.101215+0.0863202im       0.235372+0.160904im       0.113442-0.0217442im      0.054707-0.0520287im     -0.123883+0.00753659im    0.139215+0.0826989im     -0.0892061+0.19267im      -0.0576324-0.26321im        0.156144+0.0652366im    -0.0839437-0.122434im      0.107135+0.0673169im    -0.161524+0.0759185im     -0.200839+0.124382im      0.0340397-0.0646994im    -0.0777599-0.238927im        0.155401+0.0584178im     -0.246421+0.0698397im   -0.0537587+0.00789847im   -0.0173972-0.145573im     0.0712041+0.124471im     -0.110696+0.119972im       0.122028-0.086888im     0.0571834+0.056499im      0.0928349-0.211177im      0.0616891-0.0410895im     0.144787-0.0894108im   -0.0129912-0.0920224im    0.0643708-0.121077im      -0.271043-0.00970021im   -0.0572645+0.135598im        -0.251918-0.107994im
   -0.135773+0.0428139im     0.0145467-0.0488558im      -0.167842+0.0600356im      0.311031-0.0321512im     0.0402233+0.0807797im     -0.164542+0.0388901im    0.0115217+0.0667356im    -0.00974201+0.0963961im   -0.00922871-0.217095im        -0.1543-0.119844im    -0.00191058+0.0129972im    -0.186642+0.130165im      0.217872+0.11137im        0.156302+0.0157852im    -0.0352804+0.120512im       0.137094+0.0298578im       0.138546-0.0815765im     0.0880336+0.0311049im   -0.0311252+0.18719im       -0.302564-0.0762453im   -0.0549441-0.112377im     0.0482186-0.166343im      -0.114422-0.0598797im      0.20649-0.175047im     -0.0122265-0.0312984im      0.226843+0.0117857im    -0.042187+0.0700899im   -0.0847904-0.0957778im   -0.0333855+0.00786541im   -0.0512038+0.109422im      -0.103579-0.027799im         0.017281-0.364215im
   -0.197867+0.0277442im     0.0205772-0.229165im       -0.152938+0.121938im       -0.33497-0.00106153im     0.116173-0.0110325im     -0.153146+0.0679636im    0.0670527+0.0811198im      -0.266229-0.018072im      -0.134252+0.0800563im    -0.0271181+0.00592393im     0.058979+0.206186im    -0.0900696+0.0386464im    -0.100461+0.0923158im     0.0771134+0.181676im     -0.0175764-0.0761094im    -0.0765476+0.0304522im       0.198209-0.0398101im     -0.157291-0.0330177im     0.215624-0.23938im      -0.0137929-0.100087im     -0.179656-0.09787im      0.0481949-0.0969873im     0.0812606+0.193351im       0.10907+0.132816im       0.165953+0.0679823im     0.0340329-0.230609im     -0.065385-0.0594944im    -0.125993-0.105255im    0.00415669+0.129769im     -0.0163691+0.118935im      0.0212243+0.118426im        0.0285407+0.076174im
  -0.0938972+0.115372im     -0.0543439-0.0126335im       0.132272-0.0647976im      0.260308-0.169027im       0.118046+0.118596im      -0.201702+0.0536885im    -0.173237+0.0283336im     -0.0047227-0.0632996im     -0.104774+0.23327im        0.106425+0.171925im      0.0875932-0.130625im     -0.214043-0.127603im      0.066908-0.0196039im   -0.00898401-0.17902im       0.0866947-0.111688im      -0.173164-0.220897im      0.00758699+0.0354682im    -0.0986137+0.0301151im    -0.277408-0.230515im     -0.0558281-0.101861im     -0.120315-0.0925497im    -0.125485+0.0445472im    0.00166176-0.010393im     -0.189259-0.110412im     -0.0549695+0.0175918im      0.179971+0.018623im     -0.075688-0.140128im    0.00610669-0.109547im     0.0243468+0.198462im     -0.0361193+0.0465484im    -0.0521381-0.0947757im        0.181108+0.124937im
   0.0390069-0.172947im       -0.13017+0.0387754im       0.192791+0.0786956im     -0.063973-0.0531102im    -0.0192225-0.0175941im     -0.017526-0.0427526im    0.0585193-0.13414im         0.111032+0.142129im      0.0725216-0.261588im     -0.0333947-0.0529092im    -0.0760223+0.033411im    -2.1827e-5-0.00868098im    0.120221+0.163458im       -0.28989+0.0726986im     -0.186468+0.103921im      -0.241812+0.0980385im      -0.122923+0.20421im       0.0388783-0.0933744im    0.0662406-0.195305im      -0.141626+0.158665im    -0.0518396-0.234877im     -0.148444-0.138215im    -0.00977412+0.105372im    0.00394593-0.0849166im    -0.0639803+0.0662351im    -0.0979498-0.0693744im    -0.215377-0.00824411im    0.141161+0.103017im     0.0505055+0.330971im     -0.0423551-0.0826039im     0.0108142-0.0128105im        0.119292-0.0838755im
   -0.101558+0.191816im       0.144145-0.181418im       0.0184786-0.279762im      -0.021198-0.0312255im    -0.0709574-0.0790071im      0.135396+0.0702631im    -0.104925+0.130226im       0.0590679+0.0642139im      0.190402-0.133775im      0.0408741+0.0530633im     -0.238385+0.0083605im   0.00923925-0.0257064im    -0.123437-0.0210895im      0.160972-0.0568179im      0.093627-0.176665im      -0.120838-0.00951177im       0.29541-0.115876im     -0.0742167-0.131599im     0.0492097+0.0423521im     -0.199022-0.00880708im   -0.148309-0.0221957im    -0.259227-0.0717633im     0.0666741+0.137063im      0.122282-0.0706789im    -0.0938909-0.066632im     -0.0576421+0.160711im      0.158039+0.032021im      0.200466+0.191425im    -0.0279049+0.0684161im    -0.0801387-0.217241im       0.148273-0.00802908im     -0.0131545+0.0360262im
   0.0772189-0.111516im      0.0347795+0.0667633im     -0.0951559-0.0774423im    -0.0689609-0.0688498im     -0.274291-0.210718im      -0.148716+0.0425458im    -0.182788+0.0246323im     -0.0480947-0.176936im      0.0140041-0.116096im     -0.0124059-0.0902179im      0.125412-0.159874im      0.170623+0.156423im     0.0131168+0.0701418im      0.152939-0.121433im      -0.108881-0.172276im      0.0958224-0.049169im       0.0557336+0.0881484im     0.0362017+0.0507397im    -0.111891-0.154554im       0.083057+0.0259903im    0.0543771+0.0544758im     -0.10973-0.0529793im     0.0154167+0.0727712im    0.0312682+0.00765351im    -0.259007-0.0248422im     -0.203461-0.119803im      0.200646+0.0574491im    0.0551091-0.0715531im    -0.159673+0.159662im     -0.0813109+0.310961im      -0.230887+0.194607im         0.119997-0.0765573im
   0.0510674+0.136201im       0.146677-0.0389717im   -0.000831802+0.0839452im      0.119375-0.141756im     -0.0442699-0.242065im    -0.00633855+0.0693596im     -0.13778-0.137602im       -0.230488+0.0880469im    -0.0412139-0.072978im      -0.166368+0.230118im       0.140467-0.0452543im    -0.172293+0.054749im      0.118533+0.182971im      -0.097691+0.14288im      -0.0234694-0.0378865im    0.00439959+0.0749441im      0.0622231+0.123276im     -0.0504644-0.128551im     0.0495213+0.0558932im    -0.0152568+0.110236im      0.127883+0.196637im      0.196771-0.0161146im      0.120193-0.0602074im   -0.0182692-0.162335im     -0.0861823+0.200683im        0.06028+0.0375214im    0.0230869-0.17574im       0.171238+0.130403im      0.131707-0.230747im    -0.00244158-0.0361383im     0.0979886+0.251724im         0.174498+0.149407im
   -0.117755+0.323619im      -0.031457+0.0258585im      0.0701489-0.0530802im      -0.11403-0.130455im     -0.0445431+0.1425im        0.0101504-0.105116im     0.0829541+0.0219225im     -0.0385863+0.0803843im    -0.0759438+0.0136432im     -0.218601-0.149085im       0.109997-0.00125275im    0.233898+0.108869im    -0.0211229+0.0546729im      -0.14149-0.10864im        0.105595+0.0103473im     -0.180807-0.0578744im      -0.029238-0.0536411im    -0.0952528+0.184974im      0.090595-0.0878653im      0.206986-0.0496235im    -0.125987+0.00931225im    0.123024-0.230684im       -0.15545-0.175593im   -0.00278945+0.135227im      -0.184468-0.157227im       0.130114+0.206423im     -0.045415+0.168436im      0.203299-0.0809322im    0.0946551-0.0491402im     0.0516967-0.104192im     -0.0511041+0.205433im         0.123064-0.0934226im
   -0.133084-0.0327401im    -0.0359089-0.276506im        0.160089-0.0683919im     0.0816924+0.0406484im     0.0692718-0.202774im      -0.050677-0.202592im     0.0412562+0.00106838im      0.102215-0.165929im      0.0705485-0.0223574im      0.136173+0.0401116im     0.0416103-0.159724im     0.0267134-0.104347im    -0.0672243+0.108743im      -0.163336-0.0810799im    -0.0858515-0.170483im      0.0414072-0.0903437im      0.0888114-0.191411im     -0.0130269-0.0494228im    0.0975947-0.0136758im      0.171882-0.0971116im    -0.101305-0.0285842im     0.106296-0.047253im     -0.0130757+0.0393399im    0.0270684-0.175617im      -0.176489+0.286537im      -0.142903-0.00442582im   -0.315054+0.168915im    -0.0821248+0.0267033im     0.110856-0.229878im      0.0531288+0.145269im    -0.00089198-0.0665149im       -0.168557-0.175162im
    -0.23653+0.153525im      0.0747937-0.00246459im    -0.0159693+0.00394407im   -0.0816672+0.0534498im      0.165439+0.0391981im    -0.0318754+0.0979953im    0.0627578+0.121545im       0.0585484-0.0486748im    -0.0892401+0.0842181im     -0.187414+0.14017im      -0.0135303-0.12907im       0.320778-0.0759126im     0.194561+0.139524im     -0.0672816+0.0639698im     -0.149078-0.0202793im      0.165576-0.0934585im     -0.0379887+0.0438682im     0.0137017+0.0970319im     0.164878+0.217368im      -0.190556-0.135816im     0.0986024+0.0464817im   -0.0517929+0.128487im       0.191631+0.0850345im    -0.221587+0.0163523im     0.0135082-0.00976358im    -0.202197-0.0691403im   -0.0982238+0.060821im     0.0663418-0.0116935im   -0.0931344-0.00235088im    -0.212372-0.151237im      -0.187776-0.16275im          0.228225+0.0110963im
   -0.170753-0.0679227im     0.0637156-0.0704621im       -0.11789-0.0927854im    -0.0121931-0.0599555im    -0.0803063+0.266328im     0.00191552+0.187976im     0.0799622-0.101938im        0.134871+0.257344im       0.016278+0.142099im       0.179795+0.0462627im     -0.156611-0.0998109im   -0.0670386+0.0475737im   -0.0444066+0.207841im       -0.16376+0.0306799im      0.140158-0.046492im       0.142376-0.045068im      -0.0519705+0.0541762im    0.00107538-0.0393167im   -0.0453451-0.176109im      0.0551013+0.353718im     0.0386887+0.168998im      0.135495-0.0745191im      0.201342+0.127805im      0.190337+0.0179617im      -0.15658+0.0938754im     0.0316871+0.0713288im    0.0669078+0.109333im     -0.162114-0.150944im     -0.136376-0.0476501im     0.0340808-0.131927im      -0.201028-0.0554919im     0.000629856-0.013587im
   0.0107013-0.0261374im     -0.010907+0.032276im      -0.0881253-0.10409im       0.0857611+0.0456224im     -0.118479+0.156813im       0.200942+0.140777im      0.246042+0.000991156im    0.0155484-0.149457im      0.0323941-0.133593im       0.180005-0.0895842im      0.441104-0.0939301im    0.0364648+0.131478im      0.303367-0.151399im     -0.0921385+0.00986646im    0.0597257-0.133061im     -0.0639582-0.0608255im      0.0521753+0.0339445im    0.00531229-0.176184im     0.0275275-0.0496081im     -0.118663-0.105716im    0.00610432+0.038929im      0.107304+0.121553im     -0.0543853+0.209068im     0.0450773+0.0339108im     0.0106322-0.0147228im      0.035598+0.11793im      -0.158809+0.110553im     -0.120642-0.0218789im   -0.0559583+0.0437938im     -0.207713-0.0696773im      0.202589+0.176911im       -0.0232454+0.138229im
 -0.00945987-0.265687im      0.0461268+0.146066im       0.0939692+0.0847329im   -0.00910987+0.0176212im     0.0793424-0.0312639im      0.152657-0.0425307im   -0.0514782-0.047907im       -0.050673+0.300934im       0.139921+0.115482im      0.0338186+0.0270482im     -0.169818+0.150631im     0.0932801+0.0266116im      0.16877-0.0186841im      0.228814-0.0744292im    -0.0162875+0.0466661im    -0.0456226-0.0660223im     -0.0514024-0.141689im      0.0205097-0.118597im     0.0446806+0.0389192im     0.0411549-0.276431im    -0.0724271+0.291932im      0.081995-0.0225803im     0.0808706+0.18102im     -0.0672166+0.0106144im     -0.100546+0.151442im       0.244073+0.0609229im    -0.122781+0.177402im      0.230313-0.0563308im    0.0594697+0.146372im     -0.0638931+0.201839im      -0.139517+0.0585221im      -0.0423778+0.116757im
    0.216046+0.061534im     0.00153659+0.0372067im      0.0329343-0.126728im     -0.0492357-0.125834im       0.202781-0.0295126im    -0.0178045-0.238075im     0.0510899-0.0165816im      0.0690535-0.0261578im     -0.128839-0.018922im       0.102948-0.0987456im    -0.0565186+0.00622724im    0.206206-0.0428923im    0.0468314+0.106815im      -0.135852-0.0705162im      0.105405+0.123995im         0.1469-0.104761im        0.176719+0.0851298im     0.0831518-0.212965im    -0.0769229+0.0490998im     -0.109039+0.0196446im    -0.296138+0.241926im    -0.0299104+0.0137419im     0.0469062-0.0834563im     0.216612-0.0583617im      0.266021-0.0338803im    -0.0621775+0.0319201im    -0.113656-0.121898im     0.0385133-0.0654867im    -0.267249-0.00505965im     0.204329+0.150101im      0.0347832+0.0981599im        0.211408+0.0684567im
   0.0929499-0.0468865im     -0.154995-0.0887496im      0.0596037+0.0725079im    -0.0377549-0.258574im     0.00839123+0.140608im     -0.0299897-0.00809566im    0.203578+0.00390202im      0.257668+0.0767184im      0.165919+0.128942im      -0.170717+0.0492965im      0.109957+0.00039915im    -0.10433-0.106303im     0.0673823-0.0676249im     -0.127529+0.11243im      -0.0124916-0.0585964im      0.133073+0.091431im        0.255634-0.192348im     -0.0854122-0.0204477im    -0.130692-0.0486499im    -0.0256548-0.124898im       0.11323-0.085589im       0.23385+0.0523448im     -0.157912+0.16153im      0.0484695-0.0356414im      0.106873-0.045485im      -0.227483+0.0176825im     0.280144-0.0356019im     0.283411+0.0463956im    0.0789235+0.0360366im      0.071794+0.1136im        -0.182162-0.0232603im    -0.000218893+0.0535971im
   -0.134715+0.0177315im     0.0824639-0.121073im      -0.0916188-0.00410754im    0.0791351+0.0561358im      0.163645-0.0632086im      0.141246-0.0826125im     0.133265-0.145665im       -0.160778+0.0985538im      0.113064-0.120015im       0.108404+0.0992742im       0.18577-0.102793im     0.0247323-0.108864im    -0.0536812+0.151876im     -0.0412225-0.0289811im     0.0768954+0.0678481im     0.0105499+0.252627im        0.201482-0.0266451im    0.00660967+0.218511im    -0.0775748+0.101055im       0.114598+0.16022im       0.184832-0.0627054im    -0.296036+0.0200924im    -0.0826609+0.146353im     -0.267464+0.0186575im      0.113768-0.0808145im      0.145347+0.102663im    -0.0896137+0.0691821im    0.0603989-0.0350895im    -0.208171+0.105486im       0.203938+0.121461im      -0.143505+0.134661im       -0.0824374+0.0729875im
   -0.178006-0.183105im      -0.291712-0.149365im       0.0475353+0.0577985im     -0.120212-0.150836im      0.0278948-0.202778im        0.15012+0.063932im    0.00745121+0.0558717im      -0.103054-0.00454171im    0.0472686-0.00554384im    -0.240093-0.314628im      0.0410136-0.154317im    -0.0308073-0.134147im     0.0815431-0.0183092im     0.0419214-0.0305362im      0.419826+0.0575778im     -0.044879+0.0203581im     -0.0143626-0.0708693im      0.216835-0.0479067im   -0.0537789-0.0787977im     -0.066045+0.0349476im    0.0843801+0.0779584im    -0.163214-0.0406806im     0.0390142-0.0831297im   -0.0112808+0.149694im    -0.00852459+0.178701im     -0.0296393+0.0882362im   -0.0140053-0.216223im    -0.0118517-0.0955592im    -0.019991-0.141031im      -0.185749-0.0123422im    -0.0187822-0.11336im          0.022416+0.000226684im
  -0.0950794+0.0616698im      0.250328+0.130435im       -0.217524-0.152333im     -0.0944375+0.0218321im    -0.0555471-0.188875im      -0.201991-0.0755165im      0.24419+0.069973im       0.0665823+0.348446im      0.0757503-0.111559im      0.0214967-0.054002im        0.17415-0.0759786im    0.0136654-0.108735im    -0.0570782-0.151076im      0.0153091+0.0486384im   -0.00661548-0.0535722im    0.00598106-0.116803im      -0.0492399+0.00856684im     0.260018+0.0193269im    -0.120046-0.048765im       0.133803+0.0126028im    -0.218715-0.0227615im     0.202246-0.121272im      0.0995876-0.0778669im    -0.256662-0.124149im       0.128913+0.0668306im   -0.00311898-0.0318882im    0.0460659-0.201529im     0.0447343+0.07307im    -0.00405392+0.117363im      -0.123232-0.030829im      0.0319979-0.0931254im       -0.127222-0.0491646im
   -0.253493-0.0921316im    -0.0656547+0.15299im        -0.243524+0.0394885im      0.153669-0.10763im        0.174216-0.0216278im      0.157684-0.0296873im   0.00447503+0.250496im       0.0827037+0.0268669im     -0.111434+0.145997im      0.0157442+0.0258399im   -0.00646758-0.0325664im     -0.30789-0.0705238im    -0.162014-0.0822308im    -0.0893683+0.0799003im     -0.202862+0.0368197im      0.105414-0.0565398im      -0.144078-0.0258368im      0.116811+0.0331308im    0.0267727-0.0732665im     0.0779296+0.0165773im    0.0231578+0.152007im     -0.195266-0.0827191im    -0.0779071-0.0208241im     0.112799+0.0032863im    -0.0461938-0.123509im      -0.200704-0.0651989im    -0.102035+0.104723im      0.261924-0.0162704im   -0.0919813-0.0218244im    -0.0951198+0.0298006im       0.24177+0.265393im        0.0105357-0.0192449im
   -0.014442-0.124138im       0.119964+0.102904im       -0.031349+0.14956im      -0.0696475+0.0414029im    -0.0616604-0.159935im       0.151617+0.0721998im     0.033108-0.00697821im     0.0925848-0.113294im      -0.114075+0.0579559im     0.0315833+0.00790921im    0.0577812-0.0620126im     0.126281-0.127226im     -0.124592+0.326888im       0.122791-0.0245535im   -0.00731344-0.00946371im    -0.025725-0.28625im       -0.0221221-0.155581im    -0.00882849+0.0113617im    -0.243407+0.000173966im   -0.134671+0.224083im    -0.0671911-0.184253im     0.0736874+0.0666782im     -0.262664+0.0250613im     0.063895+0.0578362im      0.259572+0.190615im       0.201153-0.0951935im    0.0874261+0.224396im      0.138707+0.0662489im     0.104807-0.0599366im    -0.0818222-0.139664im      0.0182077+0.0757904im        0.108735-0.0193353im
  -0.0247872-0.175771im       0.098124-0.193499im       -0.106224-0.2687im        0.0257364-0.0491388im     -0.140717-0.00823271im     0.226605-0.0269702im     0.243996-0.137915im      -0.0304493-0.0378573im     0.0684965+0.0913754im      -0.14703+0.127205im      -0.104972-0.0651144im    0.0246157+0.116624im    -0.0366337+0.00678877im   -0.0221464+0.108784im      0.0161855+0.239873im    -0.00297805-0.0225326im      -0.131896-0.102317im     -0.0303887-0.152225im    -0.0264615-0.215535im      0.0499386-0.252684im     -0.080289-0.10751im      -0.137071+0.206im         0.0442378-0.153605im     -0.085367-0.186296im     -0.0395418-0.169184im       0.134854-0.228227im     0.0388026-0.0471122im   -0.0889737+0.0892507im   0.00433898-0.123763im       0.035781-0.0193023im       -0.1174+0.141993im         0.176062-0.124215im
   -0.129661+0.104671im   -0.000648494+0.186582im       0.0214945+0.151575im    -0.00448895-0.0633018im     0.0866604+0.0477332im     0.0933071+0.0430603im    -0.145734-0.0173133im    -0.00321464+0.0527997im     -0.151402-0.147159im       0.281796-0.00992088im    0.0359054-0.113299im     0.0652743-0.0790561im    -0.138635+0.00273001im      0.13864+0.00671928im    -0.034799-0.0312562im     -0.220185+0.281135im      -0.0132881-0.15032im        0.154322-0.242143im      0.183996-0.150593im      0.0531541-0.139257im     0.0459924+0.126737im     0.0780186+0.0980689im     -0.236575+0.02389im     -0.0415802-0.22428im        0.101392+0.00200287im    -0.139106+0.0609173im     0.133945-0.0813023im    -0.125125-0.096242im     0.0118948-0.0314945im     0.0289747-0.155248im      -0.227162+0.00290752im        0.17874-0.171685im
   -0.010693+0.0971246im      0.239371+0.0843737im       0.132498+0.0807169im      0.147133+0.134102im      -0.146685+0.135733im      -0.140963-0.0799275im    0.0753393-0.216067im      -0.0791919+0.00605913im     0.182833+0.102914im      0.0292855-0.26032im       -0.143115-0.0146176im   -0.0602845+0.10267im     -0.0210437-0.189258im     -0.0695171+0.0938616im     0.0923425-0.0220668im      0.173207-0.0572136im      0.0214474-0.187012im      -0.101786+0.224514im      0.161244-0.0395865im    -0.0609943+0.0914603im   -0.0727159+0.114949im      -0.22867+0.0790232im     -0.241886+0.0155371im   -0.0215296-0.0438267im      0.083865+0.291355im       -0.14887-0.0835397im   -0.0705921-0.143609im     0.0202421-0.0362077im     0.043012+0.0204392im     -0.139445-0.0399227im    -0.0487071+0.156355im         0.151653+0.0471372im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.0276288069523511 + 0.07341300277156794im
   -0.1423712699762819 + 0.05366461381550905im
    0.0304159220326451 + 0.07728277125361893im
  -0.11891725342011236 + 0.007095150703764045im
   0.15654901479440375 - 0.04815264734637528im
   0.10551865680393441 + 0.06356068258325952im
  0.028868658974219814 + 0.07458298916646755im
   -0.1139249774829387 - 0.014826560178753924im
   0.23694912332792556 + 0.06466619331946974im
   -0.2390913593901974 - 0.006354590727134346im
  -0.02080420532442511 - 0.054917522475783395im
   0.08087847619258758 - 0.10817124278833964im
   0.15631996218324667 + 0.09182084166959056im
    -0.126278618060837 + 0.1343787579892425im
   0.22682085464256643 + 0.07422289437504043im
   0.06859759784212237 - 0.09144549646834449im
  -0.22073772824606266 + 0.10107809013203194im
  -0.09120493370432564 - 0.23190101749218484im
   0.09092683691121263 + 0.10823705689206349im
  -0.10105672223439283 - 0.011910820534033393im
 -0.034274100380598645 - 0.02441463783310656im
  -0.07217078796171937 + 0.014945004699780502im
  -0.02677154045365086 - 0.11313123097108922im
  -0.07591378922034303 + 0.17905734037584614im
   0.05106419756728925 + 0.059579919991254865im
   0.02572925474536728 + 0.1787440716007279im
   0.42729977403152625 + 0.0im
   0.14811072013146348 - 0.0607768677860009im
   -0.2220960259615325 - 0.06447795251870779im
  -0.19113750160058582 + 0.19309174684426753im
 -0.045783318577586656 - 0.05764102294649018im
  -0.04100848527960167 + 0.14349144557993845im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Saturday 6 July 2024 08:38">Saturday 6 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

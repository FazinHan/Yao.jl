<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.395071-0.0186636im     0.226921-0.178715im       0.143384+0.0206967im    0.0768096+0.0446151im       0.12028+0.0984666im   -0.0206367+0.12263im    -0.0487078+0.0523256im    0.00645623+0.0523391im      0.026611-0.222416im     0.0768703+0.00510066im     -0.121478-0.0256657im     -0.314739+0.233424im     -0.0631787+0.145303im     0.0601688-0.144879im     -0.0333839+0.178512im     -0.0804349+0.108625im    -0.0527705-0.0359786im      0.0531048+0.051859im     -0.0757144-0.10933im        0.153039+0.0224367im     0.0721646+0.179053im      0.0604365-0.164262im     -0.0346445+0.184651im     -0.0615934-0.0871707im    0.0804824-0.215611im    -0.0437525-0.0653552im   -0.00583818+0.0953474im    -0.102079-0.225442im      0.164188-0.0611046im  -0.0376699+0.0422749im     0.0965724-0.0929618im    -0.0546917-0.0868074im
 -0.0406833-0.162577im      0.205408-0.0607676im    -0.0485173+0.0402198im     -0.11712-0.0373543im     -0.133242-0.231841im     -0.130017+0.128314im   -0.0305957+0.253071im      -0.149236-0.0694396im    -0.0600144+0.188971im    0.00772642+0.233351im      -0.0670842-0.0684014im      0.120719+0.00975483im    0.0402208-0.0507292im    0.0710737-0.126206im      0.0211128+0.316175im     -0.0706256+0.0169335im   -0.0761178+0.110702im     0.000999012-0.0538857im      0.201758+0.00352703im    -0.103682+0.100559im        0.12653-0.0895858im       0.10826-0.0549399im     -0.171411-0.273619im      0.0397312-0.227686im     0.0339955-0.0686173im    0.0790417-0.137169im      0.0603817+0.042779im    -0.0633732+0.113629im     0.0210462+0.0498277im   -0.213495+0.0457773im    -0.0419059-0.214528im       0.175309-0.0069393im
  -0.115599+0.10027im      0.0208382-0.123334im       0.273891+0.275997im    -0.0484898-0.138088im      0.0980971-0.060043im     -0.120405-0.0702903im    0.131177+0.0250622im     0.0506159+0.00611985im   -0.0901622-0.0491101im     0.145666-0.0576964im       0.103057-0.133173im     -0.0936211-0.0874545im      0.171182+0.194906im      0.049822-0.186641im     -0.0893555-0.0186801im     -0.177338+0.00945589im   -0.146068+0.0286966im     -0.0447773+0.0859332im     0.0865457+0.0657982im    -0.0507547-0.0186397im    -0.0167727-0.196982im      0.0449558-0.163954im       0.215306+0.136279im      0.0598127+0.0420321im     0.049047+0.318645im     -0.205665-0.0338721im       0.17116+0.0979988im     0.108003+0.0970189im    0.0709792-0.151955im    0.0138759-0.200694im      -0.194086-0.0777953im     0.0815131-0.00318847im
 -0.0128781-0.00858147im  -0.0216019+0.045332im      0.0576994-0.113473im      0.348592+0.0246893im     0.0236063+0.0178946im     0.327541-0.0592631im    0.040417-0.0203498im     -0.114766-0.0868162im    -0.0239685+0.0345467im    0.0923238+0.0195871im       0.129335+0.0321162im    -0.0793676+0.170472im     -0.0440606+0.126126im      0.345989-0.0633551im     -0.107344-0.0636867im    -0.0534889+0.053833im      0.272746+0.0292825im     -0.0172102-0.0717823im     0.0416813+0.113999im       0.139577-0.0272391im     0.0445807-0.243006im     -0.0310754-0.135708im      -0.115221-0.114206im       0.151571-0.207633im      0.194786+0.166027im     0.0353872-0.0148139im    -0.0536365+0.0279574im   -0.0768808+0.018238im     -0.297642+0.0201348im   0.0413418+0.0818049im    -0.0602104+0.0467571im    -0.0458937-0.164626im
  -0.148726+0.0894686im     0.244209-0.169735im      0.0185468-0.207128im    -0.0362769-0.0649497im      0.265457+0.180432im      0.135191-0.103161im    -0.304438-0.0686115im     -0.158083+0.0689449im     0.0236176-0.0636362im    -0.102843+0.0310834im          0.166-0.0520286im     0.0743661-0.165345im    -0.00101462+0.0896344im    0.0392734+0.0968257im     0.0426528-0.0344954im     -0.157372+0.125171im    -0.0261933+0.122339im        0.153315-0.103149im     -0.0289065-0.394588im    -0.00894034-0.119951im       0.102234+0.104581im       -0.13256-0.0121261im     0.0212441-0.147386im     -0.0200977+0.0106555im   -0.0934084-0.0966709im    0.0876353-0.109009im      0.0670883+0.0220651im    0.0937143+0.0820724im   -0.0505673-0.0536051im  0.00849589-0.154788im      -0.223764+0.0301391im     0.0866992-0.0565319im
 -0.0827778-0.22394im      -0.097553-0.0377504im     0.0393572+0.114303im     -0.296602-0.0530177im     0.0121725+0.00791872im    0.350287-0.0239086im   0.0902645+0.0379615im      0.139787-0.00897486im     0.243081-0.229408im     -0.153774+0.115373im       0.0631424-0.13583im      -0.0708345+0.023169im     -0.0408914+0.101337im     -0.155621+0.0786982im    -0.0419814+0.0263762im    -0.0578957+0.00519534im  -0.0164293+0.0122184im      0.0797257-0.0708023im    -0.0463637+0.231736im     -0.0372919+0.190572im     -0.0630951-0.0808984im    -0.0189034+0.0578728im     0.0281901+0.157039im      0.0611031-0.155266im     0.0959116-0.194231im      0.221788-0.0122465im     -0.144485+0.0143637im    0.0181388+0.131301im   -0.00577164+0.0235711im   -0.159569-0.265343im     -0.0421667+0.0870872im     0.0103709-0.188124im
  0.0452189+0.102058im     0.0415195-0.157153im     -0.0629738-0.0786217im   -0.0252977-0.247524im      0.0350003+0.115307im    -0.0487428-0.0613934im    0.399783-0.0328093im    -0.0171082-0.0320128im      0.046872-0.080945im     -0.260817+0.137446im      -0.0924114+0.19112im      -0.0290824+0.0205139im      0.109594-0.104635im      0.151088+0.155082im      -0.105004+0.130146im       0.208158+0.0968578im    -0.115929-0.0745866im      -0.067281+0.279399im      0.0669242+0.0678283im     0.0881922+0.0016287im      0.207795-0.0567642im    -0.0424354+0.0274636im    -0.0409237+0.00927271im     0.109614+0.0857654im   -0.0626345-0.0772176im     0.157267-0.014181im       0.218714+0.0712941im     0.277174-0.0590529im    -0.135993+0.0125533im    0.110628+0.0751992im    -0.0586196+4.69831e-5im    0.0761316-0.106287im
  -0.108235-0.0853739im    0.0848472+0.00698011im   0.00994467+0.0807864im    0.0548473-0.0051149im  -0.000717165-0.0107293im   -0.0522188-0.0683472im  -0.0636612+0.0218635im      0.271734+0.202593im       0.314315-0.0113972im    0.0106964-0.0114951im       0.153612-0.00780567im   -0.0621777+0.0391561im     0.0957247+0.0778124im    -0.117471+0.0593192im     -0.128111+0.0105374im      0.216165+0.100256im     0.0434113-0.151816im        0.107709+0.10399im        0.226138-0.210869im     -0.0790665+0.266779im       0.127668-0.0149025im      0.183118+0.0295057im      0.206868-0.158764im      -0.041613-0.0344508im   -0.0968714+0.06933im      -0.142253-0.0394776im     0.0745468-0.011323im     -0.320696-0.116778im     -0.204313+0.0901319im  0.00331921+0.180616im     -0.0543144+0.120035im     -0.0107963-0.0524266im
    0.15121-0.176089im      0.127658+0.316444im    -0.00204255+0.0449983im   -0.0546159+0.123351im     -0.0195843-0.112621im    0.00349665-0.207279im   -0.0681341+0.0593079im     0.0764279-0.100286im       0.297088+0.0325726im     0.181861-0.0141952im      0.0530135-0.20172im      -0.0238592+0.0326412im     0.0092633-0.0895824im     0.154605-0.021729im       0.156731-0.0949437im     0.0506182+0.292396im     -0.174133+0.0387723im       0.108239+0.0176698im     0.0432479+0.0987705im      0.165151+0.0405728im     0.0904684-0.0609091im     -0.319416-0.0703292im     -0.112749-0.0252772im     0.0406946+0.17304im      -0.136775-0.0641116im     -0.12957+0.115662im      0.0608836-0.108146im      0.179873-0.0616547im   -0.0622433+0.0420937im   0.0811394-0.100371im    -0.00341315-0.156316im      0.0645392+0.0619299im
 0.00920186+0.0946625im    0.0570767+0.105997im      0.0262665+0.0556546im   0.00174394-0.218587im     -0.0432006+0.154187im     0.0555248+0.16448im     0.0821347+0.0710694im   -0.00268396-0.228187im     -0.0418337+0.0990369im     0.251531+0.0947888im     -0.0294531-0.2037im       -0.0500719-0.115724im       -0.15555+0.114547im    -0.0512606+0.0506681im    -0.0668603+0.0695458im      0.220694+0.0768757im    0.0510886+0.196375im       0.0642018-0.0876332im     -0.157586-0.0365423im     -0.111641+0.0281115im   -0.00928669-0.233861im      0.0281188+0.22192im        0.213829-0.12331im       -0.121441+0.0595483im    0.0817498-0.249487im    0.00838293-0.0634434im     0.0208527+0.193429im     0.0399445-0.102769im    -0.0948847-0.101707im     0.171906+0.015288im     -0.0310111-0.0904739im     -0.273008+0.156387im
  -0.278864-0.0128139im     0.278087-0.00634952im     -0.10368-0.126237im    -0.0601134-0.0487444im    -0.0385367-0.173631im      0.216316+0.0332052im    0.132087+0.227994im      -0.035897+0.157442im      -0.112124+0.0857011im    0.0358057-0.0547926im       0.220242-0.228411im     -0.0985763+0.0822871im     0.0106522-0.02381im      0.0818254-0.0253399im     0.0796652+0.0467181im     0.0110406-0.31015im      -0.111259-0.151842im        0.154483+0.127425im     -0.0795992+0.030386im      0.0988006-0.018859im      -0.116018+0.0778027im    -0.0600314-0.0506505im       0.15183+0.00479477im     0.101678-0.00897438im  -0.0126427-0.0529754im    0.0207054+0.0307167im    -0.0700118-0.0993795im     0.155419-0.212323im     0.0648958-0.214446im    0.0318917+0.234845im      0.0827748+0.152418im      0.0174491+0.0745891im
  0.0743978+0.249688im     0.0268851-0.112471im       0.014777+0.0706782im    0.0343464+0.0103193im     -0.244256-0.0731615im   -0.0103969-0.0806819im  0.00339485+0.0350224im      0.033113+0.0479693im      0.190298-0.0736025im     0.065972-0.214945im        0.145403+0.12631im        0.349493+0.101765im     -0.0930054-0.0775904im     0.298533+0.031747im      0.0995454+0.0304042im      0.074578+0.0673078im     0.103053-0.0452244im     -0.0251449-0.0854276im    -0.0507625+0.0137581im    -0.0733451+0.0444895im     0.0255446-0.108815im      0.0230933-0.133632im       0.197882-0.0281296im     0.0206934+0.227277im      0.155666-0.13734im       0.234165-0.158804im       0.110978-0.0730017im    -0.106839-0.0522781im     0.224865-0.138579im    -0.212931-0.1372im        0.0242011+0.0663111im    -0.0144271+0.0278501im
   0.118753+0.135657im    -0.0501699+0.151955im    -0.00556714+0.14716im     -0.0478447+0.0736481im     0.0565743-0.00790155im   0.0399887+0.115586im   -0.0170277-0.0862851im     -0.125898+0.161852im     0.00585204-0.0562479im     0.217911-0.0274598im     -0.0333712-0.134562im       0.165514+0.0973866im      0.331669-0.0862668im    0.0676696-0.106686im      -0.296415-0.0760495im     -0.185394-0.195088im    -0.0394843-0.0309496im     -0.0463553+0.0960826im     -0.107047-0.149854im      0.0527808+0.0874627im      0.149847-0.0922802im     0.0163708+0.192198im     -0.0172102+0.0830657im   -0.00653671+0.082607im     -0.156264-0.175663im       0.24153+0.178196im     -0.0669085-0.0988344im   -0.0285328+0.117463im     -0.131757-0.05351im     -0.111639+0.167301im      -0.168559-0.137787im     -0.0668667-0.101029im
 -0.0179167-0.164858im    -0.0203724-0.0824206im     0.0567671+0.0784214im    -0.151765-0.186276im      -0.156236+0.228434im      -0.07186-0.0437218im  -0.0513315-0.0113784im     0.0134081+0.166488im      -0.225981-0.0768001im      0.29847+0.0436929im      -0.114553+0.102046im     -0.0586906+0.0541003im    -0.0810422-0.126465im      0.237164+0.145355im     -0.0376608+0.0018087im    -0.0748228+0.0863419im    0.0238885-0.166033im       0.0448112+0.115147im     -0.0625905-0.0279103im    -0.0950521+0.271506im     -0.0375568+0.111888im      -0.392288+0.0986909im    -0.0638321-0.10668im     -0.00608641-0.112828im    0.00319243+0.188096im     0.0700674+0.046936im      -0.109284+0.133306im      -0.10483+0.0275551im   0.00136738-0.060404im   -0.0326785-0.0518463im    -0.0435546+0.138125im      0.0417919+0.20213im
  -0.171281-0.0577771im   -0.0199258-0.0223372im     0.0830353+0.184243im      0.225923+0.0489236im      0.128604-0.225721im     0.0427977+0.182231im    0.0240707-0.0887688im   -0.00585259+0.0611563im      0.117905+0.049989im    -0.0442933+0.00973469im     -0.210093+0.0942872im     0.0743379-0.052366im      0.0831052+0.0941792im     0.197448+0.0164072im      0.280287+0.156694im     -0.0260801+0.0562228im    -0.122667-0.172879im       -0.117157+0.00951312im   -0.0860913-0.209018im     -0.0357737+0.0928223im     -0.206511+0.139124im     -0.0752683+0.228723im      0.0784041-0.046992im        0.31849+0.010296im     0.0325115-0.0545041im   -0.0845956-0.0369764im    -0.0512259+0.0534085im    0.0676313+0.0311729im     -0.12042+0.0114675im   0.0394573-0.152434im       0.122988-0.109905im      -0.244652-0.126357im
  0.0487339+0.083701im    0.00947084+0.0930822im     -0.090991-0.0144201im   -0.0108631+0.174907im      -0.078315+0.143871im       0.10049+0.0232832im  -0.0294742-0.0955414im     -0.167988+0.214004im      -0.192034-0.0185703im    -0.100976-0.220318im       0.0440898-0.244798im       0.033487-0.126553im       0.153659-0.115428im   -0.00933965-0.0159591im      0.178385+0.135321im       0.288055-0.0810021im    0.0653381+0.00941286im     0.0748323+0.0071364im    -0.0115236+0.146434im     -0.0734367+0.15792im        0.271691+0.0455741im    -0.0649008-0.0931714im     0.0641252-0.024529im      0.0628069-0.0611353im    0.0367134+0.0796888im    -0.106982+0.0805552im    -0.0132366+0.361806im    -0.0299856-0.0188223im     0.138564+0.150003im    0.0486838-0.138935im     -0.0301214-0.114243im     -0.0781522-0.254492im
 -0.0117149+0.108097im     -0.118949+0.138585im      0.0637681+0.0166443im   -0.0266562-0.169775im      0.0414115-0.116353im     0.0693712+0.115633im    0.0904955+0.0516244im    -0.0237292-0.113272im     0.00239766+0.0710537im    -0.205156+0.0820293im      -0.216304-0.105878im      0.0447617-0.0356822im     0.0132014+0.087343im     0.0933183-0.230846im      0.0434349-0.114961im    -0.00613532+0.137008im      0.418731-0.0150237im       0.402602+0.0843522im     0.0448336-0.192542im      0.0741734+0.122624im    -0.00151697+0.0314195im    -0.0551737-0.0545209im      0.095849+0.139097im     0.00313644+0.0279321im    -0.261261+0.134013im      0.150616+0.010374im      0.0211407+0.0769536im   -0.0183586+0.0415546im     0.158164+0.049125im   -0.0391799+0.0269986im      0.193805+0.00579615im     0.114852+0.0759299im
   0.185937-0.0251993im    0.0529022-0.133747im      0.0523665+0.0247288im     0.167455+0.0575849im     -0.155989-0.0469318im    0.0925537-0.118053im    -0.020262-0.0940276im    -0.0182303+0.157349im     -0.0911661+0.06365im       0.124497+0.0134809im     -0.0683378-0.0607757im      0.153319-0.0689846im       0.11288+0.32045im      -0.124302+0.296169im     -0.0458392-0.0241688im      0.097598+0.0737429im   -0.0248562-0.0128502im         0.3601+0.31041im       0.0135609+0.0421086im     0.0445889-0.146231im    -0.00377587-0.133752im       0.141462+0.205894im      -0.209456-0.0806513im     0.0547386-0.0326528im    0.0903726-0.00429488im  -0.0897459-0.00569652im   -0.0362625-0.108056im       0.09141+0.156747im      0.158784-0.098408im   -0.0760972-0.0589751im      0.169564+0.0316846im     0.0438254+0.0133892im
   0.212265+0.0890105im    -0.119631-0.0169517im     -0.366207+0.0969138im    0.0400209-0.0148522im    0.00923234-0.17623im      0.0515584+0.15478im    -0.0702644+0.0774965im     0.0404819-0.163006im       0.118426-0.115501im     0.0692475-0.0415379im      0.0621154+0.0099934im     0.0226812+0.0420708im     0.0982292-0.0726999im     0.036512-0.0114836im    -0.0614087+0.0366228im     0.0911168-0.00936383im  0.00768471+0.0491899im       0.100972-0.0262544im        0.2644+0.0473396im      0.181473-0.0485331im     -0.182431+0.286159im    -0.00556305+0.132731im     -0.0439431-0.0645862im    -0.0209695-0.111014im    -0.0243396+0.0731515im   -0.0492253-0.0680646im     0.0423293+0.220563im     0.0308752+0.139759im     0.0759033-0.30726im      0.131662-0.0521276im     -0.319378+0.198712im     -0.0436542-0.0116398im
  0.0563816+0.0179863im    0.0465582-0.0449789im      -0.18728+0.115073im     -0.121263-0.119599im      0.0559078+0.0204151im    -0.112397+0.0403608im    0.105715+0.141275im      -0.129572+0.195446im      0.0121856+0.135826im      0.112255-0.0625445im     -0.0258042+0.174219im       0.108501-0.0600306im      -0.10549-0.0227462im   -0.0832083+0.161445im      -0.173683-0.148012im     -0.0143854-0.015316im    -0.0225304+0.22105im         0.104244-0.0924394im   -0.00563703-0.0292672im      0.394615-0.0223319im    -0.0487648+0.0296418im    -0.0801901-0.218737im       0.233086+0.0779646im      0.249144-0.0758401im    0.0327039-0.0987313im    -0.203972+0.00381489im   -0.0241052+0.0855524im   -0.0153156+0.113176im     -0.149664+0.237281im    -0.206657-0.0230125im      0.117405+0.010878im      -0.107111+0.00736131im
 -0.0374491+0.229638im       0.11668+0.0609997im     0.0439354-0.0232364im   -0.0395143-0.247854im       0.104793+0.0711401im     -0.13362+0.126115im     -0.13949-0.0175172im      0.052844+0.10921im        0.147036-0.151558im     0.0901303-0.00182177im    -0.0195582-0.00595229im  -0.00370503+0.0180834im     0.0871996+0.0960162im    -0.136216+0.0592543im      0.307347+0.274188im     -0.0383591-0.0801099im     0.217527+0.0686849im   -0.000902792-0.0875346im      0.169029+0.286869im      0.0878133-0.0569011im      0.264387+0.0594076im     -0.117998+0.0908064im    -0.0491212+0.10858im        0.030679+0.0287464im    0.0545084+0.187063im     0.0374093-0.0622797im     -0.119647-0.228447im     0.0456865+0.0912179im    -0.177788-0.0834475im  -0.0714929+0.0907344im      0.092403-0.0189642im      -0.14062+0.122732im
   0.107448-0.203607im     0.0359243-0.189649im      0.0256216-0.10487im     -0.0182829+0.0747561im       0.16664+0.0231696im    -0.225617-0.11463im      0.124777-0.171011im      -0.265107-0.15384im        0.287816+0.156382im     0.0659751+0.0744703im       0.114385-0.190446im      0.0814184-0.140829im      0.0560348-0.110628im     0.0319093+0.0261801im       0.16136-0.0299546im    0.00159993+0.0683108im    0.0360521-0.0645611im      -0.151611+0.0514726im     -0.120913-0.0173576im      0.136981+0.0556053im      0.107109-0.0246296im      0.186439+0.0187582im      0.168384+0.0745973im    -0.0135877-0.244901im     0.0362497+0.114981im      0.135462+0.185337im      -0.133034+0.104909im    -0.0488926+0.0833782im    0.0633225-0.180768im    0.0099958+0.0404744im      0.108232+0.173087im     -0.0541106+0.148002im
 -0.0411521-0.0262333im   -0.0392543-0.0266075im     -0.267379+0.00622606im    0.071418+0.0975709im     0.0888795-0.0683492im     0.113987-0.0343985im    0.173572-0.0119369im     -0.151986-0.283904im    -0.00430302-0.069055im     0.0160212-0.34907im       -0.0312028+0.0580103im     -0.190898-0.265941im      0.0973537+0.0285275im   -0.0349089+0.0919402im    -0.0665002+0.0388958im     -0.121193+0.0539372im    -0.153902-0.0370992im       0.163195+0.0442932im     0.0126711-0.049im          -0.15258+0.122973im       0.134741+0.00458464im    -0.176446+0.00269847im   -0.0142659+0.123933im     -0.0319627-0.1132im        0.135926+0.0780437im    0.0895599-0.189912im       0.155494-0.237238im     -0.163624-0.0257458im    0.0479212+0.097495im    -0.114741+0.103145im     -0.0130785-0.114428im      -0.176635+0.191437im
 -0.0782821+0.0520844im   -0.0280556+0.0253229im     -0.231273-0.113736im     -0.130794+0.145031im      -0.247967+0.1184im       -0.066024+0.0718258im   -0.143655-0.134647im      0.0804756+0.041238im     -0.0396333+0.0326017im    0.0126877-0.0545592im      -0.155126-0.0808422im     -0.118147+0.211915im      -0.125157+0.232356im     0.0609906-0.102661im     -0.0227259+0.0151056im     0.0646942+0.147828im    -0.0806147-0.106647im      -0.0492438-0.0973018im     0.0280951-0.0940782im     -0.135821-0.0102616im      0.137299-0.0642211im      0.145091-0.14236im       0.0849964+0.14247im        0.345055-0.184426im     -0.103226-0.068121im     0.0489294+0.0861445im      0.125265-0.115423im      0.202217+0.269823im    0.00634941-0.0243006im    0.109496+0.0198696im    -0.0710579+0.119185im      -0.103476+0.183356im
 -0.0761031-0.0957839im   -0.0977677+0.240101im      -0.108165+0.184006im    -0.0335377-0.038532im      0.0366076+0.166431im     -0.209144-0.128755im    0.0281793-0.00141144im    0.0234672-0.100965im         0.1085-0.0310626im   -0.0320682-0.0459767im    -0.00978973-0.023029im     -0.0290371+0.246718im       0.117071+0.0726502im    -0.140226+0.0399085im      0.262869-0.0515431im     -0.134673-0.053477im     0.0762765+0.0233171im       0.123487+0.137298im      -0.294112-0.0835702im    -0.0503459-0.213865im     -0.0137902-0.0224504im     0.0329867-0.027323im     -0.0965393-0.127294im        0.25132+0.0351998im     0.190728-0.00205492im   0.0521718-0.170581im      0.0416972+0.263099im   -0.00467035-0.0990842im    0.0487981+0.0409103im   -0.149563+0.232077im      -0.208893+0.0534692im     0.0834443-0.0114974im
  0.0449239-0.0390101im    -0.146165-0.159382im       0.178994+0.23032im      0.0816855-0.0356398im    -0.0569143-0.0202161im    -0.113608-0.0413623im   -0.115414+0.125227im      -0.094497-0.0370141im     -0.161897+0.145876im      0.151792+0.0051118im      0.0890899+0.00791174im    -0.182897-0.126166im       0.129594+0.146925im     -0.107208-0.00755406im     0.141729-0.14794im       0.0747968+0.0289085im   -0.0441995-0.0587332im      0.0176378-0.136563im       0.143042+0.118322im       0.129437+0.0245211im     0.0398222+0.168266im     -0.0303148-0.0530102im     0.0736361-0.128272im       0.122936+0.0819178im   -0.0121435-0.147999im      0.456929-0.00470401im    0.0305858-0.130197im    0.00828077-0.0265259im    0.0750971+0.22126im      0.254925+0.09014im       -0.048692+0.129062im     -0.0017541-0.151897im
  0.0578126-0.0588777im   -0.0137817-0.0904676im     -0.105593-0.037919im      0.103287-0.145483im      -0.275761+0.0859901im   -0.0577324+0.256274im   -0.0997801-0.0916972im    -0.0516519-0.0371834im    -0.0621302+0.00236846im   -0.121214-0.0553211im       0.283584-0.245554im       0.014122+0.144526im      0.0751512+0.0343865im   -0.0615279+0.224493im      0.0390283-0.00429421im    -0.213656+0.143228im    -0.0221994-0.103129im      -0.0946994-0.140617im     -0.0621329+0.0205472im      0.206738+0.0963809im     -0.194671-0.0900354im     0.0290281+0.1792im      -0.00830305+0.100355im     -0.0486823-0.0174736im    -0.189528+0.181123im     0.0351071-0.0446168im      0.306335+0.0378465im    0.0498089-0.185604im    -0.0637338+0.123248im    -0.127218-0.0297849im     0.0914431-0.119801im      0.0236113-0.0410947im
  0.0411937-0.215336im      0.116312-0.0367036im     -0.119256-0.0208231im    -0.164538-0.056117im     -0.0421215+0.00342949im   -0.178203-0.103318im    0.0371326+0.0508905im    0.00380071-0.0253732im    -0.0315206-0.0589567im   -0.0684514-0.177188im      -0.0104712+0.069141im      0.0372724+0.124889im     -0.0649118+0.0696839im    0.0914742-0.0459447im   0.000381563-0.171098im      -0.166626-0.0552122im       0.2676+0.0974514im      0.0435657+0.132633im     -0.0821183+0.0268885im    -0.0148607+0.211624im      0.0160481+0.135545im       0.158281+0.0620205im      0.123249-0.243967im      -0.180413-0.0308465im    0.0627475+0.0822371im   -0.0543055-0.0486884im   -0.00858098-0.237709im      0.286209+0.072382im     0.0347372-0.0220905im    0.184433-0.0354244im   -0.00882582-0.20329im       -0.276599-0.27899im
 -0.0396459-0.151242im    -0.0600581+0.268437im      -0.191714-0.221275im     0.0468895-0.122031im     -0.0612979-1.95321e-5im  -0.0114622+0.0397164im    0.120918-0.0170935im     0.0671162+0.158111im     -0.0431239-0.199139im     0.0778812+0.0438961im      -0.137423+0.0991788im     0.0810802-0.257887im       0.187914+0.217013im     0.0778995-0.0613169im     0.0367985+0.0756076im      -0.27596+0.0605918im   -0.0334458+0.14963im        -0.136431-0.137922im      0.0337725-0.0227347im      0.165555+0.0861097im      0.122969-0.110561im      0.0747836+0.069441im      0.0695911-0.0907175im     0.0230247+0.0282968im    0.0996474-0.100211im     -0.067881+0.113849im      0.0446936-0.0311932im   -0.0963139-0.217943im      0.239963-0.0141584im    0.147389-0.0553868im      0.034336+0.247276im       0.153311-0.0357855im
  -0.042337-0.0127843im   -0.0946789-0.0550068im      0.106854+0.0264574im    -0.281978+0.117396im      -0.112462-0.112603im     0.0442195-0.197324im    -0.283432+0.136785im     -0.0900397+0.0664258im     0.0474874-0.0670486im    -0.171084-0.000393778im    0.0390632+0.0776898im      0.085827-0.0522442im     0.0906276+0.0872483im   -0.0475842+0.045255im      -0.119851+0.0686244im     0.0501321-0.0347783im     0.100763+0.242242im        -0.13337+0.0978646im    0.00336793-0.126044im       0.118376+0.108913im     -0.0952091-0.0758185im    -0.0950833+0.00804865im    -0.158914+0.169854im       0.180608-0.0166655im     0.157117+0.069865im     0.0852545+0.0148859im      0.169387+0.133288im    -0.0942493-0.149539im    -0.0333149-0.195235im     0.308926+0.14857im        0.149168-0.167475im      -0.126479+0.139879im
  -0.116555-0.0220408im    -0.125434-0.232634im     -0.0532191-0.00391737im    0.130364+0.0924707im     0.0306942+0.299397im      0.145339-0.015482im   -0.0876508+0.171836im      -0.156844-0.0483701im      0.163631-0.137037im      0.133782+0.120181im       0.0746869+0.0833461im    -0.0730557+0.102936im       0.114664-0.314879im     -0.110258-0.215289im     -0.0786135+0.0489945im     -0.176519+0.0406157im    0.0922886+0.00705158im      0.116182+0.0032849im      0.122907+0.0946393im     -0.118419+0.00388077im   0.00466249-0.0491173im     0.0434508+0.178807im         0.1056-0.134638im       0.216061+0.162332im     0.0027636-0.0548091im    -0.181936+0.0950327im      0.114967+0.0129661im     0.131176+0.0615047im     0.178701+0.0756055im   0.0259952+0.0302923im      0.260629-0.0225454im   -0.00985023+0.0834571im
  -0.122566-0.108188im     0.0113516-0.171346im     -0.0412271+0.0552348im     0.127298-0.105843im      0.0252628-0.125361im     0.0733611-0.03279im     -0.130682-0.319155im       0.264459-0.170835im     -0.0688542+0.0904638im     0.171051-0.0183236im     -0.0869178-0.173006im      0.0882032-0.040735im     0.00117784-0.167804im    -0.0991395+0.0247857im     -0.156666-0.0115634im     0.0650628-0.118849im       0.29303+0.00245672im     -0.168577+0.0268506im    -0.0680105-0.0293441im      0.135664+0.143665im       0.191495+0.147641im     -0.0550613-0.0275982im    0.00190725+0.116003im       0.163849-0.0326873im     0.132931-0.175642im     -0.126329-0.212374im      0.0382334-0.0679808im     0.140239-0.0836327im    0.0771658+0.0212458im   0.0260971-0.00449151im   -0.0435925-0.0833978im      0.276276+0.0433035im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.19145062673380506 - 0.020152688610626107im
   -0.16357145370490792 - 0.13323415087849733im
   -0.09940613731346884 + 0.03336034944981442im
    0.14525653554288506 - 0.04311546336166512im
   -0.10181851476717306 + 0.058479647176714854im
    0.11966440502380105 + 0.012157367964978856im
 -0.0055618007691720164 - 0.01001367435299244im
   0.061409070676459725 - 0.2069113720125758im
     0.0367541944829364 + 0.12497477151787366im
     0.2772154358896913 + 0.008227717095795452im
    0.18239382409838276 + 0.0997996841459089im
   0.007283739422949086 + 0.16344907880766438im
   0.022700051579591814 + 0.272723714634455im
    0.04576708063718416 - 0.039288265208501795im
  -0.013251379858452128 - 0.0026878741055847357im
   0.026465927813294595 + 0.18713712741772207im
   -0.04441625650646314 - 0.24033666773503853im
   -0.13113920429816275 + 0.008117218394976386im
   -0.13016963593293876 + 0.19259857553322765im
  -0.014930968967707596 - 0.0008103972178689823im
    0.01620189509526119 - 0.10676109670588445im
   -0.06814147993160252 - 0.07240868511889201im
    0.03412441587107335 - 0.10983103576305965im
    0.06108105691578187 - 0.1493779447148213im
     0.2460556204059165 + 0.04365092049099278im
    0.01732856288174544 - 0.049667798330106115im
    0.03271665331399043 - 0.03559322667073716im
    0.33101788790292846 + 0.0im
    0.11061927850798409 + 0.1620759244367709im
   -0.06708862961874702 + 0.015974216952996934im
   -0.12504325618580722 + 0.07005878448406291im
    0.18075471821084038 + 0.25595419813857784im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 14 August 2023 17:04">Monday 14 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

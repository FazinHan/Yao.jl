<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/dev/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.336648+0.158318im      0.0277715+0.161074im        0.14808-0.000739846im    -0.084698+0.0260178im     0.102315+0.185855im       0.115351+0.0726377im     0.291634-0.107905im      0.0723838+0.0720811im     -0.166319-0.0660594im      -0.109183-0.207213im     0.0906115+0.0322184im     -0.0511702-0.00805211im      0.24909+0.257786im     -0.057527+0.11937im     -0.00949802+0.236127im      0.146912-0.030456im     -0.110157+0.0880814im    0.117474-0.0168889im    -0.100869+0.167761im      0.0430999+0.0513688im      0.0979743+0.128013im      -0.0600615-0.0212898im    0.0801491+0.00136007im    -0.149288-0.00522198im    -0.133194+0.0346763im      0.10107+0.0277919im     0.0406393+0.0150888im      0.0663061+0.17679im      0.0252272+0.113499im    0.00989708-0.0984027im      0.1088-0.135785im      -0.144665+0.183338im
   -0.211682+0.221947im       0.472741-0.114372im     -0.0611619+0.0846051im     -0.0743101-0.0257189im    -0.026175-0.156467im     -0.0623661-0.0177355im    0.0699775-0.125091im      0.0567579+0.124866im       0.118161-0.148061im      0.00139137-0.147235im      0.142777-0.185342im        -0.12128+0.0575954im    -0.0860543-0.0589325im    0.0204163-0.172346im        0.25721-0.0395074im     0.133435+0.0182721im   -0.0743956+0.16943im     -0.185608+0.111291im    -0.0622485+0.111515im       0.133082+0.0409181im      0.0557152-0.157738im         0.14165-0.0851667im    0.0702344-0.0085781im    -0.0394472+0.0432805im     -0.107747-0.0844422im     0.185252-0.125396im      -0.050585-0.0353908im     -0.0111401+0.051027im    -0.0141945-0.0181785im    0.0430948+0.194651im   -0.0410975-0.00916713im    -0.168566+0.00855655im
   0.0314697+0.161785im     -0.0621567-0.0176777im      0.309928+0.108478im      -0.0944854-0.162437im       0.12827-0.184747im      -0.168728+0.00554805im  -0.0159318-0.0134131im     0.0406825-0.00752387im     0.184121+0.0238105im      -0.164689+0.205697im      0.104757+0.0137803im       0.150822+0.100665im       0.117356-0.0618399im     0.103364-0.0279799im    -0.0165511+0.0237329im     0.073034-0.0563896im    -0.155105-0.144466im   0.00120142+0.234214im      0.148053+0.00126304im   -0.0173143+0.0617733im   -0.000543953+0.0787272im       0.107942+0.212202im     0.0843919+0.125506im      0.0217097-0.0696906im     -0.100029-0.24824im      -0.103312+0.018583im     -0.0625516+0.0817194im       0.204533-0.105239im     -0.112091-0.00644182im   -0.227069-0.0111727im    0.185468+0.236119im      0.0425448+0.196548im
   0.0293488-0.0892945im     0.0275094+0.0443532im    -0.0123552+0.0320889im       0.271557-0.0231711im    0.0599546+0.120218im      -0.182304+0.184901im     -0.129516-0.0573651im   -0.00530002-0.314381im       0.057547+0.113059im       0.0719575+0.131957im    -0.0999087-0.287591im      -0.0523299+0.177409im      0.0503974+0.113073im     0.0826442+0.0691918im      0.102561-0.0645061im     0.084671+0.10609im      -0.219124-0.0275454im   -0.121879-0.0752914im   -0.0664655-0.124694im       0.330064-0.0861889im    -0.00878119-0.0063901im      0.0160086+0.0187598im     0.132538+0.178702im       0.126225-0.00615474im   -0.0767678-0.00106278im  -0.0156813-0.0280899im     0.0807419+0.099261im      -0.0382091+0.186155im     -0.190862+0.142228im      0.121137-0.184533im     0.123166-0.147033im     -0.0251975-0.0942926im
    0.058668-0.132397im     -0.0155701+0.160452im      0.0907182-0.117594im       0.0196463-0.104801im      0.353963+0.0104121im      0.215448-0.217185im     0.0284655-0.0583286im      0.114374-0.086217im       0.148437-0.00773106im   -0.00456194-0.0772845im    0.0225907+0.00102453im     0.0164688-0.195571im      -0.132044+0.127612im     -0.209023-0.178567im      0.0529085-0.354374im     0.0635706-0.0736708im   -0.0420608-0.0369573im   0.0909671+0.168436im     -0.164656-0.0622489im     0.0955287+0.154174im      -0.0449281+0.110556im      -0.0282543-0.082046im     0.0702927+0.0199301im      0.279739+0.149im          0.171701+0.055865im    -0.0167788-0.0142434im     0.0119383-0.161288im      -0.0320875-0.0374962im    -0.103807+0.14772im      0.0549067+0.111907im    0.0331828+0.0892282im    -0.0440921+0.0979354im
   0.0434608+0.0809198im      0.297629-0.0268424im      0.042382+0.203208im       -0.054329-0.0557186im    0.0341467+0.0954059im      0.343949+0.0267896im   0.00788966+0.261072im       0.113196+0.0425783im    -0.0838654+0.145605im        0.155597+0.356158im   -0.00501699+0.14055im       -0.0969439-0.0272391im    -0.0346415+0.0857312im    0.0929817+0.120039im       0.086809-0.00430988im   -0.142868-0.104286im    -0.0370615+0.0898489im   0.0195796-0.0170706im    0.0905189+0.0999602im      0.109724-0.11797im        0.0456471+0.19526im         0.102631+0.219835im      0.137656-0.0441473im    -0.0329548+0.0436611im     0.0714891-0.0195135im    -0.089051-0.0274779im     -0.182705+0.0156158im     -0.0820606-0.0583126im   0.00324263+0.040031im      0.328454+0.0511428im  -0.0185549+0.0772291im      0.083635-0.0273219im
   0.0177114-0.0753528im     0.0337553+0.0428469im    -0.0954904-0.0167032im     0.00617513-0.0327602im     0.074473-0.0770909im   -0.00586732+0.0375273im     0.482421+0.176272im     -0.0292239-0.0704934im    -0.0152694-0.0925575im      -0.210021+0.0373894im     -0.20302-0.0362284im       0.227765+0.0353818im     -0.100059-0.129322im     0.0582083-0.0491992im     0.0167486+0.179388im      0.125932+0.267186im    -0.0504499+0.0537771im   0.0337739+0.0467567im    0.0737999-0.127619im      0.0232292+0.0166781im     -0.0240463-0.0677735im       0.134835-0.0397747im   -0.0895567-0.0718164im      0.164877-0.141361im       0.141343+0.0828936im   -0.0988809-0.132453im      -0.178632-0.0390571im     -0.0259503+0.19013im     -0.0595474-0.133867im      0.175172+0.0365469im  -0.0268094-0.0743929im      0.224258+0.211413im
  -0.0405785-0.0484132im    -0.0662995+0.00352814im     0.224668+0.0226369im        0.22819-0.0494149im    0.0212973-0.0667238im     -0.178968-0.0146857im     0.179288-0.0561823im      0.198335-0.196232im       0.127903-0.00723486im     0.0167382-0.0792699im    0.0710906+0.00750604im     -0.022091-0.140403im     -0.0523273-0.043014im     0.0817988-0.0202283im    -0.0904358+0.0883959im    0.0202915-0.104767im     -0.168946-0.0382457im   0.0569226+0.0360869im    0.0138232+0.083303im     -0.0438512-0.202573im        0.112293+0.080741im       -0.132348-0.016949im     0.0449316+0.110446im      -0.184708-0.0954841im     0.0360152+0.114682im     -0.302999-0.167746im      0.0694129+0.0979494im     -0.0862097-0.193704im      0.114733-0.0908164im     0.148193+0.245087im    -0.322378-0.123152im      -0.222358-0.0607382im
 -0.00186916+0.0912289im      0.187297+0.017028im       0.138347-0.171915im       -0.153047+0.146534im      0.186338+0.172456im     -0.0703852+0.159808im     0.0333429+0.0236899im     -0.314678-0.0228871im      0.331077+0.0184732im    -0.00065829+0.0342799im   -0.0325171-0.00776809im      0.149452+0.0907078im   -0.00369133+0.138939im     -0.140575+0.154254im      -0.092632+0.0600562im    0.0867283-0.208129im      0.232246-0.0689345im  -0.0565943-0.0275756im      0.21096-0.0752302im      0.162782+0.0428759im      0.0427872+0.115379im      -0.0533618-0.140219im    -0.0951009-0.0367464im    0.00138491+0.0719356im      0.108307-0.106649im      0.135555-0.0291503im   -0.00492125+0.0911406im     -0.0708603-0.185923im      -0.11813-0.229301im     0.0556218-0.0021203im   -0.152235-0.132805im     -0.0316101-0.0419396im
  -0.0440247+0.0628218im     0.0124981+0.227682im      0.0320068+0.0378966im     -0.0544608-0.236919im    -0.0746214+0.242905im       -0.11877-0.0952484im    0.0353837-0.125473im      -0.043725+0.105782im      -0.198597-0.269445im        0.269777+0.0243215im   -0.0171844-0.16065im       -0.0949703+0.00753852im    0.0798783-0.0969148im    0.0329801+0.0222377im     0.0494299-0.109601im     0.0780484-0.138616im     0.0825166-0.209676im   -0.0596289-0.0678697im     0.196485-0.0172668im     -0.150764-0.229093im       0.0659132+0.000816337im   -0.0173268+0.00215941im  -0.0673111-0.0747577im     0.0491858+0.10937im        0.264952-0.0844028im    -0.146342-0.198179im     -0.0604662+0.0203586im     -0.0476704+0.0754893im   -0.0945946+0.0572286im    -0.102443+0.139196im     0.218683-0.168206im      0.0413843+0.113251im
  -0.0396257-0.360656im    -0.00432995+0.0812889im    -0.0392485+0.0826938im     -0.0757286+0.0653005im  -0.00307864+0.167837im      -0.111616+0.194995im      0.161524+0.113986im     -0.0795898+0.128915im      0.0567835-0.000429618im    0.0185793-0.0791073im     0.391583-0.0869531im      0.0643059+0.107169im     -0.0825088+0.0780043im   -0.0732848-0.0581746im      0.182325-0.16473im      -0.112439+0.0504563im    0.0961685+0.0551649im     0.17602-0.0839678im    0.0650937+0.0123605im      0.102544-0.264962im       -0.172475+0.0159343im     -0.0915442+0.0213943im    -0.118638-0.00218913im  0.000370278-0.0993793im     -0.204082-0.224909im     -0.125937+0.0441027im     0.0788609-0.070003im        0.154173+0.00628992im   0.0991695+0.110522im     0.0735549+0.0765771im  -0.0530864+0.138413im      0.0134209+0.142889im
   -0.136362-0.136305im     -0.0706116-0.0226888im   -0.00677785-0.0596506im      -0.144012+0.0900287im     0.173081-0.0523235im     -0.113909-0.173625im      -0.15859-0.0520048im    -0.0857133+0.0272121im     -0.274493-0.0390452im      0.0215131+0.0520516im    -0.044886-0.128104im        0.450485+0.0953479im     -0.113883+0.279958im     0.0900297+0.0764071im      0.157336+0.163598im     -0.056667+0.0727114im   -0.0481511-0.0402604im  -0.0215829-0.0949487im     0.051191+0.149178im     -0.0384965+0.107284im      -0.0313229+0.0992462im       0.131529-0.139458im      0.200878-0.132184im      -0.106491-0.0346718im      0.107394+0.0481374im   -0.0738058-0.103825im     -0.0248652+0.075811im     -0.00258741+0.0176316im    0.0425196+0.129499im      0.043181+0.118733im    0.0294244+0.162918im      -0.245148-0.0963076im
   0.0683597-0.169298im       0.127486+0.212041im      0.0905119+0.0254164im       0.107678+0.0441214im    -0.231982+0.0269243im    -0.0326261-0.0912918im   -0.0446191+0.0302757im     -0.100749+0.00974724im    -0.101977+0.0177158im      0.0601136-0.0485771im  -0.00375998+0.0612163im       0.306915+0.0869737im       0.38192+0.0916591im  -0.00660456-0.0656902im     0.0187536-0.19061im      0.0786886-0.109396im    -0.0842546+0.114215im    0.0945682+0.206782im    -0.0749261+0.0783271im     -0.225204-0.00106612im    -0.0315527-0.180138im       0.0276691+0.0500839im   -0.0775125+0.270267im      0.0838214-0.0444646im    -0.0257069-0.020711im      0.211124-0.0757715im     -0.123389+0.115866im       -0.221072-0.0264788im   -0.0284166-0.152314im      0.174285+0.0186446im  -0.0586967+0.11342im       0.0405501-0.094364im
   0.0607914-0.12903im       0.0577232-0.0945691im      0.108815-0.041808im       -0.126699-0.195933im      0.113305+4.07957e-5im    -0.131945+0.00778803im  -0.0622275+0.201431im      -0.174951+0.128124im     -0.0845724-0.085468im       -0.190827-0.145669im     -0.087431-0.0319303im      -0.236654-0.123898im      -0.111854+0.0521064im     0.389687+0.0601523im     0.0665529-0.15861im       0.106833+0.0541949im    0.0113901-0.0235581im    0.106094-0.0186034im   -0.0464794+0.171314im      0.0471319+0.0235079im      0.0595784+0.0368155im      0.0714551+0.0211192im    -0.339316+0.102803im     -0.0456786-0.032159im      0.0225505+0.264479im     0.0671736+0.0684222im      0.091264+0.221417im       0.0446969-0.174159im     -0.172636+0.0543255im    0.0924909-0.0176642im   0.0800375+0.0558336im     0.0189688-0.0642832im
    -0.17633+0.00949232im    -0.215961-0.0486509im     0.0181999-0.101843im       -0.249748+0.0116659im    0.0094351+0.0152397im      -0.13686+0.099499im      0.175797+0.173603im       0.121136+0.0331386im     -0.074694-0.0484639im      0.0359052+0.0180636im   -0.0455202-0.108252im      -0.0881383+0.0420913im     0.0829134-0.083181im     -0.236367+0.145611im       0.442626-0.0665742im    -0.191881-0.100799im    -0.0779959+0.14095im    -0.0734332+0.118701im     -0.199422+0.0730908im    -0.0534961+0.0805903im       0.136425+0.1646im         -0.159065+0.0917721im    0.0825626+0.0481916im      0.172364-0.0887486im     0.0808543+0.0742176im   -0.0208587-0.0493017im    -0.0535273+0.0948244im       0.016612-0.0676327im   -0.0311548-0.191851im     -0.121505-0.191671im   -0.0541528-0.0676722im     0.0118676-0.123122im
  -0.0610363-0.205814im      0.0212693-0.0221374im    0.00472165-0.103733im      -0.0590321-0.0669798im   -0.0305505-0.109318im         0.1842+0.129712im     -0.148066+0.0652359im       0.20192+0.0871256im      0.111721+0.0311806im       0.221024-0.0500688im   -0.0362803+0.000202694im   -0.0688251+0.118041im     -0.0494657-0.0421524im    -0.181857+0.296219im      0.0657278+0.071787im      0.465876+0.174816im    -0.0615937-0.0988931im   0.0698796+0.0751669im     0.075201+0.157605im     -0.0612495+0.171861im      -0.0435346-0.0837546im      0.0104114-0.0346502im    -0.102229-0.0151277im    -0.0906391+0.0245531im    -0.0359917-0.112796im     -0.171753-0.160958im      0.0788045+0.0694287im      -0.236424-0.0739947im    0.0893547+0.107512im    -0.0328027-0.164622im   -0.0519802+0.0372617im     0.0623352+0.118298im
    0.156184+0.0386707im      0.169114+0.098549im     -0.0152304-0.0428197im       0.156178+0.0304491im    0.0684644-0.0164994im     -0.274921-0.0548915im   -0.0829341+0.0740615im      0.357837+0.165714im       0.142839-0.167068im       0.0325506-0.0331363im    -0.103059+0.0822252im       0.145081+0.06462im       -0.116691+0.0426243im     0.121362-0.00489961im    0.0855856+0.0865586im    0.0784646+0.0401728im     0.424931+0.221191im   -0.0248136-0.0832966im   -0.0855534-0.0023835im    -0.0767378-0.0510951im     -0.0890251-0.00635353im     -0.141882+0.10953im       0.191725+0.108794im      0.0840818-0.023482im      0.0954653+0.00196714im  -0.0710627+0.294755im     -0.0612075+0.0893735im     -0.0887924-0.103659im     0.0215451+0.0879116im   -0.0374658-0.0658561im   0.0668364-0.0827052im     0.0202841+0.06996im
  -0.0926182-0.095536im       0.151514+0.0474041im     -0.139772+0.233784im        -0.10889-0.091447im      0.123834-0.137974im      0.0419393+0.131451im     -0.188348-0.00555762im     0.179172-0.130164im     -0.0818946-0.0488138im      0.0356746-0.0464906im    0.0302932+0.0115188im      0.0415963-0.0256748im       0.01943+0.176587im    -0.0737604-0.135171im     -0.0426203+0.14561im     -0.0986448+0.13032im      0.0605161+0.137795im     0.415355+0.165827im      0.196282-0.134252im    0.000108993-0.106061im        0.136735+0.0423496im     -0.0261742-0.0264773im    -0.160724+0.0688812im    -0.0297187+0.148428im    -0.00979593+0.0796091im    -0.055471-0.0405139im      -0.08001-0.041235im       0.0267737+0.0500622im    -0.228463-0.189062im     -0.242835-0.105458im    0.0264453-0.14131im       -0.141651-0.129137im
 -0.00875721+0.0304128im    -0.0376802-0.0103082im      0.195028-0.207636im        0.141739+0.0872731im      0.17176-0.0179265im    -0.0714371-0.154282im     0.0575384+0.0886954im     -0.061233+0.0227754im     -0.199812-0.0097702im       0.114799+0.0149856im    -0.230782-0.00623884im     -0.213805-0.193236im      -0.104321+0.0197117im    -0.174755+0.0495351im      0.127838+0.0729101im    0.0946812+0.117312im    -0.0473195+0.0489348im   0.0706694+0.105908im      0.432956+0.0515484im     0.0170666-0.201854im       -0.213385-0.0840925im     -0.0223508+0.122im        0.0944077+0.156399im     0.00990678-0.0308934im     -0.104849-0.0968412im     0.259669+0.115174im     0.00657897-0.0814786im      0.0643028+0.124727im      0.034972-0.0313973im      -0.0886+0.0921537im   -0.111047+0.0747838im   -0.00164105-0.133033im
  -0.0869436+0.0941225im      0.138232+0.0408875im      0.159677-0.128936im      -0.0611418-0.129286im       -0.1027-0.0947003im      0.043682-0.0270695im     0.053846-0.133496im     -0.0213332+0.0416116im     -0.190144-0.0221833im        0.17315-0.0773646im   -0.0765307+0.0582083im    -0.00312033+0.164833im       0.234752-0.0357534im    0.0742573+0.00870715im  -0.00262684+0.0579509im    -0.143291+0.261154im      0.178706-0.178716im    0.0934107+0.125421im     -0.181272-0.0772632im      0.405249+0.0159868im      -0.258567+0.128545im       0.0206895-0.030784im     0.0260694+0.130924im      0.0295311+0.10424im       0.0781885+0.0725397im    -0.140525+0.0365521im      0.227237-0.0223021im      0.0693037-0.0817467im     0.183865-0.20161im      0.0216005+0.0576189im  -0.0510497+0.0672047im     0.0669717+0.0129097im
  -0.0303137+0.0125577im     0.0303429+0.00473936im     0.272103+0.0383832im       0.144137+0.0147112im   -0.0637112+0.0388639im     -0.231481-0.0399686im    -0.107385+0.0537529im    -0.0338066+0.161934im     -0.0195046-0.0900178im     -0.0588939+0.0311839im    -0.077064+0.182823im        0.096268+0.079578im     -0.0962404+0.0224873im     -0.18381-0.0209508im     0.0337714-0.121824im     0.0478407+0.0542595im    0.0947632+0.0313676im   0.0363311-0.0842588im   -0.0485138-0.0678628im     0.0765409+0.100049im        0.501513+0.154566im        0.148348+0.122114im    -0.0775523+0.0246278im     -0.108764+0.0924322im    -0.0941238+0.040989im    -0.0680615-0.136893im       0.153597-0.277352im      0.00770777+0.279701im     0.0733145+0.0583292im    0.0111776-0.0038481im   -0.121972+0.0521964im      0.195387-0.0888806im
  -0.0689997+0.0327803im     -0.142695+0.059147im     -0.0429342+0.0890511im     -0.0594619-0.0922849im    0.0161653+0.0928292im    -0.0159811-0.0318677im    -0.109515-0.0921908im      0.246573+0.0475728im      0.222845-0.0178034im      -0.174236-0.0361855im     -0.16338+0.0996493im     -0.0149649-0.110065im       0.152672+0.102521im     -0.138156+0.183367im       0.126787+0.0795002im    -0.183812-0.0626195im   -0.0190452+0.0450382im   -0.013594-0.103465im    -0.0214382+0.0586316im    -0.0324241-0.217164im       -0.139842-0.0649405im       0.581974-0.123613im     -0.136118+0.0463572im     0.0703154-0.0812006im     0.0511517-0.094431im     0.0389483+0.0391562im      0.249772-0.00684929im    -0.0350773+0.00936532im   -0.046607-0.0460723im    0.0731265+0.0719192im  -0.0431885-0.0617776im    0.00937024+0.0571409im
   0.0274744-0.082907im     -0.0814061+0.00455536im    -0.111347+0.106734im       -0.242756-0.136485im     -0.234158+0.0601549im     -0.042195-0.170304im     0.0272971-0.0322962im    -0.0238044+0.0548959im    -0.0631787-0.055675im      -0.0856998-0.0818238im     0.165114-0.0259024im      0.0767892-0.229692im        0.03232+0.156164im     0.0575142+0.157275im      -0.137202-0.0572094im     0.088497+0.203785im     0.0199178+0.105459im    -0.252282+0.127821im      0.236049-0.147614im      0.0791871+0.0523818im      0.0536607-0.0174967im       0.017614+0.139491im      0.300712+0.0517784im      0.121857+0.0836001im    -0.0985552+0.0204516im   -0.0224792-0.0381344im      0.123535-0.0959046im      0.0339924-0.238421im     -0.132148+0.0885524im    0.0677468-0.10948im     -0.258128-0.175942im      0.0830164-0.0169714im
    0.122797+0.0221724im     0.0981893+0.0491728im      0.174812+0.197658im        0.205393+0.0360929im   -0.0769472-0.195032im      0.0416601+0.196116im     0.0277922-0.0916593im    -0.0242065+0.157376im      -0.125035-0.058287im       0.0613793+0.0311961im     0.145084-0.044104im     -0.00367526+0.0317551im    -0.0958187-0.0195931im    0.0249853+0.0613319im      -0.05352+0.0289003im    0.0524157-0.0895411im    -0.116984+0.0757038im  0.00438103-0.163874im      0.188674+0.08833im      -0.0872691+0.118447im        -0.03902+0.103756im       0.0457935-0.0989923im   -0.0395049-0.166807im       0.578539-0.112635im       0.079946+0.0999233im   -0.0162114+0.0663458im      0.259323-0.0568168im      0.0240405-0.0447477im    0.0378941-0.128128im    -0.0386153-0.0822451im  -0.0243777+0.0591783im      -0.11468-0.12089im
    0.172785+0.06015im      -0.0626895+0.0353283im    -0.0724561-0.0129282im      0.0411372+0.299559im      0.071495-0.164794im      0.0558255+0.0961875im    -0.212594+0.148354im     -0.0956618-0.00337342im   0.00474074-0.0727955im       0.137842-0.20396im       0.276672-0.205821im      -0.0972155-0.0960733im     0.0333103+0.0332892im   -0.0266387-0.0503866im    -0.0351047-0.015946im      0.102384-0.0494484im    0.0536536+0.0491339im   -0.101822+0.0815523im   -0.0177828-0.0281594im    -0.0429626+0.0014382im     -0.0768874+0.120624im        0.269487+0.0947938im     0.100229+0.19433im       -0.197266-0.154049im       0.374166+0.0733915im    -0.129762-0.0653426im   -0.00878963-0.002598im        0.198327+0.146461im    -0.0148279-0.132501im     0.0323117-0.0289922im  -0.0453946-0.00385128im     0.178889+0.0348205im
  -0.0908782-0.0383387im     -0.153541+0.0309585im      0.130361+0.150134im       -0.101741-0.0579909im   0.00589137-0.0869063im   -0.00874058+0.0297729im   -0.0407869-0.0238781im      0.144281+0.0514306im    -0.0611934+0.0241916im      0.0888006+0.0588465im    0.0667984-0.130767im        0.143884-0.0295342im     -0.238598-0.210992im      0.126206+0.263092im      -0.115424-0.00721092im   0.0324137-0.0768626im   -0.0227943+0.0524029im     0.18277+0.0805137im    -0.134955-0.196352im      0.0534491-0.0994407im       0.108289-0.0660488im     -0.0918325-0.0378571im    0.0360778+0.0409601im    -0.0721106+0.122113im       0.234894-0.110031im      0.485016+0.0488004im      0.120304+0.0707066im        0.11098+0.12231im       0.119226-0.0415239im     0.203276-0.0654786im  -0.0448467-0.00771777im   -0.0571142+0.179607im
   0.0281532+0.161576im       0.269812+0.031883im      -0.215758-0.122395im       0.0190945-0.056377im   -0.00750506+0.0817121im     -0.044871-0.249126im     0.0527904+0.199417im      0.0682217-0.0144848im    0.00366566+0.142199im       0.0063699+0.298261im     0.0960225-0.163749im        0.029242+0.0636457im    -0.0189438+0.173179im     -0.116612+0.0298528im    -0.0315928+0.00627568im   0.0458358-0.012592im    -0.0494247-0.101251im    0.0655469+0.126745im    -0.0784815-0.0337692im     -0.202807-0.0728941im      0.0767622-0.124627im       -0.128468-0.0709873im   -0.0187595-0.0834284im     -0.057312-0.137552im    -0.00362709+0.171933im    -0.0230082+0.052327im       0.490744+0.101558im        0.152557+0.0557423im   -0.0802672-0.0665041im   -0.0880797+0.0476579im  -0.0710398+0.0743033im      0.110824+0.0654045im
  -0.0743917-0.168743im      0.0734884+0.0666969im     0.0200401-0.0401819im      -0.115599+0.15416im      -0.264297+0.0899026im    -0.0329982+0.0821423im   -0.0230473-0.0592231im      0.234146+0.0637206im      0.267094-0.11349im         0.170865-0.0935296im    -0.224338+0.0637673im     -0.0617905+0.0427176im     0.0799103+0.069295im     0.0325382-0.107646im      -0.109402+0.0168996im   -0.0933393+0.0446667im    -0.191067-0.136535im   -0.0244927-0.0426146im     0.160377+0.0900982im     0.0247491+0.0536473im      0.0555086+0.10957im       -0.0881498-0.0643114im    0.0637515-0.0729873im     0.0542333+0.0227719im     0.0786783+0.209373im      0.122435+0.0789781im      -0.14075+0.176518im        0.341724+0.152852im     -0.152433+0.108855im    0.00636373+0.0658771im   -0.195081+0.22237im       0.0768345+0.0966108im
    0.245019-0.0560101im      0.214956-0.109529im      0.0415704-0.0316074im      -0.114279-0.0163626im    -0.192042+0.0700257im     0.0335087+0.0951577im    0.0228393-0.0866042im    -0.0663317+0.000270735im    0.223896+0.0333315im      -0.244612+0.0209579im   -0.0560485-0.0847448im    -0.00245324-0.170805im     -0.0835198+0.129246im     0.0417627+0.165937im      0.0622655-0.102529im     -0.110994+0.218735im     -0.125355+0.0259546im  0.00408595+0.0498431im   0.00961024-0.141306im      -0.138464-0.0856795im     -0.0116746+0.0766601im     -0.0784575-0.00971492im   0.0334497+0.117052im      0.0217845+0.0996283im      0.249385-0.0774785im   -0.0404064-0.0930429im    -0.0200511+0.0901808im      -0.106931+0.163516im      0.404451+0.0129314im    -0.250653+0.0832937im    0.131009+0.0782903im     -0.030625-0.183784im
   -0.119488+0.0964942im    -0.0831794+0.0307985im     -0.058224-0.233641im     -0.00452244+0.0157511im    -0.146335-0.0517637im     0.0972063+0.0416823im    0.0170649-0.0481399im     0.0133057-0.10831im         0.11956+0.0851544im     -0.0415811+0.0478995im    0.0638589-0.138012im       0.0414305-0.00406254im    0.0739047-0.0714811im     0.107266+0.0235131im     0.0315732+0.213504im     0.0364315-0.00649428im     0.29788+0.0110724im   0.0358868+0.295004im     0.0493429+0.136357im      -0.164807+0.0234093im         0.0606+0.189011im     -0.00295432+0.134105im     -0.234383+0.0710825im      0.214377+0.0649646im    -0.0227986-0.0629768im   -0.0147773-0.00310098im    0.0536008-0.0800033im       0.182355+0.150657im     0.0079263+0.340078im      0.264979+0.105465im    0.0535785-0.085842im      -0.113321-0.236552im
   0.0143884-0.255176im       0.156579+0.146174im       0.172567+0.156983im       -0.180134+0.254267im    -0.0966866-0.150245im      0.0339489-0.0574473im    0.0257629+0.00589546im   -0.0585235-0.0604569im     0.0564099-0.0242924im     -0.0845646-0.0826143im     -0.13877+0.167616im      -0.0552596+0.00426218im    -0.130147-0.0814932im    -0.128128+0.0921538im     0.0766156+0.0578197im   -0.0317285-0.105267im     0.0778827-0.218606im    -0.180716+0.157756im   -0.00952821-0.0598662im    -0.0383419-0.119781im      -0.0229783-0.198425im      -0.0651771+0.123641im      0.104142-0.0446295im    -0.0824716-0.0538006im    -0.0473046+0.166004im     -0.112764+0.00497079im     0.169972-0.125951im       0.0673752+0.033975im    -0.0972518-0.088844im      0.184557-0.0887907im    0.379118-0.0407579im     -0.207312-0.0405787im
   -0.166488+0.0559944im     -0.150571-0.0829541im     0.0628158+0.140637im        0.103279-0.0840056im    0.0979459+0.0345937im     0.0640176+0.0984746im    -0.083416-0.102868im      -0.127968+0.140608im       0.152956+0.156951im      -0.0169213-0.184687im     0.0779288+0.066998im      -0.0877781+0.0603054im     0.0219216+0.174698im      0.114872+0.0274378im      0.162812+0.100094im     -0.095467+0.0387319im    0.0808209-0.110099im     0.202456+0.148693im      0.112262+0.0854072im    -0.0513159+0.048963im        0.157732-0.212905im       -0.169358-0.157802im      0.331848-0.0122282im     0.0875058-0.16668im       0.0475811+0.0915949im    0.0279898+0.00337879im    0.0131018+0.000282943im   -0.0931474+0.0463491im    0.0168375-0.0185687im     0.101201+0.184019im     0.148846-0.106118im       0.382127-0.0256378im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.01341504409522835 + 0.039524539744221265im
     -0.269371927142286 + 0.04143536132155677im
   -0.06004199989501383 + 0.1198141215306769im
   -0.13743322359112475 + 0.09353049871611624im
 -0.0019358993453966655 + 0.19304984523043334im
  -0.007009037255173399 - 0.06656192656553257im
  -0.005968846451197094 - 0.18398197194247956im
     0.1153054570218079 - 0.28308283235383846im
    0.01806156305396498 - 0.16940459786144463im
    0.03786703887826779 - 0.05521076071935091im
   -0.06411053629619917 + 0.2769085718068924im
   -0.19705075850494885 - 0.07023659759837457im
    0.09925491488986271 - 0.15121373972836305im
   -0.15925803678974712 + 0.08405426087258754im
     0.1536033190484629 + 0.2441920046436831im
    0.07136858157018935 + 0.1223824962013041im
    0.12635427030464966 - 0.026937223264931864im
  -0.008310375942868967 - 0.083369854109144im
   -0.19757559625466506 - 0.0009090293859768484im
    0.10954374805819496 + 0.059876006829231485im
    -0.1410368959126462 - 0.03524221712371352im
    0.08777388435226335 + 0.09917768900599841im
  -0.010532332853333224 - 0.01639756666148167im
   0.026440728507225883 - 0.13412241082583615im
   -0.23250627758859932 + 0.07773514987332439im
   -0.06714212689395208 - 0.002065030648919725im
   0.019424893565855552 + 0.05837968514810907im
    0.32010238309193867 + 0.0im
  -0.024667510400676516 - 0.177010698896304im
   0.009861518193476098 + 0.13495714440993456im
    0.09565940912769688 - 0.03944206369465165im
  -0.035132544747330866 - 0.1169891131796766im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 14 August 2023 17:01">Monday 14 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

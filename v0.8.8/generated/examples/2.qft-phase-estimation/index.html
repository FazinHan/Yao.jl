<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.8/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.8/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0463464+0.188773im     -0.0599517-0.0180794im     -0.188832-0.0651565im     0.0396671+0.0741391im      0.092687+0.0887797im      -0.119701-0.114844im     -0.0531064-0.0836497im      0.0954529+0.00408104im      0.082162-0.0721336im     0.0395722-0.0360991im     -0.110362+0.209473im     -0.0214472+0.26995im         0.118616+0.0464923im   -0.0888971+0.189868im      -0.0998363-0.00167525im  -0.0226478-0.249209im       0.116755-0.141071im       0.134755+0.0609422im   -0.0699841-0.133374im    -0.058489+0.187725im      -0.195694+0.0834619im     0.202134-0.00710395im      0.102317-0.0410318im   -0.0262341+0.207294im    -0.0453388+0.0701078im      0.152476+0.180586im     -0.0481134+0.167145im      -0.092911+0.00560376im     0.223927-0.0220271im      0.112807-0.143392im        0.15348+0.120624im      0.282372+0.095723im
  -0.170352+0.0888841im     0.0113356+0.126991im      0.0370346-0.00301636im    -0.181216+0.104989im      -0.236789+0.0554196im      0.0613644+0.118831im       0.168693-0.00692794im     0.0754531+0.179665im      -0.0381816-0.00666367im    -0.129161+0.0183863im    0.00211445+0.0274843im      0.302208-0.160367im      -0.0488089+0.12689im         0.1403-0.0798498im     -0.0549992+0.148693im     0.0185658+0.140685im        0.12962+0.0156416im   -0.00426093-0.0257614im   -0.0502352+0.142643im    0.0053483+0.134493im       0.185849-0.0098383im     0.235297-0.122203im       0.0338732+0.0245745im    -0.135203+0.13543im    -0.00999111+0.0362542im     0.0743382+0.109163im      0.0797924-0.0753169im     -0.208605+0.118508im     -0.0469311+0.275965im     -0.0819072-0.0708805im      0.257086+0.284888im    -0.0227004-0.0599316im
   0.101968-0.00133943im   -0.0855801-0.125257im        0.13167+0.14238im        0.126463+0.0611433im     0.0233128-0.0446488im      0.0140095-0.0501908im      0.181134+0.276705im       0.0339249-0.224894im         0.19229-0.0125445im    -0.0808111+0.0914739im    -0.0129924+0.0619918im       0.22003-0.0125772im      -0.159627-0.0768509im    0.0169055+0.0944224im     -0.0797948-0.133569im     0.0202385+0.0974443im     0.0355974+0.0497389im     -0.319928+0.106458im    -0.0938768+0.0992712im    0.148442-0.0312707im     -0.102688-0.0754144im    0.0102843+0.182551im       0.0789973+0.197041im     0.0312726+0.316926im    -0.0728228+0.115223im     -0.0538654-0.247367im      -0.147402+0.129523im       0.125412+0.125221im       0.083935+0.100459im       0.177835+0.0322226im     0.0370718+0.0638259im    0.0203323+0.00857049im
 -0.0762487+0.131921im       0.154894-0.141342im       0.077472+0.364565im       0.138246-0.11064im       -0.068325+0.140341im     -0.00292395-0.084596im       0.125247+0.0134294im      -0.149911-0.0842092im     -0.0358764+0.00836675im     0.280303+0.132147im      -0.312033-0.0709863im     0.0174141+0.0168489im      0.0996197+0.0544998im    -0.103407+0.00208629im     0.0468857+0.170419im     -0.142821-0.0871403im     0.0539501-0.00530334im   -0.0397373+0.163851im    -0.0508332-0.227477im    0.0903025-0.00254329im     0.248553+0.226604im      0.058995+0.105698im       0.0226083+0.00531551im   -0.101218-0.0751548im    0.0426854-0.140875im      0.0453667-0.0281474im      0.069097-0.00220438im    0.0504471+0.100147im    -0.00498099-0.172197im     -0.0155327+0.109962im       0.151808+0.142011im     -0.192094-0.0179512im
  0.0911717+0.000810184im   0.0746279-0.26219im      -0.0310157-0.00265387im     0.180122-0.0797329im       0.23652-0.0373619im     -0.0624265-0.179875im       0.169271+0.0140302im      0.0568012-0.00436136im      -0.01433+0.0622788im     -0.055965-0.191898im       0.204064+0.00138794im      0.18898-0.0704187im     -0.0624504+0.336211im     -0.177013-0.0393599im       0.137489+0.102532im      0.221427-0.194394im     -0.0324885-0.0444363im    -0.0107684-0.0790632im    -0.016768+0.116641im   -0.0248646+0.157181im     -0.0470665-0.0396782im   0.00375875+0.0018834im      -0.193544+0.121982im     -0.196977-0.0124258im     0.161322-0.188436im      -0.153395+0.0557255im      0.282097-0.0068986im    -0.0113403+0.0807195im    -0.0623093-0.000811316im    0.104702-0.117428im     -0.0664765-0.00378675im   0.0030517-0.0910067im
 -0.0462374+0.103313im     -0.0321055+0.00102498im   -0.0393321+0.18188im       -0.144232-0.00225641im     0.055411+0.182207im     -0.00621043-0.0668911im    -0.0661905+0.105851im      -0.0081317+0.118625im        -0.11021+0.112616im    -0.00632057-0.0995035im     -0.134861-0.0695264im    -0.0520165-0.111607im       -0.175626+0.14483im      0.0551867+0.0774059im      -0.218197+0.158699im     -0.191891+0.116151im      -0.078688-0.102318im      0.0892134+0.0668574im   -0.0371639+0.0743503im   -0.199293+0.126234im      -0.165768-0.076262im     0.0299106-0.00152177im     -0.130757+0.148316im      0.169306+0.340583im       0.16676-0.166868im      -0.119581+0.101882im      -0.234999-0.166085im       0.161004-0.0945625im    -0.0169005-0.144529im      -0.139676+0.0996596im     -0.133602-0.0498243im    0.0403821-0.152024im
  -0.174991-0.0024704im     0.0260741-0.196607im      -0.110934+0.10208im        0.255245+0.0770221im     -0.183609-0.119604im      0.00174125+0.0945634im     0.0736931-0.0505939im     -0.0053227+0.0391394im       0.173967+0.140919im       0.183129-0.0174284im      0.199681+0.0349052im    -0.0973227-0.173351im       0.0310812-0.109319im    -0.0744715-0.102248im    -0.000789275-0.0896635im    -0.117752+0.139913im      -0.332157+0.0276158im      0.122673-0.0125574im    -0.142422-0.0968258im  -0.0350938+0.241858im      0.0223794+0.0126708im   -0.0996939+0.0818416im       0.137182-0.148337im      0.157978+0.0827808im     0.115006-0.0474891im     -0.140217-0.0185737im     0.0322346-0.187312im      -0.156692-0.126101im      0.0267526+0.134947im       0.190105+0.0243428im     0.0792886+0.0771209im     0.209397+0.0729454im
 -0.0614502+0.190936im      0.0781832-0.00922851im     0.020561-0.158063im      0.0850021-0.121438im      0.0974575-0.0122817im     -0.0158541+0.110794im      0.0291965-0.27178im        0.0786425+0.109921im       0.0415999+0.0481269im     -0.223156+0.0975634im    -0.0753137-0.0153704im     0.0544448+0.100595im       0.0950731+0.039397im      -0.09828-0.0764812im     -0.0246239+0.0358704im    -0.223789+0.251908im      -0.125696-0.100233im      -0.382004-0.0133225im     0.188785-0.145265im    0.0491551+0.0685832im      0.261913-0.035257im     0.0302941+0.0798257im      -0.243699+0.0848956im    0.0399823+0.0399519im    0.0743909+0.230443im        -0.1554+0.107382im       0.009783+0.158913im      0.0317928-0.133592im       0.029997-0.121292im      0.0476594-0.113064im     -0.0334728-0.0558368im     0.104609+0.00599505im
   -0.11058+0.215098im      0.0968694+0.0663785im    -0.0576579-0.193596im     -0.0308413-0.268817im     -0.0418283-0.124336im        0.192602+0.0853743im     0.0476937+0.336989im       -0.107137-0.0550479im       0.089823+0.0305125im     -0.250119+0.117222im      -0.116928+0.151427im     -0.0241066+0.121777im      -0.0310253-0.0444633im   -0.0347926-0.166944im       0.0567951-0.0327949im    0.0621872-0.194257im       -0.17001+0.136471im       0.164259-0.0416998im  -0.00316721+0.0857177im    0.095092+0.0205572im     0.0300551-0.0687321im   -0.0171982-0.203999im       0.0798548-0.117771im     0.0118327+0.150699im     0.0674117+0.0422495im    -0.0664764+0.145216im      0.0242711-0.119971im       0.188626+0.034815im     -0.0410119-0.28889im        0.164178+0.0486164im     0.0881612+0.0916697im   -0.0924462-0.00515224im
  -0.129649+0.24307im         0.10071-0.0917851im      0.190287-0.0287886im     -0.221513+0.0470461im    -0.0420437-0.168879im        0.204103-0.228034im      -0.115791-0.117628im        0.125964-0.0547306im      0.0359188-0.0179611im      0.050408+0.133182im     -0.0196964-0.223157im      0.0126712+0.00873529im       0.13661-0.247813im      0.149652+0.0175511im     -0.0590036+0.0935371im   -0.0302648-0.00301315im    0.0479734-0.0572806im      0.197411-0.0526879im     0.046902+0.0963787im   0.0307291+0.218686im      -0.106339+0.182102im      0.128184+0.0312813im      0.0476038+0.128701im    -0.0930589-0.0523877im    0.0499299+0.0126861im     -0.127928-0.156765im      0.0970837+0.0454956im      0.196273+0.0647457im     -0.158614+0.114475im       0.224548-0.116388im     -0.0639989-0.215492im     0.0734557-0.0570877im
   0.100558+0.149534im      0.0402573+0.251683im      -0.130652+0.204222im        0.10612-0.0638089im     -0.230792-0.0271955im       0.024462-0.0910035im    -0.0515805-0.141443im      0.00148469-0.121552im        0.293749+0.15564im      -0.0398479-0.126829im      0.0198402+0.0560764im    -0.0104496-0.111906im      -0.0251256-0.0746512im    0.0111973+0.3098im         0.0897659+0.218474im     0.0626756+0.0644419im    -0.0797085+0.1181im        -0.172943-0.109722im     0.0129016+0.0977219im   -0.266341-0.119308im     -0.0787311+0.071241im     0.0768584-0.177861im      -0.0696769-0.0770719im   -0.0246094-0.0123656im   -0.0918142+0.00544821im   -0.0652156+0.071161im       0.205534+0.0895564im      0.217786+0.0036801im    -0.0377898+0.0227481im    -0.0524989+0.10948im      -0.0462122+0.0570028im     0.015177+0.249598im
    0.11168+0.0029779im      0.133762+0.128702im      -0.080849-0.0949898im      0.216207-0.0584134im    -0.0696916+0.13615im         0.116906-0.0560574im     -0.118707-0.152757im       0.0280735-0.0803748im    -0.00296045-0.03129im       0.0185433-0.174411im     -0.0299117-0.178199im       0.325899+0.273248im     -0.00768205+0.190446im      0.064479-0.101543im      -0.0493982-0.146923im       -0.1961+0.205353im      0.0166327-0.045949im       0.134041-0.0706801im    0.0121237+0.0458655im   0.0333712-0.154232im      -0.161741-0.0202369im   -0.0444171+0.00551239im      0.195627+0.292201im     0.0979099-0.119896im       -0.0429-0.0758671im    -0.0177898+0.0188965im     0.0618307-0.259801im      0.0408659-0.0526135im     0.0599015-0.0238779im      0.173122+0.0297502im      0.155562+0.0528583im    -0.100459+0.130109im
  -0.205045-0.124303im      -0.108702+0.0958233im      -0.13796+0.164129im    -0.00614602+0.0828305im      0.232811+0.09497im        0.0152097+0.314588im       0.094029+0.0119521im      -0.107731-0.0956975im       0.214894-0.0162885im     0.0170312-0.00279817im    -0.179075+0.0274721im   -0.00093645+0.0188008im      -0.151738-0.00844335im  -0.0689628+0.11022im       -0.0106194+0.261095im     0.0107545-0.00562985im    0.0816208+0.0947387im      0.151339-0.0454147im     0.221116-0.173888im     0.115939-0.0492211im     0.0256931-0.0558015im   0.00999438-0.221633im        -0.03486+0.187176im     -0.034705+0.0268039im    0.0261697+0.0395189im      0.023277-0.138312im      0.0591214-0.176642im      -0.129252-0.0361662im     -0.026153+0.0968881im      0.241311-0.210086im      -0.109243-0.233144im     0.0131958+0.0884439im
   0.248073+0.165164im      0.0167051-0.259495im      -0.119691+0.109632im      -0.216774-0.107537im      0.0677474-0.099269im       0.0144936+0.107663im      0.0776838-0.0967782im     -0.0483175-0.395697im       -0.047078+0.00899498im    -0.117139-0.161414im     0.00644828-0.0999152im     -0.139675+0.00596981im  -0.000847141-0.0587907im     0.105492-0.193867im       0.0055627+0.0414378im   -0.0979738+0.0296602im      0.217344-0.0218995im     0.0967363-0.0416918im    0.0320344+0.0203815im  -0.0824499-0.0413666im    -0.0125938+8.47447e-5im   0.0183312-0.0197397im    -0.00216466-0.0163583im     0.091695+0.0833614im    0.0751657+0.151877im      -0.243597-0.00484013im  -0.00533112+0.0467959im     -0.397922+0.122381im     -0.0219923-0.0348353im    -0.0869117+0.13761im     0.000724319+0.0775488im   -0.0460008+0.191973im
    0.10362-0.0732692im    -0.0663802+0.0422561im     -0.103926-0.11666im       0.0684665-0.177452im     -0.0557736+0.000367645im   -0.0632752-0.110065im      0.0374786+0.0365665im    -0.00814054+0.0571241im      -0.148123-0.257802im      0.0363264+0.0142301im      0.303464+0.0255034im     -0.204043-0.0576729im     -0.0468884+0.0545784im    0.0649061+0.0834692im      -0.125831+0.214268im     -0.140315+0.0849088im   -0.00589471+0.0501914im     -0.110551-0.146397im      -0.02521-0.136225im     0.041998+0.255569im       0.119591-0.0864916im     0.138962-0.105686im        0.250575+0.125445im      -0.17196-0.0483678im     0.213625+0.0664777im      0.119256-0.0408618im     -0.173418+0.00876082im    0.0792308+0.160943im      0.0249034-0.0336787im      0.171344+0.143326im      -0.140274-0.00214733im    -0.17458+0.209577im
 -0.0956073-0.0833402im       0.06781-0.0273388im     0.0720629-0.0779613im     0.0266295-0.143946im      -0.138177-0.152881im        0.169693+0.109792im      -0.232273+0.0391022im      0.0389726-0.000146328im   -0.0385909-0.216131im      0.0679151-0.1114im       -0.0340426+0.111149im      -0.026403-0.127816im       -0.127335-0.0427052im    -0.329827-0.224162im     -0.00934371-0.0474735im    -0.120511-0.0149678im      0.143324-0.041906im       -0.14444+0.0437056im    0.0334469+0.117501im   -0.0440719+0.0491715im    -0.0289911+0.210281im     0.0764757-0.215022im       -0.115748+0.147213im      0.107566+0.147794im     -0.068397-0.377112im       0.131863-0.136914im       0.019214+0.222092im      -0.099289-0.093745im      0.0292151-0.00974584im   0.00921554-0.0157938im    -0.0142554-0.0275541im    0.0390717+0.174653im
 -0.0316911-0.0393712im     0.0535496-0.109925im       0.181923+0.0107291im      0.146175+0.151172im       0.107905+0.00654801im     -0.190316+0.0393779im    -0.0762611+0.000201724im     0.184791+0.085417im      -0.0922316-0.0289495im     -0.111712+0.2269im         0.101446+0.0838071im     -0.101782-0.0435043im       0.108041-0.205991im    -0.0621392+0.0552549im      -0.299283+0.116615im     0.0211536+0.0804396im      0.361643+0.152597im      0.0106034-0.215383im    -0.0823886-0.0193791im  -0.0546975-0.245562im        0.01584-0.0174907im    -0.103193-0.0985433im      0.0192743+0.0557642im    0.0368891+0.0319177im   0.00022165-0.148696im      -0.191811+0.0963377im       0.17944-0.137435im      0.0395502-0.00630257im    0.0266647-0.194868im       0.121433+0.0416731im     0.0459167+0.222319im     0.0868274-0.0379851im
  0.0696905+0.0340319im     -0.127949+0.120306im       0.124677+0.0334742im     0.0340172-0.0468596im   -0.00960858-0.0795012im     -0.0384936-0.0309346im     -0.163307+0.263949im      0.00633491-0.0465965im       -0.12322+0.236631im      0.0532125+0.104427im        0.11497-0.121496im       0.103383-0.110864im      -0.0479664+0.128156im     0.0242362-0.0249156im       0.186041-0.0680433im    -0.257746-0.045045im       0.102798+0.288397im      0.0802952-0.0294013im     0.076718-0.33612im     -0.199268+0.0296203im    -0.0252232-0.124866im     0.0684137-0.128226im      -0.0130509+0.0257001im   -0.0550864-0.0718617im   -0.0589326-0.0264139im     -0.204306+0.0939901im     -0.066155+0.254216im      -0.032904-0.0355237im      0.131498+0.0908527im     0.0784523-0.0543612im      0.257719-0.16073im       0.044321-0.101824im
   0.120708+0.0115101im     -0.194522+0.200563im      0.0740895+0.157381im     -0.0215565-0.288632im       -0.13207+0.0170587im      0.0708155-0.0473688im     0.0586518-0.234526im        0.111114-0.0462041im      -0.018626+0.221922im      -0.068724+0.0545516im    -0.0554599+0.119422im      0.0284261-0.105998im       -0.108239-0.0638797im   -0.0758625+0.0581631im     -0.0398948-0.140671im     0.0942045-0.0457003im      0.119339-0.270606im       0.129698-0.0971933im    0.0824132+0.015777im    0.0675046+0.00826008im     0.067238+0.00562711im   -0.207775-0.0664833im      0.0869718+0.0193967im    -0.198104-0.0162729im     0.190951-0.0185293im     0.0502351-0.113141im     -0.0816271+0.0925592im     -0.121875-0.261318im      0.0990499-0.0114931im      0.213664+0.154641im      -0.066051+0.12763im      0.0122319-0.274817im
  -0.112043+0.0515306im    -0.0365633-0.152791im      -0.231135-0.00122535im    0.0915687-0.139354im     0.00724436-0.0214105im      0.0304916-0.0132078im     -0.100317-0.0543982im      -0.299435+0.112918im      -0.0798925-0.117394im      -0.116139-0.137193im     -0.0993951-0.0242991im    -0.0330968-0.0892995im     -0.0128407-0.107509im       0.18325+0.00142174im      -0.11801+0.0369868im     0.181284+0.00832633im    0.0918759-0.0480139im      0.030844-0.241812im    0.00210634-0.262272im    0.0608765+0.0977791im    -0.0845457-0.195382im     -0.134018+0.142672im      -0.0587723+0.0617247im     0.157843+0.109676im     -0.118978-0.0321608im     0.0632494-0.0660422im       0.21128+0.248581im       0.165875-0.125622im     -0.0564747+0.201683im     -0.0265586+0.0608839im      0.224682+0.0516769im    -0.175099-0.104115im
   0.042044+0.0765571im     0.0445436+0.0617844im    -0.0345326-0.246117im     -0.0543668+0.108314im      -0.053667+0.139446im       0.0259175+0.0161482im   -0.00594351-0.190515im       -0.334353+0.0957943im     -0.0960911+0.321237im      0.0189889-0.198508im       0.199308+0.0245817im     0.0928368-0.0951581im      0.0234478-0.208478im    -0.0415192-0.0457768im       0.106741+0.0915009im     0.128659-0.117436im      0.0980145+0.22291im       -0.164001+0.0916842im   -0.0930225-0.153598im    0.0594293+0.0214884im     -0.105013+0.274815im     0.0245853+0.00308667im  -0.000291321+0.203274im     0.0393406+0.105797im    -0.0549976+0.0793239im     0.0133442-0.105986im      -0.155452-0.111454im     -0.0739739+0.0535996im    -0.0238862-0.213107im       0.113056+0.0128273im    -0.0340569+0.038312im    0.00506196-0.148706im
    0.05981-0.0326729im      0.370225+0.165583im     -0.0359191+0.156299im     -0.0309096+0.082376im       0.041083-0.249939im      -0.0934503+0.0644399im      0.192222-0.111194im     -0.00449423-0.0647763im      -0.188575+0.0351094im    -0.0571615-0.0937346im    -0.0132216+0.0294414im     -0.224945+0.00803411im     -0.289346-0.0991411im    -0.032896+0.0263609im      -0.102306-0.120999im      0.114769-0.0257623im     -0.137081+0.0507132im     0.0489573-0.0548057im    -0.026288+0.0203037im   0.0957351-0.0286418im      0.126164+0.0259353im    0.0803809+0.110446im        0.143018+0.305303im      -0.16477-0.0119663im   -0.0578333-0.0759844im   -0.00528715+0.189295im     -0.0721433+0.0533226im     0.0726172-0.0472888im    -0.0131878-0.0290023im     -0.116721-0.0357969im      0.271132-0.186574im      0.181805+0.0111656im
  0.0207627+0.0213686im     0.0685269+0.0231241im     0.0580237+0.128827im      0.0417304-0.117501im       0.225987-0.0720619im     -0.0234027+0.00373182im    -0.134143-0.088792im      -0.0442485-0.00639695im     -0.262114+0.186455im      0.0681863+0.0165579im    0.00303198+0.181106im      -0.138583+0.122004im      -0.0968558-0.00391804im    -0.14936+0.0328439im     -0.0623969-0.145638im    -0.0379484+0.216616im      0.0436501+0.204092im    0.000131884+0.123381im      0.124811+0.156473im    -0.106219+0.159909im      -0.088082+0.183986im     -0.120603-0.0305403im      0.0225689-0.125981im     0.0317604+0.108817im     0.0710212+0.213964im        0.11236+0.0366586im      0.123645-0.0920497im      0.104926+0.126333im      0.0477052+0.267163im      0.0283473-0.250274im   -0.000607498+0.112646im      -0.32254-0.027845im
   0.106521-0.0458306im      0.238039-0.036946im       0.187825+0.108775im      0.0623547+0.0605057im     0.0786954+0.10813im         0.202742+0.0735984im     0.0699246+0.052306im       -0.128858-0.063506im       -0.163336+0.0388668im    -0.0860197+0.0575316im     0.0936757-0.263618im      0.0713063-0.069479im      0.00452719-0.201768im     -0.165279+0.219959im       -0.016032-0.127286im     0.0330392-0.117501im     -0.0721885-0.195128im      0.0218898-0.103005im    -0.0848966-0.0590976im   0.0105736+0.100102im     -0.0159619-0.205529im      0.355721-0.169523im      -0.0884453-0.0778514im     0.176857-0.0883463im   -0.0766462+0.0649949im     0.0653119+0.0683289im    -0.0572691-0.0266234im    -0.0337366-0.207499im      0.0763647+0.0230945im     0.0454698-0.12999im        -0.14974+0.194584im     -0.138887+0.0908996im
  -0.209881-0.345047im       0.176467-0.0878009im    -0.0395696-0.0510537im    -0.0837958-0.282166im     -0.0546099+0.124589im      -0.0244058-0.16962im       0.0927379+0.0827641im       0.131347+0.0349378im     0.00774375+0.0411404im      0.103586-0.0277417im   -0.00289258+0.0995025im    -0.0143998+0.176503im        0.113203-0.156615im    -0.0102999+0.132441im         0.24354-0.0152663im    0.0452569+0.0176584im   -0.00272882-0.0563792im    -0.0284284-0.185133im     0.0271413-0.0441033im   0.0214361-0.218732im    -0.00451602+0.142435im      0.155836-0.0831141im     -0.0250486+0.139093im      0.228824+0.129902im      0.214536+0.0841992im     -0.147556+0.152198im     -0.0691293+0.0206684im    -0.0554908+0.100843im      0.0460981+0.252696im     -0.0368219+0.126751im      0.0408355-0.0670032im   0.00191893-0.134115im
   0.137286-0.208795im     0.00552127-0.164702im      -0.110574+0.0964257im    -0.0586085-0.0260397im    -0.0858988+0.0963052im       0.312948+0.125149im     -0.0117051+0.0578927im      0.0568982+0.0439166im     -0.0315703+0.141218im       0.126118-0.0801814im     0.0230338+0.143372im     -0.0253721-0.0884451im       0.177124-0.0844706im     0.213808-0.135747im      -0.0653265+0.196396im      -0.11581-0.125565im     -0.0572854+0.0497059im     0.0765395+0.0309738im   0.00275852+0.198438im   -0.0208207-0.0663397im      0.158248-0.070854im     -0.149436+0.13307im       -0.0488831+0.212748im    -0.0528035-0.0638601im    -0.123523+0.0534271im     0.0402038+0.224958im    -0.00828841+0.176769im       0.142196+0.0129782im      0.302151-0.0144625im      0.117127-0.248116im      -0.130623+0.097404im     0.0243269+0.0314475im
 -0.0289082-0.183194im      -0.126359-0.196684im     -0.0892995+0.0190231im    -0.0844278+0.0337927im     -0.143799+0.206421im       0.0270438+0.167143im     0.00527585-0.197635im        0.126895-0.149021im       0.0235641-0.0628742im    -0.0813137+0.244765im      0.0539867+0.122284im     -0.0312279+0.108111im      -0.0878627+0.127154im    -0.0422761-0.0396228im      0.0944726-0.10006im       0.136208+0.106127im     -0.0829878+0.0167688im       0.13469-0.116304im     -0.250747-0.110912im    -0.114456+0.173275im      -0.064842+0.17882im      0.0523504-0.125302im      -0.0909356+0.110018im     -0.142831-0.0236463im    -0.152888+0.0605606im     -0.237951-0.169781im      -0.116806+0.0351896im      0.218107-0.0851448im    0.00145355-0.144038im      -0.177363-0.1297im         0.100558+0.0357347im    -0.177504+0.0150732im
  -0.136288+0.141505im     -0.0753984-0.0661194im   0.000926799+0.144496im       0.221111-0.0489279im     -0.167485+0.0918022im      -0.120251-0.0649647im     -0.065366+0.0576798im     -0.0071165+0.0670653im      -0.132745+0.120769im    0.000553288+0.174894im       0.130518+0.0463442im    -0.0435889-0.105037im      -0.0932456+0.0494362im      0.29945-0.0406118im      0.0917635-0.259314im      0.154427+0.119624im     0.00482553-0.140123im       0.158175-0.0362497im     0.173711-0.0333171im    0.101889-0.162622im     -0.0333957+0.0948585im     0.112704+0.0380407im      -0.172959+0.0970444im   0.00297823+0.139251im    -0.0671026+0.00579108im     0.172924+0.150392im    -0.00439198+0.0707446im      -0.13395+0.158573im      -0.181209-0.196857im      0.0984817-0.142788im      -0.162157-0.0681814im   0.00117401+0.256504im
 -0.0858357-0.00590478im    0.0791799-0.0255036im    -0.0612325+0.087458im      -0.188482-0.0823084im      0.153173-0.26583im        -0.124057-0.174575im      -0.112915-0.0858992im     -0.0811521+0.0371504im       0.165188-0.0847022im      0.197631+0.0868633im      0.190006-0.141518im      0.0510328-0.066534im       -0.157025+0.137131im     -0.142288-0.171943im    -0.000994851+0.135202im     0.0171668+0.134227im     -0.0223072-0.0898659im      0.147365+0.0152884im    -0.117353-0.028321im     0.133337-0.172131im      0.0120091+0.0156296im   0.00779496-0.123348im         -0.1774-0.00861455im  -0.0423867+0.0673148im    -0.343106+0.266348im      0.0915388+0.114378im     -0.0828646-0.0315451im      0.084061-0.0187765im      0.177492+0.00205349im     0.133645+0.186892im     -0.0493819+0.142295im     0.0307442-0.102099im
 -0.0871641+0.0308411im    -0.0401372+0.0356402im     -0.154188-0.117507im      0.0447673+0.0812672im     0.0785138-0.0548265im      0.0985102-0.197707im     -0.0473918+0.0569347im      -0.227886-0.305432im      -0.0165118+0.123342im      -0.157974+0.0968808im    0.00254919+0.0853604im     -0.292602-0.0243553im       0.152251+0.235527im      0.110112+0.0116894im      0.0171717-0.0387638im   -0.0693773+0.111422im      0.0866466-0.00411352im   -0.0479341-0.041629im      -0.27384+0.127565im   -0.0788552-0.191233im       0.213144+0.0442062im     0.211164+0.0404924im      -0.169594+0.0480943im   0.00980336-0.0712539im     0.134824-0.104638im       0.188351-0.163557im     -0.0333072-0.106909im     0.00906493-0.181232im      0.0406685+0.134779im       0.112085-0.100371im      0.0628859+0.0178864im    0.0992632-0.107553im
   0.139701-0.0884047im     -0.148057+0.0833869im     0.0380679-0.073148im      0.0954857-0.00472654im    0.0829627-0.0679307im       0.140268-0.20998im         0.18106-0.0755836im       0.104821+0.071114im      -0.0992733-0.0833113im     -0.144261+0.106233im     -0.0747346-0.278359im      0.0908194+0.132766im        -0.03885-0.11776im      0.0289507-0.00266109im     0.0111248+0.109688im      0.156717+0.0188445im     -0.166243+0.155065im       0.149544+0.0334909im    -0.142613-0.102911im    -0.297931-0.0309891im      0.290668+0.166905im     -0.148722+0.0262327im     -0.0430722-0.024323im     0.0756405+0.348715im    -0.0761697-0.0923801im      0.141305-0.0103331im     0.0600286+0.000379491im   -0.158977-0.019757im       0.138659+0.00295013im    0.0410662+0.0130352im    -0.0397009-0.14552im     -0.0803202+0.110492im
  -0.117479+0.145363im      0.0911784+0.0156067im      0.156906-0.12191im       0.0625886-0.115436im     -0.0744201+0.214115im       -0.292088+0.0851665im    -0.0298416+0.0108594im      -0.192604-0.115255im      0.00941377+0.0106744im     -0.243244+0.184865im       0.107642-0.0367428im     0.0869088-0.0140719im     -0.0494153-0.120719im      -0.20869+0.00386576im      0.100308+0.249073im     -0.156505-0.0235654im    -0.0686077-0.0180187im      0.263588+0.0446213im    -0.190924+0.145037im    0.0250568-0.0611053im     -0.116438-0.0138452im    -0.229589+0.161964im      0.00951857+0.144035im    -0.0595558-0.066168im      0.120567+0.00305832im     0.120666+0.0360131im    -0.0373192+0.172434im     -0.0212972+0.00350956im    0.0764975+0.222109im      -0.166034-0.0166944im    -0.0753073-0.0276774im    0.0335125+0.141746im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.12261613012844712 - 0.07368878049422566im
   -0.1399295965296268 - 0.14339413015924948im
  -0.10575747674198596 - 0.16988941235955987im
   0.22416632418900842 + 0.025119471840752645im
  -0.13475544060069006 - 0.11705266759257198im
  -0.02880090940300104 - 0.0016491225743314052im
  -0.10523328770788835 + 0.2710889998146954im
  -0.12240206520478088 + 0.11418640981278146im
  0.012566120810422736 - 0.05467265728766556im
  -0.14128553410034927 - 0.17750534336663387im
   0.03711896217477301 + 0.1778903829919372im
   -0.1458366134337124 + 0.20631035464680955im
   -0.1109734755389017 - 0.0007293000762460571im
   -0.2855254366814659 + 0.11577653932868502im
   0.10103747407698256 + 0.09290964692397155im
  -0.03492991930198012 - 0.13541351387355655im
  -0.07366388080240467 + 0.08411058751803953im
  -0.03019569134365086 + 0.17774043271660064im
  0.012726284979998368 + 0.2610077447990935im
  -0.11538401489908447 + 0.03133280343713525im
  -0.11297873794021401 + 0.056620744192490635im
 -0.018704869476419656 + 0.03348357955752674im
   0.30969716088889815 + 0.0im
    0.1223700040654602 + 0.17510521738422535im
   0.01322134691260286 - 0.09581076372633478im
   -0.1414494367225189 - 0.219517444989625im
 -0.014223419052705247 + 0.12287553603059422im
  -0.08105880708501371 + 0.0499945759467231im
 -0.008533327095246023 + 0.04520804937156014im
   0.03715117875408299 - 0.0476910366337182im
 -0.033129835993566954 - 0.061645853557677946im
 -0.008750228904833882 + 0.08264805866326873im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 29 March 2023 19:28">Wednesday 29 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

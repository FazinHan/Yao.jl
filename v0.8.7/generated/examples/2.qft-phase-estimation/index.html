<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.7/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.7/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0577181-0.067747im       0.131969+0.173075im     0.0844433+0.177514im    -0.0532856-0.152512im       0.0762723-0.202446im       0.1272+0.118675im       0.0568479-0.172014im      -0.221183-0.0579328im     0.158952+0.163951im      -0.184948-0.199528im        -0.18344+0.125445im      0.0892646+0.158072im     0.0175963+0.141701im      0.0691551-0.00111786im    -0.136366-0.170213im     0.00633314+0.106897im      -0.130141+0.0711603im      -0.161298+0.0435717im   -0.0707547-0.151628im     0.0597825+0.0906142im     0.10155+0.0819544im     -0.19916-0.0934713im    0.0303264-0.0385353im    -0.0679872+0.0335293im   -0.00459539+0.0140534im     -0.121763-0.253184im     -0.195022+0.0583463im   -0.196548+0.0810084im      -0.102613-0.116228im       0.127887-0.00368103im     0.073344-0.0135971im     0.0713276+0.212068im
   0.0195931-0.0324483im    -0.0172053-0.246785im     0.0960603+0.187687im     -0.154339+0.0075599im      0.0867387-0.0605421im    -0.12937-0.0484873im     -0.0866176+0.00550003im     0.142124+0.14159im        0.18163-0.0160883im    -0.0792911-0.250954im       -0.144226+0.149365im      -0.183477-0.0749679im    0.0859636-0.171171im      -0.206654+0.0305594im      0.123187+0.0165708im     0.0328744+0.158649im     -0.0430736-0.198763im     -0.00985584+0.0387853im      0.25306-0.0316718im    0.0177973+0.0261839im   -0.222763+0.031801im     -0.154522+0.050992im    -0.0576242+0.277598im      -0.145431+0.0353058im     0.0767525-0.0173481im    -0.0396271-0.0758186im    0.0847232+0.0218713im   -0.120619-0.0292859im       0.162366+0.217796im     -0.0990159+0.119343im     -0.0876179+0.1373im         0.183616+0.021926im
 -0.00567846+0.13839im       0.0275354-0.00574604im    0.134047+0.0102622im    0.0592877+0.0995914im      -0.107319-0.241299im   -0.0716638+0.053725im      -0.0232874-0.144573im      0.0532831+0.0983551im   -0.0806623-0.0111622im     0.0161639-0.140662im       -0.056175+0.0175752im    -0.0329469+0.131795im      -0.16081+0.150458im      -0.150919-0.218885im     -0.0076566-0.0492202im     -0.252184-0.167758im      0.0259563-0.2154im         0.0455016+0.0092572im    -0.238381+0.0763929im    -0.206545-0.405585im    0.0837522-0.167116im     -0.049128-0.0646114im    0.0178788+0.133265im     -0.0353018+0.0981195im     -0.092019-0.0506449im      0.111042+0.198482im    -0.0495939-0.137738im    0.0227035+0.077344im       0.0737754-0.0291378im     0.0357976+0.137927im      0.0923853-0.0875441im      0.191334+0.123165im
    0.336464+0.0229956im     0.0723518-0.242711im     -0.333321-0.0740009im    -0.102223+0.0812438im      0.0728989-0.0449074im   -0.118036-0.0178606im     -0.0624903+0.0408409im    -0.0670255-0.201353im    -0.0491712+0.0940848im    -0.0927534+0.0333694im      0.0328618+0.197564im     -0.0726617+0.0197842im     0.264257-0.0931135im   -0.00876667-0.177698im       0.043683-0.0401987im    -0.0576719+0.0408im       -0.0498114+0.143293im       -0.061266-0.0320796im   0.00909741-0.153564im       0.11224-0.21327im      0.269365-0.233863im     0.0423621-0.0836335im    0.0907758-0.115899im       0.116702+0.00262392im    0.0252599+0.123039im      0.0754035+0.0050119im   -0.0718452-0.0176652im  -0.0986189+0.027649im        0.161469+0.1479im         0.176178+0.0754771im    -0.0675369+0.0634798im    -0.0216793-0.137062im
  -0.0241131-0.0169266im     -0.063825+0.0645772im   -0.0459697-0.0818503im   -0.0889912+0.0323627im       -0.35448-0.0844081im  -0.0882265+0.179731im        -0.17458+0.0850916im     0.0552649+0.0796266im     0.110323+0.135549im       0.267526+0.0184694im     0.00380334+0.0216822im     -0.185792+0.0917449im     0.103338+0.00263095im    0.0701488-0.157277im     0.00833877-0.101598im       0.090058+0.0779921im     0.0830151-0.0938229im      -0.217087+0.18483im      0.0789384+0.0915433im    0.0787708+0.0576805im  0.00177957+0.105576im      0.117762+0.0549046im    -0.132284+0.0707566im      0.245252-0.0463301im   -0.00794649-0.280602im      0.0312043+0.0578521im    0.0568458+0.043735im     -0.15543-0.0981568im        -0.2069-0.0347251im      0.332396+0.0773933im      0.129171+0.0950152im   -0.00986549+0.00235271im
   -0.163336-0.10545im        0.160917+0.0433438im     0.115486+0.11137im      0.0721164+0.0419482im      -0.243858-0.0687596im   -0.278544-0.193858im        0.106751-0.0484701im     0.0486673-0.0943954im     0.413697+0.0289709im    -0.0941255+0.10214im        0.0237204-0.0137488im    -0.0134571+0.0605513im    0.0185244+0.21893im       0.0686032-0.0486223im     0.0228709+0.108293im      0.0926299-0.116031im         0.0683-0.121362im       -0.104571-0.0902887im     0.212589-0.122565im     -0.105351-0.0211888im    0.109807+0.0276868im     0.052882+0.0598605im   -0.0471831-0.00281449im    -0.067964-0.134168im      0.0123756+0.367526im       0.185162-0.00558632im  -0.0100707-0.0184382im    0.105529+0.0653839im      0.0651802+0.0165058im      0.088311+0.0600065im    0.00923044+0.00588632im     -0.23457-0.0326117im
 -0.00972222-0.0476706im     0.0423735+0.0769542im   -0.0884734-0.145601im     0.0891791+0.0789872im     -0.0604574+0.0629078im  0.00713174+0.0686969im      -0.180011-0.252181im       -0.10266-0.130073im      0.110235+0.0507222im     0.0192371-0.187064im      -0.0354584-0.055011im       0.170861-0.12677im      -0.130592-0.17728im     -0.00360209-0.212181im       0.160969-0.0316483im     0.0304351-0.0779939im    -0.0145643-0.0396685im      0.0435375-0.0698493im     -0.20325-0.0540511im   -0.0698699+0.0707179im    0.119118+0.196254im    -0.0712215+0.0735258im    -0.285203+0.154758im      0.0534537+0.205339im      -0.207132-0.0820965im     0.0425462-0.171164im     0.0332959+0.210183im    0.0937153+0.0675466im       0.186257-0.00831269im    -0.034703-0.0135055im     -0.211776+0.134097im      -0.132357-0.227453im
    0.173744+0.0167104im    -0.0874141-0.185429im    -0.0619631+0.0105591im   -0.0839796-0.135875im       -0.123834-0.247612im     0.264966-0.00681359im      0.035591-0.0769612im     -0.110413+0.0687943im    0.0114364-0.0945191im    -0.0357735+0.000448238im   -0.0556711-0.17154im      -0.0188066+0.117862im     0.0144001-0.0769799im   -0.00803779-0.151399im      0.0152025-0.236914im     -0.0798282-0.18641im      -0.0632998+0.0366971im      0.0504224+0.194161im      0.039942-0.171976im      0.020362+0.230489im    -0.129346+0.0871292im    -0.164532+0.098469im     0.0330639+0.00206364im     0.124474-0.103707im      0.0421206+0.101146im       0.171594+0.0772972im      0.14063-0.0231731im    0.186698-0.0719724im     -0.0177909+0.135302im      -0.143076+0.18455im        0.104862-0.303405im      -0.176695-0.0968267im
    0.114919-0.00958885im    -0.126884+0.0549959im     0.105279+0.108301im        0.1927+0.0704231im       0.187092-0.115308im    0.0464663+0.045378im       -0.132806+0.0977391im     -0.105191-0.144357im     -0.151108-0.0658994im     -0.131941+0.150364im        0.235178-0.10626im        -0.05612+0.158259im      0.144147+0.0774991im     0.0920578-0.0660171im     -0.106165+0.037738im       0.122057-0.154328im      0.0100321-0.186339im       0.0213606-0.123696im    -0.0205642+0.10883im     -0.0281422+0.277886im     0.190939+0.0246927im   -0.0832543+0.0658196im    -0.184606+0.155525im      0.0036937-0.243115im     -0.0117895+0.00166218im    0.0871018+0.0470608im    0.0794454+0.080559im   -0.0635282-0.055351im        0.120751+0.139742im       0.108294+0.00546484im    -0.203996+0.0276916im      0.279574+0.187653im
   0.0618543-0.167191im      0.0529782+0.171422im     0.0874261-0.149278im     0.0576186-0.0131379im        0.28045+0.0730866im    0.149611+0.0110609im      0.0899445+0.0570801im      0.141362+0.0271508im     0.227963-0.0812568im    -0.0966175-0.0953778im      -0.148414-0.011105im    -0.00929763+0.0927229im     0.153317-0.0919281im     0.0325491-0.0893844im    -0.0430518+0.220165im      -0.206938+0.183824im      0.0961325+0.142927im      -0.0559133-0.0361208im    -0.135909+0.0156069im     -0.13897-0.085557im     0.110681+0.181113im    -0.0623795-0.0606347im     -0.14417+0.0923921im       0.10252-0.154988im       0.281193-0.0376847im   -0.00768304+0.143048im       0.17047-0.108373im     0.111831-0.169142im        0.115174-0.0763243im      0.107549+0.0261388im      0.218498-0.00994553im    0.0326759-0.170756im
  -0.0947713-0.0353443im     -0.208637-0.00238444im   -0.015721-0.019604im    -0.0957764+0.323483im       0.0487182-0.113361im    -0.143792-0.103977im        0.113288+0.0300857im     -0.111062-0.0135499im    0.0792326+0.105579im     -0.0429442-0.0920962im      -0.202401+0.0270962im     0.0994305+0.0653113im     0.158346-0.159852im       0.206454+0.291669im      0.0655862+0.0319174im     -0.112118-0.0361086im    -0.0503327-0.196507im       0.0917536+0.180275im     -0.124384+0.110499im    -0.0419764+0.0921588im    0.217193-0.14151im     -0.0172499+0.0302283im    0.0890194-0.0998514im     0.0907026+0.173809im     -0.0931341+0.0524781im      0.144384-0.130461im      0.258165+0.036968im     0.126961-0.169939im       -0.167423+0.045949im      -0.053989-0.0973974im      0.111359+0.0670679im     0.0516451+0.0924138im
   0.0465862-0.0531364im     0.0550349-0.115069im    -0.0430504-0.123799im    -0.0110707+0.288635im       0.0507721-0.0745401im   -0.244748-0.00303866im     0.0799156+0.00661169im    -0.200891+0.0133378im   -0.0700734-0.0496005im      0.113873-0.193403im      -0.0299913-0.0532667im     -0.183485+0.00868473im    -0.16975+0.173005im      -0.146004-0.148923im      -0.191726+0.283353im      0.0949443+0.094127im      0.0151382+0.0350839im      0.0292814-0.143068im      -0.11276-0.294855im     0.0886595+0.23238im     -0.172029-0.0439058im   -0.0458011+0.00771764im   0.0507989+0.0811384im     0.0834082-0.00673441im   -0.0698656+0.11625im      -0.0623697-0.00334927im   0.0734853-0.0444598im  -0.0100259-0.119243im       -0.191567-0.16486im       0.0578967-0.128972im     -0.0307244-0.152938im       0.144734-0.153119im
   0.0777337+0.116412im     -0.0894648-0.212502im      0.177427+0.107299im    -0.0561933+0.141649im      -0.0283176+0.184349im   -0.0987692+0.0439642im      -0.187216+0.115545im      0.0917147+0.0771759im    -0.034789+0.105833im      -0.129883-0.0829222im      -0.119173-0.0530714im      0.124577+0.0637479im     -0.12032+0.0774793im      0.242889-0.0610528im     0.0404083+0.0154847im     -0.151269+0.0105015im      0.300252+0.0854202im     -0.0512356-0.118931im     0.0281235-0.0204564im     0.131945+0.190946im     0.127381-0.12938im     -0.0376447+0.0940772im   0.00992951+0.0919987im     0.0426388-0.139577im      0.0702636-0.162357im       0.172251-0.0782966im    -0.286444+0.0669972im  -0.0475244+0.153886im       0.0594885-0.075999im      -0.234611-0.0680596im      0.257398-0.0380478im    -0.0235784-0.108376im
    0.182317+0.243833im    -0.00351002+0.212923im      0.276617-0.00331104im   -0.342493+0.089862im      -0.0498398-0.0417976im   0.0748073+0.0678681im     -0.0778338-0.0751689im     -0.199834+0.0206885im    0.0409758-0.170003im      0.0192885-0.0788096im      0.0940123-0.0662219im     0.0407239+0.0710741im    0.0939512-0.0283453im     -0.135296+0.0842389im      0.224217+0.0775149im    0.00241309+0.0974466im    -0.0876954-0.0284854im       0.102796-0.32826im      0.0825107-0.0188258im     0.006435-0.155366im   0.00338174-0.116388im    -0.0703558+0.0717982im    -0.037559-0.17604im      0.00362075-0.274414im      -0.109152-0.0529893im    0.00265202+0.0379973im     0.133947+0.0715712im   -0.108538-0.0620706im      -0.115044-0.103376im     -0.0504869+0.0490633im   -0.00752308+0.124421im      -0.214255-0.0300209im
 -0.00386642+0.141391im       0.220104-0.152136im     0.0819225-0.00905516im   0.0187917+0.106275im      -0.0406836-0.242803im   -0.0791277+0.0207886im      -0.113631+0.0578098im      0.235333-0.152054im     -0.168204+0.166958im      -0.144642-0.0572123im    -0.00994443-0.180253im       0.211959-0.0145006im      0.10474-0.143914im      0.0949163-0.0271592im     -0.175502-0.0197977im       0.18559-0.0565712im    -0.0569601+0.000361035im     0.155381+0.00879695im  0.00511853+0.0951819im    0.0741682-0.264107im    -0.198584+0.125526im    -0.0157962-0.180979im     0.0405476+0.177914im       0.113501-0.139656im       0.203977+0.0468316im    -0.0212335-0.204786im      0.100384+0.0792779im   0.0544112-0.0821754im     -0.0740907-0.204157im      0.0192619-0.0910178im    -0.0507632-0.0156875im     -0.140565+0.0565328im
  -0.0113021+0.00887126im    -0.117753-0.0603151im   -0.0383668-0.0682355im    0.0255665-0.0522758im      0.0850215-0.0890666im   0.0465345-0.0863781im       0.121111-0.0185828im    -0.0486334-0.161725im     -0.104878-0.109803im     -0.0605854-0.12926im          0.20494+0.0314215im      0.139504-0.0422509im   -0.0163438+0.0726462im      -0.11443-0.0955806im    -0.0934339+0.131135im      -0.259745+0.0515055im     0.0793025-0.0699974im     -0.0162847+0.0139877im     0.190244+0.0299627im     0.045198-0.0293001im  -0.0582043+0.126883im     0.0922049+0.222053im     -0.170491-0.0416895im      0.183282+0.178918im       0.186054+0.0117028im      0.154944-0.161204im      0.204537-0.141385im    -0.208426+0.429234im       -0.190902+0.0114546im   -0.00250424-0.0319932im     0.0714927+0.113818im     -0.0712868+0.112291im
    -0.18712-0.277507im      0.0974885-0.143004im      0.193638+0.113048im     0.0724643+0.0169592im      0.0544039+0.112208im   -0.0245078-0.170561im      -0.0948542+0.141959im      -0.144628+0.0387797im    -0.114096-0.00473386im  -0.00986582-0.0345882im      -0.121217+0.016803im      -0.213433-0.0615243im     0.272594-0.0640733im     0.0466817-0.28529im        0.125522+0.0516092im     0.0712791-0.0216203im     -0.383028+0.00432835im      0.160118-0.0457612im    -0.114534+0.0926195im   -0.0511817+0.0222845im  -0.0374219+0.147709im     0.0776038-0.0166651im     0.019196-0.203962im      0.0868147-0.0137021im     -0.109232-0.105823im       0.139288+0.0398907im   -0.0965231-0.042938im   -0.0765342+0.175839im     -0.00658874-0.172489im     -0.0845679+0.102393im       0.099175-0.0578148im    -0.0607316+0.0771438im
  -0.0275741+0.0377215im     0.0962457-0.0256277im    -0.181351+0.0679313im   0.00528164-0.00937862im      0.120319+0.0684229im  -0.0798293-0.0109086im     -0.0332051-0.288078im       0.132627-0.104434im      0.215035-0.131056im     0.00885066+0.176671im       -0.176287-0.117143im     -0.0260503+0.142586im     0.0168425-0.287478im      0.0274317+0.0979812im     -0.279211-0.0461445im     -0.110011-0.0220324im    -0.0292772-0.118327im      -0.0916516-0.197607im     -0.194015+0.0278725im    0.0359406+0.105066im    -0.175739-0.0678448im      0.12682+0.00730842im    0.161892+0.0283773im     0.0711625-0.187275im     -0.0980905-0.0882726im     0.0330765+0.102965im    -0.0138801+0.016769im   -0.0133686+0.287281im       -0.223139+0.00352705im   -0.0279983+0.200134im     -0.0728286+0.138097im      0.0686524-0.0414425im
   -0.311436+0.11711im      -0.0398277+0.159262im      0.150236+0.126506im      0.252824+0.0552003im     -0.0854322+0.011902im     0.142331-0.121118im       -0.215948+0.176846im      -0.133146-0.172191im    -0.0285101-0.0253229im    -0.0112252-0.0886699im     -0.0674361-0.179052im     -0.0676202-0.0397114im    0.0791126-0.106339im     -0.0385776-0.00717793im   -0.0956094-0.141773im      0.0305711+0.239586im       0.133468+0.0859633im     -0.0903498-0.15975im      0.0165488-0.199613im     0.0238656-0.0850346im   0.0288182-0.151483im     -0.145942-0.0926214im     0.148667+0.0243511im     0.0144316+0.269099im       0.140491-0.0404236im      0.113371+0.129546im      0.062222+0.0255438im  -0.0194267-0.00247455im     -0.134452+0.266322im      0.0504749+0.0406142im    -0.0902119-0.0674083im    -0.0651435-0.0918875im
   -0.032428+0.138137im      -0.199633+0.0703527im   -0.0131568+0.040633im     -0.168286-0.066117im      -0.0515237+0.172245im    -0.118405-0.115344im       0.0206442+0.0797799im     -0.184152-0.0536348im    -0.117989-0.0391591im     -0.216328+0.0995854im    -0.00649083-0.054562im       0.119589+0.153633im     0.0673212-0.0438691im      0.187641-0.24394im         0.11964+0.0119672im    -0.0318333+0.176279im       0.143418+0.0712359im     -0.0115509+0.301686im    -0.0987812-0.00726199im   -0.163968-0.0306189im   -0.174323+0.0919149im   0.00373963-0.10463im     -0.0266353+0.226666im      -0.102689-0.0194801im     -0.165036+0.273096im      -0.104408+0.0948858im    -0.044706-0.150443im    -0.114407-0.0219872im      -0.157666-0.104719im     -0.0470783+0.126173im      -0.134798+0.176199im      0.0353165-0.070177im
  -0.0664638-0.0857303im      0.037036+0.0495385im    -0.315152-0.134509im     0.0272372-0.0719341im      -0.204739-0.107804im   -0.0207039+0.0476097im      0.0312564+0.314938im    -0.00660834+0.135693im    -0.0475118-0.235547im      -0.118414+0.0942614im      -0.171896+0.0937838im     0.0698377+0.0157964im   -0.0616551+0.0294928im     0.0779056+0.0984449im      0.068008-0.00822803im    -0.128603+0.0829408im  -0.000160547-0.205407im        0.191605-0.155821im     0.0815692-0.174414im      0.152239-0.0167075im  -0.0299287+0.0812006im    -0.276871-0.271013im     -0.189688-0.0564614im     0.0615833-0.0257755im    0.00896475+0.00249127im     0.102849+0.157296im    -0.0741546+0.181968im    0.0665082+0.120518im    -0.000736551-0.133416im     -0.0123591-0.0197621im      -0.03504+0.136042im      0.0897266+0.0976304im
   -0.035034+0.127209im      0.0655252+0.25676im      -0.147863+0.0529998im    0.0184284+0.257288im      -0.0261771+0.0548734im   0.0484041+0.0198204im     -0.0441528-0.191314im     -0.0180214+0.020244im     -0.170782-0.0203689im      -0.16475+0.170689im       -0.107308+0.00224924im    -0.361476+0.0880521im      0.15417-0.143665im     -0.0180184-0.1023im      -0.00261003+0.157948im      -0.218505-0.11322im        0.125751+0.0193007im      -0.110576+0.0400075im      0.26335+0.0919601im    0.0543399-0.0475486im    -0.13693+0.132667im      -0.20672+0.162252im      0.115288-0.0173157im    -0.0324123+0.102628im     -0.0940783+0.0148427im    -0.0689458-0.0939511im   -0.0705356+0.0821441im   0.0963288+0.0188973im       0.142162-0.0980589im     0.0582818-0.218946im      0.0447907-0.0984087im    -0.0862881+0.104908im
   -0.175148+0.0448742im     0.0487964+0.0451069im   -0.0969648+0.0852186im   -0.0147484-0.042907im        0.203452+0.0857073im   0.0101793+0.231513im       -0.229804+0.0585568im    -0.0243361+0.0337323im   -0.0434262+0.152764im     -0.0945072+0.126453im       -0.141525-0.0360211im      0.138405-0.169888im     0.0106212-0.00649003im   -0.0670728+0.220366im     -0.0080105+0.25638im       0.0485508-0.240815im     -0.0197343+0.0108172im       0.116699+0.173365im      0.092668-0.241837im    -0.0538378-0.0753943im  -0.0282283-0.160602im    -0.0993162+0.184114im     -0.223646+0.00208728im  -0.00337303-0.0109601im    -0.0816079-0.00564595im    0.0770477-0.00991443im  0.00940715-0.129312im    -0.128868-0.001151im      -0.0803809-0.0925472im        0.2191+0.308599im      0.0663412-0.162126im     0.00526619-0.0972122im
  -0.0860249-0.0547201im      0.112121-0.0440582im     0.103334-0.0779016im    -0.104966-0.065396im      -0.0651529-0.0291351im   0.0857804+0.182308im       0.0070964+0.0325345im      0.329802-0.213101im    -0.0857536+0.115562im      -0.185544-0.018126im      -0.0279503-0.228738im      -0.269457-0.024657im      -0.13872-0.0237014im    -0.0561048-0.147406im       0.046591-0.0342441im    -0.0340563+0.160803im      0.0307995-0.11473im         0.115558+0.131074im     -0.173525-0.0270807im    0.0883252+0.147745im    0.0598796-0.183638im     -0.114226+0.141367im     -0.139504-0.344239im      -0.143352-0.0528631im    -0.0160059+0.119042im     -0.0810218-0.034613im    0.00333246-0.167664im     0.117828+0.0088109im     -0.0666244+0.0715096im     0.0439289-0.0783447im   -0.00782552+0.257602im    -0.00676329+0.0112207im
  -0.0460848+0.148118im     -0.0262201+0.0134371im    0.0236962+0.0206935im      0.15504+0.0105937im     -0.0777512-0.26616im     0.0172895+0.0882242im      0.0385358+0.0158991im     0.0218431+0.0594989im    -0.138054-0.0832662im     0.0389641+0.038112im      -0.0587915+0.166044im     -0.0822441-0.167371im      0.259506-0.0272949im     -0.118463+0.0434167im     -0.386742-0.00458211im    -0.073908+0.0548053im      0.096543+0.0225791im      0.0779316+0.0562349im   -0.0606446-0.175798im     -0.184277+0.0581658im   0.0892179+0.111099im      0.237385-0.0079352im    -0.150834-0.0223116im     -0.178606-0.0927879im     -0.186568+0.039382im       0.025306-0.0627892im    -0.111445+0.103116im    -0.134431-0.131155im       0.0371245+0.0595052im     -0.255098-0.0170776im      0.202709+0.203577im      -0.133922-0.144524im
   0.0604535-0.0672445im      0.173222+0.0749944im    -0.067835+0.233787im     0.0205275-0.0823086im     -0.0762048+0.0111126im   -0.153084-0.189461im         0.10168+0.178342im      0.0385385-0.102788im     -0.138172-0.1354im        -0.154507-0.191026im        0.062543-0.0267523im      0.159722+0.111191im     0.0610084-0.0579331im     -0.100361-0.04992im        0.130661-0.0452234im     -0.117012-0.27996im        0.145002-0.0868121im      0.0400176-0.153176im    -0.0252276+0.0156113im   -0.0545852+0.111736im    -0.109133+0.00262063im     0.12726+0.0569496im   -0.0220907-0.130358im    -0.00897668+0.104036im    -0.00507166-0.149088im      -0.344299-0.0887581im   -0.0718687+0.132497im    0.0553048-0.183551im       -0.111386+0.128522im       0.196619+0.144494im       0.213108-0.00334787im    0.0597667-0.15443im
   0.0257822-0.195754im     -0.0620514-0.0117282im     0.201421-0.0349258im    -0.017299+0.0292658im      0.0163362-0.0428754im   0.0805014-0.0507366im   -0.000781008+0.0145697im       0.21989-0.124895im     0.0165813-0.132387im       0.217977+0.197156im       0.0304605-0.0432154im      0.150239-0.0526639im    0.0867321-0.0643616im     -0.153966+0.0254446im     0.0783128+0.102707im      -0.026799-0.0809497im     0.0485693+0.0124789im      -0.156808-0.0489972im   -0.0617941-0.0800291im    0.0972572-0.0399939im  -0.0393704+0.00733222im   -0.263143-0.0820018im   0.00621683+0.0951065im      0.404972+0.0824012im      -0.26952+0.175696im     -0.0521916-0.138708im     -0.301752-0.164413im   -0.0936643-0.159208im      -0.0301309+0.118538im       -0.10026-0.00237894im    0.0934631+0.0784869im    0.00526754+0.143549im
   -0.168501+0.117697im      0.0350934+0.20706im      -0.146701-0.0639183im    -0.134543+0.0789924im      0.0274662-0.0788917im    -0.11957-0.0368578im      -0.173923+0.169728im      0.0660664-0.129911im     0.0921157+0.288204im       0.053604-0.0839446im       0.247394+0.250733im       0.219447-0.00589307im     0.12103+0.0110683im    -0.0995449-0.0871229im     -0.017777+0.023071im      -0.133514-0.0647697im     -0.136599+0.0460675im      -0.123909-0.0261486im    -0.158513-0.103951im      0.039161+0.239574im    -0.198748+0.00549311im   -0.101913+0.0331735im    0.0561587-0.0062334im    -0.0988694-0.0836194im     0.0232069-0.101651im     -0.0388757+0.252342im      0.044505-0.157957im     0.120941+0.0254172im       0.141333+0.0361689im     -0.178911-0.0408153im     0.0515735+0.00391744im    -0.104742+0.205852im
   0.0684892-0.108346im     -0.0715726-0.0346746im   -0.0390656-0.204705im     0.0635384-0.252531im        0.162651+0.0355846im   -0.242531-0.089738im        -0.18321+0.00305728im   -0.0845377+0.14586im      0.0970878+0.0379082im     -0.038891-0.0394985im       0.317708-0.120579im      -0.124716+0.101494im    -0.0362674-0.0775748im       0.16981+0.0511486im     -0.185884-0.0170368im      -0.13624+0.0575117im     -0.169748-0.141399im        0.127515-0.0363832im   -0.0137467-0.0149492im     0.047868-0.21858im    0.00693113+0.0475053im    -0.194051+0.19278im     -0.0044533+0.106191im       -0.16121+0.0533515im    -0.0525655-0.0371992im     0.0171159-0.0179485im    -0.240949+0.0179162im    0.019151-0.165913im       -0.207983+0.135264im      0.0341384-0.116215im       0.128195-0.0145684im     -0.200246-0.0227304im
    0.103087-0.108923im      0.0958065+0.295295im     0.0845936+0.0445463im    -0.179293+0.088112im      -0.0101559+0.0180125im  -0.0421096-0.0529251im     -0.0123168+0.120221im      0.0251311-0.0972029im   -0.0317963-0.0264727im     -0.171729+0.103454im        0.046002+0.106531im      -0.219776-0.0473355im    -0.270144-0.0338805im      -0.10579+0.0235249im    -0.0228854+0.0525756im     -0.107756-0.213141im      -0.239676+0.0291056im      -0.173489+0.217612im    -0.0390663-0.00450007im  -0.0318866-0.027755im    0.0366585-0.0639611im    0.0981823-0.178223im     -0.121412+0.0879725im      0.077574-0.01168im        0.250497-0.0823868im      0.191111-0.0661069im    -0.101476+0.155436im   -0.0657352-0.0619546im      -0.231925+0.08974im       -0.266256-0.0207899im     -0.156968-0.0213194im    0.00289253-0.156253im
   -0.215986-0.210438im        0.21078-0.0694717im    0.0378813-0.0873896im    -0.268133+0.0410538im     -0.0234226+0.0596876im    0.188978+0.357293im       0.0446632+0.129186im      -0.249983+0.0247689im   -0.0758857+0.0443874im     0.0232639-0.0928495im       0.127369+0.168298im      -0.014544+0.110704im     0.0286594-0.134398im       0.130608+0.0108319im     -0.175306-0.034824im     -0.0267473-0.0529253im      0.209823-0.242903im      -0.0460269-0.187604im     0.0948052+0.0790791im   -0.0651212-0.0568452im   0.0231158+0.0601457im     0.104113+0.0333151im    0.0969844+0.0281663im     0.0488032+0.0384695im     0.0462122+0.0906315im   -0.00591802-0.10637im      -0.116412-0.221975im     0.144018-0.0623274im      0.0206372+0.0324195im     -0.135457+0.145857im      -0.175279-0.0338466im     0.0101115-0.0838044im
    0.138881+0.116181im     -0.0283789+0.0074758im   -0.0160735+0.136036im     0.0265631+0.15321im     -0.000781993-0.0596689im   -0.128305+0.014032im       0.0963988+0.233632im       0.066228+0.00183139im  0.00884109-0.133664im        0.23308-0.0501499im      -0.128533-0.098222im      0.0121924+0.0742289im     0.101207+0.0175239im     0.0149246+0.0756426im     -0.158564-0.0441804im   0.000804193+0.0410636im     -0.188986-0.0622951im     -0.0871073+0.0874291im    0.0433067+0.184385im    -0.0443963+0.0495635im    0.227974-0.0287826im    -0.216938+0.0898594im    -0.211634+0.0184756im    -0.0248544+0.0900583im     0.0689587-0.0168725im     -0.362094+0.0487748im    -0.120904-0.197235im    0.0592448+0.234785im      0.00342446-0.101023im     -0.0726644+0.0671966im     -0.220126-0.142277im      -0.240856-0.169423im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.11673063436805496 - 0.117040278077903im
   -0.15638299089045946 - 0.21978330934673865im
    0.07330116871373109 + 0.18527598557385225im
    0.12067475222224448 - 0.14709918406229175im
  -0.011888312313205423 - 0.017381543582984736im
  -0.038524558268694574 + 0.12096299168702915im
    0.07684298389952171 + 0.2489831470481131im
   -0.01623398180325579 + 0.07500818133908348im
    0.12812066729722676 + 0.04498409378199979im
    0.08003739530348841 + 0.04988190855761494im
      0.125575845184661 + 0.155614459338058im
    0.13509200592421858 - 0.03951648915038213im
    0.05891769045291741 - 0.09734156488715807im
 -0.0017180213841590881 + 0.09708149890169247im
   -0.12043189981159608 + 0.05407166678512832im
    0.10391806498278323 + 0.19650506340174856im
     0.1268406732187373 - 0.0798868878717942im
     0.2722041547967634 + 0.0im
   0.004984853706522805 + 0.09696508880162093im
   -0.26000236879164923 + 0.04507956648696917im
    0.10030358742500481 - 0.1756877500097865im
    0.05349165994808211 - 0.02636139898473825im
    0.16016123422555512 - 0.12982525942686984im
    0.02681253845783745 - 0.2603976210576238im
   0.010047560917160353 + 0.1219182626033952im
    0.24324906569679935 - 0.09391361780208032im
    0.19069588640638432 - 0.03121274480449479im
  -0.020212288240278032 + 0.026658508550653763im
  -0.030554652466241873 + 0.049037396120466176im
   -0.10810257692301735 - 0.07884503661197105im
   0.052853514302272676 - 0.1776157598566708im
   -0.15991113521031078 - 0.15367184710022672im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 2 March 2023 00:53">Thursday 2 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

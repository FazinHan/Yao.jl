<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.4/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.4/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.245307+0.014935im       0.0210883+0.067957im     0.0106009-0.117777im        -0.028465-0.114184im      0.165584+0.0463929im      0.105207-0.275904im      0.0107991+0.0944219im   -0.152523+0.214078im    -0.0162091+0.157316im     0.0509926+0.0561548im    0.0693882-0.0389718im    -0.0485884-0.177374im     -0.0780489-0.180326im    -0.0235212-0.371343im     -0.0377239-0.126212im     -0.119351+0.150158im      -0.0309699-0.0798486im    0.0482297-0.134669im     0.0221085+0.126246im    -0.0750983-0.0250051im    -0.047248-0.0963521im     -0.155247+0.190493im       0.173574-0.193939im    -0.00803654-0.295399im      -0.133877-0.011418im     0.0404746+0.183665im      0.0554227+0.0838406im     0.0651498-0.13944im     -0.00830216+0.0912127im     -0.132994+0.119588im       0.025255-0.052168im    -0.00729349+0.0351297im
   0.181882-0.0243804im         0.1994-0.0179085im   -0.0750142+0.246927im        0.0354325+0.0949978im    0.0765808-0.0828946im      0.139107+0.13549im       0.0166899+0.119967im   -0.0293998+0.180385im    -0.0553568-0.237817im      -0.19271-0.117375im    -0.0753026+0.0284393im     0.0262793-0.033827im      -0.220209-0.162035im     -0.075883-0.108147im      0.0182814+0.0433234im    -0.112008+0.00936438im     0.0416832-0.0531256im   -0.0288539-0.0157057im      0.18816+0.18257im      -0.135189-0.205856im    -0.0716386+0.076686im      -0.287559-0.0616291im     0.0297474+0.00246356im    -0.203234+0.216274im      3.9195e-5-0.0203654im    0.0416258+0.00475923im    -0.168614-0.190091im       0.150679-0.0290886im    -0.0605238+0.201295im       0.058906-0.0963302im      0.017815+0.0259627im      0.171773-0.160427im
  -0.213674+0.079302im        -0.19496-0.0741157im     0.128127-0.0402717im       -0.038143-0.172849im     -0.109083+0.0527662im     -0.134994+0.177162im     -0.0372684+0.255757im    0.0165621-0.0277908im       0.1192+0.0602198im   -0.0986216+0.0685319im   -0.0195013+0.00406964im   -0.0538558-0.0108001im     -0.107693+0.171675im    -0.0403706-0.107114im      0.0279374+0.258327im     0.0776777+0.165498im        0.107758+0.169021im      0.109495+0.225602im      0.039053-0.0132605im     0.105274-0.119259im     0.0164171-0.145192im      -0.223836-0.0438843im     0.0881109+0.261554im     0.00732566+0.0214596im      0.136536-0.0452405im   -0.0192727-0.0986079im     0.0282037-0.130215im      -0.010827-0.205357im     -0.0425789+0.0570544im    0.00278333+0.342373im     -0.0227099-0.159002im      0.0859106-0.0763221im
  0.0673868+0.235073im      -0.0486476-0.187518im     0.0244436-0.00734219im        0.28492-0.00337553im   -0.167476-0.168373im      0.0186494-0.279126im      0.0877857+0.107714im   0.00179914+0.0275829im     0.286116+0.245174im     -0.286322+0.0548876im    0.0119426+0.0167765im     0.0389711-0.0641653im       0.17688-0.0199816im   -0.0862762-0.00977094im    0.0718888-0.0502811im   -0.0723648-0.215636im       0.0960521-0.00428854im    0.147713-0.076208im    -0.0948911+0.123566im    -0.0286233+0.0475718im     0.101879-0.139513im    -0.00943718+0.0263392im     0.0515279+0.0210759im     -0.132975+0.082603im       0.079418-0.0968938im    0.0310703-0.128731im    -0.00207574-0.185715im     0.00191105+0.254756im       0.133133+0.136555im      -0.105961-0.0621171im      0.110841+0.0148452im     -0.108612+0.0597269im
  -0.160119-0.0110305im      -0.177807+0.204793im     -0.046971+0.000160962im     0.0206101+0.132079im     0.0746514-0.160172im      0.0177138+0.178779im       0.116664+0.164541im     0.213989-0.0902208im    -0.253138-0.0577446im   -0.0724443-0.0107716im     0.261399-0.186321im      0.0447081-0.128197im      0.0140386+0.0464592im     -0.17204-0.0132681im     0.0530163-0.00666021im    0.131677+0.105443im       -0.120799-0.286194im     -0.115926-0.153427im    -0.0286087+0.194532im    -0.0375445+0.18532im       0.142499-0.0827315im     0.0604285-0.113137im       0.111502-0.0207823im      0.112749+0.0393744im     0.0341703-0.00180144im  0.00353949-0.169001im     -0.0440258-0.154404im       0.150432+0.163249im        -0.1207-0.0521043im     -0.107388+0.162833im   -0.000804216+0.10756im       0.0253678+0.117575im
  -0.100425-0.127081im        0.154913-0.340573im      0.163583-0.0347913im      -0.0153443+0.0610265im     -0.16289+0.144465im     -0.0762337+0.03292im     -0.00822506+0.0010622im   -0.142145+0.0821969im    -0.080954-0.0443331im     0.102675-0.053668im     0.0355517-0.139991im        0.17413+0.0979248im    -0.0324031-0.133652im    -0.0589296+0.18524im        0.119874-0.142193im      0.260971+0.140747im       0.0292701-0.191033im      0.197141-0.0560335im   -0.0818539+0.0760966im     0.146436+0.0428303im    -0.063381-0.264703im      -0.054221+0.0878824im     -0.181086-0.202203im     -0.0840664-0.0662203im      0.149215-0.0135494im   -0.0365316-0.128677im      -0.017038-0.200315im      0.0535096-0.163766im     -0.0725221-0.0310763im    -0.0324442-0.182861im      -0.121076-0.0862871im    0.00832135+0.0164386im
 -0.0179742-0.217696im         0.11314-0.153968im    -0.0599437+0.114568im        0.0472857-0.0926422im   -0.0280418+0.0247748im     -0.104055-0.0491398im      0.368121+0.170303im    0.0339687+0.128531im     0.0175705-0.117156im     0.0265368-0.00775396im   0.0380988+0.157165im     -0.0854855+0.113004im      0.0365534+0.159277im     0.0364453+0.146316im       0.154765-0.212771im     0.0299245-0.0676407im       -0.10283+0.0107294im     0.107184+0.0846812im    0.0519533+0.177514im      0.135842+0.0393774im   -0.0980811+0.14998im       -0.153714+0.00193635im   -0.0260738+0.0953026im     0.0974964-0.120581im      -0.109862+0.0301295im    0.0157536+0.160401im       0.247348-0.0510723im     -0.100143+0.0601631im    -0.0504569-0.00645671im  -0.00243848+0.204278im       0.181861+0.353859im      0.0786763+0.0890694im
  -0.147147-0.0213883im     -0.0942598-0.171973im     0.0113895+0.078666im       -0.0249356+0.205678im     -0.192611-0.053941im       0.123175-0.010533im      -0.084585-0.187104im     0.094447-0.0954442im   -0.0345397-0.0341528im   -0.0624553+0.179949im     -0.309055+0.0684058im   -0.00849901+0.10493im      -0.0202935+0.0600153im   -0.0909611+0.0704746im     0.0527869-0.0410486im   -0.0244073+0.199104im       0.0471369+0.0438675im    0.0787979-0.0581095im   0.00359146-0.0162634im     0.029339-0.0168242im   -0.0496241+0.0589663im      0.170681-0.0747932im      0.389723-0.00476806im    -0.247648-0.0902904im     -0.130801+0.048756im    -0.0925664+0.120927im       0.005839+0.0477882im     0.0386573+0.0805746im    -0.0225931+0.075891im      -0.218059+0.0336218im     -0.213062+0.0981527im      0.321666+0.138499im
 -0.0307107-0.200957im        0.142271-0.0597706im     0.118935-0.137035im        0.0968393+0.110478im      0.122956+0.0559966im     -0.108421-0.0219798im      0.241736-0.0319961im  -0.0177019-0.0897819im  -0.00354109-0.0553768im   -0.0725889+0.273167im    -0.0849573-0.198634im       0.210126+0.100863im     -0.0490362+0.0707327im    0.0848181-0.177959im      -0.072944+0.229487im    0.00184205-0.0171047im       0.239732+0.184909im     -0.191833-0.0633174im   -0.0743346+0.305888im     0.0349107-0.0993013im   0.00245274-0.0300581im      0.138697-0.179922im     0.00582676-0.207808im      0.0391194+0.04024im     -0.00506493+0.0885461im    0.0582687+0.0056712im     -0.142519+0.0319142im     -0.244569-0.0638222im    0.00901894+0.13212im        0.055363+0.0472991im     0.0392578+0.0912545im     -0.130535+0.0756134im
   -0.17856+0.128423im        0.278211-0.0706363im    0.0103808-0.0978811im       -0.228392+0.110086im      0.158303+0.0988903im     -0.097132-0.0214798im    -0.0826566+0.100998im    -0.121576-0.0707643im   -0.0764948-0.0622998im   -0.0328515+0.157111im    -0.0130565-0.119179im     -0.0161351-0.0429241im     0.0068368+0.135173im     -0.153278+0.0487113im     -0.125873+0.0473603im    -0.196734-0.275384im       0.0896599+0.0932448im     0.251926-0.203808im      0.190188-0.259495im     0.0126602+0.0304515im    -0.048572+0.0652104im    -0.0999112-0.136743im    -0.00596812-0.0243362im     0.0126294+0.0026138im    0.00935285-0.0119985im    0.0180568-0.162923im     -0.0398184-0.0580777im      0.199371-0.010119im      0.0791278-0.219677im      -0.148759+0.0506104im     0.0299616+0.262164im     -0.0418012-0.00192192im
  -0.110707+0.321762im     -0.00276142-0.016309im     0.0793777-0.0635423im      -0.0115792-0.066815im     -0.155694+0.0144303im     0.0284193-0.131268im       0.077579-0.0396769im   -0.159542-0.18199im     -0.0190211-0.382305im    -0.0360713-0.132415im     -0.131541-0.086921im      0.0665325+0.0223566im    -0.0423875+0.141881im     0.0998609-0.0859505im     0.0566951+0.159333im     -0.126697+0.0260045im      -0.307211-0.133721im     -0.183086+0.180654im      -0.14871-0.053735im    -0.0271693-0.136976im    -0.0804806+0.0837141im    -0.0495364+0.183511im      0.0716234-0.131692im       0.119054+0.038265im      0.0859483+0.029068im       0.15924+0.0553206im     0.0481642-0.230457im     -0.0770827+0.0183241im     0.0261768-0.0873126im     -0.195766-0.101886im      0.0376346+0.0556877im    -0.0345558+0.0941558im
  0.0260279-0.00678272im      0.150133+0.0373565im   -0.0543244-0.102936im         0.248835-0.183528im     0.0376481+0.143271im        0.28515+0.0705159im      -0.10689-0.298178im     0.210597+0.196434im     0.0704949-0.199963im    -0.0917643-0.0641105im     0.169408+0.0171817im    -0.0248711+0.0160057im     0.0482099+0.162356im     0.0414597-0.0354578im     -0.080451+0.118935im    -0.0998786+0.148604im      -0.0338487+0.0851147im    0.0806924-0.0605741im   -0.0147969-0.11967im       0.141919+0.232808im     -0.146306-0.104466im       -0.15546+0.00428192im  -0.00385396-0.137062im      -0.163187+0.00363863im      0.24122-0.0288002im   -0.0535153-0.0861503im    -0.0209285+0.0886316im    -0.0944676+0.126945im       -0.17633+0.062686im     -0.0261247+0.162725im     -0.0365995+0.113984im     -0.0981123+0.0694653im
  0.0299323-0.0803698im        -0.0751+0.178633im     -0.022358-0.190208im          0.18121+0.247681im     0.0160997+0.00153009im    -0.175281-0.0615232im     0.0432586+0.0619344im  -0.0139055-0.0524367im     0.108953+0.0618928im   -0.0880356-0.166322im      0.185142-0.0491154im      0.101651+0.127699im      0.0571709+0.120427im     0.0698184-0.0152769im      0.114313-0.0760079im    0.0711995+0.0685515im       0.162232+0.124884im    -0.0850668+0.0838785im     0.190158-0.201734im     0.0922358-0.15193im      0.0372556+0.227427im      -0.254347+0.214035im      -0.133946-0.109938im     -0.0337133-0.0199315im     -0.092239+0.114644im     -0.101876+0.0374418im     -0.134638-0.0040462im      0.213027+0.0686769im    -0.0115585+0.0753907im     -0.122513-0.0182778im      -0.21198-0.049534im      0.0348879+0.289181im
 0.00855081-0.0120596im     -0.0936402+0.0206446im    -0.221899-0.0655485im      -0.0912305+0.065166im     -0.110065-0.0984615im     -0.115456+0.114072im       0.182906-0.152163im    0.0444666-0.0606112im  -0.00619565-0.0250282im     0.221006-0.00326852im  -0.0320088-0.0237013im    -0.0316061+0.00792674im    0.0351112+0.0467312im     0.178076-0.201834im       0.100578+0.107876im     0.0665955+0.142582im       -0.202334+0.175844im      0.146693-0.142721im     -0.156699+0.0395522im   -0.0110291+0.060049im     0.0909875-0.0810849im     -0.183956-0.0402817im    -0.0873923+0.0929432im     -0.174306+0.031628im      -0.075495-0.0941923im     0.088772-0.107412im      0.0654103+0.103944im       0.244774-0.126617im       0.275763+0.237666im     -0.0988592-0.172657im     -0.0290435+0.237145im      -0.166114-0.127059im
  0.0300455-0.208596im      0.00233049+0.196202im    -0.0177972+0.0727549im     -0.00237234-0.112731im     0.0845587-0.133626im     -0.0881586-0.16622im        0.139404-0.201325im   -0.0266482-0.0461767im    -0.180265+0.182245im     -0.158073-0.101993im     -0.269986+0.157752im      0.0799922-0.0613836im     -0.154392+0.155034im      0.198768+0.0392909im      0.116716+0.0339325im    -0.117489+0.000682351im     0.112616-0.100702im    -0.0422119-0.181931im     0.0111321-0.0812742im     0.031351-0.0740735im    0.0179893-0.157241im     0.00631103+0.0314308im    -0.0595854-0.0552431im     -0.108584+0.0037741im     0.0919452-0.214164im     0.0425437+0.00865141im     0.170682-0.263335im      0.0770166-0.00999456im    0.0230575-0.233636im       0.120436+0.191144im      -0.248114-0.00369183im   -0.0627217-0.0351146im
  0.0369178+0.146156im        0.185374-0.277928im     -0.219233-0.0178367im        0.170238-0.0487854im    -0.134477-0.030783im      0.0747738+0.00571601im   -0.0851005+0.0203619im   0.0679123-0.0951781im   -0.0374969-0.00596653im    0.177223-0.0125177im    0.0916022-0.0667724im     0.0311749+0.347944im     -0.0868214+0.041528im     0.0710957-0.163101im    -0.00710663-0.224645im     0.0218452+0.00270046im    -0.0108147+0.0670983im    -0.125087-0.162731im     0.0676384-0.0181183im     -0.26304-0.178291im    -0.0503542-0.0982062im     0.0358675-0.0940956im    -0.0110211+0.122637im       0.248398-0.106969im     -0.0474931-0.0108084im     0.059073-0.0190953im    -0.0179198-0.0568754im     0.0802698+0.161966im    -0.00847473-0.0189082im      0.031725+0.268935im      -0.250952-0.0974879im     -0.109662-0.127079im
 -0.0159819-0.0120005im      -0.148081-0.0972841im    -0.301501+0.0158926im        0.117736-0.0108617im      0.14642-0.149529im       0.112185+0.0699771im     0.0375336-0.031244im   0.00316282+0.0287im       0.0726457-0.00700359im   0.0104493+0.133477im     0.0387988+0.0450444im      0.192056-0.0230606im     0.0406073+0.00980212im   -0.304889-0.0298249im     -0.143055-0.143427im    -0.0816235+0.0607427im      -0.140849+0.165178im     0.0934312+0.152164im    0.00916621-0.0173257im     0.373381-0.0908245im     0.177031+0.0305608im    -0.0348358-0.0932726im     0.0393364-0.167992im        0.16268+0.109503im     -0.0623617-0.207595im     0.0996742+0.192347im     -0.0393338-0.137086im     -0.0614771-0.148946im     -0.0308484-0.196472im    0.000994953-0.140933im      -0.179384-0.0355449im    -0.0990055-0.0839393im
   -0.19791+0.0642357im     -0.0302577+0.104427im     -0.194733-0.0345692im       -0.120533+0.00865067im   0.0235872+0.0464275im     0.0919408+0.10547im       -0.035065+0.0777153im     0.10681-0.16029im       0.104256+0.0367501im    -0.392116+0.00987597im   -0.113848+0.110782im       0.153292+0.155808im     -0.0926762-0.138078im     0.0733804+0.199602im     -0.0238818-0.168433im     -0.121817+0.262427im      -0.0673927+0.0134973im     0.123529-0.040942im    -0.0984118+0.00805713im   -0.239683+0.0646176im   -0.0639067+0.0348946im     -0.145459-0.171264im      -0.246294-0.15224im        0.112316-0.0924967im    -0.0185197+0.0452593im   -0.0402941-0.0556773im    0.00808475+0.0169259im     -0.144557-0.0764706im      0.236293+0.0238624im     0.0857226+0.0128294im      0.139408-0.0741709im   -0.00898868+0.151396im
 -0.0533615+0.000189114im    0.0631766+0.124616im    -0.0795242+0.306927im        0.0486722+0.0820366im   -0.0657078+0.0766159im     -0.239177-0.0335084im     -0.028871-0.146916im    0.0762989+0.0388946im      0.16106+0.156032im    -0.0170529-0.0576502im     -0.10167-0.143867im       0.274581+0.00474278im  -0.00925922-0.0213564im   -0.0637967-0.104107im       0.113502+0.172373im    -0.0156385+0.0271108im     -0.0331449-0.18132im       0.185251-0.0759101im    -0.084922-0.00984498im    0.166381+0.091302im     -0.216131+0.311275im     -0.0141431+0.0409593im     0.0235298-0.0229303im      0.250905-0.0859985im    -0.0521307+0.0302271im   -0.0416499-0.0798627im    -0.0606727+0.0480983im    -0.0366664+0.114324im     -0.0799892+0.0676125im     -0.118502+0.0973301im     0.0270665-0.100515im      -0.019185-0.371782im
  -0.118034-0.0150096im     -0.0297171+0.133809im      0.133258+0.108503im         0.090513-0.0645255im      0.24868-0.103085im      -0.028265-0.00597807im  0.000435341+0.210721im     0.213073-0.0960909im    0.0082971-0.0482565im     0.217244+0.0341563im    -0.314368+0.216539im      0.0132412+0.270238im       0.151884-0.028284im    -0.0302428-0.180891im      -0.122884-0.0456661im    -0.126185-0.0444562im     -0.0936571+0.0906482im      0.10142+0.069im      -0.00653672+0.11881im     -0.0165755+0.00860917im  -0.0155983-0.188977im      0.0221089+0.252165im       -0.12111-0.0592729im    0.00950254+0.00920597im    0.0920576+0.188628im     -0.294169-0.17586im      -0.0705257-0.0497592im     0.0621344+0.0873183im     -0.109489-0.0538im       -0.0336156-0.127704im     -0.0530531+0.0727991im     0.0269286-0.0633707im
  -0.117655-0.0469204im      0.0226682+0.0649569im    -0.148651-0.0484995im       -0.197419-0.0653908im     -0.33281-0.100103im       0.185161+0.104796im      0.0276221+0.119851im   -0.0839311+0.265358im      -0.13517+0.0410357im    -0.038448+0.188936im     -0.151641+0.141939im       0.088722+0.168265im       0.170365-0.194579im     0.0785806+0.0108711im     -0.152792+0.15041im      0.0798382-0.177774im     -0.00481176-0.135945im    -0.0465561+0.0336596im    0.0440098+0.0377904im      0.13589+0.0432967im     0.018846+0.193235im    -0.00737133+0.112212im     -0.0493379-0.0198622im    -0.0950916+0.122589im    -0.00106034+0.164394im       0.12509-0.0283093im    -0.0151056+0.0322132im      0.112455+0.0288681im    -0.0391109+0.0132343im    -0.0324312+0.203867im      -0.111961-0.0966866im     -0.307895+0.131654im
    0.14056+0.20517im       -0.0491363-0.12549im     0.00710319-0.0463323im        0.043459+0.182047im     0.0743703+0.00897263im   0.00836658+0.0471489im    -0.0647067-0.106274im     0.239646-0.299697im    -0.0702095-0.0413374im   -0.0674828+0.0354625im   -0.0292546+0.0201953im     -0.125604-0.182629im      0.0187686-0.105403im      0.161641-0.0275698im     0.0383468-0.0646327im    -0.135194-0.0553832im       0.243355-0.118849im      0.189056+0.20706im      0.0824705+0.181119im     0.0796639+0.217164im     -0.159561-0.0532505im    0.00228254+0.117752im      -0.116474+0.0242061im     0.0765524+0.00774477im    -0.131836+0.184553im       0.24028+0.133911im      0.0764457-0.0652207im      0.109806-0.21999im       -0.159112+0.056561im        0.01848+0.091835im      -0.121189+0.0327017im     -0.160734-0.00926107im
 -0.0123057-0.171234im      0.00789005+0.00729506im   0.0189475-0.149729im       0.00706267+0.0421129im   -0.0785838-0.110775im       0.226552-0.114029im      -0.063786+0.161018im      0.16325+0.0392726im      0.26189-0.0131783im    0.0852798-0.0631921im   -0.0624278-0.142388im      0.0680256-0.100412im       0.300684-0.0276424im     0.158896+0.0648354im      0.160937+0.0607358im   -0.0262947+0.160284im      -0.0252938+0.12721im     -0.0384655-0.0670488im     0.239367+0.170774im     -0.130176+0.0095689im   -0.0702371+0.218458im       0.119441+0.0149955im    0.00644614+0.0450574im    -0.0260182-0.122717im       0.207267-0.0719479im     0.219461-0.100581im     -0.0735235-0.041305im      0.0436224-0.202091im      0.0109594-0.322243im      0.0087433-0.0289564im   0.000631643+0.0586649im      0.111204-0.14538im
 -0.0336147-0.127524im      -0.0372215+0.144506im     0.0679385-0.3027im          0.0881987+0.118263im     -0.166243+0.108099im    -0.00195146-0.0632831im   -0.00674291+0.0536251im   0.0524435+0.0630928im    -0.109476-0.0811999im   -0.0468764+0.0459946im    -0.204924+0.0487055im     0.0504107-0.128877im     -0.0367633-0.163091im     -0.293809-0.00407664im    0.0478762-0.098889im    -0.0571378+0.0232357im     0.00167622+0.206107im     -0.162939-0.182604im     -0.172521-0.170525im      0.133999+0.0677907im    -0.145406-0.128562im      -0.129311+0.0509882im    -0.0524199+0.282286im       0.164184-0.0307134im     0.0254252+0.18565im       0.256109+0.0661962im     0.0211712-0.0851068im     0.0130385+0.183095im     -0.0247532+0.0657537im      0.193975-0.100649im     0.00771088+0.0451213im     0.0770321-0.120366im
   0.138367-0.176734im      -0.0285484+0.0576565im   -0.0590582-0.14183im         -0.100185+0.275497im     -0.315294+0.00552675im    0.0323857-0.0818638im    -0.0660058-0.0804672im    0.136568-0.0377609im     0.051495-0.0667684im    0.0514529+0.0390987im   -0.0908882-0.00247576im    -0.123945-0.12437im      -0.0322366+0.204945im     -0.133991-0.144746im      -0.382761-0.0828845im    0.0557826-0.0630809im      0.0796739-0.126834im     0.0969717+0.0370088im   -0.0906986+0.105742im     -0.147545-0.160406im     0.0525137+0.113098im     -0.0934755+0.0170981im     -0.111596-0.0902049im      0.104996-0.106403im       0.240346-0.170282im      -0.26459+0.0865004im      0.151827-0.106777im      0.0432929-0.0445557im    -0.0780154+0.0461707im     0.0151959+0.0398074im      0.148903-0.0215915im    -0.0417688-0.0208417im
   0.131065+0.0488029im     -0.0677563+0.0905209im   0.00240836+0.0304989im        0.146012+0.0980497im    0.0227451-0.0883065im     -0.147228+0.0934331im     -0.181749+0.061461im     0.209621+0.133105im    -0.0411647-0.0107056im   -0.0575881+0.246954im    -0.0451834-0.00437026im     0.128625+0.187224im      -0.192783-0.133806im     0.0912092-0.0594421im      0.139404+0.0976607im     0.230795-0.0663984im     -0.0627702-0.042455im     0.0471309+0.103296im      0.123411-0.213017im    -0.0371407-0.0888729im    -0.116152-0.170229im      0.0336847+0.0136317im      0.121298-0.0308361im    -0.0613823-0.250982im      0.0991967-0.160864im     0.0963784+0.220888im     -0.0252438+0.00182583im    0.0862695+0.00260543im   -0.0195271-0.156333im     -0.0100962-0.0876074im      0.337485+0.139069im      -0.181421+0.0994561im
   0.112122-0.105187im      0.00673714-0.026866im     -0.092431+0.0395303im      -0.0149148+0.135335im     0.0296765+0.00586052im    -0.105762-0.0270299im    0.00691882+0.0251353im   0.0356952-0.0724828im    -0.123593-0.065668im     -0.150436+0.209744im      0.223591+0.0782684im      0.177937-0.14326im        0.338208-0.0499109im   -0.0451487+0.045077im     0.00710393+0.0158735im    -0.100651-0.0605059im       -0.21807-0.0293198im    -0.174132+0.0693291im     0.131712-0.112161im    -0.0620593-0.231652im     -0.228093-0.17984im      -0.0344571-0.00386521im    0.0483615+0.00392666im    -0.155168-0.108453im    -0.00211478+0.109196im     -0.117051-0.193195im       0.346282+0.0413518im     -0.170663-0.115833im      0.0356869+0.105139im      -0.116153+0.0237261im     -0.106683-0.107839im     -0.0277115-0.159156im
  0.0396162+0.154079im      -0.0135128+0.0538336im    0.0472753-0.150285im         0.178466-0.301407im     -0.003987-0.106006im     -0.0523705-0.083514im     -0.0318084-0.160214im     0.138393+0.163828im     -0.136009-0.0251225im   -0.0356779+0.100588im     0.0281185+0.0539803im    -0.0200454+0.0635877im     0.0147862-0.0470181im   -0.0366246+0.0104305im     0.0663147+0.16333im        0.15539-0.152567im       0.0308637+0.0475789im    0.0462735-0.176771im    -0.0268027+0.0288907im    -0.135211+0.0633297im    0.0510079+0.269164im      -0.086111-0.210992im      0.0303162+0.0271445im      0.146394-0.105524im      -0.116528+0.176548im     -0.203728-0.0438488im      0.165772-0.269172im      0.0104361-0.327024im      -0.087082+0.0259394im   -0.00381467-0.231795im      -0.111629-0.0359236im      0.106165+0.0745697im
    0.12142+0.182283im         0.15667+0.0456802im     0.195381-0.107435im         0.128889-0.0704453im    -0.243866+0.0768986im    -0.0423814+0.264054im      0.0136134+0.191958im     0.166728+0.0618843im    -0.215479+0.141547im     0.0193613-0.0891802im    -0.028574-0.0437556im     0.0660752-0.0357568im     0.0366385-0.0611191im    0.0958012-0.0869653im      -0.23785+0.0199503im    -0.148992+0.177449im        0.125787-0.0763848im   -0.0335352+0.0377269im     0.117298+0.0149946im     0.169431-0.0152149im    0.0483813+0.062784im      0.0113866+0.0653659im   -0.00139361-0.0848408im   -0.00685093-0.0879107im     -0.286365-0.264012im    -0.0259545-0.114004im       0.155375+0.00452513im    -0.165232+0.109728im       0.216761-0.0835879im     0.0272925-0.115896im     -0.0568162+0.151021im       0.123535-0.0422018im
 -0.0915367+0.116337im      -0.0564895+0.200172im    -0.0990638-0.0607745im       0.0765526-0.0461329im    -0.168746+0.0877228im   -0.00123188-0.159641im      -0.106276+0.0587217im  -0.0654333+0.0920161im    -0.138323-0.0157314im    0.0368544+0.0893859im    0.0573312-0.261688im       0.160832+0.0709379im     -0.136788+0.25646im     -0.0262454+0.102022im       0.141074-0.14222im      -0.274457+0.151987im        0.019359-0.0305629im     0.114411+0.0527959im    0.0927723+0.177575im    0.00135028-0.0791455im    0.0717856-0.00573704im     0.130313-0.0273306im    -0.0781126+0.204806im      -0.276434+0.132818im     -0.0983514+0.174343im     -0.193578+0.0929496im     0.0685028+0.0539286im   0.000858483-0.0302421im     -0.150403-0.0751619im      0.127457-0.114156im       0.112111+0.0147084im     -0.224334-0.12119im
  0.0604232+0.0134023im     -0.0337296+0.141996im      0.091119-0.0358531im       -0.101582+0.0239793im     0.175735+0.0776209im      0.212732+0.0692504im    -0.0463438-0.0948419im    -0.14598+0.074627im      0.225926+0.00229411im    0.125808+0.176274im    -0.0741024-0.0351764im       0.16902+0.155971im     -0.0743914+0.0111178im   -0.0479341+0.139346im      0.0239472-0.0718692im   -0.0235931+0.064114im        0.103046+0.00881783im   -0.185756+0.0784109im      0.13818-0.0710644im   -0.0607533+0.147369im      0.104587+0.00129749im     0.141143+0.118757im      -0.116506+0.0865994im     0.0983667-0.00822372im     -0.11749-0.241941im     0.0637207-0.15512im        0.262329-0.272069im      0.0645969-0.0288686im     -0.117519+0.360725im      -0.208913+0.0561629im      0.084538+0.0959961im    -0.0105814-0.0431348im
  -0.108682-0.0395448im      -0.102526-0.0936591im    -0.280117+0.141665im     -0.000350774-0.020431im     -0.171041-0.00293567im     0.032337+0.176606im      -0.042709+0.220573im    -0.103518+0.0924898im   0.00868734-0.0816304im    -0.079084-0.0141445im    0.0204616+0.0452754im      -0.11054-0.22438im      -0.0724508+0.195128im      0.187485-0.0837529im      0.120635+0.0936025im   -0.0485329-0.0576584im       0.110034+0.200472im    -0.0439034-0.143107im      0.157838-0.109185im     0.0716728+0.119663im    -0.0501973-0.112472im       0.319232+0.094141im     -0.0568421-0.31069im        0.184508-0.0998262im     0.0199054+0.135491im     -0.125233+0.0495643im     0.0826773-0.130864im      0.0790813+0.0613584im   0.000355127+0.153675im      0.0787414-0.18056im       0.0558264-0.0451765im     0.0527233-0.0499922im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 -0.001917045036720767 - 0.05024854990731735im
  0.041598325182572865 + 0.16819574400873818im
  0.008277731836380675 - 0.03888319305799201im
   0.10286709154367606 - 0.07020542650766665im
   0.32974647318999617 + 0.0im
  -0.11838530470523749 - 0.14531842631877284im
  0.054852403055685145 + 0.008365739460130178im
   0.03925626479881058 - 0.03917614041601499im
  0.052209860838948186 + 0.28300945151756807im
  -0.12453499293715392 + 0.10020528612533577im
   0.07635480959321508 + 0.043055378428439796im
   0.12122902503036903 + 0.1878180562501258im
  -0.19846068321736526 + 0.007260886183558879im
   0.14495506739447514 + 0.09365072572598478im
   0.08157213708044254 - 0.02197686947257784im
  -0.19568882676224883 + 0.02957117847040731im
   0.13455183417158287 - 0.05961438156600879im
 -0.051493930912194105 + 0.09225388777304099im
   -0.2894009195496307 + 0.09739965816343764im
  -0.03241980333860806 - 0.1345951489976917im
  -0.02606907729050829 - 0.1966978246398761im
 -0.004489867418243932 + 0.169249525403832im
   0.03072472369682687 - 0.08544272241513483im
 -0.047187922196475156 + 0.09391499286745086im
   0.14644596846200003 - 0.2402179937573708im
  0.061643334145769196 - 0.08444980596341875im
   -0.1672683291712248 - 0.05943104086528947im
  -0.10009948259817646 + 0.01869518530008241im
   0.16925718287813235 - 0.14055192697297877im
   0.08799754326330958 - 0.09545212734375659im
  -0.20509593501282877 - 0.18035056268835703im
  -0.10848180895798651 + 0.051518221489226176im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Thursday 25 August 2022 16:53">Thursday 25 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

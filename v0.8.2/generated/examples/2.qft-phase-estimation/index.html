<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><form class="docs-search" action="../../../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumBFS/Yao.jl/gh-pages?filepath=v0.8.2/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumBFS/Yao.jl/blob/gh-pages/v0.8.2/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumBFS/tutorials/tree/gh-pages/dev/generated/examples/2.qft-phase-estimation"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="generated/examples/2.qft-phase-estimation/@ref example-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0159604-0.360672im      -0.132224-0.0917351im   -0.0798252+0.0806318im   -0.0194598-0.114371im     0.0242479-0.0679904im     -0.117687+0.190756im      0.042493+0.17762im       -0.033967+0.32861im      -0.0865273+0.0255273im   -0.0504323+0.097783im    0.0518165+0.24081im      -0.0382776+0.130256im      -0.146225+0.00762591im    0.0727964-0.181459im      -0.0451514-0.033521im       -0.1782-0.0650165im    -0.0232829+0.0883273im    -0.00601798+0.0350877im     -0.125555-0.075012im      0.233463-0.142027im      -0.0391919+0.00833534im   -0.167722-0.209414im      -0.0390889+0.131008im       0.0453719+0.0549853im    0.00653684+0.077113im      -0.240267+0.0413493im    0.197776-0.00638663im   -0.0310132+0.0204155im  -0.00605765-0.215548im    0.0887025+0.0551765im       0.1185+0.13131im      0.0744053-0.134508im
   0.0512979-0.0910114im     -0.265461-0.189105im      0.112883-0.129895im    0.00887081+0.00664348im   -0.144016+0.0855274im     -0.188205-0.134953im      0.168198-0.0177408im     -0.222173-0.00777885im    0.0503306+0.0773815im     0.318037-0.170672im    0.0285698-0.125281im      0.0301631-0.123994im     -0.0478297+0.201078im       -0.11602-0.0864358im      0.0140774-0.100645im     0.0273624+0.00649429im     0.155626+0.0275808im       0.143492+0.0521658im   -0.00299199-0.236808im     -0.113831-0.0488066im      -0.177837+0.0224026im    0.0205721-0.0947829im     -0.0598614+0.0129962im      -0.139419+0.00644509im   -0.0476984-0.230536im      0.0578483-0.0302099im  0.00964412-0.0471841im     -0.180939-0.0770657im    -0.270528-0.156051im   -0.0870554+0.00463899im   -0.198446+0.0538592im   -0.0923009-0.0770522im
   -0.110934-0.041137im      0.0310545+0.0874711im   -0.0221023-0.43983im     -0.0556641+0.168529im    -0.0374122-0.226251im       0.124145+0.0506182im     0.104944-0.00289085im   0.00458482+0.124286im      -0.277486-0.0724651im    0.0461265-0.0232331im   -0.039353-0.0143884im     -0.237002-0.0969016im     -0.213153+0.0402872im    -0.0291523-0.00454238im    -0.0375706+0.0523748im   -0.0908302+0.0633569im      0.104907+0.108612im       0.0338136+0.157624im       0.118528-0.0726762im   -0.0390438-0.0259606im       -0.04689-0.171642im     0.0218483-0.196391im       -0.103626+0.0736976im       0.105646+0.108949im       0.052342-0.115288im       0.120183-0.169279im   -0.0138758+0.0453448im      0.146596+0.0956378im      0.10713+0.30628im    -0.0551499+0.0485547im     0.110593-0.172141im    -0.0454278-0.107052im
     0.15744+0.146233im      0.0926525+0.0830048im       0.1259-0.0645037im   -0.0570539-0.146505im      0.033707-0.011757im       0.080225-0.180476im     0.0560457-0.01507im      -0.0995232-0.0562531im     0.0173348+0.0614058im   -0.0638991+0.0729766im    0.117258+0.0483678im     -0.188456-0.163442im       0.117387-0.0113569im    -0.0538089+0.121344im       0.0113835+0.00394495im  -0.0647129-0.15972im       0.0425971-0.108185im       -0.207963+0.0156079im      -0.14975-0.0643071im     0.137807+0.0531046im      -0.248607-0.0792361im    -0.196824+0.169667im       0.0592904+0.108468im        0.160789+0.265664im      0.0465417+0.144274im      -0.154366-0.19602im    -0.0951731-0.0977933im      0.144842+0.0716497im    -0.249677-0.234724im     -0.13956+0.0467856im    0.0496043-0.183089im    -0.0664979-0.146828im
   0.0522394+0.0756852im     -0.089002+0.0491664im   -0.0252032+0.0464242im    -0.137587+0.0271432im    -0.269977-0.20169im       -0.129068+0.283879im     0.0364798+0.0461176im    -0.0422556+0.0267018im     -0.106542+0.287595im      0.144662-0.067059im   -0.0701549-0.144154im      -0.136722-0.0475639im    -0.0139192+0.109084im      0.0730389+0.0565381im     -0.0727075+0.0301116im    0.0986193-0.261225im      -0.168772+0.00260118im    -0.0835515+0.0692639im       0.22447+0.148762im     0.0666926+0.0365568im       0.133104+0.103913im    -0.0317518+0.216298im       0.0574635+0.0844275im      -0.130409+0.133087im      0.0132693-0.0398962im     0.0442246-0.0228132im  -0.0566969-0.181842im        0.14281-0.275329im     0.0724673-0.0613028im  -0.0867824+0.0534292im     0.170961+0.204096im    0.00217613+0.0633896im
   0.0279726+0.215515im     -0.0497419-0.0331035im    0.0517971-0.0673418im    -0.107043+0.0128702im    -0.195292-0.0927694im     -0.119712-0.271901im     0.0854192-0.07493im        -0.07583-0.0292101im    -0.0754904+0.191276im    -0.0262865+0.273271im     0.214174+0.0380891im    -0.0547071+0.0835731im    -0.0450138-0.0861258im     -0.169511-0.208013im       -0.170825-0.1473im       0.0195386-0.099868im      -0.086457+0.0688075im       0.240839-0.0803736im      -0.16902+0.0820853im     0.100544+0.124286im        0.165105-0.0230573im   -0.0240668-0.0787175im     -0.0663976-0.106564im      -0.0275556+0.174498im      -0.150355+0.137488im    -0.00853695+0.129552im   -0.0892701+0.0318613im     -0.268355+0.054682im     0.0527801+0.156163im    0.0983077+0.133178im       0.11861-0.0928155im    0.0170143+0.138672im
    0.201222-0.00256458im    -0.139032+0.0157627im     0.364937+0.167865im     0.0715626+0.0738946im     0.104351-0.0493679im    -0.0447772-0.088404im     -0.137199-0.296098im       0.074096+0.14488im      -0.0941912-0.0151328im    0.0635418-0.0514431im  -0.0870821+0.100704im      -0.126199+0.206532im     -0.0651977+0.117698im      -0.089675-0.118933im       0.0690054-0.00569372im   0.0382024-0.143493im      -0.041785-0.0368759im      -0.030194+0.124044im     -0.0486874-0.0324898im    -0.151674-0.0231999im       0.047946-0.0433344im     -0.18974-0.146831im         0.10018-0.00363526im     0.0251858-0.13466im        0.146417+0.205142im      0.0273536-0.202456im    -0.197971-0.00958955im   0.00326376-0.159695im     0.0467148+0.116589im     0.118483-0.321369im     0.0104026+0.0402931im    -0.104056+0.0010474im
  -0.0570305-0.00380904im    0.0628548+0.0185796im    0.0053031-0.205712im     -0.255475+0.16688im     -0.0289928+0.0763179im      0.180527+0.106595im    -0.0394322-0.0838812im     -0.199543-0.2384im       -0.0544431-0.0825984im  -0.00400567+0.173577im    -0.185021+0.00437624im     0.207688+0.149764im     -0.0110974-0.0515597im      -0.17779-0.101586im       0.0524958+0.229275im     0.0055293-0.0828405im     -0.105674+0.0660982im     -0.0714634+0.123482im     -0.0214016+0.0934278im    0.0649494-0.0909662im      -0.200693+0.0794493im    -0.199427+0.0497736im       0.122195+0.0176534im      -0.171424-0.0654713im     -0.179644+0.0969158im     0.0466536-0.147307im   0.00189721+0.127469im      -0.113286+0.0417498im     0.017663-0.0467064im    0.147265+0.155816im    -0.0975842+0.243531im     -0.143996-0.157232im
    0.228319+0.241698im     -0.0468427-0.0937315im   -0.0816152+0.00729009im   0.0122635+0.137857im     -0.245348-0.113529im     -0.0491117+0.168946im    -0.0447156+0.178192im      0.0995331-0.0243955im    -0.0248501-0.341154im    -0.0976906-0.163347im     0.306846+0.183987im     -0.0350876+0.00209044im     0.155253+0.0501675im     -0.108442+0.125011im        0.018606-0.105462im     0.0734617+0.0843151im      0.160961+0.137192im       -0.116043+0.148778im     -0.0425244-0.0348765im     0.205734-0.169627im      -0.0143192-0.10927im      0.0448409-0.103425im        0.197126-0.00616705im    -0.0624364+0.0514956im    -0.0174988+0.0239501im     0.0279227+0.110497im    -0.188507+0.000466716im  -0.0268709+0.0506309im    0.0418797+0.0068202im   0.0291195-0.0367342im    -0.129874+0.167437im     -0.111485+0.0713041im
    0.108882-0.0073989im      0.104061-0.09005im      0.0589984+0.0219622im   -0.0833614+0.0768807im   -0.0142452-0.0562916im     -0.175789+0.0739867im   -0.0441375-0.00716089im   0.00785217-0.100357im      -0.165929+0.0994922im    -0.289842-0.368766im   -0.0801831+0.054147im     -0.0604056-0.129293im      0.0586261-0.00189007im    0.0899892-0.263211im        0.145276+0.0928142im    0.0922319+0.0444942im      0.178784+0.03734im         0.161624-0.0160634im     0.0996955+0.156316im    -0.0986716-0.0132094im      0.0419589-0.0584744im      -0.1696+0.149867im       -0.211363-0.0434077im     -0.0516929-0.0407608im      0.249654+0.100414im     -0.0302768+0.0691921im  -0.0186525-0.011325im     -0.0490169+0.133853im    -0.0972183-0.100968im     0.258803+0.259487im    -0.0565364-0.144339im    -0.0167606-0.0614151im
   -0.067446-0.0871371im      0.105997+0.160312im      0.137753+0.191912im     0.0453168+0.0592244im   -0.0824279+0.0231793im    -0.0912944+0.041421im     -0.125649+0.24193im        0.189666-0.0167464im    -0.0951071+0.018755im      0.156236+0.0580086im  -0.0452487-0.201914im     -0.0229109-0.0899288im   0.000150967-0.180118im     -0.0352961+0.19441im      -0.00336982-0.120078im      0.134919+0.165312im      -0.119836+0.0904401im      0.0744019+0.021564im       -0.09737-0.0851367im      0.17991+0.0640175im       0.012236+0.0730447im   -0.0171202-0.0240751im      -0.148834-0.0371469im     -0.0308029-0.0175952im    -0.0850422-0.216158im      -0.160015-0.311511im    -0.205541-0.0353948im    -0.0763628+0.0397058im   -0.0405871-0.026378im     0.379141-0.00464304im   0.0467991-0.0752672im    -0.157099-0.150058im
    0.125406-0.139011im     -0.0127053-0.0876279im    -0.106877+0.173789im     -0.437004+0.222078im     0.0388673+0.153524im       0.100339+0.0311626im   0.00260166+0.102298im       0.109822-0.0507895im    -0.0336635-0.0165427im     0.170488-0.0475444im   0.0554535+0.250589im      -0.131318-0.203229im       0.137819-0.129884im     -0.0414755-0.0156266im      -0.161835+0.0497033im   -0.0584618+0.0519121im     -0.107929-0.216843im        0.188395-0.0500096im     0.0395499-0.00998979im   0.0343793+0.159563im       0.0788788-0.0868362im    -0.077994+0.000646789im    -0.144865+0.0643241im      0.0739265-0.0455018im   -0.00986271+0.0452066im     0.0988017-0.0087762im    0.125605+0.119518im     -0.0444747-0.0933664im    0.0347079-0.0037254im   -0.198879-0.17195im     -0.0521194-0.0248783im    -0.283415-0.0009429im
   0.0440132-0.0082955im    -0.0547968-0.0456792im   -0.0789835+0.105199im      0.286008-0.0996302im   -0.0271926+0.0537649im      0.158526+0.183557im     -0.141559-0.025621im     -0.0709565-0.0423124im     -0.145725+0.0110406im    0.0276686-0.0288286im   0.0367015+0.00201491im   -0.0253678-0.105862im      -0.288293-0.261236im     -0.0908553+0.000484303im     -0.13445+0.00671484im   -0.122826+0.0508866im      0.178641+0.0664771im     -0.0985636+0.0493822im      0.159184+0.175117im    -0.0690807+0.247077im      -0.0666871+0.0630882im    -0.108225+0.0624293im      0.0141272+0.0204516im       0.104316+0.0521232im    -0.0863631+0.102694im      -0.122195+0.0949677im  -0.0669289-0.227866im       -0.33396-0.132445im   -0.00460241+0.158275im    -0.120562-0.0255358im    -0.232555-0.0206106im   -0.0245527-0.175993im
    0.295933+0.140943im        0.18307+0.347901im    -0.0989863+0.0578463im     0.043705-0.0988263im   0.00314077+0.147465im       0.125379+0.0696764im    0.0509064-0.0206603im     0.0141604+0.0278733im     0.0522997-0.130863im   -0.00758707-0.0255784im  -0.0794304-0.173576im      -0.170284-0.112717im      -0.158924+0.0551254im     -0.343959-0.2604im        0.00927197-0.0890033im    0.0172143-0.0196605im      -0.16376+0.0344764im      0.0766878+0.17181im       -0.082881+0.0091327im    0.0655837-0.0666598im      -0.024044+0.0536569im    0.0563483-0.0611199im     -0.0620565+0.0730645im      -0.232694-0.142618im       0.157533-0.0835272im     -0.172259+0.0999385im    0.261219-0.06213im       0.0182094+0.0284347im   0.00405006-0.0217358im  -0.0877448-0.00723651im   0.0167408-0.0560565im    -0.023685+0.122421im
   -0.136663+0.00425064im     0.111453+0.0765071im   -0.0946285+0.07593im      -0.116973-0.123543im      0.199833-0.0612218im    -0.0323185+0.0635726im    0.0298921+0.194922im       -0.35565-0.218392im        0.15859+0.0627762im   -0.0410594-0.157366im     0.164616-0.0540348im       0.01397+0.0961954im     -0.036282+0.0537837im     -0.129994+0.0100995im     -0.0939946-0.203045im     -0.221188-0.0104603im      0.041954-0.134843im      -0.0931445+0.00754783im    0.0316399-0.0578626im   -0.0980615-0.275989im        0.182497-0.163571im     -0.157304-0.0484483im      -0.120742-0.212597im       0.0550538+0.00796368im    0.0278672+0.00715092im   -0.0511915-0.233721im   -0.0118919-0.132341im     0.00939256-0.168412im      0.120193+0.14045im     0.0965291+0.0241119im   -0.0797659+0.0219987im   -0.0784084+0.110149im
  -0.0343504+0.172218im      -0.215336-0.0854522im   -0.0429596-0.0257258im    0.0108239+0.0551059im   -0.0180055-0.0647803im      0.101875-0.0549138im   -0.0802377+0.0383544im       0.17247-0.0369472im    -0.0119697-0.104294im     0.0409038-0.0300395im   -0.113182-0.064859im      -0.164695+0.0354202im     -0.131607-0.221921im     -0.0777196+0.148084im       0.0308474-0.0991478im    -0.403673-0.276071im    -0.00607641-0.0382257im      0.0531034-0.18874im      -0.0149646-0.137361im     -0.151211-0.0787057im      0.0287857+0.026776im    -0.0790188+0.00721522im     -0.201501-0.0430858im      -0.171777-0.245436im     -0.0632648+0.0225929im    -0.0577179+0.199465im    -0.236097+0.0561122im      0.209287+0.0697421im   0.00423608-0.177687im   -0.0122719+0.163136im     0.0132236+0.06356im     -0.0134285-0.0577908im
  -0.0611486-0.00682127im    -0.241389-0.114906im     -0.152719-0.128838im     0.0886072-0.0841109im   -0.0806313+0.0291669im      0.201787-0.130414im    -0.0516883-0.0433754im     -0.100661+0.0470681im      -0.20156-0.22167im      0.0530417-0.234633im     -0.10736+0.0190058im      0.130736+0.137308im     -0.0313425-0.022762im      -0.068693+0.0174898im     -0.0707771+0.0805659im     0.174674-0.0464148im     -0.307389-0.360534im      -0.0544898-0.0564997im   0.000693734+0.117474im      0.243004-0.118113im        0.159203-0.146602im    -0.0191975+0.0373147im    -0.00219356-0.071869im      -0.0110252+0.121051im       0.131167-0.164966im     -0.0723787+0.0720933im  -0.0455089-0.046917im     -0.0608624-0.047461im     -0.087904-0.0578522im    0.116363-0.0611848im   0.00235113-0.242437im     0.0322157-0.0502191im
    0.191708-0.137562im       0.134059+0.195407im     -0.089293-0.234501im     -0.131097-0.0145357im    -0.114257-0.145716im       0.112392-0.188386im    -0.0662016+0.0594811im     0.0622633+0.161436im      0.0450593+0.141574im     0.0263755-0.0653753im    0.067236-0.0767794im     0.0204395+0.107766im     0.00914034-0.234149im     0.00400886-0.129095im       0.0324095+0.176327im      0.125258+0.203842im      0.0762935-0.011923im       -0.105233-0.199251im       0.209968-0.125275im    -0.0267137+0.0229465im      0.0900681-0.104177im    -0.0522806-0.132356im     -0.00703358-0.173967im      -0.0954398-0.072567im       -0.19083+0.140091im      -0.116868+0.0315563im  -0.0407861-0.185315im        0.11325-0.0392545im    -0.265396-0.0610041im   0.0164509-0.175842im    -0.0553301+0.183715im     0.0750061+0.0809864im
  -0.0529453+0.0498315im     0.0181273-0.00103271im    0.143502+0.124168im     0.0404291+0.00619833im  -0.0482129-0.23149im      0.00775096+0.166876im    -0.0600687-0.212001im     -0.0235849-0.1286im        -0.161284+0.0553522im   -0.0039744+0.0038071im   -0.213623+0.0185933im     0.0411643-0.106337im      0.0999921+0.00538305im    -0.220433-0.0331243im     -0.0606798+0.0178138im   -0.0259989+0.210562im     -0.0537447+0.00890591im     -0.107032-0.166im         0.0881737-0.318371im      0.184429-0.140551im       -0.156051+0.26612im     -0.0300577-0.0920589im      -0.161086-0.246375im        0.240283+0.172427im      0.0576267+0.0365137im    -0.0221185+0.183845im    0.0539489+0.194767im      0.0370337-0.107329im     -0.018508-0.0189176im  -0.0740689-0.00614675im  -0.0252257+0.00708661im   0.0149947+0.164482im
    0.112678-0.0168764im    -0.0587181-0.139238im    -0.0698614-0.115092im      0.189371+0.0100703im     0.177051-0.100583im      -0.204139+0.0139243im    0.0752043-0.072385im       0.238072-0.189744im       0.104926+0.211437im    -0.0571235+0.0875302im  -0.0221379+0.0839531im     -0.129509-0.256548im     -0.0331108-0.031866im      -0.198246+0.0441128im     -0.0992671+0.257325im    -0.0389152+0.208413im      -0.146409-0.238318im     -0.00173876+0.185053im    -0.00375729+0.0111954im    -0.148366-0.244037im        0.171762-0.086729im        0.1363-0.0221316im       0.152903-0.0153488im     -0.0706466+0.0545105im     -0.103133+0.0109973im     -0.160077-0.0647113im   -0.047358+0.0717073im      -0.10074+0.0164094im    0.0374245-0.076139im    0.0224328+0.0293673im    0.0724378+0.111611im     0.0851058-0.168236im
  -0.0488942+0.112162im      0.0676392+0.0191983im    0.0527418+0.024931im       0.12153-0.121779im     0.0856199+0.0109871im     -0.111248-0.00558211im   -0.117716+0.00341443im    -0.144455+0.121806im      0.0489598+0.143337im     0.0258792-0.150936im   -0.0293247+0.169068im      0.0339354+0.159135im       0.067863-0.274976im     -0.0987748+0.0366148im      -0.324325-0.0405768im     0.166103+0.0531913im     0.0742512-0.013228im         0.18727+0.0436324im     0.0864123-0.0390691im     0.089484-0.15435im        -0.358852-0.148944im      0.149993+0.0979885im      0.0173514+0.0283927im      -0.141104-0.173754im     -0.0323954+0.0818495im      0.162107+0.092111im    0.0332445-0.0100564im      0.128666-0.103156im     0.0133561+0.0732454im  -0.0299503+0.0559198im     0.298537-0.0336281im    -0.149392-0.189638im
   -0.243516-0.0185383im   -0.00674874-0.00562007im   0.0640636+0.0889861im     0.061718+0.0818286im   -0.0469836-0.0223915im     0.0469491-0.146746im     -0.144377+0.251333im      -0.125893+0.156327im      0.0936115+0.123718im     -0.157108-0.053169im   -0.0854309-0.209519im     -0.0706403-0.0993701im     0.0837532+0.00690196im    -0.256754+0.0121409im      0.0492316+0.133146im     -0.017019-0.0175956im      0.113717-0.000716927im    -0.053314+0.083144im     -0.0619471+0.382667im     0.0122247+0.0979321im       0.050269-0.0286248im    0.0641059-0.39176im        0.0771609+0.0354328im      0.0548624+0.0240349im     0.0324511+0.0452999im      0.048412+0.0922965im  -0.0494848+0.267449im      0.0909319-0.216827im    -0.0737131-0.177417im   -0.0642991+0.0361396im   -0.0253101-0.017957im     -0.118969+0.0189193im
   0.0851873+0.0631586im    -0.0648425+0.0689517im   -0.0967664-0.00381957im  0.00999872+0.0902139im     0.367361-0.19082im       0.0923546+0.126195im     0.0708005-0.0594059im      0.183119+0.15515im       0.0410746+0.0849457im    0.0631402+0.0194502im   0.0235294-0.0529993im    -0.0207376+0.276369im     -0.0623269-0.00391967im   -0.0569206+0.0227513im       0.137975-0.0554598im      0.16795-0.0767472im       0.18711+0.00640852im    -0.0383437+0.195088im      -0.138485+0.0888573im      0.10572+0.00626827im     0.0465465-0.0698052im     0.129638+0.208137im       -0.359411-0.184937im     0.000529625+0.180381im      -0.174046-0.0127859im      0.158154-0.0152411im   0.0572532+0.120481im      -0.101806-0.0868258im    -0.048351-0.196017im   -0.0651299+0.0143981im    -0.158244-0.0204394im   -0.0559968-0.0418327im
    0.101512-0.117373im      0.0791998-0.0882303im    0.0230862+0.0703872im     0.273773+0.0069236im    -0.190697-0.0901502im     0.0149105+0.113866im     0.0307527+0.0845107im    -0.0892038+0.0845137im     0.0345538+0.0334409im    0.0127925+0.18288im     -0.155472+0.122513im     -0.0216626-0.130756im      0.0717418+0.196798im      0.0976235-0.105426im       0.0928091+0.167774im     -0.201213+0.0408575im    -0.0433906-0.1146im        -0.0251113-0.075374im      -0.217543+0.200486im      0.140398-0.0785896im       -0.10424-0.124603im    -0.0266536+0.0636549im      -0.151949-0.280837im       -0.142621-0.194958im      -0.200877-0.0257847im      0.185889-0.0699177im   -0.114705-0.194798im      0.0326827+0.0975494im   -0.0663417+0.134797im      -0.1323-0.0289482im    0.0157236-0.117186im      -0.14996+0.136657im
     0.11609-0.0212588im     0.0937438+0.150998im     0.0340125+0.0709586im   -0.0208997+0.0494422im    0.0414939-0.0540338im     -0.108963-0.0970168im    0.0473759+0.0446605im    -0.0726802-0.0926464im     0.0198834-0.139466im      0.122584-0.131777im      0.15982+0.211668im     -0.0310835+0.0438003im     -0.105995+0.0395217im     -0.110158-0.124677im        0.155817+0.0838083im   0.00842828-0.0816041im      0.106982-0.180254im       -0.157532-0.0609315im      0.148967+0.197327im    -0.0863263+0.0443886im      -0.161171+0.179043im    -0.0448922-0.00486812im    -0.0721772+0.0467113im       0.224765-0.0862924im     -0.292597-0.376933im     -0.0285718+0.108142im    -0.116106+0.110689im      -0.075357+0.0085129im    0.0820686-0.0522366im   0.0768256-0.0255116im     0.354948+0.00350932im    0.121965+0.0193856im
   0.0690434-0.0305416im    -0.0237358-0.101887im    -0.0630454+0.00679542im   0.0427705+0.109495im     -0.122877-0.0240661im   0.000638162-0.0977685im    0.0029708+0.116683im      0.0521278+0.0424223im      0.159055-0.085415im     -0.150909-0.0104218im   -0.184529+0.029254im     -0.0679437+0.151539im      -0.137125+0.032354im     -0.0335912-0.182573im       -0.263684-0.317518im      0.159845+0.133783im      -0.143833+0.135138im       -0.137837-0.122401im       0.108577+0.137776im     -0.219497-0.0865907im      0.0728427+0.202415im    -0.0435243+0.0753096im       0.070347-0.15876im         0.154262+0.0633532im    0.00635595-0.0193245im     0.0881958-0.217619im   -0.0102377+0.0149297im     0.0268535+0.242865im   -0.00657237-0.177211im     -0.24503+0.0224324im    0.0485233-0.00622268im   -0.181808-0.147856im
   0.0814537+0.0294071im    -0.0151943-0.016845im      0.132578-0.282069im     0.0436805+0.20371im       0.174832+0.26187im      0.00829876+0.113244im     -0.159822+0.0433905im     0.0801483-0.0255542im     0.0495643+0.122701im    -0.0113422+0.0698564im   0.0121182+0.0214643im      0.153391-0.0462753im    -0.0518655+0.13012im        0.138648+0.0174598im     -0.0208276-0.228234im     0.0692777+0.0666145im     -0.208951-0.149175im      -0.0836771+0.15545im       0.0698811+0.0196718im   -0.0671105+0.0672819im      -0.156562-0.0498478im   -0.0440971-0.254433im       -0.138099+0.0105536im       0.127689+0.0831886im    -0.0739645+0.0730793im    -0.0150603+0.278334im   -0.0819359-0.30162im       0.0891952-0.0350472im    0.0757543-0.126811im     0.100396+0.158678im     0.0381109-0.010428im     -0.158977+0.168625im
 -0.00543936+0.0387855im      0.155257+0.141274im     0.0105521-0.173757im     0.0488545-0.0234356im    0.0484299+0.0989878im    -0.0582253+0.150964im      0.138911+0.13088im      -0.0301974+0.0772173im     -0.261723-0.12548im      0.0378795+0.108813im   0.00329241+0.0794063im   -0.00903849-0.0607881im    -0.0790923+0.180135im      -0.121852+0.0373251im       0.144259-0.0980315im     0.120925+0.00156079im   -0.0628767-0.0391913im         0.1537-0.435957im     -0.0742469+0.029279im    -0.0838851-0.0549844im      0.0421654-0.107589im      0.226062+0.0825399im        0.06459-0.000477423im     0.215518-0.169632im      0.0676662+0.222564im     0.00382675-0.0492403im   -0.139479+0.0272716im     -0.123105-0.294929im    -0.0547549-0.116492im   -0.0476181+0.10754im     -0.0219152+0.133809im      0.006443-0.133989im
   -0.326908-0.0875608im      0.178229+0.311197im     -0.105567+0.0238581im   -0.0282736+0.0886285im    -0.125755+0.0135687im     -0.213839+0.0244807im    -0.097914-0.188393im     -0.0905643-0.000671966im  -0.0913725-0.0832571im    0.0629558+0.159401im   -0.0483798+0.194132im      -0.192211+0.00074282im   -0.0681982-0.110818im       0.125605+0.0315623im      -0.138851-0.0513936im    0.0125117-0.0644941im      0.122097-0.195891im      -0.0526116+0.1574im         0.047079-0.0139751im   -0.0836479-0.106803im    -0.000537739+0.00895036im   0.0980762-0.0471702im      0.0432993-0.0146133im      -0.143592+0.0199129im      0.113004+0.0341902im      0.107095+0.0321355im   -0.147501-0.0449699im     -0.180453+0.129025im     -0.055795-0.340512im   -0.0212522-0.0962635im    -0.158249-0.0859101im     0.033318+0.202246im
  -0.0105235+0.144811im      -0.168975-0.103174im     -0.114711-0.0406748im    -0.163373-0.0605865im    0.0530223+0.0658496im     -0.142956+0.0672712im     0.156445+0.212757im    -0.00916278-0.199825im      -0.204181+0.101612im    -0.0633091-0.0527622im   -0.199367-0.00876033im    0.0216821+0.282731im      0.0791014-0.108637im      -0.170497+0.0333638im       0.134556+0.0954016im    -0.117907+0.12292im       0.0186866+0.0448633im      0.0170202+0.135974im     -0.0837763+0.0310192im    0.0164119+0.131279im      -0.0861337+0.13924im        0.21811-0.116671im      -0.0605818+0.0394784im       0.126542-0.113969im       0.102108+0.104787im      0.0324398-0.12665im    -0.0765691-0.3074im       -0.0549443+0.146618im     -0.055416-0.0789751im   -0.104693-0.244775im      0.151947-0.0640353im     0.116334+0.126738im
    0.112315+0.00870292im    -0.170935+0.0562762im   -0.0152323+0.146601im    -0.0644818+0.103779im      0.117572-0.119527im      0.0247653+0.0633798im    -0.224702+0.376524im     -0.0392343+0.0343213im     -0.107135+0.043965im      0.208641+0.170191im    -0.204432-0.0799193im    -0.0098688+0.0694103im      0.137941+0.0568596im   -0.00887241-0.110686im       0.0381899-0.0359812im     0.150114-0.0216333im      0.123056-0.134966im       -0.101432-0.0490153im     0.0333881-0.149897im     -0.215915-0.140263im      -0.0441365-0.100422im     -0.012931+0.071379im         0.21802+0.163031im      -0.0629437+0.044969im     -0.0954321+0.088794im      -0.125356+0.0734083im   0.0186366+0.0889834im     -0.119162+0.123149im    -0.0384017+0.188633im   -0.0683852+0.184874im    -0.0277039-0.280404im      0.108214+0.123072im
   0.0369517+0.0670112im     0.0941484+0.157238im     0.0100375-0.0272394im     0.246688+0.103424im     0.0465589+0.00687586im   -0.0949866-0.0964369im     0.117741+0.109775im      -0.107093-0.0234506im     -0.021538-0.07066im      0.0297731+0.124236im    0.0640922-0.0759635im   -0.00842916+0.201848im       0.362991+0.00796992im     0.121832-0.0796325im       0.018729+0.217649im    -0.0506928-0.052195im     -0.0254086-0.0409719im     -0.0160374-0.054285im       0.109697-0.0879813im   -0.0302905-0.0975179im       0.179279+0.218932im     -0.030313-0.111428im        -0.24745+0.159707im      -0.0774591+0.147063im       0.151715-0.00261835im   -0.0242985+0.179661im   -0.0521042-0.10289im      -0.0889495+0.0219911im     0.116445+0.0725619im   -0.131154-0.0624205im   -0.0359226+0.0454885im    -0.246704-0.354908im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 -0.016760148846640913 - 0.1241701915682129im
  0.061163397262461325 + 0.12375355970892674im
  0.027031409986754417 + 0.013553541927634173im
   0.07592552536717007 - 0.06433359641545444im
   0.07847185125524676 - 0.09465158039276901im
  -0.17511657114735807 - 0.07201148289231245im
  0.052400133377227646 + 0.0023610540876507075im
  -0.17343673715858654 - 0.019919391253715973im
    0.1672115372754195 + 0.061009273096558084im
    0.4005586991775121 + 0.0im
  -0.14864598443248217 - 0.009006364240397857im
   0.17235317946307202 + 0.11850106589737652im
   0.23090537870161904 + 0.06172184303399071im
   0.05914235856966122 - 0.07432963123135221im
  0.011173573944651655 + 0.09664615233128045im
    0.1209397626001327 - 0.1958432011977706im
   0.26968658922239447 - 0.13583967632626398im
   0.04811081012208392 - 0.1199311642818579im
  -0.04075839686243368 - 0.17242127198511534im
  -0.07641609434507463 + 0.03570944228923206im
   0.21981176961722904 + 0.19313164520139403im
  -0.10209580582724613 + 0.10486089615151742im
   0.08193219406406063 - 0.006177204485992932im
 -0.020303457377440184 + 0.07109758957315018im
 -0.022775633617281493 - 0.18952967181936986im
  -0.06209542013172942 + 0.04507758977563647im
   0.13862353189975513 + 0.040280123499300026im
  0.018914206249864757 + 0.0032850996699409357im
   0.13205619323399198 - 0.0673892911435464im
   -0.1869392424294813 - 0.03158077526010354im
   0.03382016513120373 + 0.16112261324879668im
  -0.20922008338166745 + 0.16000927210173702im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 10 June 2022 03:27">Friday 10 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
